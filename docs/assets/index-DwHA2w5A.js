var jd=Object.defineProperty;var Xd=(e,r,t)=>r in e?jd(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var At=(e,r,t)=>Xd(e,typeof r!="symbol"?r+"":r,t);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();const Yd=Math.sqrt(50),Kd=Math.sqrt(10),qd=Math.sqrt(2);function Li(e,r,t){const n=(r-e)/Math.max(0,t),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=Yd?10:i>=Kd?5:i>=qd?2:1;let o,c,l;return a<0?(l=Math.pow(10,-a)/s,o=Math.round(e*l),c=Math.round(r*l),o/l<e&&++o,c/l>r&&--c,l=-l):(l=Math.pow(10,a)*s,o=Math.round(e/l),c=Math.round(r/l),o*l<e&&++o,c*l>r&&--c),c<o&&.5<=t&&t<2?Li(e,r,t*2):[o,c,l]}function Jd(e,r,t){if(r=+r,e=+e,t=+t,!(t>0))return[];if(e===r)return[e];const n=r<e,[a,i,s]=n?Li(r,e,t):Li(e,r,t);if(!(i>=a))return[];const o=i-a+1,c=new Array(o);if(n)if(s<0)for(let l=0;l<o;++l)c[l]=(i-l)/-s;else for(let l=0;l<o;++l)c[l]=(i-l)*s;else if(s<0)for(let l=0;l<o;++l)c[l]=(a+l)/-s;else for(let l=0;l<o;++l)c[l]=(a+l)*s;return c}function io(e,r,t){return r=+r,e=+e,t=+t,Li(e,r,t)[2]}function Zd(e,r,t){r=+r,e=+e,t=+t;const n=r<e,a=n?io(r,e,t):io(e,r,t);return(n?-1:1)*(a<0?1/-a:a)}function Qd(e,r){let t;if(r===void 0)for(const n of e)n!=null&&(t<n||t===void 0&&n>=n)&&(t=n);else{let n=-1;for(let a of e)(a=r(a,++n,e))!=null&&(t<a||t===void 0&&a>=a)&&(t=a)}return t}var e1={value:()=>{}};function Vo(){for(var e=0,r=arguments.length,t={},n;e<r;++e){if(!(n=arguments[e]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new bi(t)}function bi(e){this._=e}function t1(e,r){return e.trim().split(/^|\s+/).map(function(t){var n="",a=t.indexOf(".");if(a>=0&&(n=t.slice(a+1),t=t.slice(0,a)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}bi.prototype=Vo.prototype={constructor:bi,on:function(e,r){var t=this._,n=t1(e+"",t),a,i=-1,s=n.length;if(arguments.length<2){for(;++i<s;)if((a=(e=n[i]).type)&&(a=r1(t[a],e.name)))return a;return}if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++i<s;)if(a=(e=n[i]).type)t[a]=r0(t[a],e.name,r);else if(r==null)for(a in t)t[a]=r0(t[a],e.name,null);return this},copy:function(){var e={},r=this._;for(var t in r)e[t]=r[t].slice();return new bi(e)},call:function(e,r){if((a=arguments.length-2)>0)for(var t=new Array(a),n=0,a,i;n<a;++n)t[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],n=0,a=i.length;n<a;++n)i[n].value.apply(r,t)},apply:function(e,r,t){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],a=0,i=n.length;a<i;++a)n[a].value.apply(r,t)}};function r1(e,r){for(var t=0,n=e.length,a;t<n;++t)if((a=e[t]).name===r)return a.value}function r0(e,r,t){for(var n=0,a=e.length;n<a;++n)if(e[n].name===r){e[n]=e1,e=e.slice(0,n).concat(e.slice(n+1));break}return t!=null&&e.push({name:r,value:t}),e}var so="http://www.w3.org/1999/xhtml";const n0={svg:"http://www.w3.org/2000/svg",xhtml:so,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function cs(e){var r=e+="",t=r.indexOf(":");return t>=0&&(r=e.slice(0,t))!=="xmlns"&&(e=e.slice(t+1)),n0.hasOwnProperty(r)?{space:n0[r],local:e}:e}function n1(e){return function(){var r=this.ownerDocument,t=this.namespaceURI;return t===so&&r.documentElement.namespaceURI===so?r.createElement(e):r.createElementNS(t,e)}}function a1(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Go(e){var r=cs(e);return(r.local?a1:n1)(r)}function i1(){}function jo(e){return e==null?i1:function(){return this.querySelector(e)}}function s1(e){typeof e!="function"&&(e=jo(e));for(var r=this._groups,t=r.length,n=new Array(t),a=0;a<t;++a)for(var i=r[a],s=i.length,o=n[a]=new Array(s),c,l,f=0;f<s;++f)(c=i[f])&&(l=e.call(c,c.__data__,f,i))&&("__data__"in c&&(l.__data__=c.__data__),o[f]=l);return new $t(n,this._parents)}function o1(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function c1(){return[]}function af(e){return e==null?c1:function(){return this.querySelectorAll(e)}}function l1(e){return function(){return o1(e.apply(this,arguments))}}function f1(e){typeof e=="function"?e=l1(e):e=af(e);for(var r=this._groups,t=r.length,n=[],a=[],i=0;i<t;++i)for(var s=r[i],o=s.length,c,l=0;l<o;++l)(c=s[l])&&(n.push(e.call(c,c.__data__,l,s)),a.push(c));return new $t(n,a)}function sf(e){return function(){return this.matches(e)}}function of(e){return function(r){return r.matches(e)}}var u1=Array.prototype.find;function h1(e){return function(){return u1.call(this.children,e)}}function d1(){return this.firstElementChild}function p1(e){return this.select(e==null?d1:h1(typeof e=="function"?e:of(e)))}var x1=Array.prototype.filter;function m1(){return Array.from(this.children)}function g1(e){return function(){return x1.call(this.children,e)}}function _1(e){return this.selectAll(e==null?m1:g1(typeof e=="function"?e:of(e)))}function v1(e){typeof e!="function"&&(e=sf(e));for(var r=this._groups,t=r.length,n=new Array(t),a=0;a<t;++a)for(var i=r[a],s=i.length,o=n[a]=[],c,l=0;l<s;++l)(c=i[l])&&e.call(c,c.__data__,l,i)&&o.push(c);return new $t(n,this._parents)}function cf(e){return new Array(e.length)}function w1(){return new $t(this._enter||this._groups.map(cf),this._parents)}function Mi(e,r){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=r}Mi.prototype={constructor:Mi,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,r){return this._parent.insertBefore(e,r)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function y1(e){return function(){return e}}function k1(e,r,t,n,a,i){for(var s=0,o,c=r.length,l=i.length;s<l;++s)(o=r[s])?(o.__data__=i[s],n[s]=o):t[s]=new Mi(e,i[s]);for(;s<c;++s)(o=r[s])&&(a[s]=o)}function E1(e,r,t,n,a,i,s){var o,c,l=new Map,f=r.length,u=i.length,d=new Array(f),h;for(o=0;o<f;++o)(c=r[o])&&(d[o]=h=s.call(c,c.__data__,o,r)+"",l.has(h)?a[o]=c:l.set(h,c));for(o=0;o<u;++o)h=s.call(e,i[o],o,i)+"",(c=l.get(h))?(n[o]=c,c.__data__=i[o],l.delete(h)):t[o]=new Mi(e,i[o]);for(o=0;o<f;++o)(c=r[o])&&l.get(d[o])===c&&(a[o]=c)}function T1(e){return e.__data__}function b1(e,r){if(!arguments.length)return Array.from(this,T1);var t=r?E1:k1,n=this._parents,a=this._groups;typeof e!="function"&&(e=y1(e));for(var i=a.length,s=new Array(i),o=new Array(i),c=new Array(i),l=0;l<i;++l){var f=n[l],u=a[l],d=u.length,h=A1(e.call(f,f&&f.__data__,l,n)),x=h.length,p=o[l]=new Array(x),m=s[l]=new Array(x),g=c[l]=new Array(d);t(f,u,p,m,g,h,r);for(var w=0,v=0,k,A;w<x;++w)if(k=p[w]){for(w>=v&&(v=w+1);!(A=m[v])&&++v<x;);k._next=A||null}}return s=new $t(s,n),s._enter=o,s._exit=c,s}function A1(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function S1(){return new $t(this._exit||this._groups.map(cf),this._parents)}function C1(e,r,t){var n=this.enter(),a=this,i=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),r!=null&&(a=r(a),a&&(a=a.selection())),t==null?i.remove():t(i),n&&a?n.merge(a).order():a}function F1(e){for(var r=e.selection?e.selection():e,t=this._groups,n=r._groups,a=t.length,i=n.length,s=Math.min(a,i),o=new Array(a),c=0;c<s;++c)for(var l=t[c],f=n[c],u=l.length,d=o[c]=new Array(u),h,x=0;x<u;++x)(h=l[x]||f[x])&&(d[x]=h);for(;c<a;++c)o[c]=t[c];return new $t(o,this._parents)}function R1(){for(var e=this._groups,r=-1,t=e.length;++r<t;)for(var n=e[r],a=n.length-1,i=n[a],s;--a>=0;)(s=n[a])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function I1(e){e||(e=O1);function r(u,d){return u&&d?e(u.__data__,d.__data__):!u-!d}for(var t=this._groups,n=t.length,a=new Array(n),i=0;i<n;++i){for(var s=t[i],o=s.length,c=a[i]=new Array(o),l,f=0;f<o;++f)(l=s[f])&&(c[f]=l);c.sort(r)}return new $t(a,this._parents).order()}function O1(e,r){return e<r?-1:e>r?1:e>=r?0:NaN}function D1(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function P1(){return Array.from(this)}function N1(){for(var e=this._groups,r=0,t=e.length;r<t;++r)for(var n=e[r],a=0,i=n.length;a<i;++a){var s=n[a];if(s)return s}return null}function L1(){let e=0;for(const r of this)++e;return e}function M1(){return!this.node()}function B1(e){for(var r=this._groups,t=0,n=r.length;t<n;++t)for(var a=r[t],i=0,s=a.length,o;i<s;++i)(o=a[i])&&e.call(o,o.__data__,i,a);return this}function U1(e){return function(){this.removeAttribute(e)}}function z1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function $1(e,r){return function(){this.setAttribute(e,r)}}function H1(e,r){return function(){this.setAttributeNS(e.space,e.local,r)}}function W1(e,r){return function(){var t=r.apply(this,arguments);t==null?this.removeAttribute(e):this.setAttribute(e,t)}}function V1(e,r){return function(){var t=r.apply(this,arguments);t==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}function G1(e,r){var t=cs(e);if(arguments.length<2){var n=this.node();return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}return this.each((r==null?t.local?z1:U1:typeof r=="function"?t.local?V1:W1:t.local?H1:$1)(t,r))}function lf(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function j1(e){return function(){this.style.removeProperty(e)}}function X1(e,r,t){return function(){this.style.setProperty(e,r,t)}}function Y1(e,r,t){return function(){var n=r.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,t)}}function K1(e,r,t){return arguments.length>1?this.each((r==null?j1:typeof r=="function"?Y1:X1)(e,r,t??"")):Nn(this.node(),e)}function Nn(e,r){return e.style.getPropertyValue(r)||lf(e).getComputedStyle(e,null).getPropertyValue(r)}function q1(e){return function(){delete this[e]}}function J1(e,r){return function(){this[e]=r}}function Z1(e,r){return function(){var t=r.apply(this,arguments);t==null?delete this[e]:this[e]=t}}function Q1(e,r){return arguments.length>1?this.each((r==null?q1:typeof r=="function"?Z1:J1)(e,r)):this.node()[e]}function ff(e){return e.trim().split(/^|\s+/)}function Xo(e){return e.classList||new uf(e)}function uf(e){this._node=e,this._names=ff(e.getAttribute("class")||"")}uf.prototype={add:function(e){var r=this._names.indexOf(e);r<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var r=this._names.indexOf(e);r>=0&&(this._names.splice(r,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function hf(e,r){for(var t=Xo(e),n=-1,a=r.length;++n<a;)t.add(r[n])}function df(e,r){for(var t=Xo(e),n=-1,a=r.length;++n<a;)t.remove(r[n])}function ep(e){return function(){hf(this,e)}}function tp(e){return function(){df(this,e)}}function rp(e,r){return function(){(r.apply(this,arguments)?hf:df)(this,e)}}function np(e,r){var t=ff(e+"");if(arguments.length<2){for(var n=Xo(this.node()),a=-1,i=t.length;++a<i;)if(!n.contains(t[a]))return!1;return!0}return this.each((typeof r=="function"?rp:r?ep:tp)(t,r))}function ap(){this.textContent=""}function ip(e){return function(){this.textContent=e}}function sp(e){return function(){var r=e.apply(this,arguments);this.textContent=r??""}}function op(e){return arguments.length?this.each(e==null?ap:(typeof e=="function"?sp:ip)(e)):this.node().textContent}function cp(){this.innerHTML=""}function lp(e){return function(){this.innerHTML=e}}function fp(e){return function(){var r=e.apply(this,arguments);this.innerHTML=r??""}}function up(e){return arguments.length?this.each(e==null?cp:(typeof e=="function"?fp:lp)(e)):this.node().innerHTML}function hp(){this.nextSibling&&this.parentNode.appendChild(this)}function dp(){return this.each(hp)}function pp(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function xp(){return this.each(pp)}function mp(e){var r=typeof e=="function"?e:Go(e);return this.select(function(){return this.appendChild(r.apply(this,arguments))})}function gp(){return null}function _p(e,r){var t=typeof e=="function"?e:Go(e),n=r==null?gp:typeof r=="function"?r:jo(r);return this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})}function vp(){var e=this.parentNode;e&&e.removeChild(this)}function wp(){return this.each(vp)}function yp(){var e=this.cloneNode(!1),r=this.parentNode;return r?r.insertBefore(e,this.nextSibling):e}function kp(){var e=this.cloneNode(!0),r=this.parentNode;return r?r.insertBefore(e,this.nextSibling):e}function Ep(e){return this.select(e?kp:yp)}function Tp(e){return arguments.length?this.property("__data__",e):this.node().__data__}function bp(e){return function(r){e.call(this,r,this.__data__)}}function Ap(e){return e.trim().split(/^|\s+/).map(function(r){var t="",n=r.indexOf(".");return n>=0&&(t=r.slice(n+1),r=r.slice(0,n)),{type:r,name:t}})}function Sp(e){return function(){var r=this.__on;if(r){for(var t=0,n=-1,a=r.length,i;t<a;++t)i=r[t],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):r[++n]=i;++n?r.length=n:delete this.__on}}}function Cp(e,r,t){return function(){var n=this.__on,a,i=bp(r);if(n){for(var s=0,o=n.length;s<o;++s)if((a=n[s]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=i,a.options=t),a.value=r;return}}this.addEventListener(e.type,i,t),a={type:e.type,name:e.name,value:r,listener:i,options:t},n?n.push(a):this.__on=[a]}}function Fp(e,r,t){var n=Ap(e+""),a,i=n.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var c=0,l=o.length,f;c<l;++c)for(a=0,f=o[c];a<i;++a)if((s=n[a]).type===f.type&&s.name===f.name)return f.value}return}for(o=r?Cp:Sp,a=0;a<i;++a)this.each(o(n[a],r,t));return this}function pf(e,r,t){var n=lf(e),a=n.CustomEvent;typeof a=="function"?a=new a(r,t):(a=n.document.createEvent("Event"),t?(a.initEvent(r,t.bubbles,t.cancelable),a.detail=t.detail):a.initEvent(r,!1,!1)),e.dispatchEvent(a)}function Rp(e,r){return function(){return pf(this,e,r)}}function Ip(e,r){return function(){return pf(this,e,r.apply(this,arguments))}}function Op(e,r){return this.each((typeof r=="function"?Ip:Rp)(e,r))}function*Dp(){for(var e=this._groups,r=0,t=e.length;r<t;++r)for(var n=e[r],a=0,i=n.length,s;a<i;++a)(s=n[a])&&(yield s)}var xf=[null];function $t(e,r){this._groups=e,this._parents=r}function La(){return new $t([[document.documentElement]],xf)}function Pp(){return this}$t.prototype=La.prototype={constructor:$t,select:s1,selectAll:f1,selectChild:p1,selectChildren:_1,filter:v1,data:b1,enter:w1,exit:S1,join:C1,merge:F1,selection:Pp,order:R1,sort:I1,call:D1,nodes:P1,node:N1,size:L1,empty:M1,each:B1,attr:G1,style:K1,property:Q1,classed:np,text:op,html:up,raise:dp,lower:xp,append:mp,insert:_p,remove:wp,clone:Ep,datum:Tp,on:Fp,dispatch:Op,[Symbol.iterator]:Dp};function Xt(e){return typeof e=="string"?new $t([[document.querySelector(e)]],[document.documentElement]):new $t([[e]],xf)}function Np(e){return Xt(Go(e).call(document.documentElement))}function Lp(e){let r;for(;r=e.sourceEvent;)e=r;return e}function Xr(e,r){if(e=Lp(e),r===void 0&&(r=e.currentTarget),r){var t=r.ownerSVGElement||r;if(t.createSVGPoint){var n=t.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(r.getScreenCTM().inverse()),[n.x,n.y]}if(r.getBoundingClientRect){var a=r.getBoundingClientRect();return[e.clientX-a.left-r.clientLeft,e.clientY-a.top-r.clientTop]}}return[e.pageX,e.pageY]}const oo={capture:!0,passive:!1};function co(e){e.preventDefault(),e.stopImmediatePropagation()}function Mp(e){var r=e.document.documentElement,t=Xt(e).on("dragstart.drag",co,oo);"onselectstart"in r?t.on("selectstart.drag",co,oo):(r.__noselect=r.style.MozUserSelect,r.style.MozUserSelect="none")}function Bp(e,r){var t=e.document.documentElement,n=Xt(e).on("dragstart.drag",null);r&&(n.on("click.drag",co,oo),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in t?n.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}function Yo(e,r,t){e.prototype=r.prototype=t,t.constructor=e}function mf(e,r){var t=Object.create(e.prototype);for(var n in r)t[n]=r[n];return t}function Ma(){}var Ea=.7,Bi=1/Ea,Sn="\\s*([+-]?\\d+)\\s*",Ta="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",mr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Up=/^#([0-9a-f]{3,8})$/,zp=new RegExp(`^rgb\\(${Sn},${Sn},${Sn}\\)$`),$p=new RegExp(`^rgb\\(${mr},${mr},${mr}\\)$`),Hp=new RegExp(`^rgba\\(${Sn},${Sn},${Sn},${Ta}\\)$`),Wp=new RegExp(`^rgba\\(${mr},${mr},${mr},${Ta}\\)$`),Vp=new RegExp(`^hsl\\(${Ta},${mr},${mr}\\)$`),Gp=new RegExp(`^hsla\\(${Ta},${mr},${mr},${Ta}\\)$`),a0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Yo(Ma,an,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:i0,formatHex:i0,formatHex8:jp,formatHsl:Xp,formatRgb:s0,toString:s0});function i0(){return this.rgb().formatHex()}function jp(){return this.rgb().formatHex8()}function Xp(){return gf(this).formatHsl()}function s0(){return this.rgb().formatRgb()}function an(e){var r,t;return e=(e+"").trim().toLowerCase(),(r=Up.exec(e))?(t=r[1].length,r=parseInt(r[1],16),t===6?o0(r):t===3?new Pt(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):t===8?ei(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):t===4?ei(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=zp.exec(e))?new Pt(r[1],r[2],r[3],1):(r=$p.exec(e))?new Pt(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=Hp.exec(e))?ei(r[1],r[2],r[3],r[4]):(r=Wp.exec(e))?ei(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=Vp.exec(e))?f0(r[1],r[2]/100,r[3]/100,1):(r=Gp.exec(e))?f0(r[1],r[2]/100,r[3]/100,r[4]):a0.hasOwnProperty(e)?o0(a0[e]):e==="transparent"?new Pt(NaN,NaN,NaN,0):null}function o0(e){return new Pt(e>>16&255,e>>8&255,e&255,1)}function ei(e,r,t,n){return n<=0&&(e=r=t=NaN),new Pt(e,r,t,n)}function Yp(e){return e instanceof Ma||(e=an(e)),e?(e=e.rgb(),new Pt(e.r,e.g,e.b,e.opacity)):new Pt}function Ui(e,r,t,n){return arguments.length===1?Yp(e):new Pt(e,r,t,n??1)}function Pt(e,r,t,n){this.r=+e,this.g=+r,this.b=+t,this.opacity=+n}Yo(Pt,Ui,mf(Ma,{brighter(e){return e=e==null?Bi:Math.pow(Bi,e),new Pt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ea:Math.pow(Ea,e),new Pt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Pt(tn(this.r),tn(this.g),tn(this.b),zi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:c0,formatHex:c0,formatHex8:Kp,formatRgb:l0,toString:l0}));function c0(){return`#${Zr(this.r)}${Zr(this.g)}${Zr(this.b)}`}function Kp(){return`#${Zr(this.r)}${Zr(this.g)}${Zr(this.b)}${Zr((isNaN(this.opacity)?1:this.opacity)*255)}`}function l0(){const e=zi(this.opacity);return`${e===1?"rgb(":"rgba("}${tn(this.r)}, ${tn(this.g)}, ${tn(this.b)}${e===1?")":`, ${e})`}`}function zi(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function tn(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Zr(e){return e=tn(e),(e<16?"0":"")+e.toString(16)}function f0(e,r,t,n){return n<=0?e=r=t=NaN:t<=0||t>=1?e=r=NaN:r<=0&&(e=NaN),new rr(e,r,t,n)}function gf(e){if(e instanceof rr)return new rr(e.h,e.s,e.l,e.opacity);if(e instanceof Ma||(e=an(e)),!e)return new rr;if(e instanceof rr)return e;e=e.rgb();var r=e.r/255,t=e.g/255,n=e.b/255,a=Math.min(r,t,n),i=Math.max(r,t,n),s=NaN,o=i-a,c=(i+a)/2;return o?(r===i?s=(t-n)/o+(t<n)*6:t===i?s=(n-r)/o+2:s=(r-t)/o+4,o/=c<.5?i+a:2-i-a,s*=60):o=c>0&&c<1?0:s,new rr(s,o,c,e.opacity)}function qp(e,r,t,n){return arguments.length===1?gf(e):new rr(e,r,t,n??1)}function rr(e,r,t,n){this.h=+e,this.s=+r,this.l=+t,this.opacity=+n}Yo(rr,qp,mf(Ma,{brighter(e){return e=e==null?Bi:Math.pow(Bi,e),new rr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ea:Math.pow(Ea,e),new rr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*r,a=2*t-n;return new Pt(Ss(e>=240?e-240:e+120,a,n),Ss(e,a,n),Ss(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new rr(u0(this.h),ti(this.s),ti(this.l),zi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=zi(this.opacity);return`${e===1?"hsl(":"hsla("}${u0(this.h)}, ${ti(this.s)*100}%, ${ti(this.l)*100}%${e===1?")":`, ${e})`}`}}));function u0(e){return e=(e||0)%360,e<0?e+360:e}function ti(e){return Math.max(0,Math.min(1,e||0))}function Ss(e,r,t){return(e<60?r+(t-r)*e/60:e<180?t:e<240?r+(t-r)*(240-e)/60:r)*255}function Jp(e,r,t,n,a){var i=e*e,s=i*e;return((1-3*e+3*i-s)*r+(4-6*i+3*s)*t+(1+3*e+3*i-3*s)*n+s*a)/6}function Zp(e){var r=e.length-1;return function(t){var n=t<=0?t=0:t>=1?(t=1,r-1):Math.floor(t*r),a=e[n],i=e[n+1],s=n>0?e[n-1]:2*a-i,o=n<r-1?e[n+2]:2*i-a;return Jp((t-n/r)*r,s,a,i,o)}}const Ko=e=>()=>e;function Qp(e,r){return function(t){return e+t*r}}function ex(e,r,t){return e=Math.pow(e,t),r=Math.pow(r,t)-e,t=1/t,function(n){return Math.pow(e+n*r,t)}}function tx(e){return(e=+e)==1?_f:function(r,t){return t-r?ex(r,t,e):Ko(isNaN(r)?t:r)}}function _f(e,r){var t=r-e;return t?Qp(e,t):Ko(isNaN(e)?r:e)}const $i=function e(r){var t=tx(r);function n(a,i){var s=t((a=Ui(a)).r,(i=Ui(i)).r),o=t(a.g,i.g),c=t(a.b,i.b),l=_f(a.opacity,i.opacity);return function(f){return a.r=s(f),a.g=o(f),a.b=c(f),a.opacity=l(f),a+""}}return n.gamma=e,n}(1);function rx(e){return function(r){var t=r.length,n=new Array(t),a=new Array(t),i=new Array(t),s,o;for(s=0;s<t;++s)o=Ui(r[s]),n[s]=o.r||0,a[s]=o.g||0,i[s]=o.b||0;return n=e(n),a=e(a),i=e(i),o.opacity=1,function(c){return o.r=n(c),o.g=a(c),o.b=i(c),o+""}}}var nx=rx(Zp);function ax(e,r){r||(r=[]);var t=e?Math.min(r.length,e.length):0,n=r.slice(),a;return function(i){for(a=0;a<t;++a)n[a]=e[a]*(1-i)+r[a]*i;return n}}function ix(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function sx(e,r){var t=r?r.length:0,n=e?Math.min(t,e.length):0,a=new Array(n),i=new Array(t),s;for(s=0;s<n;++s)a[s]=qo(e[s],r[s]);for(;s<t;++s)i[s]=r[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function ox(e,r){var t=new Date;return e=+e,r=+r,function(n){return t.setTime(e*(1-n)+r*n),t}}function pr(e,r){return e=+e,r=+r,function(t){return e*(1-t)+r*t}}function cx(e,r){var t={},n={},a;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(a in r)a in e?t[a]=qo(e[a],r[a]):n[a]=r[a];return function(i){for(a in t)n[a]=t[a](i);return n}}var lo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Cs=new RegExp(lo.source,"g");function lx(e){return function(){return e}}function fx(e){return function(r){return e(r)+""}}function vf(e,r){var t=lo.lastIndex=Cs.lastIndex=0,n,a,i,s=-1,o=[],c=[];for(e=e+"",r=r+"";(n=lo.exec(e))&&(a=Cs.exec(r));)(i=a.index)>t&&(i=r.slice(t,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,c.push({i:s,x:pr(n,a)})),t=Cs.lastIndex;return t<r.length&&(i=r.slice(t),o[s]?o[s]+=i:o[++s]=i),o.length<2?c[0]?fx(c[0].x):lx(r):(r=c.length,function(l){for(var f=0,u;f<r;++f)o[(u=c[f]).i]=u.x(l);return o.join("")})}function qo(e,r){var t=typeof r,n;return r==null||t==="boolean"?Ko(r):(t==="number"?pr:t==="string"?(n=an(r))?(r=n,$i):vf:r instanceof an?$i:r instanceof Date?ox:ix(r)?ax:Array.isArray(r)?sx:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?cx:pr)(e,r)}function ux(e,r){return e=+e,r=+r,function(t){return Math.round(e*(1-t)+r*t)}}var h0=180/Math.PI,fo={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function wf(e,r,t,n,a,i){var s,o,c;return(s=Math.sqrt(e*e+r*r))&&(e/=s,r/=s),(c=e*t+r*n)&&(t-=e*c,n-=r*c),(o=Math.sqrt(t*t+n*n))&&(t/=o,n/=o,c/=o),e*n<r*t&&(e=-e,r=-r,c=-c,s=-s),{translateX:a,translateY:i,rotate:Math.atan2(r,e)*h0,skewX:Math.atan(c)*h0,scaleX:s,scaleY:o}}var ri;function hx(e){const r=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return r.isIdentity?fo:wf(r.a,r.b,r.c,r.d,r.e,r.f)}function dx(e){return e==null||(ri||(ri=document.createElementNS("http://www.w3.org/2000/svg","g")),ri.setAttribute("transform",e),!(e=ri.transform.baseVal.consolidate()))?fo:(e=e.matrix,wf(e.a,e.b,e.c,e.d,e.e,e.f))}function yf(e,r,t,n){function a(l){return l.length?l.pop()+" ":""}function i(l,f,u,d,h,x){if(l!==u||f!==d){var p=h.push("translate(",null,r,null,t);x.push({i:p-4,x:pr(l,u)},{i:p-2,x:pr(f,d)})}else(u||d)&&h.push("translate("+u+r+d+t)}function s(l,f,u,d){l!==f?(l-f>180?f+=360:f-l>180&&(l+=360),d.push({i:u.push(a(u)+"rotate(",null,n)-2,x:pr(l,f)})):f&&u.push(a(u)+"rotate("+f+n)}function o(l,f,u,d){l!==f?d.push({i:u.push(a(u)+"skewX(",null,n)-2,x:pr(l,f)}):f&&u.push(a(u)+"skewX("+f+n)}function c(l,f,u,d,h,x){if(l!==u||f!==d){var p=h.push(a(h)+"scale(",null,",",null,")");x.push({i:p-4,x:pr(l,u)},{i:p-2,x:pr(f,d)})}else(u!==1||d!==1)&&h.push(a(h)+"scale("+u+","+d+")")}return function(l,f){var u=[],d=[];return l=e(l),f=e(f),i(l.translateX,l.translateY,f.translateX,f.translateY,u,d),s(l.rotate,f.rotate,u,d),o(l.skewX,f.skewX,u,d),c(l.scaleX,l.scaleY,f.scaleX,f.scaleY,u,d),l=f=null,function(h){for(var x=-1,p=d.length,m;++x<p;)u[(m=d[x]).i]=m.x(h);return u.join("")}}}var px=yf(hx,"px, ","px)","deg)"),xx=yf(dx,", ",")",")"),mx=1e-12;function d0(e){return((e=Math.exp(e))+1/e)/2}function gx(e){return((e=Math.exp(e))-1/e)/2}function _x(e){return((e=Math.exp(2*e))-1)/(e+1)}const vx=function e(r,t,n){function a(i,s){var o=i[0],c=i[1],l=i[2],f=s[0],u=s[1],d=s[2],h=f-o,x=u-c,p=h*h+x*x,m,g;if(p<mx)g=Math.log(d/l)/r,m=function(E){return[o+E*h,c+E*x,l*Math.exp(r*E*g)]};else{var w=Math.sqrt(p),v=(d*d-l*l+n*p)/(2*l*t*w),k=(d*d-l*l-n*p)/(2*d*t*w),A=Math.log(Math.sqrt(v*v+1)-v),F=Math.log(Math.sqrt(k*k+1)-k);g=(F-A)/r,m=function(E){var z=E*g,C=d0(A),G=l/(t*w)*(C*_x(r*z+A)-gx(A));return[o+G*h,c+G*x,l*C/d0(r*z+A)]}}return m.duration=g*1e3*r/Math.SQRT2,m}return a.rho=function(i){var s=Math.max(.001,+i),o=s*s,c=o*o;return e(s,o,c)},a}(Math.SQRT2,2,4);var Ln=0,ea=0,Zn=0,kf=1e3,Hi,ta,Wi=0,sn=0,ls=0,ba=typeof performance=="object"&&performance.now?performance:Date,Ef=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Jo(){return sn||(Ef(wx),sn=ba.now()+ls)}function wx(){sn=0}function Vi(){this._call=this._time=this._next=null}Vi.prototype=Tf.prototype={constructor:Vi,restart:function(e,r,t){if(typeof e!="function")throw new TypeError("callback is not a function");t=(t==null?Jo():+t)+(r==null?0:+r),!this._next&&ta!==this&&(ta?ta._next=this:Hi=this,ta=this),this._call=e,this._time=t,uo()},stop:function(){this._call&&(this._call=null,this._time=1/0,uo())}};function Tf(e,r,t){var n=new Vi;return n.restart(e,r,t),n}function yx(){Jo(),++Ln;for(var e=Hi,r;e;)(r=sn-e._time)>=0&&e._call.call(void 0,r),e=e._next;--Ln}function p0(){sn=(Wi=ba.now())+ls,Ln=ea=0;try{yx()}finally{Ln=0,Ex(),sn=0}}function kx(){var e=ba.now(),r=e-Wi;r>kf&&(ls-=r,Wi=e)}function Ex(){for(var e,r=Hi,t,n=1/0;r;)r._call?(n>r._time&&(n=r._time),e=r,r=r._next):(t=r._next,r._next=null,r=e?e._next=t:Hi=t);ta=e,uo(n)}function uo(e){if(!Ln){ea&&(ea=clearTimeout(ea));var r=e-sn;r>24?(e<1/0&&(ea=setTimeout(p0,e-ba.now()-ls)),Zn&&(Zn=clearInterval(Zn))):(Zn||(Wi=ba.now(),Zn=setInterval(kx,kf)),Ln=1,Ef(p0))}}function x0(e,r,t){var n=new Vi;return r=r==null?0:+r,n.restart(a=>{n.stop(),e(a+r)},r,t),n}var Tx=Vo("start","end","cancel","interrupt"),bx=[],bf=0,m0=1,ho=2,Ai=3,g0=4,po=5,Si=6;function fs(e,r,t,n,a,i){var s=e.__transition;if(!s)e.__transition={};else if(t in s)return;Ax(e,t,{name:r,index:n,group:a,on:Tx,tween:bx,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:bf})}function Zo(e,r){var t=cr(e,r);if(t.state>bf)throw new Error("too late; already scheduled");return t}function _r(e,r){var t=cr(e,r);if(t.state>Ai)throw new Error("too late; already running");return t}function cr(e,r){var t=e.__transition;if(!t||!(t=t[r]))throw new Error("transition not found");return t}function Ax(e,r,t){var n=e.__transition,a;n[r]=t,t.timer=Tf(i,0,t.time);function i(l){t.state=m0,t.timer.restart(s,t.delay,t.time),t.delay<=l&&s(l-t.delay)}function s(l){var f,u,d,h;if(t.state!==m0)return c();for(f in n)if(h=n[f],h.name===t.name){if(h.state===Ai)return x0(s);h.state===g0?(h.state=Si,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete n[f]):+f<r&&(h.state=Si,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete n[f])}if(x0(function(){t.state===Ai&&(t.state=g0,t.timer.restart(o,t.delay,t.time),o(l))}),t.state=ho,t.on.call("start",e,e.__data__,t.index,t.group),t.state===ho){for(t.state=Ai,a=new Array(d=t.tween.length),f=0,u=-1;f<d;++f)(h=t.tween[f].value.call(e,e.__data__,t.index,t.group))&&(a[++u]=h);a.length=u+1}}function o(l){for(var f=l<t.duration?t.ease.call(null,l/t.duration):(t.timer.restart(c),t.state=po,1),u=-1,d=a.length;++u<d;)a[u].call(e,f);t.state===po&&(t.on.call("end",e,e.__data__,t.index,t.group),c())}function c(){t.state=Si,t.timer.stop(),delete n[r];for(var l in n)return;delete e.__transition}}function Ci(e,r){var t=e.__transition,n,a,i=!0,s;if(t){r=r==null?null:r+"";for(s in t){if((n=t[s]).name!==r){i=!1;continue}a=n.state>ho&&n.state<po,n.state=Si,n.timer.stop(),n.on.call(a?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete t[s]}i&&delete e.__transition}}function Sx(e){return this.each(function(){Ci(this,e)})}function Cx(e,r){var t,n;return function(){var a=_r(this,e),i=a.tween;if(i!==t){n=t=i;for(var s=0,o=n.length;s<o;++s)if(n[s].name===r){n=n.slice(),n.splice(s,1);break}}a.tween=n}}function Fx(e,r,t){var n,a;if(typeof t!="function")throw new Error;return function(){var i=_r(this,e),s=i.tween;if(s!==n){a=(n=s).slice();for(var o={name:r,value:t},c=0,l=a.length;c<l;++c)if(a[c].name===r){a[c]=o;break}c===l&&a.push(o)}i.tween=a}}function Rx(e,r){var t=this._id;if(e+="",arguments.length<2){for(var n=cr(this.node(),t).tween,a=0,i=n.length,s;a<i;++a)if((s=n[a]).name===e)return s.value;return null}return this.each((r==null?Cx:Fx)(t,e,r))}function Qo(e,r,t){var n=e._id;return e.each(function(){var a=_r(this,n);(a.value||(a.value={}))[r]=t.apply(this,arguments)}),function(a){return cr(a,n).value[r]}}function Af(e,r){var t;return(typeof r=="number"?pr:r instanceof an?$i:(t=an(r))?(r=t,$i):vf)(e,r)}function Ix(e){return function(){this.removeAttribute(e)}}function Ox(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Dx(e,r,t){var n,a=t+"",i;return function(){var s=this.getAttribute(e);return s===a?null:s===n?i:i=r(n=s,t)}}function Px(e,r,t){var n,a=t+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===a?null:s===n?i:i=r(n=s,t)}}function Nx(e,r,t){var n,a,i;return function(){var s,o=t(this),c;return o==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=o+"",s===c?null:s===n&&c===a?i:(a=c,i=r(n=s,o)))}}function Lx(e,r,t){var n,a,i;return function(){var s,o=t(this),c;return o==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=o+"",s===c?null:s===n&&c===a?i:(a=c,i=r(n=s,o)))}}function Mx(e,r){var t=cs(e),n=t==="transform"?xx:Af;return this.attrTween(e,typeof r=="function"?(t.local?Lx:Nx)(t,n,Qo(this,"attr."+e,r)):r==null?(t.local?Ox:Ix)(t):(t.local?Px:Dx)(t,n,r))}function Bx(e,r){return function(t){this.setAttribute(e,r.call(this,t))}}function Ux(e,r){return function(t){this.setAttributeNS(e.space,e.local,r.call(this,t))}}function zx(e,r){var t,n;function a(){var i=r.apply(this,arguments);return i!==n&&(t=(n=i)&&Ux(e,i)),t}return a._value=r,a}function $x(e,r){var t,n;function a(){var i=r.apply(this,arguments);return i!==n&&(t=(n=i)&&Bx(e,i)),t}return a._value=r,a}function Hx(e,r){var t="attr."+e;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(r==null)return this.tween(t,null);if(typeof r!="function")throw new Error;var n=cs(e);return this.tween(t,(n.local?zx:$x)(n,r))}function Wx(e,r){return function(){Zo(this,e).delay=+r.apply(this,arguments)}}function Vx(e,r){return r=+r,function(){Zo(this,e).delay=r}}function Gx(e){var r=this._id;return arguments.length?this.each((typeof e=="function"?Wx:Vx)(r,e)):cr(this.node(),r).delay}function jx(e,r){return function(){_r(this,e).duration=+r.apply(this,arguments)}}function Xx(e,r){return r=+r,function(){_r(this,e).duration=r}}function Yx(e){var r=this._id;return arguments.length?this.each((typeof e=="function"?jx:Xx)(r,e)):cr(this.node(),r).duration}function Kx(e,r){if(typeof r!="function")throw new Error;return function(){_r(this,e).ease=r}}function qx(e){var r=this._id;return arguments.length?this.each(Kx(r,e)):cr(this.node(),r).ease}function Jx(e,r){return function(){var t=r.apply(this,arguments);if(typeof t!="function")throw new Error;_r(this,e).ease=t}}function Zx(e){if(typeof e!="function")throw new Error;return this.each(Jx(this._id,e))}function Qx(e){typeof e!="function"&&(e=sf(e));for(var r=this._groups,t=r.length,n=new Array(t),a=0;a<t;++a)for(var i=r[a],s=i.length,o=n[a]=[],c,l=0;l<s;++l)(c=i[l])&&e.call(c,c.__data__,l,i)&&o.push(c);return new Rr(n,this._parents,this._name,this._id)}function em(e){if(e._id!==this._id)throw new Error;for(var r=this._groups,t=e._groups,n=r.length,a=t.length,i=Math.min(n,a),s=new Array(n),o=0;o<i;++o)for(var c=r[o],l=t[o],f=c.length,u=s[o]=new Array(f),d,h=0;h<f;++h)(d=c[h]||l[h])&&(u[h]=d);for(;o<n;++o)s[o]=r[o];return new Rr(s,this._parents,this._name,this._id)}function tm(e){return(e+"").trim().split(/^|\s+/).every(function(r){var t=r.indexOf(".");return t>=0&&(r=r.slice(0,t)),!r||r==="start"})}function rm(e,r,t){var n,a,i=tm(r)?Zo:_r;return function(){var s=i(this,e),o=s.on;o!==n&&(a=(n=o).copy()).on(r,t),s.on=a}}function nm(e,r){var t=this._id;return arguments.length<2?cr(this.node(),t).on.on(e):this.each(rm(t,e,r))}function am(e){return function(){var r=this.parentNode;for(var t in this.__transition)if(+t!==e)return;r&&r.removeChild(this)}}function im(){return this.on("end.remove",am(this._id))}function sm(e){var r=this._name,t=this._id;typeof e!="function"&&(e=jo(e));for(var n=this._groups,a=n.length,i=new Array(a),s=0;s<a;++s)for(var o=n[s],c=o.length,l=i[s]=new Array(c),f,u,d=0;d<c;++d)(f=o[d])&&(u=e.call(f,f.__data__,d,o))&&("__data__"in f&&(u.__data__=f.__data__),l[d]=u,fs(l[d],r,t,d,l,cr(f,t)));return new Rr(i,this._parents,r,t)}function om(e){var r=this._name,t=this._id;typeof e!="function"&&(e=af(e));for(var n=this._groups,a=n.length,i=[],s=[],o=0;o<a;++o)for(var c=n[o],l=c.length,f,u=0;u<l;++u)if(f=c[u]){for(var d=e.call(f,f.__data__,u,c),h,x=cr(f,t),p=0,m=d.length;p<m;++p)(h=d[p])&&fs(h,r,t,p,d,x);i.push(d),s.push(f)}return new Rr(i,s,r,t)}var cm=La.prototype.constructor;function lm(){return new cm(this._groups,this._parents)}function fm(e,r){var t,n,a;return function(){var i=Nn(this,e),s=(this.style.removeProperty(e),Nn(this,e));return i===s?null:i===t&&s===n?a:a=r(t=i,n=s)}}function Sf(e){return function(){this.style.removeProperty(e)}}function um(e,r,t){var n,a=t+"",i;return function(){var s=Nn(this,e);return s===a?null:s===n?i:i=r(n=s,t)}}function hm(e,r,t){var n,a,i;return function(){var s=Nn(this,e),o=t(this),c=o+"";return o==null&&(c=o=(this.style.removeProperty(e),Nn(this,e))),s===c?null:s===n&&c===a?i:(a=c,i=r(n=s,o))}}function dm(e,r){var t,n,a,i="style."+r,s="end."+i,o;return function(){var c=_r(this,e),l=c.on,f=c.value[i]==null?o||(o=Sf(r)):void 0;(l!==t||a!==f)&&(n=(t=l).copy()).on(s,a=f),c.on=n}}function pm(e,r,t){var n=(e+="")=="transform"?px:Af;return r==null?this.styleTween(e,fm(e,n)).on("end.style."+e,Sf(e)):typeof r=="function"?this.styleTween(e,hm(e,n,Qo(this,"style."+e,r))).each(dm(this._id,e)):this.styleTween(e,um(e,n,r),t).on("end.style."+e,null)}function xm(e,r,t){return function(n){this.style.setProperty(e,r.call(this,n),t)}}function mm(e,r,t){var n,a;function i(){var s=r.apply(this,arguments);return s!==a&&(n=(a=s)&&xm(e,s,t)),n}return i._value=r,i}function gm(e,r,t){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(r==null)return this.tween(n,null);if(typeof r!="function")throw new Error;return this.tween(n,mm(e,r,t??""))}function _m(e){return function(){this.textContent=e}}function vm(e){return function(){var r=e(this);this.textContent=r??""}}function wm(e){return this.tween("text",typeof e=="function"?vm(Qo(this,"text",e)):_m(e==null?"":e+""))}function ym(e){return function(r){this.textContent=e.call(this,r)}}function km(e){var r,t;function n(){var a=e.apply(this,arguments);return a!==t&&(r=(t=a)&&ym(a)),r}return n._value=e,n}function Em(e){var r="text";if(arguments.length<1)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,km(e))}function Tm(){for(var e=this._name,r=this._id,t=Cf(),n=this._groups,a=n.length,i=0;i<a;++i)for(var s=n[i],o=s.length,c,l=0;l<o;++l)if(c=s[l]){var f=cr(c,r);fs(c,e,t,l,s,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Rr(n,this._parents,e,t)}function bm(){var e,r,t=this,n=t._id,a=t.size();return new Promise(function(i,s){var o={value:s},c={value:function(){--a===0&&i()}};t.each(function(){var l=_r(this,n),f=l.on;f!==e&&(r=(e=f).copy(),r._.cancel.push(o),r._.interrupt.push(o),r._.end.push(c)),l.on=r}),a===0&&i()})}var Am=0;function Rr(e,r,t,n){this._groups=e,this._parents=r,this._name=t,this._id=n}function Cf(){return++Am}var Er=La.prototype;Rr.prototype={constructor:Rr,select:sm,selectAll:om,selectChild:Er.selectChild,selectChildren:Er.selectChildren,filter:Qx,merge:em,selection:lm,transition:Tm,call:Er.call,nodes:Er.nodes,node:Er.node,size:Er.size,empty:Er.empty,each:Er.each,on:nm,attr:Mx,attrTween:Hx,style:pm,styleTween:gm,text:wm,textTween:Em,remove:im,tween:Rx,delay:Gx,duration:Yx,ease:qx,easeVarying:Zx,end:bm,[Symbol.iterator]:Er[Symbol.iterator]};function Sm(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Cm={time:null,delay:0,duration:250,ease:Sm};function Fm(e,r){for(var t;!(t=e.__transition)||!(t=t[r]);)if(!(e=e.parentNode))throw new Error(`transition ${r} not found`);return t}function Rm(e){var r,t;e instanceof Rr?(r=e._id,e=e._name):(r=Cf(),(t=Cm).time=Jo(),e=e==null?null:e+"");for(var n=this._groups,a=n.length,i=0;i<a;++i)for(var s=n[i],o=s.length,c,l=0;l<o;++l)(c=s[l])&&fs(c,e,r,l,s,t||Fm(c,r));return new Rr(n,this._parents,e,r)}La.prototype.interrupt=Sx;La.prototype.transition=Rm;const xo=Math.PI,mo=2*xo,Kr=1e-6,Im=mo-Kr;function Ff(e){this._+=e[0];for(let r=1,t=e.length;r<t;++r)this._+=arguments[r]+e[r]}function Om(e){let r=Math.floor(e);if(!(r>=0))throw new Error(`invalid digits: ${e}`);if(r>15)return Ff;const t=10**r;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*t)/t+n[a]}}class Dm{constructor(r){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=r==null?Ff:Om(r)}moveTo(r,t){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(r,t){this._append`L${this._x1=+r},${this._y1=+t}`}quadraticCurveTo(r,t,n,a){this._append`Q${+r},${+t},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(r,t,n,a,i,s){this._append`C${+r},${+t},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(r,t,n,a,i){if(r=+r,t=+t,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,c=n-r,l=a-t,f=s-r,u=o-t,d=f*f+u*u;if(this._x1===null)this._append`M${this._x1=r},${this._y1=t}`;else if(d>Kr)if(!(Math.abs(u*c-l*f)>Kr)||!i)this._append`L${this._x1=r},${this._y1=t}`;else{let h=n-s,x=a-o,p=c*c+l*l,m=h*h+x*x,g=Math.sqrt(p),w=Math.sqrt(d),v=i*Math.tan((xo-Math.acos((p+d-m)/(2*g*w)))/2),k=v/w,A=v/g;Math.abs(k-1)>Kr&&this._append`L${r+k*f},${t+k*u}`,this._append`A${i},${i},0,0,${+(u*h>f*x)},${this._x1=r+A*c},${this._y1=t+A*l}`}}arc(r,t,n,a,i,s){if(r=+r,t=+t,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),c=n*Math.sin(a),l=r+o,f=t+c,u=1^s,d=s?a-i:i-a;this._x1===null?this._append`M${l},${f}`:(Math.abs(this._x1-l)>Kr||Math.abs(this._y1-f)>Kr)&&this._append`L${l},${f}`,n&&(d<0&&(d=d%mo+mo),d>Im?this._append`A${n},${n},0,1,${u},${r-o},${t-c}A${n},${n},0,1,${u},${this._x1=l},${this._y1=f}`:d>Kr&&this._append`A${n},${n},0,${+(d>=xo)},${u},${this._x1=r+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(r,t,n,a){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+t}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function Pm(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Gi(e,r){if((t=(e=r?e.toExponential(r-1):e.toExponential()).indexOf("e"))<0)return null;var t,n=e.slice(0,t);return[n.length>1?n[0]+n.slice(2):n,+e.slice(t+1)]}function Mn(e){return e=Gi(Math.abs(e)),e?e[1]:NaN}function Nm(e,r){return function(t,n){for(var a=t.length,i=[],s=0,o=e[0],c=0;a>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),i.push(t.substring(a-=o,a+o)),!((c+=o+1)>n));)o=e[s=(s+1)%e.length];return i.reverse().join(r)}}function Lm(e){return function(r){return r.replace(/[0-9]/g,function(t){return e[+t]})}}var Mm=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ji(e){if(!(r=Mm.exec(e)))throw new Error("invalid format: "+e);var r;return new ec({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}ji.prototype=ec.prototype;function ec(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}ec.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Bm(e){e:for(var r=e.length,t=1,n=-1,a;t<r;++t)switch(e[t]){case".":n=a=t;break;case"0":n===0&&(n=t),a=t;break;default:if(!+e[t])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var Rf;function Um(e,r){var t=Gi(e,r);if(!t)return e+"";var n=t[0],a=t[1],i=a-(Rf=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Gi(e,Math.max(0,r+i-1))[0]}function _0(e,r){var t=Gi(e,r);if(!t)return e+"";var n=t[0],a=t[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const v0={"%":(e,r)=>(e*100).toFixed(r),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Pm,e:(e,r)=>e.toExponential(r),f:(e,r)=>e.toFixed(r),g:(e,r)=>e.toPrecision(r),o:e=>Math.round(e).toString(8),p:(e,r)=>_0(e*100,r),r:_0,s:Um,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function w0(e){return e}var y0=Array.prototype.map,k0=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function zm(e){var r=e.grouping===void 0||e.thousands===void 0?w0:Nm(y0.call(e.grouping,Number),e.thousands+""),t=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?w0:Lm(y0.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"−":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function l(u){u=ji(u);var d=u.fill,h=u.align,x=u.sign,p=u.symbol,m=u.zero,g=u.width,w=u.comma,v=u.precision,k=u.trim,A=u.type;A==="n"?(w=!0,A="g"):v0[A]||(v===void 0&&(v=12),k=!0,A="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var F=p==="$"?t:p==="#"&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",E=p==="$"?n:/[%p]/.test(A)?s:"",z=v0[A],C=/[defgprs%]/.test(A);v=v===void 0?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function G(H){var b=F,j=E,_,W,q;if(A==="c")j=z(H)+j,H="";else{H=+H;var X=H<0||1/H<0;if(H=isNaN(H)?c:z(Math.abs(H),v),k&&(H=Bm(H)),X&&+H==0&&x!=="+"&&(X=!1),b=(X?x==="("?x:o:x==="-"||x==="("?"":x)+b,j=(A==="s"?k0[8+Rf/3]:"")+j+(X&&x==="("?")":""),C){for(_=-1,W=H.length;++_<W;)if(q=H.charCodeAt(_),48>q||q>57){j=(q===46?a+H.slice(_+1):H.slice(_))+j,H=H.slice(0,_);break}}}w&&!m&&(H=r(H,1/0));var ue=b.length+H.length+j.length,P=ue<g?new Array(g-ue+1).join(d):"";switch(w&&m&&(H=r(P+H,P.length?g-j.length:1/0),P=""),h){case"<":H=b+H+j+P;break;case"=":H=b+P+H+j;break;case"^":H=P.slice(0,ue=P.length>>1)+b+H+j+P.slice(ue);break;default:H=P+b+H+j;break}return i(H)}return G.toString=function(){return u+""},G}function f(u,d){var h=l((u=ji(u),u.type="f",u)),x=Math.max(-8,Math.min(8,Math.floor(Mn(d)/3)))*3,p=Math.pow(10,-x),m=k0[8+x/3];return function(g){return h(p*g)+m}}return{format:l,formatPrefix:f}}var ni,If,Of;$m({thousands:",",grouping:[3],currency:["$",""]});function $m(e){return ni=zm(e),If=ni.format,Of=ni.formatPrefix,ni}function Hm(e){return Math.max(0,-Mn(Math.abs(e)))}function Wm(e,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Mn(r)/3)))*3-Mn(Math.abs(e)))}function Vm(e,r){return e=Math.abs(e),r=Math.abs(r)-e,Math.max(0,Mn(r)-Mn(e))+1}function Gm(e){var r=0,t=e.children,n=t&&t.length;if(!n)r=1;else for(;--n>=0;)r+=t[n].value;e.value=r}function jm(){return this.eachAfter(Gm)}function Xm(e,r){let t=-1;for(const n of this)e.call(r,n,++t,this);return this}function Ym(e,r){for(var t=this,n=[t],a,i,s=-1;t=n.pop();)if(e.call(r,t,++s,this),a=t.children)for(i=a.length-1;i>=0;--i)n.push(a[i]);return this}function Km(e,r){for(var t=this,n=[t],a=[],i,s,o,c=-1;t=n.pop();)if(a.push(t),i=t.children)for(s=0,o=i.length;s<o;++s)n.push(i[s]);for(;t=a.pop();)e.call(r,t,++c,this);return this}function qm(e,r){let t=-1;for(const n of this)if(e.call(r,n,++t,this))return n}function Jm(e){return this.eachAfter(function(r){for(var t=+e(r.data)||0,n=r.children,a=n&&n.length;--a>=0;)t+=n[a].value;r.value=t})}function Zm(e){return this.eachBefore(function(r){r.children&&r.children.sort(e)})}function Qm(e){for(var r=this,t=eg(r,e),n=[r];r!==t;)r=r.parent,n.push(r);for(var a=n.length;e!==t;)n.splice(a,0,e),e=e.parent;return n}function eg(e,r){if(e===r)return e;var t=e.ancestors(),n=r.ancestors(),a=null;for(e=t.pop(),r=n.pop();e===r;)a=e,e=t.pop(),r=n.pop();return a}function tg(){for(var e=this,r=[e];e=e.parent;)r.push(e);return r}function rg(){return Array.from(this)}function ng(){var e=[];return this.eachBefore(function(r){r.children||e.push(r)}),e}function ag(){var e=this,r=[];return e.each(function(t){t!==e&&r.push({source:t.parent,target:t})}),r}function*ig(){var e=this,r,t=[e],n,a,i;do for(r=t.reverse(),t=[];e=r.pop();)if(yield e,n=e.children)for(a=0,i=n.length;a<i;++a)t.push(n[a]);while(t.length)}function Df(e,r){e instanceof Map?(e=[void 0,e],r===void 0&&(r=cg)):r===void 0&&(r=og);for(var t=new Bn(e),n,a=[t],i,s,o,c;n=a.pop();)if((s=r(n.data))&&(c=(s=Array.from(s)).length))for(n.children=s,o=c-1;o>=0;--o)a.push(i=s[o]=new Bn(s[o])),i.parent=n,i.depth=n.depth+1;return t.eachBefore(Pf)}function sg(){return Df(this).eachBefore(lg)}function og(e){return e.children}function cg(e){return Array.isArray(e)?e[1]:null}function lg(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Pf(e){var r=0;do e.height=r;while((e=e.parent)&&e.height<++r)}function Bn(e){this.data=e,this.depth=this.height=0,this.parent=null}Bn.prototype=Df.prototype={constructor:Bn,count:jm,each:Xm,eachAfter:Km,eachBefore:Ym,find:qm,sum:Jm,sort:Zm,path:Qm,ancestors:tg,descendants:rg,leaves:ng,links:ag,copy:sg,[Symbol.iterator]:ig};function Fs(e){return e==null?null:fg(e)}function fg(e){if(typeof e!="function")throw new Error;return e}var ug={depth:-1},E0={},Rs={};function hg(e){return e.id}function dg(e){return e.parentId}function pg(){var e=hg,r=dg,t;function n(a){var i=Array.from(a),s=e,o=r,c,l,f,u,d,h,x,p,m=new Map;if(t!=null){const g=i.map((k,A)=>xg(t(k,A,a))),w=g.map(T0),v=new Set(g).add("");for(const k of w)v.has(k)||(v.add(k),g.push(k),w.push(T0(k)),i.push(Rs));s=(k,A)=>g[A],o=(k,A)=>w[A]}for(f=0,c=i.length;f<c;++f)l=i[f],h=i[f]=new Bn(l),(x=s(l,f,a))!=null&&(x+="")&&(p=h.id=x,m.set(p,m.has(p)?E0:h)),(x=o(l,f,a))!=null&&(x+="")&&(h.parent=x);for(f=0;f<c;++f)if(h=i[f],x=h.parent){if(d=m.get(x),!d)throw new Error("missing: "+x);if(d===E0)throw new Error("ambiguous: "+x);d.children?d.children.push(h):d.children=[h],h.parent=d}else{if(u)throw new Error("multiple roots");u=h}if(!u)throw new Error("no root");if(t!=null){for(;u.data===Rs&&u.children.length===1;)u=u.children[0],--c;for(let g=i.length-1;g>=0&&(h=i[g],h.data===Rs);--g)h.data=null}if(u.parent=ug,u.eachBefore(function(g){g.depth=g.parent.depth+1,--c}).eachBefore(Pf),u.parent=null,c>0)throw new Error("cycle");return u}return n.id=function(a){return arguments.length?(e=Fs(a),n):e},n.parentId=function(a){return arguments.length?(r=Fs(a),n):r},n.path=function(a){return arguments.length?(t=Fs(a),n):t},n}function xg(e){e=`${e}`;let r=e.length;return go(e,r-1)&&!go(e,r-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function T0(e){let r=e.length;if(r<2)return"";for(;--r>1&&!go(e,r););return e.slice(0,r)}function go(e,r){if(e[r]==="/"){let t=0;for(;r>0&&e[--r]==="\\";)++t;if((t&1)===0)return!0}return!1}function mg(e,r){return e.parent===r.parent?1:2}function Is(e){var r=e.children;return r?r[0]:e.t}function Os(e){var r=e.children;return r?r[r.length-1]:e.t}function gg(e,r,t){var n=t/(r.i-e.i);r.c-=n,r.s+=t,e.c+=n,r.z+=t,r.m+=t}function _g(e){for(var r=0,t=0,n=e.children,a=n.length,i;--a>=0;)i=n[a],i.z+=r,i.m+=r,r+=i.s+(t+=i.c)}function vg(e,r,t){return e.a.parent===r.parent?e.a:t}function Fi(e,r){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=r}Fi.prototype=Object.create(Bn.prototype);function wg(e){for(var r=new Fi(e,0),t,n=[r],a,i,s,o;t=n.pop();)if(i=t._.children)for(t.children=new Array(o=i.length),s=o-1;s>=0;--s)n.push(a=t.children[s]=new Fi(i[s],s)),a.parent=t;return(r.parent=new Fi(null,0)).children=[r],r}function yg(){var e=mg,r=1,t=1,n=null;function a(l){var f=wg(l);if(f.eachAfter(i),f.parent.m=-f.z,f.eachBefore(s),n)l.eachBefore(c);else{var u=l,d=l,h=l;l.eachBefore(function(w){w.x<u.x&&(u=w),w.x>d.x&&(d=w),w.depth>h.depth&&(h=w)});var x=u===d?1:e(u,d)/2,p=x-u.x,m=r/(d.x+x+p),g=t/(h.depth||1);l.eachBefore(function(w){w.x=(w.x+p)*m,w.y=w.depth*g})}return l}function i(l){var f=l.children,u=l.parent.children,d=l.i?u[l.i-1]:null;if(f){_g(l);var h=(f[0].z+f[f.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=o(l,d,l.parent.A||u[0])}function s(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function o(l,f,u){if(f){for(var d=l,h=l,x=f,p=d.parent.children[0],m=d.m,g=h.m,w=x.m,v=p.m,k;x=Os(x),d=Is(d),x&&d;)p=Is(p),h=Os(h),h.a=l,k=x.z+w-d.z-m+e(x._,d._),k>0&&(gg(vg(x,l,u),l,k),m+=k,g+=k),w+=x.m,m+=d.m,v+=p.m,g+=h.m;x&&!Os(h)&&(h.t=x,h.m+=w-g),d&&!Is(p)&&(p.t=d,p.m+=m-v,u=l)}return u}function c(l){l.x*=r,l.y=l.depth*t}return a.separation=function(l){return arguments.length?(e=l,a):e},a.size=function(l){return arguments.length?(n=!1,r=+l[0],t=+l[1],a):n?null:[r,t]},a.nodeSize=function(l){return arguments.length?(n=!0,r=+l[0],t=+l[1],a):n?[r,t]:null},a}function kg(e,r){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof r=="function"?this.interpolator(r):this.range(r);break}}return this}function Nf(e){return e}function Eg(e,r,t,n){var a=Zd(e,r,t),i;switch(n=ji(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(r));return n.precision==null&&!isNaN(i=Wm(a,s))&&(n.precision=i),Of(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=Vm(a,Math.max(Math.abs(e),Math.abs(r))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=Hm(a))&&(n.precision=i-(n.type==="%")*2);break}}return If(n)}function Tg(e){var r=e.domain;return e.ticks=function(t){var n=r();return Jd(n[0],n[n.length-1],t??10)},e.tickFormat=function(t,n){var a=r();return Eg(a[0],a[a.length-1],t??10,n)},e.nice=function(t){t==null&&(t=10);var n=r(),a=0,i=n.length-1,s=n[a],o=n[i],c,l,f=10;for(o<s&&(l=s,s=o,o=l,l=a,a=i,i=l);f-- >0;){if(l=io(s,o,t),l===c)return n[a]=s,n[i]=o,r(n);if(l>0)s=Math.floor(s/l)*l,o=Math.ceil(o/l)*l;else if(l<0)s=Math.ceil(s*l)/l,o=Math.floor(o*l)/l;else break;c=l}return e},e}function bg(){var e=0,r=1,t,n,a,i,s=Nf,o=!1,c;function l(u){return u==null||isNaN(u=+u)?c:s(a===0?.5:(u=(i(u)-t)*a,o?Math.max(0,Math.min(1,u)):u))}l.domain=function(u){return arguments.length?([e,r]=u,t=i(e=+e),n=i(r=+r),a=t===n?0:1/(n-t),l):[e,r]},l.clamp=function(u){return arguments.length?(o=!!u,l):o},l.interpolator=function(u){return arguments.length?(s=u,l):s};function f(u){return function(d){var h,x;return arguments.length?([h,x]=d,s=u(h,x),l):[s(0),s(1)]}}return l.range=f(qo),l.rangeRound=f(ux),l.unknown=function(u){return arguments.length?(c=u,l):c},function(u){return i=u,t=u(e),n=u(r),a=t===n?0:1/(n-t),l}}function Ag(e,r){return r.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Lf(){var e=Tg(bg()(Nf));return e.copy=function(){return Ag(e,Lf())},kg.apply(e,arguments)}function Sg(e){for(var r=e.length/6|0,t=new Array(r),n=0;n<r;)t[n]="#"+e.slice(n*6,++n*6);return t}const Cg=e=>nx(e[e.length-1]);var Fg=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Sg);const Rg=Cg(Fg);function b0(e){return function(){return e}}function Ig(e){let r=3;return e.digits=function(t){if(!arguments.length)return r;if(t==null)r=null;else{const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);r=n}return e},()=>new Dm(r)}var Og=Array.prototype.slice;function Dg(e){return e[0]}function Pg(e){return e[1]}class Ng{constructor(r,t){this._context=r,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(r,t){switch(r=+r,t=+t,this._point){case 0:{this._point=1,this._line?this._context.lineTo(r,t):this._context.moveTo(r,t);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+r)/2,this._y0,this._x0,t,r,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,r,this._y0,r,t);break}}this._x0=r,this._y0=t}}function Lg(e){return new Ng(e,!1)}function Mg(e){return e.source}function Bg(e){return e.target}function Ug(e){let r=Mg,t=Bg,n=Dg,a=Pg,i=null,s=null,o=Ig(c);function c(){let l;const f=Og.call(arguments),u=r.apply(this,f),d=t.apply(this,f);if(i==null&&(s=e(l=o())),s.lineStart(),f[0]=u,s.point(+n.apply(this,f),+a.apply(this,f)),f[0]=d,s.point(+n.apply(this,f),+a.apply(this,f)),s.lineEnd(),l)return s=null,l+""||null}return c.source=function(l){return arguments.length?(r=l,c):r},c.target=function(l){return arguments.length?(t=l,c):t},c.x=function(l){return arguments.length?(n=typeof l=="function"?l:b0(+l),c):n},c.y=function(l){return arguments.length?(a=typeof l=="function"?l:b0(+l),c):a},c.context=function(l){return arguments.length?(l==null?i=s=null:s=e(i=l),c):i},c}function zg(){return Ug(Lg)}const ai=e=>()=>e;function $g(e,{sourceEvent:r,target:t,transform:n,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:r,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:a}})}function Ar(e,r,t){this.k=e,this.x=r,this.y=t}Ar.prototype={constructor:Ar,scale:function(e){return e===1?this:new Ar(this.k*e,this.x,this.y)},translate:function(e,r){return e===0&r===0?this:new Ar(this.k,this.x+this.k*e,this.y+this.k*r)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Mf=new Ar(1,0,0);Ar.prototype;function Ds(e){e.stopImmediatePropagation()}function Qn(e){e.preventDefault(),e.stopImmediatePropagation()}function Hg(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Wg(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function A0(){return this.__zoom||Mf}function Vg(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Gg(){return navigator.maxTouchPoints||"ontouchstart"in this}function jg(e,r,t){var n=e.invertX(r[0][0])-t[0][0],a=e.invertX(r[1][0])-t[1][0],i=e.invertY(r[0][1])-t[0][1],s=e.invertY(r[1][1])-t[1][1];return e.translate(a>n?(n+a)/2:Math.min(0,n)||Math.max(0,a),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function Xg(){var e=Hg,r=Wg,t=jg,n=Vg,a=Gg,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],o=250,c=vx,l=Vo("start","zoom","end"),f,u,d,h=500,x=150,p=0,m=10;function g(_){_.property("__zoom",A0).on("wheel.zoom",z,{passive:!1}).on("mousedown.zoom",C).on("dblclick.zoom",G).filter(a).on("touchstart.zoom",H).on("touchmove.zoom",b).on("touchend.zoom touchcancel.zoom",j).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(_,W,q,X){var ue=_.selection?_.selection():_;ue.property("__zoom",A0),_!==ue?A(_,W,q,X):ue.interrupt().each(function(){F(this,arguments).event(X).start().zoom(null,typeof W=="function"?W.apply(this,arguments):W).end()})},g.scaleBy=function(_,W,q,X){g.scaleTo(_,function(){var ue=this.__zoom.k,P=typeof W=="function"?W.apply(this,arguments):W;return ue*P},q,X)},g.scaleTo=function(_,W,q,X){g.transform(_,function(){var ue=r.apply(this,arguments),P=this.__zoom,se=q==null?k(ue):typeof q=="function"?q.apply(this,arguments):q,Y=P.invert(se),T=typeof W=="function"?W.apply(this,arguments):W;return t(v(w(P,T),se,Y),ue,s)},q,X)},g.translateBy=function(_,W,q,X){g.transform(_,function(){return t(this.__zoom.translate(typeof W=="function"?W.apply(this,arguments):W,typeof q=="function"?q.apply(this,arguments):q),r.apply(this,arguments),s)},null,X)},g.translateTo=function(_,W,q,X,ue){g.transform(_,function(){var P=r.apply(this,arguments),se=this.__zoom,Y=X==null?k(P):typeof X=="function"?X.apply(this,arguments):X;return t(Mf.translate(Y[0],Y[1]).scale(se.k).translate(typeof W=="function"?-W.apply(this,arguments):-W,typeof q=="function"?-q.apply(this,arguments):-q),P,s)},X,ue)};function w(_,W){return W=Math.max(i[0],Math.min(i[1],W)),W===_.k?_:new Ar(W,_.x,_.y)}function v(_,W,q){var X=W[0]-q[0]*_.k,ue=W[1]-q[1]*_.k;return X===_.x&&ue===_.y?_:new Ar(_.k,X,ue)}function k(_){return[(+_[0][0]+ +_[1][0])/2,(+_[0][1]+ +_[1][1])/2]}function A(_,W,q,X){_.on("start.zoom",function(){F(this,arguments).event(X).start()}).on("interrupt.zoom end.zoom",function(){F(this,arguments).event(X).end()}).tween("zoom",function(){var ue=this,P=arguments,se=F(ue,P).event(X),Y=r.apply(ue,P),T=q==null?k(Y):typeof q=="function"?q.apply(ue,P):q,K=Math.max(Y[1][0]-Y[0][0],Y[1][1]-Y[0][1]),B=ue.__zoom,N=typeof W=="function"?W.apply(ue,P):W,ie=c(B.invert(T).concat(K/B.k),N.invert(T).concat(K/N.k));return function(pe){if(pe===1)pe=N;else{var fe=ie(pe),le=K/fe[2];pe=new Ar(le,T[0]-fe[0]*le,T[1]-fe[1]*le)}se.zoom(null,pe)}})}function F(_,W,q){return!q&&_.__zooming||new E(_,W)}function E(_,W){this.that=_,this.args=W,this.active=0,this.sourceEvent=null,this.extent=r.apply(_,W),this.taps=0}E.prototype={event:function(_){return _&&(this.sourceEvent=_),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(_,W){return this.mouse&&_!=="mouse"&&(this.mouse[1]=W.invert(this.mouse[0])),this.touch0&&_!=="touch"&&(this.touch0[1]=W.invert(this.touch0[0])),this.touch1&&_!=="touch"&&(this.touch1[1]=W.invert(this.touch1[0])),this.that.__zoom=W,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(_){var W=Xt(this.that).datum();l.call(_,this.that,new $g(_,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:l}),W)}};function z(_,...W){if(!e.apply(this,arguments))return;var q=F(this,W).event(_),X=this.__zoom,ue=Math.max(i[0],Math.min(i[1],X.k*Math.pow(2,n.apply(this,arguments)))),P=Xr(_);if(q.wheel)(q.mouse[0][0]!==P[0]||q.mouse[0][1]!==P[1])&&(q.mouse[1]=X.invert(q.mouse[0]=P)),clearTimeout(q.wheel);else{if(X.k===ue)return;q.mouse=[P,X.invert(P)],Ci(this),q.start()}Qn(_),q.wheel=setTimeout(se,x),q.zoom("mouse",t(v(w(X,ue),q.mouse[0],q.mouse[1]),q.extent,s));function se(){q.wheel=null,q.end()}}function C(_,...W){if(d||!e.apply(this,arguments))return;var q=_.currentTarget,X=F(this,W,!0).event(_),ue=Xt(_.view).on("mousemove.zoom",T,!0).on("mouseup.zoom",K,!0),P=Xr(_,q),se=_.clientX,Y=_.clientY;Mp(_.view),Ds(_),X.mouse=[P,this.__zoom.invert(P)],Ci(this),X.start();function T(B){if(Qn(B),!X.moved){var N=B.clientX-se,ie=B.clientY-Y;X.moved=N*N+ie*ie>p}X.event(B).zoom("mouse",t(v(X.that.__zoom,X.mouse[0]=Xr(B,q),X.mouse[1]),X.extent,s))}function K(B){ue.on("mousemove.zoom mouseup.zoom",null),Bp(B.view,X.moved),Qn(B),X.event(B).end()}}function G(_,...W){if(e.apply(this,arguments)){var q=this.__zoom,X=Xr(_.changedTouches?_.changedTouches[0]:_,this),ue=q.invert(X),P=q.k*(_.shiftKey?.5:2),se=t(v(w(q,P),X,ue),r.apply(this,W),s);Qn(_),o>0?Xt(this).transition().duration(o).call(A,se,X,_):Xt(this).call(g.transform,se,X,_)}}function H(_,...W){if(e.apply(this,arguments)){var q=_.touches,X=q.length,ue=F(this,W,_.changedTouches.length===X).event(_),P,se,Y,T;for(Ds(_),se=0;se<X;++se)Y=q[se],T=Xr(Y,this),T=[T,this.__zoom.invert(T),Y.identifier],ue.touch0?!ue.touch1&&ue.touch0[2]!==T[2]&&(ue.touch1=T,ue.taps=0):(ue.touch0=T,P=!0,ue.taps=1+!!f);f&&(f=clearTimeout(f)),P&&(ue.taps<2&&(u=T[0],f=setTimeout(function(){f=null},h)),Ci(this),ue.start())}}function b(_,...W){if(this.__zooming){var q=F(this,W).event(_),X=_.changedTouches,ue=X.length,P,se,Y,T;for(Qn(_),P=0;P<ue;++P)se=X[P],Y=Xr(se,this),q.touch0&&q.touch0[2]===se.identifier?q.touch0[0]=Y:q.touch1&&q.touch1[2]===se.identifier&&(q.touch1[0]=Y);if(se=q.that.__zoom,q.touch1){var K=q.touch0[0],B=q.touch0[1],N=q.touch1[0],ie=q.touch1[1],pe=(pe=N[0]-K[0])*pe+(pe=N[1]-K[1])*pe,fe=(fe=ie[0]-B[0])*fe+(fe=ie[1]-B[1])*fe;se=w(se,Math.sqrt(pe/fe)),Y=[(K[0]+N[0])/2,(K[1]+N[1])/2],T=[(B[0]+ie[0])/2,(B[1]+ie[1])/2]}else if(q.touch0)Y=q.touch0[0],T=q.touch0[1];else return;q.zoom("touch",t(v(se,Y,T),q.extent,s))}}function j(_,...W){if(this.__zooming){var q=F(this,W).event(_),X=_.changedTouches,ue=X.length,P,se;for(Ds(_),d&&clearTimeout(d),d=setTimeout(function(){d=null},h),P=0;P<ue;++P)se=X[P],q.touch0&&q.touch0[2]===se.identifier?delete q.touch0:q.touch1&&q.touch1[2]===se.identifier&&delete q.touch1;if(q.touch1&&!q.touch0&&(q.touch0=q.touch1,delete q.touch1),q.touch0)q.touch0[1]=this.__zoom.invert(q.touch0[0]);else if(q.end(),q.taps===2&&(se=Xr(se,this),Math.hypot(u[0]-se[0],u[1]-se[1])<m)){var Y=Xt(this).on("dblclick.zoom");Y&&Y.apply(this,arguments)}}}return g.wheelDelta=function(_){return arguments.length?(n=typeof _=="function"?_:ai(+_),g):n},g.filter=function(_){return arguments.length?(e=typeof _=="function"?_:ai(!!_),g):e},g.touchable=function(_){return arguments.length?(a=typeof _=="function"?_:ai(!!_),g):a},g.extent=function(_){return arguments.length?(r=typeof _=="function"?_:ai([[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]]),g):r},g.scaleExtent=function(_){return arguments.length?(i[0]=+_[0],i[1]=+_[1],g):[i[0],i[1]]},g.translateExtent=function(_){return arguments.length?(s[0][0]=+_[0][0],s[1][0]=+_[1][0],s[0][1]=+_[0][1],s[1][1]=+_[1][1],g):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},g.constrain=function(_){return arguments.length?(t=_,g):t},g.duration=function(_){return arguments.length?(o=+_,g):o},g.interpolate=function(_){return arguments.length?(c=_,g):c},g.on=function(){var _=l.on.apply(l,arguments);return _===l?g:_},g.clickDistance=function(_){return arguments.length?(p=(_=+_)*_,g):Math.sqrt(p)},g.tapDistance=function(_){return arguments.length?(m=+_,g):m},g}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Bf=1252,Yg=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],tc={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},rc=function(e){Yg.indexOf(e)!=-1&&(Bf=tc[0]=e)};function Kg(){rc(1252)}var ar=function(e){rc(e)};function Uf(){ar(1200),Kg()}function S0(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function qg(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function zf(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var ra=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?qg(e.slice(2)):r==254&&t==255?zf(e.slice(2)):r==65279?e.slice(1):e},ii=function(r){return String.fromCharCode(r)},C0=function(r){return String.fromCharCode(r)},_o,Br="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function F0(e){for(var r="",t=0,n=0,a=0,i=0,s=0,o=0,c=0,l=0;l<e.length;)t=e.charCodeAt(l++),i=t>>2,n=e.charCodeAt(l++),s=(t&3)<<4|n>>4,a=e.charCodeAt(l++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),r+=Br.charAt(i)+Br.charAt(s)+Br.charAt(o)+Br.charAt(c);return r}function Ht(e){var r="",t=0,n=0,a=0,i=0,s=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)i=Br.indexOf(e.charAt(l++)),s=Br.indexOf(e.charAt(l++)),t=i<<2|s>>4,r+=String.fromCharCode(t),o=Br.indexOf(e.charAt(l++)),n=(s&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(n)),c=Br.indexOf(e.charAt(l++)),a=(o&3)<<6|c,c!==64&&(r+=String.fromCharCode(a));return r}var Ne=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),fn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function $r(e){return Ne?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function R0(e){return Ne?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var nr=function(r){return Ne?fn(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function un(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function nc(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return nc(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var Mr=Ne?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:fn(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)if(a=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Jg(e){for(var r=[],t=0,n=e.length+250,a=$r(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[t++]=s;else if(s<2048)a[t++]=192|s>>6&31,a[t++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[t++]=240|s>>8&7,a[t++]=128|s>>2&63,a[t++]=128|o>>6&15|(s&3)<<4,a[t++]=128|o&63}else a[t++]=224|s>>12&15,a[t++]=128|s>>6&63,a[t++]=128|s&63;t>n&&(r.push(a.slice(0,t)),t=0,a=$r(65535),n=65530)}return r.push(a.slice(0,t)),Mr(r)}var Rt=/\u0000/g,na=/[\u0001-\u0006]/g;function Cn(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function ir(e,r){var t=""+e;return t.length>=r?t:qe("0",r-t.length)+t}function ac(e,r){var t=""+e;return t.length>=r?t:qe(" ",r-t.length)+t}function Xi(e,r){var t=""+e;return t.length>=r?t:t+qe(" ",r-t.length)}function Zg(e,r){var t=""+Math.round(e);return t.length>=r?t:qe("0",r-t.length)+t}function Qg(e,r){var t=""+e;return t.length>=r?t:qe("0",r-t.length)+t}var I0=Math.pow(2,32);function gn(e,r){if(e>I0||e<-I0)return Zg(e,r);var t=Math.round(e);return Qg(t,r)}function Yi(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var O0=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ps=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function e_(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Oe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},D0={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},t_={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ki(e,r,t){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,c=1,l=0,f=0,u=Math.floor(a);l<r&&(u=Math.floor(a),o=u*s+i,f=u*l+c,!(a-u<5e-8));)a=1/(a-u),i=s,s=o,c=l,l=f;if(f>r&&(l>r?(f=c,o=i):(f=l,o=s)),!t)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function Qr(e,r,t){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=t?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=t?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),t&&(i=o_(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var $f=new Date(1899,11,31,0,0,0),r_=$f.getTime(),n_=new Date(1900,2,1,0,0,0);function Hf(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=n_&&(t+=24*60*60*1e3),(t-(r_+(e.getTimezoneOffset()-$f.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ic(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function a_(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function i_(e){var r=e<0?12:11,t=ic(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function s_(e){var r=ic(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Aa(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=i_(e):r===10?t=e.toFixed(10).substr(0,12):t=s_(e),ic(a_(t.toUpperCase()))}function on(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Aa(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Kt(14,Hf(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function o_(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function c_(e,r,t,n){var a="",i=0,s=0,o=t.y,c,l=0;switch(e){case 98:o=t.y+543;case 121:switch(r.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(r.length){case 1:case 2:c=t.m,l=r.length;break;case 3:return Ps[t.m-1][1];case 5:return Ps[t.m-1][0];default:return Ps[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=t.d,l=r.length;break;case 3:return O0[t.q][0];default:return O0[t.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(t.H+11)%12,l=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=t.H,l=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=t.M,l=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?ir(t.S,r.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(t.S+t.u)),i>=60*s&&(i=0),r==="s"?i===0?"0":""+i/s:(a=ir(i,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}l=r.length===3?1:2;break;case 101:c=o,l=1;break}var f=l>0?ir(c,l):"";return f}function Ur(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var Wf=/%/g;function l_(e,r,t){var n=r.replace(Wf,""),a=r.length-n.length;return Cr(e,n,t*Math.pow(10,2*a))+qe("%",a)}function f_(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Cr(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function Vf(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Vf(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),t=(r/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),t.indexOf("e")===-1){var s=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Gf=/# (\?+)( ?)\/( ?)(\d+)/;function u_(e,r,t){var n=parseInt(e[4],10),a=Math.round(r*n),i=Math.floor(a/n),s=a-i*n,o=n;return t+(i===0?"":""+i)+" "+(s===0?qe(" ",e[1].length+1+e[4].length):ac(s,e[1].length)+e[2]+"/"+e[3]+ir(o,e[4].length))}function h_(e,r,t){return t+(r===0?"":""+r)+qe(" ",e[1].length+2+e[4].length)}var jf=/^#*0*\.([0#]+)/,Xf=/\).*[0#]/,Yf=/\(###\) ###\\?-####/;function St(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function P0(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function N0(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function d_(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function p_(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Gt(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Xf)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Gt("n",n,t):"("+Gt("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return f_(e,r,t);if(r.indexOf("%")!==-1)return l_(e,r,t);if(r.indexOf("E")!==-1)return Vf(r,t);if(r.charCodeAt(0)===36)return"$"+Gt(e,r.substr(r.charAt(1)==" "?2:1),t);var a,i,s,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+gn(c,r.length);if(r.match(/^[#?]+$/))return a=gn(t,0),a==="0"&&(a=""),a.length>r.length?a:St(r.substr(0,r.length-a.length))+a;if(i=r.match(Gf))return u_(i,c,l);if(r.match(/^#+0+$/))return l+gn(c,r.length-r.indexOf("0"));if(i=r.match(jf))return a=P0(t,i[1].length).replace(/^([^\.]+)$/,"$1."+St(i[1])).replace(/\.$/,"."+St(i[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+qe("0",St(i[1]).length-p.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return l+P0(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return l+Ur(gn(c,0));if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Gt(e,r,-t):Ur(""+(Math.floor(t)+d_(t,i[1].length)))+"."+ir(N0(t,i[1].length),i[1].length);if(i=r.match(/^#,#*,#0/))return Gt(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Cn(Gt(e,r.replace(/[\\-]/g,""),t)),s=0,Cn(Cn(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(r.match(Yf))return a=Gt(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Ki(c,Math.pow(10,s)-1,!1),a=""+l,f=Cr("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=Xi(o[2],s),f.length<i[4].length&&(f=St(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Ki(c,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ac(o[1],s)+i[2]+"/"+i[3]+Xi(o[2],s):qe(" ",2*s+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=gn(t,0),r.length<=a.length?a:St(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var u=r.indexOf(".")-s,d=r.length-a.length-u;return St(r.substr(0,u)+a+r.substr(r.length-d))}if(i=r.match(/^00,000\.([#0]*0)$/))return s=N0(t,i[1].length),t<0?"-"+Gt(e,r,-t):Ur(p_(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ir(0,3-x.length):"")+x})+"."+ir(s,i[1].length);switch(r){case"###,##0.00":return Gt(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var h=Ur(gn(c,0));return h!=="0"?l+h:"";case"###,###.00":return Gt(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Gt(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function x_(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Cr(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function m_(e,r,t){var n=r.replace(Wf,""),a=r.length-n.length;return Cr(e,n,t*Math.pow(10,2*a))+qe("%",a)}function Kf(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Kf(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),t=(r/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!t.match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ur(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Xf)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ur("n",n,t):"("+ur("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return x_(e,r,t);if(r.indexOf("%")!==-1)return m_(e,r,t);if(r.indexOf("E")!==-1)return Kf(r,t);if(r.charCodeAt(0)===36)return"$"+ur(e,r.substr(r.charAt(1)==" "?2:1),t);var a,i,s,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+ir(c,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:St(r.substr(0,r.length-a.length))+a;if(i=r.match(Gf))return h_(i,c,l);if(r.match(/^#+0+$/))return l+ir(c,r.length-r.indexOf("0"));if(i=r.match(jf))return a=(""+t).replace(/^([^\.]+)$/,"$1."+St(i[1])).replace(/\.$/,"."+St(i[1])),a=a.replace(/\.(\d*)$/,function(x,p){return"."+p+qe("0",St(i[1]).length-p.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return l+Ur(""+c);if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ur(e,r,-t):Ur(""+t)+"."+qe("0",i[1].length);if(i=r.match(/^#,#*,#0/))return ur(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Cn(ur(e,r.replace(/[\\-]/g,""),t)),s=0,Cn(Cn(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(r.match(Yf))return a=ur(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Ki(c,Math.pow(10,s)-1,!1),a=""+l,f=Cr("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=Xi(o[2],s),f.length<i[4].length&&(f=St(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Ki(c,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ac(o[1],s)+i[2]+"/"+i[3]+Xi(o[2],s):qe(" ",2*s+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:St(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var u=r.indexOf(".")-s,d=r.length-a.length-u;return St(r.substr(0,u)+a+r.substr(r.length-d))}if(i=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ur(e,r,-t):Ur(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ir(0,3-x.length):"")+x})+"."+ir(0,i[1].length);switch(r){case"###,###":case"##,###":case"#,###":var h=Ur(""+c);return h!=="0"?l+h:"";default:if(r.match(/\.[0#?]*$/))return ur(e,r.slice(0,r.lastIndexOf(".")),t)+St(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Cr(e,r,t){return(t|0)===t?ur(e,r,t):Gt(e,r,t)}function g_(e){for(var r=[],t=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(a,n-a),a=n+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var qf=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Wn(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Yi(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(qf))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function __(e,r,t,n){for(var a=[],i="",s=0,o="",c="t",l,f,u,d="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!Yi(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(u=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(u);a[a.length]={t:"t",v:i},++s;break;case"\\":var h=e.charAt(++s),x=h==="("||h===")"?h:"t";a[a.length]={t:x,v:h},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:r},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(l==null&&(l=Qr(r,t,e.charAt(s+1)==="2"),l==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||l==null&&(l=Qr(r,t),l==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),a[a.length]={t:o,v:i},c=o;break;case"A":case"a":case"上":var p={t:o,v:o};if(l==null&&(l=Qr(r,t)),e.substr(s,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",d="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",s+=5,d="h"):e.substr(s,5).toUpperCase()==="上午/下午"?(l!=null&&(p.v=l.H>=12?"下午":"上午"),p.t="T",s+=5,d="h"):(p.t="t",++s),l==null&&p.t==="T")return"";a[a.length]=p,c=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(qf)){if(l==null&&(l=Qr(r,t),l==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Wn(e)||(a[a.length]={t:"t",v:i}));break;case".":if(l!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},c=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var m=0,g=0,w;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=d,c="h",m<1&&(m=1);break;case"s":(w=a[s].v.match(/\.0+$/))&&(g=Math.max(g,w[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":c=a[s].t;break;case"m":c==="s"&&(a[s].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&a[s].v.match(/[Hh]/)&&(m=1),m<2&&a[s].v.match(/[Mm]/)&&(m=2),m<3&&a[s].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var v="",k;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=c_(a[s].t.charCodeAt(0),a[s].v,l,g),a[s].t="t";break;case"n":case"?":for(k=s+1;a[k]!=null&&((o=a[k].t)==="?"||o==="D"||(o===" "||o==="t")&&a[k+1]!=null&&(a[k+1].t==="?"||a[k+1].t==="t"&&a[k+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[k].v==="/"||a[k].v===" "&&a[k+1]!=null&&a[k+1].t=="?"));)a[s].v+=a[k].v,a[k]={v:"",t:";"},++k;v+=a[s].v,s=k-1;break;case"G":a[s].t="t",a[s].v=on(r,t);break}var A="",F,E;if(v.length>0){v.charCodeAt(0)==40?(F=r<0&&v.charCodeAt(0)===45?-r:r,E=Cr("n",v,F)):(F=r<0&&n>1?-r:r,E=Cr("n",v,F),F<0&&a[0]&&a[0].t=="t"&&(E=E.substr(1),a[0].v="-"+a[0].v)),k=E.length-1;var z=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){z=s;break}var C=a.length;if(z===a.length&&E.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(k>=a[s].v.length-1?(k-=a[s].v.length,a[s].v=E.substr(k+1,a[s].v.length)):k<0?a[s].v="":(a[s].v=E.substr(0,k+1),k=-1),a[s].t="t",C=s);k>=0&&C<a.length&&(a[C].v=E.substr(0,k+1)+a[C].v)}else if(z!==a.length&&E.indexOf("E")===-1){for(k=E.indexOf(".")-1,s=z;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(f=a[s].v.indexOf(".")>-1&&s===z?a[s].v.indexOf(".")-1:a[s].v.length-1,A=a[s].v.substr(f+1);f>=0;--f)k>=0&&(a[s].v.charAt(f)==="0"||a[s].v.charAt(f)==="#")&&(A=E.charAt(k--)+A);a[s].v=A,a[s].t="t",C=s}for(k>=0&&C<a.length&&(a[C].v=E.substr(0,k+1)+a[C].v),k=E.indexOf(".")+1,s=z;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==z)){for(f=a[s].v.indexOf(".")>-1&&s===z?a[s].v.indexOf(".")+1:0,A=a[s].v.substr(0,f);f<a[s].v.length;++f)k<E.length&&(A+=E.charAt(k++));a[s].v=A,a[s].t="t",C=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(F=n>1&&r<0&&s>0&&a[s-1].v==="-"?-r:r,a[s].v=Cr(a[s].t,a[s].v,F),a[s].t="t");var G="";for(s=0;s!==a.length;++s)a[s]!=null&&(G+=a[s].v);return G}var L0=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function M0(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function v_(e,r){var t=g_(e),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var i=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,i];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var s=t[0].match(L0),o=t[1].match(L0);return M0(r,s)?[n,t[0]]:M0(r,o)?[n,t[1]]:[n,t[s!=null&&o!=null?2:1]]}return[n,i]}function Kt(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:Oe)[e],n==null&&(n=t.table&&t.table[D0[e]]||Oe[D0[e]]),n==null&&(n=t_[e]||"General");break}if(Yi(n,0))return on(r,t);r instanceof Date&&(r=Hf(r,t.date1904));var a=v_(n,r);if(Yi(a[1]))return on(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return __(a[1],r,t,a[0])}function rn(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(Oe[t]==null){r<0&&(r=t);continue}if(Oe[t]==e){r=t;break}}r<0&&(r=391)}return Oe[r]=e,r}function Jf(){Oe=e_()}var w_={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Zf=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function y_(e){var r=typeof e=="number"?Oe[e]:e;return r=r.replace(Zf,"(\\d+)"),new RegExp("^"+r+"$")}function k_(e,r,t){var n=-1,a=-1,i=-1,s=-1,o=-1,c=-1;(r.match(Zf)||[]).forEach(function(u,d){var h=parseInt(t[d+1],10);switch(u.toLowerCase().charAt(0)){case"y":n=h;break;case"d":i=h;break;case"h":s=h;break;case"s":c=h;break;case"m":s>=0?o=h:a=h;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?l:n==-1&&a==-1&&i==-1?f:l+"T"+f}var E_=function(){var e={};e.version="1.2.0";function r(){for(var E=0,z=new Array(256),C=0;C!=256;++C)E=C,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,z[C]=E;return typeof Int32Array<"u"?new Int32Array(z):z}var t=r();function n(E){var z=0,C=0,G=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(G=0;G!=256;++G)H[G]=E[G];for(G=0;G!=256;++G)for(C=E[G],z=256+G;z<4096;z+=256)C=H[z]=C>>>8^E[C&255];var b=[];for(G=1;G!=16;++G)b[G-1]=typeof Int32Array<"u"?H.subarray(G*256,G*256+256):H.slice(G*256,G*256+256);return b}var a=n(t),i=a[0],s=a[1],o=a[2],c=a[3],l=a[4],f=a[5],u=a[6],d=a[7],h=a[8],x=a[9],p=a[10],m=a[11],g=a[12],w=a[13],v=a[14];function k(E,z){for(var C=z^-1,G=0,H=E.length;G<H;)C=C>>>8^t[(C^E.charCodeAt(G++))&255];return~C}function A(E,z){for(var C=z^-1,G=E.length-15,H=0;H<G;)C=v[E[H++]^C&255]^w[E[H++]^C>>8&255]^g[E[H++]^C>>16&255]^m[E[H++]^C>>>24]^p[E[H++]]^x[E[H++]]^h[E[H++]]^d[E[H++]]^u[E[H++]]^f[E[H++]]^l[E[H++]]^c[E[H++]]^o[E[H++]]^s[E[H++]]^i[E[H++]]^t[E[H++]];for(G+=15;H<G;)C=C>>>8^t[(C^E[H++])&255];return~C}function F(E,z){for(var C=z^-1,G=0,H=E.length,b=0,j=0;G<H;)b=E.charCodeAt(G++),b<128?C=C>>>8^t[(C^b)&255]:b<2048?(C=C>>>8^t[(C^(192|b>>6&31))&255],C=C>>>8^t[(C^(128|b&63))&255]):b>=55296&&b<57344?(b=(b&1023)+64,j=E.charCodeAt(G++)&1023,C=C>>>8^t[(C^(240|b>>8&7))&255],C=C>>>8^t[(C^(128|b>>2&63))&255],C=C>>>8^t[(C^(128|j>>6&15|(b&3)<<4))&255],C=C>>>8^t[(C^(128|j&63))&255]):(C=C>>>8^t[(C^(224|b>>12&15))&255],C=C>>>8^t[(C^(128|b>>6&63))&255],C=C>>>8^t[(C^(128|b&63))&255]);return~C}return e.table=t,e.bstr=k,e.buf=A,e.str=F,e}(),Me=function(){var r={};r.version="1.2.1";function t(S,L){for(var I=S.split("/"),D=L.split("/"),M=0,U=0,te=Math.min(I.length,D.length);M<te;++M){if(U=I[M].length-D[M].length)return U;if(I[M]!=D[M])return I[M]<D[M]?-1:1}return I.length-D.length}function n(S){if(S.charAt(S.length-1)=="/")return S.slice(0,-1).indexOf("/")===-1?S:n(S.slice(0,-1));var L=S.lastIndexOf("/");return L===-1?S:S.slice(0,L+1)}function a(S){if(S.charAt(S.length-1)=="/")return a(S.slice(0,-1));var L=S.lastIndexOf("/");return L===-1?S:S.slice(L+1)}function i(S,L){typeof L=="string"&&(L=new Date(L));var I=L.getHours();I=I<<6|L.getMinutes(),I=I<<5|L.getSeconds()>>>1,S.write_shift(2,I);var D=L.getFullYear()-1980;D=D<<4|L.getMonth()+1,D=D<<5|L.getDate(),S.write_shift(2,D)}function s(S){var L=S.read_shift(2)&65535,I=S.read_shift(2)&65535,D=new Date,M=I&31;I>>>=5;var U=I&15;I>>>=4,D.setMilliseconds(0),D.setFullYear(I+1980),D.setMonth(U-1),D.setDate(M);var te=L&31;L>>>=5;var oe=L&63;return L>>>=6,D.setHours(L),D.setMinutes(oe),D.setSeconds(te<<1),D}function o(S){dt(S,0);for(var L={},I=0;S.l<=S.length-4;){var D=S.read_shift(2),M=S.read_shift(2),U=S.l+M,te={};switch(D){case 21589:I=S.read_shift(1),I&1&&(te.mtime=S.read_shift(4)),M>5&&(I&2&&(te.atime=S.read_shift(4)),I&4&&(te.ctime=S.read_shift(4))),te.mtime&&(te.mt=new Date(te.mtime*1e3));break}S.l=U,L[D]=te}return L}var c;function l(){return c||(c={})}function f(S,L){if(S[0]==80&&S[1]==75)return Za(S,L);if((S[0]|32)==109&&(S[1]|32)==105)return zd(S,L);if(S.length<512)throw new Error("CFB file size "+S.length+" < 512");var I=3,D=512,M=0,U=0,te=0,oe=0,ee=0,re=[],ne=S.slice(0,512);dt(ne,0);var ge=u(ne);switch(I=ge[0],I){case 3:D=512;break;case 4:D=4096;break;case 0:if(ge[1]==0)return Za(S,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}D!==512&&(ne=S.slice(0,D),dt(ne,28));var we=S.slice(0,D);d(ne,I);var ke=ne.read_shift(4,"i");if(I===3&&ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ke);ne.l+=4,te=ne.read_shift(4,"i"),ne.l+=4,ne.chk("00100000","Mini Stream Cutoff Size: "),oe=ne.read_shift(4,"i"),M=ne.read_shift(4,"i"),ee=ne.read_shift(4,"i"),U=ne.read_shift(4,"i");for(var _e=-1,ye=0;ye<109&&(_e=ne.read_shift(4,"i"),!(_e<0));++ye)re[ye]=_e;var Ie=h(S,D);m(ee,U,Ie,D,re);var Xe=w(Ie,te,re,D);Xe[te].name="!Directory",M>0&&oe!==j&&(Xe[oe].name="!MiniFAT"),Xe[re[0]].name="!FAT",Xe.fat_addrs=re,Xe.ssz=D;var Ye={},gt=[],Kn=[],qn=[];v(te,Xe,Ie,gt,M,Ye,Kn,oe),x(Kn,qn,gt),gt.shift();var Jn={FileIndex:Kn,FullPaths:qn};return L&&L.raw&&(Jn.raw={header:we,sectors:Ie}),Jn}function u(S){if(S[S.l]==80&&S[S.l+1]==75)return[0,0];S.chk(_,"Header Signature: "),S.l+=16;var L=S.read_shift(2,"u");return[S.read_shift(2,"u"),L]}function d(S,L){var I=9;switch(S.l+=2,I=S.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}S.chk("0600","Mini Sector Shift: "),S.chk("000000000000","Reserved: ")}function h(S,L){for(var I=Math.ceil(S.length/L)-1,D=[],M=1;M<I;++M)D[M-1]=S.slice(M*L,(M+1)*L);return D[I-1]=S.slice(I*L),D}function x(S,L,I){for(var D=0,M=0,U=0,te=0,oe=0,ee=I.length,re=[],ne=[];D<ee;++D)re[D]=ne[D]=D,L[D]=I[D];for(;oe<ne.length;++oe)D=ne[oe],M=S[D].L,U=S[D].R,te=S[D].C,re[D]===D&&(M!==-1&&re[M]!==M&&(re[D]=re[M]),U!==-1&&re[U]!==U&&(re[D]=re[U])),te!==-1&&(re[te]=D),M!==-1&&D!=re[D]&&(re[M]=re[D],ne.lastIndexOf(M)<oe&&ne.push(M)),U!==-1&&D!=re[D]&&(re[U]=re[D],ne.lastIndexOf(U)<oe&&ne.push(U));for(D=1;D<ee;++D)re[D]===D&&(U!==-1&&re[U]!==U?re[D]=re[U]:M!==-1&&re[M]!==M&&(re[D]=re[M]));for(D=1;D<ee;++D)if(S[D].type!==0){if(oe=D,oe!=re[oe])do oe=re[oe],L[D]=L[oe]+"/"+L[D];while(oe!==0&&re[oe]!==-1&&oe!=re[oe]);re[D]=-1}for(L[0]+="/",D=1;D<ee;++D)S[D].type!==2&&(L[D]+="/")}function p(S,L,I){for(var D=S.start,M=S.size,U=[],te=D;I&&M>0&&te>=0;)U.push(L.slice(te*b,te*b+b)),M-=b,te=qr(I,te*4);return U.length===0?at(0):Mr(U).slice(0,S.size)}function m(S,L,I,D,M){var U=j;if(S===j){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(S!==-1){var te=I[S],oe=(D>>>2)-1;if(!te)return;for(var ee=0;ee<oe&&(U=qr(te,ee*4))!==j;++ee)M.push(U);m(qr(te,D-4),L-1,I,D,M)}}function g(S,L,I,D,M){var U=[],te=[];M||(M=[]);var oe=D-1,ee=0,re=0;for(ee=L;ee>=0;){M[ee]=!0,U[U.length]=ee,te.push(S[ee]);var ne=I[Math.floor(ee*4/D)];if(re=ee*4&oe,D<4+re)throw new Error("FAT boundary crossed: "+ee+" 4 "+D);if(!S[ne])break;ee=qr(S[ne],re)}return{nodes:U,data:X0([te])}}function w(S,L,I,D){var M=S.length,U=[],te=[],oe=[],ee=[],re=D-1,ne=0,ge=0,we=0,ke=0;for(ne=0;ne<M;++ne)if(oe=[],we=ne+L,we>=M&&(we-=M),!te[we]){ee=[];var _e=[];for(ge=we;ge>=0;){_e[ge]=!0,te[ge]=!0,oe[oe.length]=ge,ee.push(S[ge]);var ye=I[Math.floor(ge*4/D)];if(ke=ge*4&re,D<4+ke)throw new Error("FAT boundary crossed: "+ge+" 4 "+D);if(!S[ye]||(ge=qr(S[ye],ke),_e[ge]))break}U[we]={nodes:oe,data:X0([ee])}}return U}function v(S,L,I,D,M,U,te,oe){for(var ee=0,re=D.length?2:0,ne=L[S].data,ge=0,we=0,ke;ge<ne.length;ge+=128){var _e=ne.slice(ge,ge+128);dt(_e,64),we=_e.read_shift(2),ke=fc(_e,0,we-re),D.push(ke);var ye={name:ke,type:_e.read_shift(1),color:_e.read_shift(1),L:_e.read_shift(4,"i"),R:_e.read_shift(4,"i"),C:_e.read_shift(4,"i"),clsid:_e.read_shift(16),state:_e.read_shift(4,"i"),start:0,size:0},Ie=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);Ie!==0&&(ye.ct=k(_e,_e.l-8));var Xe=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);Xe!==0&&(ye.mt=k(_e,_e.l-8)),ye.start=_e.read_shift(4,"i"),ye.size=_e.read_shift(4,"i"),ye.size<0&&ye.start<0&&(ye.size=ye.type=0,ye.start=j,ye.name=""),ye.type===5?(ee=ye.start,M>0&&ee!==j&&(L[ee].name="!StreamData")):ye.size>=4096?(ye.storage="fat",L[ye.start]===void 0&&(L[ye.start]=g(I,ye.start,L.fat_addrs,L.ssz)),L[ye.start].name=ye.name,ye.content=L[ye.start].data.slice(0,ye.size)):(ye.storage="minifat",ye.size<0?ye.size=0:ee!==j&&ye.start!==j&&L[ee]&&(ye.content=p(ye,L[ee].data,(L[oe]||{}).data))),ye.content&&dt(ye.content,0),U[ke]=ye,te.push(ye)}}function k(S,L){return new Date((Ut(S,L+4)/1e7*Math.pow(2,32)+Ut(S,L)/1e7-11644473600)*1e3)}function A(S,L){return l(),f(c.readFileSync(S),L)}function F(S,L){var I=L&&L.type;switch(I||Ne&&Buffer.isBuffer(S)&&(I="buffer"),I||"base64"){case"file":return A(S,L);case"base64":return f(nr(Ht(S)),L);case"binary":return f(nr(S),L)}return f(S,L)}function E(S,L){var I=L||{},D=I.root||"Root Entry";if(S.FullPaths||(S.FullPaths=[]),S.FileIndex||(S.FileIndex=[]),S.FullPaths.length!==S.FileIndex.length)throw new Error("inconsistent CFB structure");S.FullPaths.length===0&&(S.FullPaths[0]=D+"/",S.FileIndex[0]={name:D,type:5}),I.CLSID&&(S.FileIndex[0].clsid=I.CLSID),z(S)}function z(S){var L="Sh33tJ5";if(!Me.find(S,"/"+L)){var I=at(4);I[0]=55,I[1]=I[3]=50,I[2]=54,S.FileIndex.push({name:L,type:2,content:I,size:4,L:69,R:69,C:69}),S.FullPaths.push(S.FullPaths[0]+L),C(S)}}function C(S,L){E(S);for(var I=!1,D=!1,M=S.FullPaths.length-1;M>=0;--M){var U=S.FileIndex[M];switch(U.type){case 0:D?I=!0:(S.FileIndex.pop(),S.FullPaths.pop());break;case 1:case 2:case 5:D=!0,isNaN(U.R*U.L*U.C)&&(I=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!L)){var te=new Date(1987,1,19),oe=0,ee=Object.create?Object.create(null):{},re=[];for(M=0;M<S.FullPaths.length;++M)ee[S.FullPaths[M]]=!0,S.FileIndex[M].type!==0&&re.push([S.FullPaths[M],S.FileIndex[M]]);for(M=0;M<re.length;++M){var ne=n(re[M][0]);D=ee[ne],D||(re.push([ne,{name:a(ne).replace("/",""),type:1,clsid:q,ct:te,mt:te,content:null}]),ee[ne]=!0)}for(re.sort(function(ke,_e){return t(ke[0],_e[0])}),S.FullPaths=[],S.FileIndex=[],M=0;M<re.length;++M)S.FullPaths[M]=re[M][0],S.FileIndex[M]=re[M][1];for(M=0;M<re.length;++M){var ge=S.FileIndex[M],we=S.FullPaths[M];if(ge.name=a(we).replace("/",""),ge.L=ge.R=ge.C=-(ge.color=1),ge.size=ge.content?ge.content.length:0,ge.start=0,ge.clsid=ge.clsid||q,M===0)ge.C=re.length>1?1:-1,ge.size=0,ge.type=5;else if(we.slice(-1)=="/"){for(oe=M+1;oe<re.length&&n(S.FullPaths[oe])!=we;++oe);for(ge.C=oe>=re.length?-1:oe,oe=M+1;oe<re.length&&n(S.FullPaths[oe])!=n(we);++oe);ge.R=oe>=re.length?-1:oe,ge.type=1}else n(S.FullPaths[M+1]||"")==n(we)&&(ge.R=M+1),ge.type=2}}}function G(S,L){var I=L||{};if(I.fileType=="mad")return $d(S,I);switch(C(S),I.fileType){case"zip":return Gr(S,I)}var D=function(ke){for(var _e=0,ye=0,Ie=0;Ie<ke.FileIndex.length;++Ie){var Xe=ke.FileIndex[Ie];if(Xe.content){var Ye=Xe.content.length;Ye>0&&(Ye<4096?_e+=Ye+63>>6:ye+=Ye+511>>9)}}for(var gt=ke.FullPaths.length+3>>2,Kn=_e+7>>3,qn=_e+127>>7,Jn=Kn+ye+gt+qn,jr=Jn+127>>7,As=jr<=109?0:Math.ceil((jr-109)/127);Jn+jr+As+127>>7>jr;)As=++jr<=109?0:Math.ceil((jr-109)/127);var kr=[1,As,jr,qn,gt,ye,_e,0];return ke.FileIndex[0].size=_e<<6,kr[7]=(ke.FileIndex[0].start=kr[0]+kr[1]+kr[2]+kr[3]+kr[4]+kr[5])+(kr[6]+7>>3),kr}(S),M=at(D[7]<<9),U=0,te=0;{for(U=0;U<8;++U)M.write_shift(1,W[U]);for(U=0;U<8;++U)M.write_shift(2,0);for(M.write_shift(2,62),M.write_shift(2,3),M.write_shift(2,65534),M.write_shift(2,9),M.write_shift(2,6),U=0;U<3;++U)M.write_shift(2,0);for(M.write_shift(4,0),M.write_shift(4,D[2]),M.write_shift(4,D[0]+D[1]+D[2]+D[3]-1),M.write_shift(4,0),M.write_shift(4,4096),M.write_shift(4,D[3]?D[0]+D[1]+D[2]-1:j),M.write_shift(4,D[3]),M.write_shift(-4,D[1]?D[0]-1:j),M.write_shift(4,D[1]),U=0;U<109;++U)M.write_shift(-4,U<D[2]?D[1]+U:-1)}if(D[1])for(te=0;te<D[1];++te){for(;U<236+te*127;++U)M.write_shift(-4,U<D[2]?D[1]+U:-1);M.write_shift(-4,te===D[1]-1?j:te+1)}var oe=function(ke){for(te+=ke;U<te-1;++U)M.write_shift(-4,U+1);ke&&(++U,M.write_shift(-4,j))};for(te=U=0,te+=D[1];U<te;++U)M.write_shift(-4,X.DIFSECT);for(te+=D[2];U<te;++U)M.write_shift(-4,X.FATSECT);oe(D[3]),oe(D[4]);for(var ee=0,re=0,ne=S.FileIndex[0];ee<S.FileIndex.length;++ee)ne=S.FileIndex[ee],ne.content&&(re=ne.content.length,!(re<4096)&&(ne.start=te,oe(re+511>>9)));for(oe(D[6]+7>>3);M.l&511;)M.write_shift(-4,X.ENDOFCHAIN);for(te=U=0,ee=0;ee<S.FileIndex.length;++ee)ne=S.FileIndex[ee],ne.content&&(re=ne.content.length,!(!re||re>=4096)&&(ne.start=te,oe(re+63>>6)));for(;M.l&511;)M.write_shift(-4,X.ENDOFCHAIN);for(U=0;U<D[4]<<2;++U){var ge=S.FullPaths[U];if(!ge||ge.length===0){for(ee=0;ee<17;++ee)M.write_shift(4,0);for(ee=0;ee<3;++ee)M.write_shift(4,-1);for(ee=0;ee<12;++ee)M.write_shift(4,0);continue}ne=S.FileIndex[U],U===0&&(ne.start=ne.size?ne.start-1:j);var we=U===0&&I.root||ne.name;if(re=2*(we.length+1),M.write_shift(64,we,"utf16le"),M.write_shift(2,re),M.write_shift(1,ne.type),M.write_shift(1,ne.color),M.write_shift(-4,ne.L),M.write_shift(-4,ne.R),M.write_shift(-4,ne.C),ne.clsid)M.write_shift(16,ne.clsid,"hex");else for(ee=0;ee<4;++ee)M.write_shift(4,0);M.write_shift(4,ne.state||0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,ne.start),M.write_shift(4,ne.size),M.write_shift(4,0)}for(U=1;U<S.FileIndex.length;++U)if(ne=S.FileIndex[U],ne.size>=4096)if(M.l=ne.start+1<<9,Ne&&Buffer.isBuffer(ne.content))ne.content.copy(M,M.l,0,ne.size),M.l+=ne.size+511&-512;else{for(ee=0;ee<ne.size;++ee)M.write_shift(1,ne.content[ee]);for(;ee&511;++ee)M.write_shift(1,0)}for(U=1;U<S.FileIndex.length;++U)if(ne=S.FileIndex[U],ne.size>0&&ne.size<4096)if(Ne&&Buffer.isBuffer(ne.content))ne.content.copy(M,M.l,0,ne.size),M.l+=ne.size+63&-64;else{for(ee=0;ee<ne.size;++ee)M.write_shift(1,ne.content[ee]);for(;ee&63;++ee)M.write_shift(1,0)}if(Ne)M.l=M.length;else for(;M.l<M.length;)M.write_shift(1,0);return M}function H(S,L){var I=S.FullPaths.map(function(ee){return ee.toUpperCase()}),D=I.map(function(ee){var re=ee.split("/");return re[re.length-(ee.slice(-1)=="/"?2:1)]}),M=!1;L.charCodeAt(0)===47?(M=!0,L=I[0].slice(0,-1)+L):M=L.indexOf("/")!==-1;var U=L.toUpperCase(),te=M===!0?I.indexOf(U):D.indexOf(U);if(te!==-1)return S.FileIndex[te];var oe=!U.match(na);for(U=U.replace(Rt,""),oe&&(U=U.replace(na,"!")),te=0;te<I.length;++te)if((oe?I[te].replace(na,"!"):I[te]).replace(Rt,"")==U||(oe?D[te].replace(na,"!"):D[te]).replace(Rt,"")==U)return S.FileIndex[te];return null}var b=64,j=-2,_="d0cf11e0a1b11ae1",W=[208,207,17,224,161,177,26,225],q="00000000000000000000000000000000",X={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:j,FREESECT:-1,HEADER_SIGNATURE:_,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ue(S,L,I){l();var D=G(S,I);c.writeFileSync(L,D)}function P(S){for(var L=new Array(S.length),I=0;I<S.length;++I)L[I]=String.fromCharCode(S[I]);return L.join("")}function se(S,L){var I=G(S,L);switch(L&&L.type||"buffer"){case"file":return l(),c.writeFileSync(L.filename,I),I;case"binary":return typeof I=="string"?I:P(I);case"base64":return F0(typeof I=="string"?I:P(I));case"buffer":if(Ne)return Buffer.isBuffer(I)?I:fn(I);case"array":return typeof I=="string"?nr(I):I}return I}var Y;function T(S){try{var L=S.InflateRaw,I=new L;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)Y=S;else throw new Error("zlib does not expose bytesRead")}catch(D){console.error("cannot use native zlib: "+(D.message||D))}}function K(S,L){if(!Y)return qa(S,L);var I=Y.InflateRaw,D=new I,M=D._processChunk(S.slice(S.l),D._finishFlushFlag);return S.l+=D.bytesRead,M}function B(S){return Y?Y.deflateRawSync(S):Fe(S)}var N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(S){var L=(S<<1|S<<11)&139536|(S<<5|S<<15)&558144;return(L>>16|L>>8|L)&255}for(var le=typeof Uint8Array<"u",he=le?new Uint8Array(256):[],be=0;be<256;++be)he[be]=fe(be);function V(S,L){var I=he[S&255];return L<=8?I>>>8-L:(I=I<<8|he[S>>8&255],L<=16?I>>>16-L:(I=I<<8|he[S>>16&255],I>>>24-L))}function Ue(S,L){var I=L&7,D=L>>>3;return(S[D]|(I<=6?0:S[D+1]<<8))>>>I&3}function y(S,L){var I=L&7,D=L>>>3;return(S[D]|(I<=5?0:S[D+1]<<8))>>>I&7}function ae(S,L){var I=L&7,D=L>>>3;return(S[D]|(I<=4?0:S[D+1]<<8))>>>I&15}function Z(S,L){var I=L&7,D=L>>>3;return(S[D]|(I<=3?0:S[D+1]<<8))>>>I&31}function R(S,L){var I=L&7,D=L>>>3;return(S[D]|(I<=1?0:S[D+1]<<8))>>>I&127}function O(S,L,I){var D=L&7,M=L>>>3,U=(1<<I)-1,te=S[M]>>>D;return I<8-D||(te|=S[M+1]<<8-D,I<16-D)||(te|=S[M+2]<<16-D,I<24-D)||(te|=S[M+3]<<24-D),te&U}function J(S,L,I){var D=L&7,M=L>>>3;return D<=5?S[M]|=(I&7)<<D:(S[M]|=I<<D&255,S[M+1]=(I&7)>>8-D),L+3}function ce(S,L,I){var D=L&7,M=L>>>3;return I=(I&1)<<D,S[M]|=I,L+1}function de(S,L,I){var D=L&7,M=L>>>3;return I<<=D,S[M]|=I&255,I>>>=8,S[M+1]=I,L+8}function Q(S,L,I){var D=L&7,M=L>>>3;return I<<=D,S[M]|=I&255,I>>>=8,S[M+1]=I&255,S[M+2]=I>>>8,L+16}function xe(S,L){var I=S.length,D=2*I>L?2*I:L+5,M=0;if(I>=L)return S;if(Ne){var U=R0(D);if(S.copy)S.copy(U);else for(;M<S.length;++M)U[M]=S[M];return U}else if(le){var te=new Uint8Array(D);if(te.set)te.set(S);else for(;M<I;++M)te[M]=S[M];return te}return S.length=D,S}function ve(S){for(var L=new Array(S),I=0;I<S;++I)L[I]=0;return L}function me(S,L,I){var D=1,M=0,U=0,te=0,oe=0,ee=S.length,re=le?new Uint16Array(32):ve(32);for(U=0;U<32;++U)re[U]=0;for(U=ee;U<I;++U)S[U]=0;ee=S.length;var ne=le?new Uint16Array(ee):ve(ee);for(U=0;U<ee;++U)re[M=S[U]]++,D<M&&(D=M),ne[U]=0;for(re[0]=0,U=1;U<=D;++U)re[U+16]=oe=oe+re[U-1]<<1;for(U=0;U<ee;++U)oe=S[U],oe!=0&&(ne[U]=re[oe+16]++);var ge=0;for(U=0;U<ee;++U)if(ge=S[U],ge!=0)for(oe=V(ne[U],D)>>D-ge,te=(1<<D+4-ge)-1;te>=0;--te)L[oe|te<<ge]=ge&15|U<<4;return D}var Ee=le?new Uint16Array(512):ve(512),$e=le?new Uint16Array(32):ve(32);if(!le){for(var Ae=0;Ae<512;++Ae)Ee[Ae]=0;for(Ae=0;Ae<32;++Ae)$e[Ae]=0}(function(){for(var S=[],L=0;L<32;L++)S.push(5);me(S,$e,32);var I=[];for(L=0;L<=143;L++)I.push(8);for(;L<=255;L++)I.push(9);for(;L<=279;L++)I.push(7);for(;L<=287;L++)I.push(8);me(I,Ee,288)})();var je=function(){for(var L=le?new Uint8Array(32768):[],I=0,D=0;I<pe.length-1;++I)for(;D<pe[I+1];++D)L[D]=I;for(;D<32768;++D)L[D]=29;var M=le?new Uint8Array(259):[];for(I=0,D=0;I<ie.length-1;++I)for(;D<ie[I+1];++D)M[D]=I;function U(oe,ee){for(var re=0;re<oe.length;){var ne=Math.min(65535,oe.length-re),ge=re+ne==oe.length;for(ee.write_shift(1,+ge),ee.write_shift(2,ne),ee.write_shift(2,~ne&65535);ne-- >0;)ee[ee.l++]=oe[re++]}return ee.l}function te(oe,ee){for(var re=0,ne=0,ge=le?new Uint16Array(32768):[];ne<oe.length;){var we=Math.min(65535,oe.length-ne);if(we<10){for(re=J(ee,re,+(ne+we==oe.length)),re&7&&(re+=8-(re&7)),ee.l=re/8|0,ee.write_shift(2,we),ee.write_shift(2,~we&65535);we-- >0;)ee[ee.l++]=oe[ne++];re=ee.l*8;continue}re=J(ee,re,+(ne+we==oe.length)+2);for(var ke=0;we-- >0;){var _e=oe[ne];ke=(ke<<5^_e)&32767;var ye=-1,Ie=0;if((ye=ge[ke])&&(ye|=ne&-32768,ye>ne&&(ye-=32768),ye<ne))for(;oe[ye+Ie]==oe[ne+Ie]&&Ie<250;)++Ie;if(Ie>2){_e=M[Ie],_e<=22?re=de(ee,re,he[_e+1]>>1)-1:(de(ee,re,3),re+=5,de(ee,re,he[_e-23]>>5),re+=3);var Xe=_e<8?0:_e-4>>2;Xe>0&&(Q(ee,re,Ie-ie[_e]),re+=Xe),_e=L[ne-ye],re=de(ee,re,he[_e]>>3),re-=3;var Ye=_e<4?0:_e-2>>1;Ye>0&&(Q(ee,re,ne-ye-pe[_e]),re+=Ye);for(var gt=0;gt<Ie;++gt)ge[ke]=ne&32767,ke=(ke<<5^oe[ne])&32767,++ne;we-=Ie-1}else _e<=143?_e=_e+48:re=ce(ee,re,1),re=de(ee,re,he[_e]),ge[ke]=ne&32767,++ne}re=de(ee,re,0)-1}return ee.l=(re+7)/8|0,ee.l}return function(ee,re){return ee.length<8?U(ee,re):te(ee,re)}}();function Fe(S){var L=at(50+Math.floor(S.length*1.1)),I=je(S,L);return L.slice(0,I)}var He=le?new Uint16Array(32768):ve(32768),ot=le?new Uint16Array(32768):ve(32768),De=le?new Uint16Array(128):ve(128),Wt=1,mn=1;function Jt(S,L){var I=Z(S,L)+257;L+=5;var D=Z(S,L)+1;L+=5;var M=ae(S,L)+4;L+=4;for(var U=0,te=le?new Uint8Array(19):ve(19),oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,re=le?new Uint8Array(8):ve(8),ne=le?new Uint8Array(8):ve(8),ge=te.length,we=0;we<M;++we)te[N[we]]=U=y(S,L),ee<U&&(ee=U),re[U]++,L+=3;var ke=0;for(re[0]=0,we=1;we<=ee;++we)ne[we]=ke=ke+re[we-1]<<1;for(we=0;we<ge;++we)(ke=te[we])!=0&&(oe[we]=ne[ke]++);var _e=0;for(we=0;we<ge;++we)if(_e=te[we],_e!=0){ke=he[oe[we]]>>8-_e;for(var ye=(1<<7-_e)-1;ye>=0;--ye)De[ke|ye<<_e]=_e&7|we<<3}var Ie=[];for(ee=1;Ie.length<I+D;)switch(ke=De[R(S,L)],L+=ke&7,ke>>>=3){case 16:for(U=3+Ue(S,L),L+=2,ke=Ie[Ie.length-1];U-- >0;)Ie.push(ke);break;case 17:for(U=3+y(S,L),L+=3;U-- >0;)Ie.push(0);break;case 18:for(U=11+R(S,L),L+=7;U-- >0;)Ie.push(0);break;default:Ie.push(ke),ee<ke&&(ee=ke);break}var Xe=Ie.slice(0,I),Ye=Ie.slice(I);for(we=I;we<286;++we)Xe[we]=0;for(we=D;we<30;++we)Ye[we]=0;return Wt=me(Xe,He,286),mn=me(Ye,ot,30),L}function Ka(S,L){if(S[0]==3&&!(S[1]&3))return[$r(L),2];for(var I=0,D=0,M=R0(L||1<<18),U=0,te=M.length>>>0,oe=0,ee=0;(D&1)==0;){if(D=y(S,I),I+=3,D>>>1)D>>1==1?(oe=9,ee=5):(I=Jt(S,I),oe=Wt,ee=mn);else{I&7&&(I+=8-(I&7));var re=S[I>>>3]|S[(I>>>3)+1]<<8;if(I+=32,re>0)for(!L&&te<U+re&&(M=xe(M,U+re),te=M.length);re-- >0;)M[U++]=S[I>>>3],I+=8;continue}for(;;){!L&&te<U+32767&&(M=xe(M,U+32767),te=M.length);var ne=O(S,I,oe),ge=D>>>1==1?Ee[ne]:He[ne];if(I+=ge&15,ge>>>=4,(ge>>>8&255)===0)M[U++]=ge;else{if(ge==256)break;ge-=257;var we=ge<8?0:ge-4>>2;we>5&&(we=0);var ke=U+ie[ge];we>0&&(ke+=O(S,I,we),I+=we),ne=O(S,I,ee),ge=D>>>1==1?$e[ne]:ot[ne],I+=ge&15,ge>>>=4;var _e=ge<4?0:ge-2>>1,ye=pe[ge];for(_e>0&&(ye+=O(S,I,_e),I+=_e),!L&&te<ke&&(M=xe(M,ke+100),te=M.length);U<ke;)M[U]=M[U-ye],++U}}}return L?[M,I+7>>>3]:[M.slice(0,U),I+7>>>3]}function qa(S,L){var I=S.slice(S.l||0),D=Ka(I,L);return S.l+=D[1],D[0]}function Ja(S,L){if(S)typeof console<"u"&&console.error(L);else throw new Error(L)}function Za(S,L){var I=S;dt(I,0);var D=[],M=[],U={FileIndex:D,FullPaths:M};E(U,{root:L.root});for(var te=I.length-4;(I[te]!=80||I[te+1]!=75||I[te+2]!=5||I[te+3]!=6)&&te>=0;)--te;I.l=te+4,I.l+=4;var oe=I.read_shift(2);I.l+=6;var ee=I.read_shift(4);for(I.l=ee,te=0;te<oe;++te){I.l+=20;var re=I.read_shift(4),ne=I.read_shift(4),ge=I.read_shift(2),we=I.read_shift(2),ke=I.read_shift(2);I.l+=8;var _e=I.read_shift(4),ye=o(I.slice(I.l+ge,I.l+ge+we));I.l+=ge+we+ke;var Ie=I.l;I.l=_e+4,Qa(I,re,ne,U,ye),I.l=Ie}return U}function Qa(S,L,I,D,M){S.l+=2;var U=S.read_shift(2),te=S.read_shift(2),oe=s(S);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var ee=S.read_shift(4),re=S.read_shift(4),ne=S.read_shift(4),ge=S.read_shift(2),we=S.read_shift(2),ke="",_e=0;_e<ge;++_e)ke+=String.fromCharCode(S[S.l++]);if(we){var ye=o(S.slice(S.l,S.l+we));(ye[21589]||{}).mt&&(oe=ye[21589].mt),((M||{})[21589]||{}).mt&&(oe=M[21589].mt)}S.l+=we;var Ie=S.slice(S.l,S.l+re);switch(te){case 8:Ie=K(S,ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+te)}var Xe=!1;U&8&&(ee=S.read_shift(4),ee==134695760&&(ee=S.read_shift(4),Xe=!0),re=S.read_shift(4),ne=S.read_shift(4)),re!=L&&Ja(Xe,"Bad compressed size: "+L+" != "+re),ne!=I&&Ja(Xe,"Bad uncompressed size: "+I+" != "+ne),bs(D,ke,Ie,{unsafe:!0,mt:oe})}function Gr(S,L){var I=L||{},D=[],M=[],U=at(1),te=I.compression?8:0,oe=0,ee=0,re=0,ne=0,ge=0,we=S.FullPaths[0],ke=we,_e=S.FileIndex[0],ye=[],Ie=0;for(ee=1;ee<S.FullPaths.length;++ee)if(ke=S.FullPaths[ee].slice(we.length),_e=S.FileIndex[ee],!(!_e.size||!_e.content||ke=="Sh33tJ5")){var Xe=ne,Ye=at(ke.length);for(re=0;re<ke.length;++re)Ye.write_shift(1,ke.charCodeAt(re)&127);Ye=Ye.slice(0,Ye.l),ye[ge]=E_.buf(_e.content,0);var gt=_e.content;te==8&&(gt=B(gt)),U=at(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,oe),U.write_shift(2,te),_e.mt?i(U,_e.mt):U.write_shift(4,0),U.write_shift(-4,ye[ge]),U.write_shift(4,gt.length),U.write_shift(4,_e.content.length),U.write_shift(2,Ye.length),U.write_shift(2,0),ne+=U.length,D.push(U),ne+=Ye.length,D.push(Ye),ne+=gt.length,D.push(gt),U=at(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,oe),U.write_shift(2,te),U.write_shift(4,0),U.write_shift(-4,ye[ge]),U.write_shift(4,gt.length),U.write_shift(4,_e.content.length),U.write_shift(2,Ye.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,Xe),Ie+=U.l,M.push(U),Ie+=Ye.length,M.push(Ye),++ge}return U=at(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,ge),U.write_shift(2,ge),U.write_shift(4,Ie),U.write_shift(4,ne),U.write_shift(2,0),Mr([Mr(D),Mr(M),U])}var yr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Nd(S,L){if(S.ctype)return S.ctype;var I=S.name||"",D=I.match(/\.([^\.]+)$/);return D&&yr[D[1]]||L&&(D=(I=L).match(/[\.\\]([^\.\\])+$/),D&&yr[D[1]])?yr[D[1]]:"application/octet-stream"}function Ld(S){for(var L=F0(S),I=[],D=0;D<L.length;D+=76)I.push(L.slice(D,D+76));return I.join(`\r
`)+`\r
`}function Md(S){var L=S.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var ne=re.charCodeAt(0).toString(16).toUpperCase();return"="+(ne.length==1?"0"+ne:ne)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],D=L.split(`\r
`),M=0;M<D.length;++M){var U=D[M];if(U.length==0){I.push("");continue}for(var te=0;te<U.length;){var oe=76,ee=U.slice(te,te+oe);ee.charAt(oe-1)=="="?oe--:ee.charAt(oe-2)=="="?oe-=2:ee.charAt(oe-3)=="="&&(oe-=3),ee=U.slice(te,te+oe),te+=oe,te<U.length&&(ee+="="),I.push(ee)}}return I.join(`\r
`)}function Bd(S){for(var L=[],I=0;I<S.length;++I){for(var D=S[I];I<=S.length&&D.charAt(D.length-1)=="=";)D=D.slice(0,D.length-1)+S[++I];L.push(D)}for(var M=0;M<L.length;++M)L[M]=L[M].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return nr(L.join(`\r
`))}function Ud(S,L,I){for(var D="",M="",U="",te,oe=0;oe<10;++oe){var ee=L[oe];if(!ee||ee.match(/^\s*$/))break;var re=ee.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":D=re[2].trim();break;case"content-type":U=re[2].trim();break;case"content-transfer-encoding":M=re[2].trim();break}}switch(++oe,M.toLowerCase()){case"base64":te=nr(Ht(L.slice(oe).join("")));break;case"quoted-printable":te=Bd(L.slice(oe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+M)}var ne=bs(S,D.slice(I.length),te,{unsafe:!0});U&&(ne.ctype=U)}function zd(S,L){if(P(S.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=L&&L.root||"",D=(Ne&&Buffer.isBuffer(S)?S.toString("binary"):P(S)).split(`\r
`),M=0,U="";for(M=0;M<D.length;++M)if(U=D[M],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),I||(I=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),U.slice(0,I.length)!=I););var te=(D[1]||"").match(/boundary="(.*?)"/);if(!te)throw new Error("MAD cannot find boundary");var oe="--"+(te[1]||""),ee=[],re=[],ne={FileIndex:ee,FullPaths:re};E(ne);var ge,we=0;for(M=0;M<D.length;++M){var ke=D[M];ke!==oe&&ke!==oe+"--"||(we++&&Ud(ne,D.slice(ge,M),I),ge=M)}return ne}function $d(S,L){var I=L||{},D=I.boundary||"SheetJS";D="------="+D;for(var M=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+D.slice(2)+'"',"","",""],U=S.FullPaths[0],te=U,oe=S.FileIndex[0],ee=1;ee<S.FullPaths.length;++ee)if(te=S.FullPaths[ee].slice(U.length),oe=S.FileIndex[ee],!(!oe.size||!oe.content||te=="Sh33tJ5")){te=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var re=oe.content,ne=Ne&&Buffer.isBuffer(re)?re.toString("binary"):P(re),ge=0,we=Math.min(1024,ne.length),ke=0,_e=0;_e<=we;++_e)(ke=ne.charCodeAt(_e))>=32&&ke<128&&++ge;var ye=ge>=we*4/5;M.push(D),M.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+te),M.push("Content-Transfer-Encoding: "+(ye?"quoted-printable":"base64")),M.push("Content-Type: "+Nd(oe,te)),M.push(""),M.push(ye?Md(ne):Ld(ne))}return M.push(D+`--\r
`),M.join(`\r
`)}function Hd(S){var L={};return E(L,S),L}function bs(S,L,I,D){var M=D&&D.unsafe;M||E(S);var U=!M&&Me.find(S,L);if(!U){var te=S.FullPaths[0];L.slice(0,te.length)==te?te=L:(te.slice(-1)!="/"&&(te+="/"),te=(te+L).replace("//","/")),U={name:a(L),type:2},S.FileIndex.push(U),S.FullPaths.push(te),M||Me.utils.cfb_gc(S)}return U.content=I,U.size=I?I.length:0,D&&(D.CLSID&&(U.clsid=D.CLSID),D.mt&&(U.mt=D.mt),D.ct&&(U.ct=D.ct)),U}function Wd(S,L){E(S);var I=Me.find(S,L);if(I){for(var D=0;D<S.FileIndex.length;++D)if(S.FileIndex[D]==I)return S.FileIndex.splice(D,1),S.FullPaths.splice(D,1),!0}return!1}function Vd(S,L,I){E(S);var D=Me.find(S,L);if(D){for(var M=0;M<S.FileIndex.length;++M)if(S.FileIndex[M]==D)return S.FileIndex[M].name=a(I),S.FullPaths[M]=I,!0}return!1}function Gd(S){C(S,!0)}return r.find=H,r.read=F,r.parse=f,r.write=se,r.writeFile=ue,r.utils={cfb_new:Hd,cfb_add:bs,cfb_del:Wd,cfb_mov:Vd,cfb_gc:Gd,ReadShift:ha,CheckField:wu,prep_blob:dt,bconcat:Mr,use_zlib:T,_deflateRaw:Fe,_inflateRaw:qa,consts:X},r}();function T_(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function gr(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function sc(e){for(var r=[],t=gr(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}var qi=new Date(1899,11,30,0,0,0);function It(e,r){var t=e.getTime(),n=qi.getTime()+(e.getTimezoneOffset()-qi.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var Qf=new Date,b_=qi.getTime()+(Qf.getTimezoneOffset()-qi.getTimezoneOffset())*6e4,B0=Qf.getTimezoneOffset();function us(e){var r=new Date;return r.setTime(e*24*60*60*1e3+b_),r.getTimezoneOffset()!==B0&&r.setTime(r.getTime()+(r.getTimezoneOffset()-B0)*6e4),r}function A_(e){var r=0,t=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(t=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(a[i],10)}return r}var U0=new Date("2017-02-19T19:06:09.000Z"),eu=isNaN(U0.getFullYear())?new Date("2/19/17"):U0,S_=eu.getFullYear()==2017;function ft(e,r){var t=new Date(e);if(S_)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(eu.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function cn(e,r){if(Ne&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return ia(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ia(zf(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return ia(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ia(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return t[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function pt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=pt(e[t]));return r}function qe(e,r){for(var t="";t.length<r;)t+=e;return t}function or(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return t=-t,i}),!isNaN(r=Number(n)))?r/t:r}var C_=["january","february","march","april","may","june","july","august","september","october","november","december"];function Un(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),a=r.getMonth(),i=r.getDate();if(isNaN(i))return t;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&C_.indexOf(s)==-1)return t}else if(s.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||i>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var F_=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,a){if(e||typeof n=="string")return t.split(n);for(var i=t.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}}();function tu(e){return e?e.content&&e.type?cn(e.content,!0):e.data?ra(e.data):e.asNodeBuffer&&Ne?ra(e.asNodeBuffer().toString("binary")):e.asBinary?ra(e.asBinary()):e._data&&e._data.getContent?ra(cn(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function ru(e){if(!e)return null;if(e.data)return S0(e.data);if(e.asNodeBuffer&&Ne)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?S0(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function R_(e){return e&&e.name.slice(-4)===".bin"?ru(e):tu(e)}function jt(e,r){for(var t=e.FullPaths||gr(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<t.length;++i){var s=t[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[t[i]]:e.FileIndex[i]}return null}function oc(e,r){var t=jt(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function et(e,r,t){if(!t)return R_(oc(e,r));if(!r)return null;try{return et(e,r)}catch{return null}}function zt(e,r,t){if(!t)return tu(oc(e,r));if(!r)return null;try{return zt(e,r)}catch{return null}}function I_(e,r,t){return ru(oc(e,r))}function z0(e){for(var r=e.FullPaths||gr(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function O_(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return Ne?n=fn(t):n=Jg(t),Me.utils.cfb_add(e,r,n)}Me.utils.cfb_add(e,r,t)}else e.file(r,t)}function nu(e,r){switch(r.type){case"base64":return Me.read(e,{type:"base64"});case"binary":return Me.read(e,{type:"binary"});case"buffer":case"array":return Me.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function aa(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var au=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,D_=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,$0=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,P_=/<[^>]*>/g,bt=au.match($0)?$0:P_,N_=/<\w*:/,L_=/<(\/?)\w+:/;function Ce(e,r,t){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(r||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(D_),o=0,c="",l=0,f="",u="",d=1;if(s)for(l=0;l!=s.length;++l){for(u=s[l],i=0;i!=u.length&&u.charCodeAt(i)!==61;++i);for(f=u.slice(0,i).trim();u.charCodeAt(i+1)==32;)++i;for(d=(a=u.charCodeAt(i+1))==34||a==39?1:0,c=u.slice(i+1+d,u.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,n[f.toLowerCase()]=c;else{var h=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[h]&&f.slice(o-3,o)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function vr(e){return e.replace(L_,"<$1")}var iu={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},M_=sc(iu),ze=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,c){return iu[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(r,function(o,c){return String.fromCharCode(parseInt(c,16))});var s=a.indexOf("]]>");return t(a.slice(0,i))+a.slice(i+9,s)+t(a.slice(s+3))}}(),B_=/[&<>'"]/g,U_=/[\u0000-\u001f]/g;function cc(e){var r=e+"";return r.replace(B_,function(t){return M_[t]}).replace(/\n/g,"<br/>").replace(U_,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var H0=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function Ge(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ns(e){for(var r="",t=0,n=0,a=0,i=0,s=0,o=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(a=e.charCodeAt(t++),n>191&&n<224){s=(n&31)<<6,s|=a&63,r+=String.fromCharCode(s);continue}if(i=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(t++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function W0(e){var r=$r(2*e.length),t,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?t=o:o<224?(t=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(t=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,t=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,s=55296+(t>>>10&1023),t=56320+(t&1023)),s!==0&&(r[i++]=s&255,r[i++]=s>>>8,s=0),r[i++]=t%256,r[i++]=t>>>8;return r.slice(0,i).toString("ucs2")}function V0(e){return fn(e,"binary").toString("utf8")}var si="foo bar bazâð£",Ve=Ne&&(V0(si)==Ns(si)&&V0||W0(si)==Ns(si)&&W0)||Ns,ia=Ne?function(e){return fn(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,a=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Sa=function(){var e={};return function(t,n){var a=t+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),su=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),z_=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),$_=/<\/?(?:vt:)?variant>/g,H_=/<(?:vt:)([^>]*)>([\s\S]*)</;function G0(e,r){var t=Ce(e),n=e.match(z_(t.baseType))||[],a=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return a}return n.forEach(function(i){var s=i.replace($_,"").match(H_);s&&a.push({v:Ve(s[2]),t:s[1]})}),a}var W_=/(^\s|\s$|\n)/;function V_(e){return gr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function G_(e,r,t){return"<"+e+(t!=null?V_(t):"")+(r!=null?(r.match(W_)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function lc(e){if(Ne&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ve(un(nc(e)));throw new Error("Bad input format: expected Buffer or string")}var Ca=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,j_={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},X_=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function Y_(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,i=5;i>=0;--i)a=a*256+e[r+i];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function K_(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,i=0,s=n?-r:r;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(r)?26985:0);for(var o=0;o<=5;++o,i/=256)e[t+o]=i&255;e[t+6]=(a&15)<<4|i&15,e[t+7]=a>>4|n}var j0=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=t)r.push.apply(r,e[0][n].slice(a,a+t));return r},X0=Ne?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:fn(r)})):j0(e)}:j0,Y0=function(e,r,t){for(var n=[],a=r;a<t;a+=2)n.push(String.fromCharCode(Sr(e,a)));return n.join("").replace(Rt,"")},fc=Ne?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Rt,""):Y0(e,r,t)}:Y0,K0=function(e,r,t){for(var n=[],a=r;a<r+t;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},ou=Ne?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):K0(e,r,t)}:K0,q0=function(e,r,t){for(var n=[],a=r;a<t;a++)n.push(String.fromCharCode(kn(e,a)));return n.join("")},Ba=Ne?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):q0(r,t,n)}:q0,cu=function(e,r){var t=Ut(e,r);return t>0?Ba(e,r+4,r+4+t-1):""},lu=cu,fu=function(e,r){var t=Ut(e,r);return t>0?Ba(e,r+4,r+4+t-1):""},uu=fu,hu=function(e,r){var t=2*Ut(e,r);return t>0?Ba(e,r+4,r+4+t-1):""},du=hu,pu=function(r,t){var n=Ut(r,t);return n>0?fc(r,t+4,t+4+n):""},xu=pu,mu=function(e,r){var t=Ut(e,r);return t>0?Ba(e,r+4,r+4+t):""},gu=mu,_u=function(e,r){return Y_(e,r)},Ji=_u,vu=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Ne&&(lu=function(r,t){if(!Buffer.isBuffer(r))return cu(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},uu=function(r,t){if(!Buffer.isBuffer(r))return fu(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},du=function(r,t){if(!Buffer.isBuffer(r))return hu(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},xu=function(r,t){if(!Buffer.isBuffer(r))return pu(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},gu=function(r,t){if(!Buffer.isBuffer(r))return mu(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},Ji=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):_u(r,t)},vu=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var kn=function(e,r){return e[r]},Sr=function(e,r){return e[r+1]*256+e[r]},q_=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Ut=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},qr=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},J_=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function ha(e,r){var t="",n,a,i=[],s,o,c,l;switch(r){case"dbcs":if(l=this.l,Ne&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)t+=String.fromCharCode(Sr(this,l)),l+=2;e*=2;break;case"utf8":t=Ba(this,this.l,this.l+e);break;case"utf16le":e*=2,t=fc(this,this.l,this.l+e);break;case"wstr":return ha.call(this,e,"dbcs");case"lpstr-ansi":t=lu(this,this.l),e=4+Ut(this,this.l);break;case"lpstr-cp":t=uu(this,this.l),e=4+Ut(this,this.l);break;case"lpwstr":t=du(this,this.l),e=4+2*Ut(this,this.l);break;case"lpp4":e=4+Ut(this,this.l),t=xu(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ut(this,this.l),t=gu(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(s=kn(this,this.l+e++))!==0;)i.push(ii(s));t=i.join("");break;case"_wstr":for(e=0,t="";(s=Sr(this,this.l+e))!==0;)i.push(ii(s)),e+=2;e+=2,t=i.join("");break;case"dbcs-cont":for(t="",l=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return s=kn(this,l),this.l=l+1,o=ha.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ii(Sr(this,l))),l+=2}t=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",l=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return s=kn(this,l),this.l=l+1,o=ha.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ii(kn(this,l))),l+=1}t=i.join("");break;default:switch(e){case 1:return n=kn(this,this.l),this.l++,n;case 2:return n=(r==="i"?q_:Sr)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(e>0?qr:J_)(this,this.l),this.l+=4,n):(a=Ut(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=Ji(this,this.l):a=Ji([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=ou(this,this.l,e);break}}return this.l+=e,t}var Z_=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},Q_=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},ev=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function tv(e,r,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)ev(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var s=r.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,Z_(this,r,this.l);break;case 8:if(n=8,t==="f"){K_(this,r,this.l);break}case 16:break;case-4:n=4,Q_(this,r,this.l);break}return this.l+=n,this}function wu(e,r){var t=ou(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function dt(e,r){e.l=r,e.read_shift=ha,e.chk=wu,e.write_shift=tv}function Tt(e,r){e.l+=r}function at(e){var r=$r(e);return dt(r,0),r}function Or(e,r,t){if(e){var n,a,i;dt(e,e.l||0);for(var s=e.length,o=0,c=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var l=ns[o]||ns[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;c=e.l+i;var f=l.f&&l.f(e,i,t);if(e.l=c,r(f,l,o))return}}}function vo(){var e=[],r=Ne?256:2048,t=function(l){var f=at(l);return dt(f,0),f},n=t(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(l){return n&&l<n.length-n.l?n:(a(),n=t(Math.max(l+1,r)))},s=function(){return a(),Mr(e)},o=function(l){a(),n=l,n.l==null&&(n.l=n.length),i(r)};return{next:i,push:o,end:s,_bufs:e}}function da(e,r,t){var n=pt(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function J0(e,r,t){var n=pt(e);return n.s=da(n.s,r.s,t),n.e=da(n.e,r.s,t),n}function pa(e,r){if(e.cRel&&e.c<0)for(e=pt(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=pt(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Re(e);return!e.cRel&&e.cRel!=null&&(t=av(t)),!e.rRel&&e.rRel!=null&&(t=rv(t)),t}function Ls(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+it(e.s.c)+":"+(e.e.cRel?"":"$")+it(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+xt(e.s.r)+":"+(e.e.rRel?"":"$")+xt(e.e.r):pa(e.s,r.biff)+":"+pa(e.e,r.biff)}function uc(e){return parseInt(nv(e),10)-1}function xt(e){return""+(e+1)}function rv(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function nv(e){return e.replace(/\$(\d+)$/,"$1")}function hc(e){for(var r=iv(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function it(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function av(e){return e.replace(/^([A-Z])/,"$$$1")}function iv(e){return e.replace(/^\$([A-Z])/,"$1")}function sv(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ft(e){for(var r=0,t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function Re(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Vn(e){var r=e.indexOf(":");return r==-1?{s:Ft(e),e:Ft(e)}:{s:Ft(e.slice(0,r)),e:Ft(e.slice(r+1))}}function Be(e,r){return typeof r>"u"||typeof r=="number"?Be(e.s,e.e):(typeof e!="string"&&(e=Re(e)),typeof r!="string"&&(r=Re(r)),e==r?e:e+":"+r)}function Je(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,i=e.length;for(t=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.s.c=--t,t=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(r.s.r=--t,n===i||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.e.c=--t,t=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return r.e.r=--t,r}function Z0(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=Kt(e.z,t?It(r):r)}catch{}try{return e.w=Kt((e.XF||{}).numFmtId||(t?14:0),t?It(r):r)}catch{return""+r}}function Ir(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?pn[e.v]||e.v:r==null?Z0(e,e.v):Z0(e,r))}function Wr(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function yu(e,r,t){var n=t||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Ft(n.origin):n.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=Je(i["!ref"]);l.s.c=f.s.c,l.s.r=f.s.r,l.e.c=Math.max(l.e.c,f.e.c),l.e.r=Math.max(l.e.r,f.e.r),s==-1&&(l.e.r=s=f.e.r+1)}for(var u=0;u!=r.length;++u)if(r[u]){if(!Array.isArray(r[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=r[u].length;++d)if(!(typeof r[u][d]>"u")){var h={v:r[u][d]},x=s+u,p=o+d;if(l.s.r>x&&(l.s.r=x),l.s.c>p&&(l.s.c=p),l.e.r<x&&(l.e.r=x),l.e.c<p&&(l.e.c=p),r[u][d]&&typeof r[u][d]=="object"&&!Array.isArray(r[u][d])&&!(r[u][d]instanceof Date))h=r[u][d];else if(Array.isArray(h.v)&&(h.f=r[u][d][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Oe[14],n.cellDates?(h.t="d",h.w=Kt(h.z,It(h.v))):(h.t="n",h.v=It(h.v),h.w=Kt(h.z,h.v))):h.t="s";if(a)i[x]||(i[x]=[]),i[x][p]&&i[x][p].z&&(h.z=i[x][p].z),i[x][p]=h;else{var m=Re({c:p,r:x});i[m]&&i[m].z&&(h.z=i[m].z),i[m]=h}}}return l.s.c<1e7&&(i["!ref"]=Be(l)),i}function Gn(e,r){return yu(null,e,r)}function ov(e){return e.read_shift(4,"i")}function Et(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function cv(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function dc(e,r){var t=e.l,n=e.read_shift(1),a=Et(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(cv(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=t+r,s}var lv=dc;function qt(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function hn(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var fv=Et;function pc(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var uv=Et,wo=pc;function xc(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var a=n===0?Ji([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):qr(r,0)>>2;return t?a/100:a}function ku(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var dn=ku;function yt(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function hv(e){var r={},t=e.read_shift(1),n=t>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var l=nn[a];l&&(r.rgb=Ra(l));break;case 2:r.rgb=Ra([s,o,c]);break;case 3:r.theme=a;break}return i!=0&&(r.tint=i>0?i/32767:i/32768),r}function dv(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function Eu(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function pv(e){return Eu(e,1)}function xv(e){return Eu(e,2)}var mc=2,Dt=3,oi=11,Q0=12,Zi=19,ci=64,mv=65,gv=71,_v=4108,vv=4126,lt=80,Tu=81,wv=[lt,Tu],yv={1:{n:"CodePage",t:mc},2:{n:"Category",t:lt},3:{n:"PresentationFormat",t:lt},4:{n:"ByteCount",t:Dt},5:{n:"LineCount",t:Dt},6:{n:"ParagraphCount",t:Dt},7:{n:"SlideCount",t:Dt},8:{n:"NoteCount",t:Dt},9:{n:"HiddenCount",t:Dt},10:{n:"MultimediaClipCount",t:Dt},11:{n:"ScaleCrop",t:oi},12:{n:"HeadingPairs",t:_v},13:{n:"TitlesOfParts",t:vv},14:{n:"Manager",t:lt},15:{n:"Company",t:lt},16:{n:"LinksUpToDate",t:oi},17:{n:"CharacterCount",t:Dt},19:{n:"SharedDoc",t:oi},22:{n:"HyperlinksChanged",t:oi},23:{n:"AppVersion",t:Dt,p:"version"},24:{n:"DigSig",t:mv},26:{n:"ContentType",t:lt},27:{n:"ContentStatus",t:lt},28:{n:"Language",t:lt},29:{n:"Version",t:lt},255:{},2147483648:{n:"Locale",t:Zi},2147483651:{n:"Behavior",t:Zi},1919054434:{}},kv={1:{n:"CodePage",t:mc},2:{n:"Title",t:lt},3:{n:"Subject",t:lt},4:{n:"Author",t:lt},5:{n:"Keywords",t:lt},6:{n:"Comments",t:lt},7:{n:"Template",t:lt},8:{n:"LastAuthor",t:lt},9:{n:"RevNumber",t:lt},10:{n:"EditTime",t:ci},11:{n:"LastPrinted",t:ci},12:{n:"CreatedDate",t:ci},13:{n:"ModifiedDate",t:ci},14:{n:"PageCount",t:Dt},15:{n:"WordCount",t:Dt},16:{n:"CharCount",t:Dt},17:{n:"Thumbnail",t:gv},18:{n:"Application",t:lt},19:{n:"DocSecurity",t:Dt},255:{},2147483648:{n:"Locale",t:Zi},2147483651:{n:"Behavior",t:Zi},1919054434:{}},el={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Ev=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Tv(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var bv=Tv([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),nn=pt(bv),pn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},bu={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},tl={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function Av(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Sv(e){var r=Av();if(!e||!e.match)return r;var t={};if((e.match(bt)||[]).forEach(function(n){var a=Ce(n);switch(a[0].replace(N_,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":r[tl[a.ContentType]]!==void 0&&r[tl[a.ContentType]].push(a.PartName);break}}),r.xmlns!==j_.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var bn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function yo(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function xa(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(bt)||[]).forEach(function(a){var i=Ce(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:aa(i.Target,r);t[o]=s,n[i.Id]=s}}),t["!id"]=n,t}var Cv="application/vnd.oasis.opendocument.spreadsheet";function Fv(e,r){for(var t=lc(e),n,a;n=Ca.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ce(n[0],!1),a.path=="/"&&a.type!==Cv)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var ma=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Rv=function(){for(var e=new Array(ma.length),r=0;r<ma.length;++r){var t=ma[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Au(e){var r={};e=Ve(e);for(var t=0;t<ma.length;++t){var n=ma[t],a=e.match(Rv[t]);a!=null&&a.length>0&&(r[n[1]]=ze(a[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=ft(r[n[1]]))}return r}var Iv=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Su(e,r,t,n){var a=[];if(typeof e=="string")a=G0(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(f){return{v:f}}));var s=typeof r=="string"?G0(r,n).map(function(f){return f.v}):r,o=0,c=0;if(s.length>0)for(var l=0;l!==a.length;l+=2){switch(c=+a[l+1].v,a[l].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=c,t.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=s.slice(o,o+c);break}o+=c}}function Ov(e,r,t){var n={};return r||(r={}),e=Ve(e),Iv.forEach(function(a){var i=(e.match(Sa(a[0]))||[])[1];switch(a[2]){case"string":i&&(r[a[1]]=ze(i));break;case"bool":r[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Su(n.HeadingPairs,n.TitlesOfParts,r,t),r}var Dv=/<[^>]+>[^<]*/g;function Pv(e,r){var t={},n="",a=e.match(Dv);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=Ce(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ze(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),l=c[0].slice(4),f=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":t[n]=ze(f);break;case"bool":t[n]=Ge(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(f);break;case"filetime":case"date":t[n]=ft(f);break;case"cy":case"error":t[n]=ze(f);break;default:if(l.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",s,l,c)}}else if(s.slice(0,2)!=="</"){if(r.WTF)throw new Error(s)}}}return t}var Nv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ms;function Lv(e,r,t){Ms||(Ms=sc(Nv)),r=Ms[r]||r,e[r]=t}function gc(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Cu(e,r,t){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return a}function Fu(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function Ru(e,r,t){return r===31?Fu(e):Cu(e,r,t)}function ko(e,r,t){return Ru(e,r,t===!1?0:4)}function Mv(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Ru(e,r,0)}function Bv(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var a=e.l;t[n]=e.read_shift(0,"lpwstr").replace(Rt,""),e.l-a&2&&(e.l+=2)}return t}function Uv(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(Rt,"");return t}function zv(e){var r=e.l,t=Qi(e,Tu);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=Qi(e,Dt);return[t,n]}function $v(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(zv(e));return t}function rl(e,r){for(var t=e.read_shift(4),n={},a=0;a!=t;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,r===1200?"utf16le":"utf8").replace(Rt,"").replace(na,"!"),r===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Iu(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function Hv(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Qi(e,r,t){var n=e.read_shift(2),a,i=t||{};if(e.l+=2,r!==Q0&&n!==r&&wv.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===Q0?n:r){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Cu(e,n,4).replace(Rt,"");case 31:return Fu(e);case 64:return gc(e);case 65:return Iu(e);case 71:return Hv(e);case 80:return ko(e,n,!i.raw).replace(Rt,"");case 81:return Mv(e,n).replace(Rt,"");case 4108:return $v(e);case 4126:case 4127:return n==4127?Bv(e):Uv(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function nl(e,r){var t=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,c=-1,l={};for(s=0;s!=a;++s){var f=e.read_shift(4),u=e.read_shift(4);i[s]=[f,u+t]}i.sort(function(w,v){return w[1]-v[1]});var d={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var h=!0;if(s>0&&r)switch(r[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break}if((!r||s==0)&&e.l<=i[s][1]&&(h=!1,e.l=i[s][1]),h)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(r){var x=r[i[s][0]];if(d[x.n]=Qi(e,x.t,{raw:!0}),x.p==="version"&&(d[x.n]=String(d[x.n]>>16)+"."+("0000"+String(d[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(d[x.n]){case 0:d[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ar(o=d[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[x.n])}}else if(i[s][0]===1){if(o=d.CodePage=Qi(e,mc),ar(o),c!==-1){var p=e.l;e.l=i[c][1],l=rl(e,o),e.l=p}}else if(i[s][0]===0){if(o===0){c=s,e.l=i[s+1][1];continue}l=rl(e,o)}else{var m=l[i[s][0]],g;switch(e[e.l]){case 65:e.l+=4,g=Iu(e);break;case 30:e.l+=4,g=ko(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,g=ko(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Ze(e,4);break;case 64:e.l+=4,g=ft(gc(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[m]=g}}return e.l=t+n,d}function al(e,r,t){var n=e.content;if(!n)return{};dt(n,0);var a,i,s,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),f=n.read_shift(16);if(f!==Me.utils.consts.HEADER_CLSID&&f!==t)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),c=n.read_shift(4));var u=nl(n,r),d={SystemIdentifier:l};for(var h in u)d[h]=u[h];if(d.FMTID=i,a===1)return d;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var x;try{x=nl(n,null)}catch{}for(h in x)d[h]=x[h];return d.FMTID=[i,s],d}function Dr(e,r){return e.read_shift(r),null}function Wv(e,r,t){for(var n=[],a=e.l+r;e.l<a;)n.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Ze(e,r){return e.read_shift(r)===1}function tt(e){return e.read_shift(2,"u")}function Ou(e,r){return Wv(e,r,tt)}function Vv(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function Ua(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function Gv(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,a=t&8,i=1+(t&1),s=0,o,c={};a&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var l=i==2?"dbcs-cont":"sbcs-cont",f=r===0?"":e.read_shift(r,l);return a&&(e.l+=4*s),n&&(e.l+=o),c.t=f,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function ln(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function za(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):ln(e,n,t)}function xn(e,r,t){if(t.biff>5)return za(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function jv(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function Xv(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var a=e.read_shift((n?r-24:r)>>1,"utf16le").replace(Rt,"");return n&&(e.l+=24),a}function Yv(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(Rt,"");return t+s}function Kv(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return Xv(e);case"0303000000000000c000000000000046":return Yv(e);default:throw new Error("Unsupported Moniker "+t)}}function li(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Rt,""):"";return t}function qv(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,c,l="",f,u;a&16&&(i=li(e,t-e.l)),a&128&&(s=li(e,t-e.l)),(a&257)===257&&(o=li(e,t-e.l)),(a&257)===1&&(c=Kv(e,t-e.l)),a&8&&(l=li(e,t-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(u=gc(e)),e.l=t;var d=s||o||c||"";d&&l&&(d+="#"+l),d||(d="#"+l),a&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var h={Target:d};return f&&(h.guid=f),u&&(h.time=u),i&&(h.Tooltip=i),h}function Du(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[r,t,n,a]}function Pu(e,r){var t=Du(e);return t[3]=0,t}function wr(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function Jv(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function Zv(e,r,t){return r===0?"":xn(e,r,t)}function Qv(e,r,t){var n=t.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function Nu(e){var r=e.read_shift(2),t=xc(e);return[r,t]}function e2(e,r,t){e.l+=4,r-=4;var n=e.l+r,a=Ua(e,r,t),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function hs(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r},e:{c:a,r:t}}}function Lu(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r},e:{c:a,r:t}}}var t2=Lu;function Mu(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function r2(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function n2(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function _t(e){e.l+=2,e.l+=e.read_shift(2)}var a2={0:_t,4:_t,5:_t,6:_t,7:n2,8:_t,9:_t,10:_t,11:_t,12:_t,13:r2,14:_t,15:_t,16:_t,17:_t,18:_t,19:_t,20:_t,21:Mu};function i2(e,r){for(var t=e.l+r,n=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{n.push(a2[a](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function fi(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function s2(e,r){return r===0||e.read_shift(2),1200}function o2(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,a=xn(e,0,t);return e.read_shift(r+n-e.l),a}function c2(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function l2(e,r,t){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=Ua(e,0,t);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function f2(e,r){for(var t=e.l+r,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<t;++s)i.push(Gv(e));return i.Count=n,i.Unique=a,i}function u2(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function h2(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function d2(e){var r=Jv(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function p2(e){return e.read_shift(2),e.read_shift(4)}function il(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function x2(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2);return{Pos:[r,t],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:c,TabRatio:l}}function m2(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function g2(){}function _2(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Ua(e,0,t),n}function v2(e){var r=wr(e);return r.isst=e.read_shift(4),r}function w2(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,a=wr(e);t.biff==2&&e.l++;var i=za(e,n-e.l,t);return a.val=i,a}function y2(e,r,t){var n=e.read_shift(2),a=xn(e,0,t);return[n,a]}var k2=xn;function sl(e,r,t){var n=e.l+r,a=t.biff==8||!t.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c}}}function E2(e){var r=e.read_shift(2),t=e.read_shift(2),n=Nu(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function T2(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<t;)i.push(Nu(e));if(e.l!==t)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function b2(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<t;)i.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function A2(e,r,t,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=Ev[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function S2(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=A2(e,r,n.fStyle,t),n}function C2(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function ol(e,r,t){var n=wr(e);(t.biff==2||r==9)&&++e.l;var a=Vv(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function F2(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=wr(e),a=yt(e);return n.val=a,n}var cl=Zv;function R2(e,r,t){var n=e.l+r,a=e.read_shift(2),i=e.read_shift(2);if(t.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=ln(e,i),o=[];n>e.l;)o.push(za(e));return[i,a,s,o]}function ll(e,r,t){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(a=e2(e,r-2,t)),i.body=a||e.read_shift(r-2),typeof a=="string"&&(i.Name=a),i}var I2=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function fl(e,r,t){var n=e.l+r,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),c=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var l=ln(e,s,t);a&32&&(l=I2[l.charCodeAt(0)]);var f=n-e.l;t&&t.biff==2&&--f;var u=n==e.l||o===0||!(f>0)?[]:hE(e,f,t,o);return{chKey:i,Name:l,itab:c,rgce:u}}function Bu(e,r,t){if(t.biff<8)return O2(e,r,t);for(var n=[],a=e.l+r,i=e.read_shift(t.biff>8?4:2);i--!==0;)n.push(Qv(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function O2(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=Ua(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function D2(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),a=e.read_shift(2),i=ln(e,n,t),s=ln(e,a,t);return[i,s]}function P2(e,r,t){var n=Lu(e);e.l++;var a=e.read_shift(1);return r-=8,[dE(e,r,t),a,n]}function ul(e,r,t){var n=t2(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,fE(e,r,t)]}function N2(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function L2(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=xn(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:a},o,s,i]}}function M2(e,r,t){return L2(e,r,t)}function B2(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(hs(e));return t}function U2(e,r,t){if(t&&t.biff<8)return $2(e,r,t);var n=Mu(e),a=i2(e,r-22,n[1]);return{cmo:n,ft:a}}var z2={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:n}}};function $2(e,r,t){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var s=[];return s.push((z2[n]||Tt)(e,r,t)),{cmo:[a,n,i],ft:s}}function H2(e,r,t){var n=e.l,a="";try{e.l+=4;var i=(t.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=jv(e,6,t);var o=e.read_shift(2);e.read_shift(2),tt(e,2);var c=e.read_shift(2);e.l+=c;for(var l=1;l<e.lens.length-1;++l){if(e.l-n!=e.lens[l])throw new Error("TxO: bad continue record");var f=e[e.l],u=ln(e,e.lens[l+1]-e.lens[l]-1);if(a+=u,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+r,{t:a}}catch{return e.l=n+r,{t:a}}}function W2(e,r){var t=hs(e);e.l+=16;var n=qv(e,r-24);return[t,n]}function V2(e,r){e.read_shift(2);var t=hs(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(Rt,""),[t,n]}function G2(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=el[t]||t,t=e.read_shift(2),r[1]=el[t]||t,r}function j2(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Pu(e));return t}function X2(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Pu(e));return t}function Y2(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function Uu(e,r,t){if(!t.cellStyles)return Tt(e,r);var n=t&&t.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var l={s:a,e:i,w:s,ixfe:o,flags:c};return(t.biff>=5||!t.biff)&&(l.level=c>>8&7),l}function K2(e,r){var t={};return r<32||(e.l+=16,t.header=yt(e),t.footer=yt(e),e.l+=2),t}function q2(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var J2=wr,Z2=Ou,Q2=za;function ew(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function tw(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=wr(e);++e.l;var a=xn(e,r-7,t);return n.t="str",n.val=a,n}function rw(e){var r=wr(e);++e.l;var t=yt(e);return r.t="n",r.val=t,r}function nw(e){var r=wr(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function aw(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function iw(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function sw(e,r,t){var n=e.l+r,a=wr(e),i=e.read_shift(2),s=ln(e,i,t);return e.l=n,a.t="str",a.val=s,a}var ow=[2,3,48,49,131,139,140,245],hl=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=sc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,c){var l=[],f=$r(1);switch(c.type){case"base64":f=nr(Ht(o));break;case"binary":f=nr(o);break;case"buffer":case"array":f=o;break}dt(f,0);var u=f.read_shift(1),d=!!(u&136),h=!1,x=!1;switch(u){case 2:break;case 3:break;case 48:h=!0,d=!0;break;case 49:h=!0,d=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var p=0,m=521;u==2&&(p=f.read_shift(2)),f.l+=3,u!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),u!=2&&(m=f.read_shift(2));var g=f.read_shift(2),w=c.codepage||1252;u!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(w=e[f[f.l]]),f.l+=1,f.l+=2),x&&(f.l+=36);for(var v=[],k={},A=Math.min(f.length,u==2?521:m-10-(h?264:0)),F=x?32:11;f.l<A&&f[f.l]!=13;)switch(k={},k.name=_o.utils.decode(w,f.slice(f.l,f.l+F)).replace(/[\u0000\r\n].*$/g,""),f.l+=F,k.type=String.fromCharCode(f.read_shift(1)),u!=2&&!x&&(k.offset=f.read_shift(4)),k.len=f.read_shift(1),u==2&&(k.offset=f.read_shift(2)),k.dec=f.read_shift(1),k.name.length&&v.push(k),u!=2&&(f.l+=x?13:14),k.type){case"B":(!h||k.len!=8)&&c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(f[f.l]!==13&&(f.l=m-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=m;var E=0,z=0;for(l[0]=[],z=0;z!=v.length;++z)l[0][z]=v[z].name;for(;p-- >0;){if(f[f.l]===42){f.l+=g;continue}for(++f.l,l[++E]=[],z=0,z=0;z!=v.length;++z){var C=f.slice(f.l,f.l+v[z].len);f.l+=v[z].len,dt(C,0);var G=_o.utils.decode(w,C);switch(v[z].type){case"C":G.trim().length&&(l[E][z]=G.replace(/\s+$/,""));break;case"D":G.length===8?l[E][z]=new Date(+G.slice(0,4),+G.slice(4,6)-1,+G.slice(6,8)):l[E][z]=G;break;case"F":l[E][z]=parseFloat(G.trim());break;case"+":case"I":l[E][z]=x?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(G.trim().toUpperCase()){case"Y":case"T":l[E][z]=!0;break;case"N":case"F":l[E][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+G+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));l[E][z]="##MEMO##"+(x?parseInt(G.trim(),10):C.read_shift(4));break;case"N":G=G.replace(/\u0000/g,"").trim(),G&&G!="."&&(l[E][z]=+G||0);break;case"@":l[E][z]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":l[E][z]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":l[E][z]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[E][z]=-C.read_shift(-8,"f");break;case"B":if(h&&v[z].len==8){l[E][z]=C.read_shift(8,"f");break}case"G":case"P":C.l+=v[z].len;break;case"0":if(v[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[z].type)}}}if(u!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=v,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var f=Gn(t(o,l),l);return f["!cols"]=l.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete l.DBF,f}function a(o,c){try{return Wr(n(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){var l=c||{};if(+l.codepage>=0&&ar(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var f=vo(),u=Fo(o,{header:1,raw:!0,cellDates:!0}),d=u[0],h=u.slice(1),x=o["!cols"]||[],p=0,m=0,g=0,w=1;for(p=0;p<d.length;++p){if(((x[p]||{}).DBF||{}).name){d[p]=x[p].DBF.name,++g;continue}if(d[p]!=null){if(++g,typeof d[p]=="number"&&(d[p]=d[p].toString(10)),typeof d[p]!="string")throw new Error("DBF Invalid column name "+d[p]+" |"+typeof d[p]+"|");if(d.indexOf(d[p])!==p){for(m=0;m<1024;++m)if(d.indexOf(d[p]+"_"+m)==-1){d[p]+="_"+m;break}}}}var v=Je(o["!ref"]),k=[],A=[],F=[];for(p=0;p<=v.e.c-v.s.c;++p){var E="",z="",C=0,G=[];for(m=0;m<h.length;++m)h[m][p]!=null&&G.push(h[m][p]);if(G.length==0||d[p]==null){k[p]="?";continue}for(m=0;m<G.length;++m){switch(typeof G[m]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=G[m]instanceof Date?"D":"C";break;default:z="C"}C=Math.max(C,String(G[m]).length),E=E&&E!=z?"C":z}C>250&&(C=250),z=((x[p]||{}).DBF||{}).type,z=="C"&&x[p].DBF.len>C&&(C=x[p].DBF.len),E=="B"&&z=="N"&&(E="N",F[p]=x[p].DBF.dec,C=x[p].DBF.len),A[p]=E=="C"||z=="N"?C:i[E]||0,w+=A[p],k[p]=E}var H=f.next(32);for(H.write_shift(4,318902576),H.write_shift(4,h.length),H.write_shift(2,296+32*g),H.write_shift(2,w),p=0;p<4;++p)H.write_shift(4,0);for(H.write_shift(4,0|(+r[Bf]||3)<<8),p=0,m=0;p<d.length;++p)if(d[p]!=null){var b=f.next(32),j=(d[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);b.write_shift(1,j,"sbcs"),b.write_shift(1,k[p]=="?"?"C":k[p],"sbcs"),b.write_shift(4,m),b.write_shift(1,A[p]||i[k[p]]||0),b.write_shift(1,F[p]||0),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(1,0),b.write_shift(4,0),b.write_shift(4,0),m+=A[p]||i[k[p]]||0}var _=f.next(264);for(_.write_shift(4,13),p=0;p<65;++p)_.write_shift(4,0);for(p=0;p<h.length;++p){var W=f.next(w);for(W.write_shift(1,0),m=0;m<d.length;++m)if(d[m]!=null)switch(k[m]){case"L":W.write_shift(1,h[p][m]==null?63:h[p][m]?84:70);break;case"B":W.write_shift(8,h[p][m]||0,"f");break;case"N":var q="0";for(typeof h[p][m]=="number"&&(q=h[p][m].toFixed(F[m]||0)),g=0;g<A[m]-q.length;++g)W.write_shift(1,32);W.write_shift(1,q,"sbcs");break;case"D":h[p][m]?(W.write_shift(4,("0000"+h[p][m].getFullYear()).slice(-4),"sbcs"),W.write_shift(2,("00"+(h[p][m].getMonth()+1)).slice(-2),"sbcs"),W.write_shift(2,("00"+h[p][m].getDate()).slice(-2),"sbcs")):W.write_shift(8,"00000000","sbcs");break;case"C":var X=String(h[p][m]!=null?h[p][m]:"").slice(0,A[m]);for(W.write_shift(1,X,"sbcs"),g=0;g<A[m]-X.length;++g)W.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),cw=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+gr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(d,h){var x=e[h];return typeof x=="number"?C0(x):x},n=function(d,h,x){var p=h.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?d:C0(p)};e["|"]=254;function a(d,h){switch(h.type){case"base64":return i(Ht(d),h);case"binary":return i(d,h);case"buffer":return i(Ne&&Buffer.isBuffer(d)?d.toString("binary"):un(d),h);case"array":return i(cn(d),h)}throw new Error("Unrecognized type "+h.type)}function i(d,h){var x=d.split(/[\n\r]+/),p=-1,m=-1,g=0,w=0,v=[],k=[],A=null,F={},E=[],z=[],C=[],G=0,H;for(+h.codepage>=0&&ar(+h.codepage);g!==x.length;++g){G=0;var b=x[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),j=b.replace(/;;/g,"\0").split(";").map(function(N){return N.replace(/\u0000/g,";")}),_=j[0],W;if(b.length>0)switch(_){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":j[1].charAt(0)=="P"&&k.push(b.slice(3).replace(/;;/g,";"));break;case"C":var q=!1,X=!1,ue=!1,P=!1,se=-1,Y=-1;for(w=1;w<j.length;++w)switch(j[w].charAt(0)){case"A":break;case"X":m=parseInt(j[w].slice(1))-1,X=!0;break;case"Y":for(p=parseInt(j[w].slice(1))-1,X||(m=0),H=v.length;H<=p;++H)v[H]=[];break;case"K":W=j[w].slice(1),W.charAt(0)==='"'?W=W.slice(1,W.length-1):W==="TRUE"?W=!0:W==="FALSE"?W=!1:isNaN(or(W))?isNaN(Un(W).getDate())||(W=ft(W)):(W=or(W),A!==null&&Wn(A)&&(W=us(W))),q=!0;break;case"E":P=!0;var T=Fn(j[w].slice(1),{r:p,c:m});v[p][m]=[v[p][m],T];break;case"S":ue=!0,v[p][m]=[v[p][m],"S5S"];break;case"G":break;case"R":se=parseInt(j[w].slice(1))-1;break;case"C":Y=parseInt(j[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+b)}if(q&&(v[p][m]&&v[p][m].length==2?v[p][m][0]=W:v[p][m]=W,A=null),ue){if(P)throw new Error("SYLK shared formula cannot have own formula");var K=se>-1&&v[se][Y];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");v[p][m][1]=Ku(K[1],{r:p-se,c:m-Y})}break;case"F":var B=0;for(w=1;w<j.length;++w)switch(j[w].charAt(0)){case"X":m=parseInt(j[w].slice(1))-1,++B;break;case"Y":for(p=parseInt(j[w].slice(1))-1,H=v.length;H<=p;++H)v[H]=[];break;case"M":G=parseInt(j[w].slice(1))/20;break;case"F":break;case"G":break;case"P":A=k[parseInt(j[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=j[w].slice(1).split(" "),H=parseInt(C[0],10);H<=parseInt(C[1],10);++H)G=parseInt(C[2],10),z[H-1]=G===0?{hidden:!0}:{wch:G},zn(z[H-1]);break;case"C":m=parseInt(j[w].slice(1))-1,z[m]||(z[m]={});break;case"R":p=parseInt(j[w].slice(1))-1,E[p]||(E[p]={}),G>0?(E[p].hpt=G,E[p].hpx=Ia(G)):G===0&&(E[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+b)}B<1&&(A=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+b)}}return E.length>0&&(F["!rows"]=E),z.length>0&&(F["!cols"]=z),h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),[v,F]}function s(d,h){var x=a(d,h),p=x[0],m=x[1],g=Gn(p,h);return gr(m).forEach(function(w){g[w]=m[w]}),g}function o(d,h){return Wr(s(d,h),h)}function c(d,h,x,p){var m="C;Y"+(x+1)+";X"+(p+1)+";K";switch(d.t){case"n":m+=d.v||0,d.f&&!d.F&&(m+=";E"+Yy(d.f,{r:x,c:p}));break;case"b":m+=d.v?"TRUE":"FALSE";break;case"e":m+=d.w||d.v;break;case"d":m+='"'+(d.w||d.v)+'"';break;case"s":m+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function l(d,h){h.forEach(function(x,p){var m="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?m+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=ts(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=rs(x.wpx)),typeof x.wch=="number"&&(m+=Math.round(x.wch))),m.charAt(m.length-1)!=" "&&d.push(m)})}function f(d,h){h.forEach(function(x,p){var m="F;";x.hidden?m+="M0;":x.hpt?m+="M"+20*x.hpt+";":x.hpx&&(m+="M"+20*ju(x.hpx)+";"),m.length>2&&d.push(m+"R"+(p+1))})}function u(d,h){var x=["ID;PWXL;N;E"],p=[],m=Je(d["!ref"]),g,w=Array.isArray(d),v=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),d["!cols"]&&l(x,d["!cols"]),d["!rows"]&&f(x,d["!rows"]),x.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var k=m.s.r;k<=m.e.r;++k)for(var A=m.s.c;A<=m.e.c;++A){var F=Re({r:k,c:A});g=w?(d[k]||[])[A]:d[F],!(!g||g.v==null&&(!g.f||g.F))&&p.push(c(g,d,k,A))}return x.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:s,from_sheet:u}}(),lw=function(){function e(i,s){switch(s.type){case"base64":return r(Ht(i),s);case"binary":return r(i,s);case"buffer":return r(Ne&&Buffer.isBuffer(i)?i.toString("binary"):un(i),s);case"array":return r(cn(i),s)}throw new Error("Unrecognized type "+s.type)}function r(i,s){for(var o=i.split(`
`),c=-1,l=-1,f=0,u=[];f!==o.length;++f){if(o[f].trim()==="BOT"){u[++c]=[],l=0;continue}if(!(c<0)){var d=o[f].trim().split(","),h=d[0],x=d[1];++f;for(var p=o[f]||"";(p.match(/["]/g)||[]).length&1&&f<o.length-1;)p+=`
`+o[++f];switch(p=p.trim(),+h){case-1:if(p==="BOT"){u[++c]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?u[c][l]=!0:p==="FALSE"?u[c][l]=!1:isNaN(or(x))?isNaN(Un(x).getDate())?u[c][l]=x:u[c][l]=ft(x):u[c][l]=or(x),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),u[c][l++]=p!==""?p:null;break}if(p==="EOD")break}}return s&&s.sheetRows&&(u=u.slice(0,s.sheetRows)),u}function t(i,s){return Gn(e(i,s),s)}function n(i,s){return Wr(t(i,s),s)}var a=function(){var i=function(c,l,f,u,d){c.push(l),c.push(f+","+u),c.push('"'+d.replace(/"/g,'""')+'"')},s=function(c,l,f,u){c.push(l+","+f),c.push(l==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(c){var l=[],f=Je(c["!ref"]),u,d=Array.isArray(c);i(l,"TABLE",0,1,"sheetjs"),i(l,"VECTORS",0,f.e.r-f.s.r+1,""),i(l,"TUPLES",0,f.e.c-f.s.c+1,""),i(l,"DATA",0,0,"");for(var h=f.s.r;h<=f.e.r;++h){s(l,-1,0,"BOT");for(var x=f.s.c;x<=f.e.c;++x){var p=Re({r:h,c:x});if(u=d?(c[h]||[])[x]:c[p],!u){s(l,1,0,"");continue}switch(u.t){case"n":var m=u.w;!m&&u.v!=null&&(m=u.v),m==null?u.f&&!u.F?s(l,1,0,"="+u.f):s(l,1,0,""):s(l,0,m,"V");break;case"b":s(l,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":s(l,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=Kt(u.z||Oe[14],It(ft(u.v)))),s(l,0,u.w,"V");break;default:s(l,1,0,"")}}}s(l,-1,0,"EOD");var g=`\r
`,w=l.join(g);return w}}();return{to_workbook:n,to_sheet:t,from_sheet:a}}(),fw=function(){function e(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(u,d){for(var h=u.split(`
`),x=-1,p=-1,m=0,g=[];m!==h.length;++m){var w=h[m].trim().split(":");if(w[0]==="cell"){var v=Ft(w[1]);if(g.length<=v.r)for(x=g.length;x<=v.r;++x)g[x]||(g[x]=[]);switch(x=v.r,p=v.c,w[2]){case"t":g[x][p]=e(w[3]);break;case"v":g[x][p]=+w[3];break;case"vtf":var k=w[w.length-1];case"vtc":switch(w[3]){case"nl":g[x][p]=!!+w[4];break;default:g[x][p]=+w[4];break}w[2]=="vtf"&&(g[x][p]=[g[x][p],k])}}}return d&&d.sheetRows&&(g=g.slice(0,d.sheetRows)),g}function n(u,d){return Gn(t(u,d),d)}function a(u,d){return Wr(n(u,d),d)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(u){if(!u||!u["!ref"])return"";for(var d=[],h=[],x,p="",m=Vn(u["!ref"]),g=Array.isArray(u),w=m.s.r;w<=m.e.r;++w)for(var v=m.s.c;v<=m.e.c;++v)if(p=Re({r:w,c:v}),x=g?(u[w]||[])[v]:u[p],!(!x||x.v==null||x.t==="z")){switch(h=["cell",p,"t"],x.t){case"s":case"str":h.push(r(x.v));break;case"n":x.f?(h[2]="vtf",h[3]="n",h[4]=x.v,h[5]=r(x.f)):(h[2]="v",h[3]=x.v);break;case"b":h[2]="vt"+(x.f?"f":"c"),h[3]="nl",h[4]=x.v?"1":"0",h[5]=r(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var k=It(ft(x.v));h[2]="vtc",h[3]="nd",h[4]=""+k,h[5]=x.w||Kt(x.z||Oe[14],k);break;case"e":continue}d.push(h.join(":"))}return d.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(u){return[i,s,o,s,l(u),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),Fa=function(){function e(f,u,d,h,x){x.raw?u[d][h]=f:f===""||(f==="TRUE"?u[d][h]=!0:f==="FALSE"?u[d][h]=!1:isNaN(or(f))?isNaN(Un(f).getDate())?u[d][h]=f:u[d][h]=ft(f):u[d][h]=or(f))}function r(f,u){var d=u||{},h=[];if(!f||f.length===0)return h;for(var x=f.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var m=10,g=0,w=0;w<=p;++w)g=x[w].indexOf(" "),g==-1?g=x[w].length:g++,m=Math.max(m,g);for(w=0;w<=p;++w){h[w]=[];var v=0;for(e(x[w].slice(0,m).trim(),h,w,v,d),v=1;v<=(x[w].length-m)/10+1;++v)e(x[w].slice(m+(v-1)*10,m+v*10).trim(),h,w,v,d)}return d.sheetRows&&(h=h.slice(0,d.sheetRows)),h}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var u={},d=!1,h=0,x=0;h<f.length;++h)(x=f.charCodeAt(h))==34?d=!d:!d&&x in t&&(u[x]=(u[x]||0)+1);x=[];for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&x.push([u[h],h]);if(!x.length){u=n;for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&x.push([u[h],h])}return x.sort(function(p,m){return p[0]-m[0]||n[p[1]]-n[m[1]]}),t[x.pop()[1]]||44}function i(f,u){var d=u||{},h="",x=d.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(h=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(h=f.charAt(4),f=f.slice(6)):h=a(f.slice(0,1024)):d&&d.FS?h=d.FS:h=a(f.slice(0,1024));var m=0,g=0,w=0,v=0,k=0,A=h.charCodeAt(0),F=!1,E=0,z=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var C=d.dateNF!=null?y_(d.dateNF):null;function G(){var H=f.slice(v,k),b={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)b.t="z";else if(d.raw)b.t="s",b.v=H;else if(H.trim().length===0)b.t="s",b.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(b.t="s",b.v=H.slice(2,-1).replace(/""/g,'"')):qy(H)?(b.t="n",b.f=H.slice(1)):(b.t="s",b.v=H);else if(H=="TRUE")b.t="b",b.v=!0;else if(H=="FALSE")b.t="b",b.v=!1;else if(!isNaN(w=or(H)))b.t="n",d.cellText!==!1&&(b.w=H),b.v=w;else if(!isNaN(Un(H).getDate())||C&&H.match(C)){b.z=d.dateNF||Oe[14];var j=0;C&&H.match(C)&&(H=k_(H,d.dateNF,H.match(C)||[]),j=1),d.cellDates?(b.t="d",b.v=ft(H,j)):(b.t="n",b.v=It(ft(H,j))),d.cellText!==!1&&(b.w=Kt(b.z,b.v instanceof Date?It(b.v):b.v)),d.cellNF||delete b.z}else b.t="s",b.v=H;if(b.t=="z"||(d.dense?(x[m]||(x[m]=[]),x[m][g]=b):x[Re({c:g,r:m})]=b),v=k+1,z=f.charCodeAt(v),p.e.c<g&&(p.e.c=g),p.e.r<m&&(p.e.r=m),E==A)++g;else if(g=0,++m,d.sheetRows&&d.sheetRows<=m)return!0}e:for(;k<f.length;++k)switch(E=f.charCodeAt(k)){case 34:z===34&&(F=!F);break;case A:case 10:case 13:if(!F&&G())break e;break}return k-v>0&&G(),x["!ref"]=Be(p),x}function s(f,u){return!(u&&u.PRN)||u.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,u):Gn(r(f,u),u)}function o(f,u){var d="",h=u.type=="string"?[0,0,0,0]:bc(f,u);switch(u.type){case"base64":d=Ht(f);break;case"binary":d=f;break;case"buffer":u.codepage==65001?d=f.toString("utf8"):(u.codepage,d=Ne&&Buffer.isBuffer(f)?f.toString("binary"):un(f));break;case"array":d=cn(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+u.type)}return h[0]==239&&h[1]==187&&h[2]==191?d=Ve(d.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?d=Ve(d):u.type=="binary",d.slice(0,19)=="socialcalc:version:"?fw.to_sheet(u.type=="string"?d:Ve(d),u):s(d,u)}function c(f,u){return Wr(o(f,u),u)}function l(f){for(var u=[],d=Je(f["!ref"]),h,x=Array.isArray(f),p=d.s.r;p<=d.e.r;++p){for(var m=[],g=d.s.c;g<=d.e.c;++g){var w=Re({r:p,c:g});if(h=x?(f[p]||[])[g]:f[w],!h||h.v==null){m.push("          ");continue}for(var v=(h.w||(Ir(h),h.w)||"").slice(0,10);v.length<10;)v+=" ";m.push(v+(g===0?" ":""))}u.push(m.join(""))}return u.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function uw(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var a=cw.to_workbook(e,t);return t.WTF=n,a}catch(i){if(t.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Fa.to_workbook(e,r)}}var ga=function(){function e(T,K,B){if(T){dt(T,T.l||0);for(var N=B.Enum||se;T.l<T.length;){var ie=T.read_shift(2),pe=N[ie]||N[65535],fe=T.read_shift(2),le=T.l+fe,he=pe.f&&pe.f(T,fe,B);if(T.l=le,K(he,pe,ie))return}}}function r(T,K){switch(K.type){case"base64":return t(nr(Ht(T)),K);case"binary":return t(nr(T),K);case"buffer":case"array":return t(T,K)}throw"Unsupported type "+K.type}function t(T,K){if(!T)return T;var B=K||{},N=B.dense?[]:{},ie="Sheet1",pe="",fe=0,le={},he=[],be=[],V={s:{r:0,c:0},e:{r:0,c:0}},Ue=B.sheetRows||0;if(T[2]==0&&(T[3]==8||T[3]==9)&&T.length>=16&&T[14]==5&&T[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(T[2]==2)B.Enum=se,e(T,function(R,O,J){switch(J){case 0:B.vers=R,R>=4096&&(B.qpro=!0);break;case 6:V=R;break;case 204:R&&(pe=R);break;case 222:pe=R;break;case 15:case 51:B.qpro||(R[1].v=R[1].v.slice(1));case 13:case 14:case 16:J==14&&(R[2]&112)==112&&(R[2]&15)>1&&(R[2]&15)<15&&(R[1].z=B.dateNF||Oe[14],B.cellDates&&(R[1].t="d",R[1].v=us(R[1].v))),B.qpro&&R[3]>fe&&(N["!ref"]=Be(V),le[ie]=N,he.push(ie),N=B.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},fe=R[3],ie=pe||"Sheet"+(fe+1),pe="");var ce=B.dense?(N[R[0].r]||[])[R[0].c]:N[Re(R[0])];if(ce){ce.t=R[1].t,ce.v=R[1].v,R[1].z!=null&&(ce.z=R[1].z),R[1].f!=null&&(ce.f=R[1].f);break}B.dense?(N[R[0].r]||(N[R[0].r]=[]),N[R[0].r][R[0].c]=R[1]):N[Re(R[0])]=R[1];break}},B);else if(T[2]==26||T[2]==14)B.Enum=Y,T[2]==14&&(B.qpro=!0,T.l=0),e(T,function(R,O,J){switch(J){case 204:ie=R;break;case 22:R[1].v=R[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(R[3]>fe&&(N["!ref"]=Be(V),le[ie]=N,he.push(ie),N=B.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},fe=R[3],ie="Sheet"+(fe+1)),Ue>0&&R[0].r>=Ue)break;B.dense?(N[R[0].r]||(N[R[0].r]=[]),N[R[0].r][R[0].c]=R[1]):N[Re(R[0])]=R[1],V.e.c<R[0].c&&(V.e.c=R[0].c),V.e.r<R[0].r&&(V.e.r=R[0].r);break;case 27:R[14e3]&&(be[R[14e3][0]]=R[14e3][1]);break;case 1537:be[R[0]]=R[1],R[0]==fe&&(ie=R[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+T[2]);if(N["!ref"]=Be(V),le[pe||ie]=N,he.push(pe||ie),!be.length)return{SheetNames:he,Sheets:le};for(var y={},ae=[],Z=0;Z<be.length;++Z)le[he[Z]]?(ae.push(be[Z]||he[Z]),y[be[Z]]=le[be[Z]]||le[he[Z]]):(ae.push(be[Z]),y[be[Z]]={"!ref":"A1"});return{SheetNames:ae,Sheets:y}}function n(T,K){var B=K||{};if(+B.codepage>=0&&ar(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var N=vo(),ie=Je(T["!ref"]),pe=Array.isArray(T),fe=[];Qt(N,0,i(1030)),Qt(N,6,c(ie));for(var le=Math.min(ie.e.r,8191),he=ie.s.r;he<=le;++he)for(var be=xt(he),V=ie.s.c;V<=ie.e.c;++V){he===ie.s.r&&(fe[V]=it(V));var Ue=fe[V]+be,y=pe?(T[he]||[])[V]:T[Ue];if(!(!y||y.t=="z"))if(y.t=="n")(y.v|0)==y.v&&y.v>=-32768&&y.v<=32767?Qt(N,13,h(he,V,y.v)):Qt(N,14,p(he,V,y.v));else{var ae=Ir(y);Qt(N,15,u(he,V,ae.slice(0,239)))}}return Qt(N,1),N.end()}function a(T,K){var B=K||{};if(+B.codepage>=0&&ar(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var N=vo();Qt(N,0,s(T));for(var ie=0,pe=0;ie<T.SheetNames.length;++ie)(T.Sheets[T.SheetNames[ie]]||{})["!ref"]&&Qt(N,27,P(T.SheetNames[ie],pe++));var fe=0;for(ie=0;ie<T.SheetNames.length;++ie){var le=T.Sheets[T.SheetNames[ie]];if(!(!le||!le["!ref"])){for(var he=Je(le["!ref"]),be=Array.isArray(le),V=[],Ue=Math.min(he.e.r,8191),y=he.s.r;y<=Ue;++y)for(var ae=xt(y),Z=he.s.c;Z<=he.e.c;++Z){y===he.s.r&&(V[Z]=it(Z));var R=V[Z]+ae,O=be?(le[y]||[])[Z]:le[R];if(!(!O||O.t=="z"))if(O.t=="n")Qt(N,23,G(y,Z,fe,O.v));else{var J=Ir(O);Qt(N,22,E(y,Z,fe,J.slice(0,239)))}}++fe}}return Qt(N,1),N.end()}function i(T){var K=at(2);return K.write_shift(2,T),K}function s(T){var K=at(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var B=0,N=0,ie=0,pe=0;pe<T.SheetNames.length;++pe){var fe=T.SheetNames[pe],le=T.Sheets[fe];if(!(!le||!le["!ref"])){++ie;var he=Vn(le["!ref"]);B<he.e.r&&(B=he.e.r),N<he.e.c&&(N=he.e.c)}}return B>8191&&(B=8191),K.write_shift(2,B),K.write_shift(1,ie),K.write_shift(1,N),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(T,K,B){var N={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&B.qpro?(N.s.c=T.read_shift(1),T.l++,N.s.r=T.read_shift(2),N.e.c=T.read_shift(1),T.l++,N.e.r=T.read_shift(2),N):(N.s.c=T.read_shift(2),N.s.r=T.read_shift(2),K==12&&B.qpro&&(T.l+=2),N.e.c=T.read_shift(2),N.e.r=T.read_shift(2),K==12&&B.qpro&&(T.l+=2),N.s.c==65535&&(N.s.c=N.e.c=N.s.r=N.e.r=0),N)}function c(T){var K=at(8);return K.write_shift(2,T.s.c),K.write_shift(2,T.s.r),K.write_shift(2,T.e.c),K.write_shift(2,T.e.r),K}function l(T,K,B){var N=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(N[0].c=T.read_shift(1),N[3]=T.read_shift(1),N[0].r=T.read_shift(2),T.l+=2):(N[2]=T.read_shift(1),N[0].c=T.read_shift(2),N[0].r=T.read_shift(2)),N}function f(T,K,B){var N=T.l+K,ie=l(T,K,B);if(ie[1].t="s",B.vers==20768){T.l++;var pe=T.read_shift(1);return ie[1].v=T.read_shift(pe,"utf8"),ie}return B.qpro&&T.l++,ie[1].v=T.read_shift(N-T.l,"cstr"),ie}function u(T,K,B){var N=at(7+B.length);N.write_shift(1,255),N.write_shift(2,K),N.write_shift(2,T),N.write_shift(1,39);for(var ie=0;ie<N.length;++ie){var pe=B.charCodeAt(ie);N.write_shift(1,pe>=128?95:pe)}return N.write_shift(1,0),N}function d(T,K,B){var N=l(T,K,B);return N[1].v=T.read_shift(2,"i"),N}function h(T,K,B){var N=at(7);return N.write_shift(1,255),N.write_shift(2,K),N.write_shift(2,T),N.write_shift(2,B,"i"),N}function x(T,K,B){var N=l(T,K,B);return N[1].v=T.read_shift(8,"f"),N}function p(T,K,B){var N=at(13);return N.write_shift(1,255),N.write_shift(2,K),N.write_shift(2,T),N.write_shift(8,B,"f"),N}function m(T,K,B){var N=T.l+K,ie=l(T,K,B);if(ie[1].v=T.read_shift(8,"f"),B.qpro)T.l=N;else{var pe=T.read_shift(2);k(T.slice(T.l,T.l+pe),ie),T.l+=pe}return ie}function g(T,K,B){var N=K&32768;return K&=-32769,K=(N?T:0)+(K>=8192?K-16384:K),(N?"":"$")+(B?it(K):xt(K))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(T,K){dt(T,0);for(var B=[],N=0,ie="",pe="",fe="",le="";T.l<T.length;){var he=T[T.l++];switch(he){case 0:B.push(T.read_shift(8,"f"));break;case 1:pe=g(K[0].c,T.read_shift(2),!0),ie=g(K[0].r,T.read_shift(2),!1),B.push(pe+ie);break;case 2:{var be=g(K[0].c,T.read_shift(2),!0),V=g(K[0].r,T.read_shift(2),!1);pe=g(K[0].c,T.read_shift(2),!0),ie=g(K[0].r,T.read_shift(2),!1),B.push(be+V+":"+pe+ie)}break;case 3:if(T.l<T.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(T.read_shift(2));break;case 6:{for(var Ue="";he=T[T.l++];)Ue+=String.fromCharCode(he);B.push('"'+Ue.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:le=B.pop(),fe=B.pop(),B.push(["AND","OR"][he-20]+"("+fe+","+le+")");break;default:if(he<32&&v[he])le=B.pop(),fe=B.pop(),B.push(fe+v[he]+le);else if(w[he]){if(N=w[he][1],N==69&&(N=T[T.l++]),N>B.length){console.error("WK1 bad formula parse 0x"+he.toString(16)+":|"+B.join("|")+"|");return}var y=B.slice(-N);B.length-=N,B.push(w[he][0]+"("+y.join(",")+")")}else return he<=7?console.error("WK1 invalid opcode "+he.toString(16)):he<=24?console.error("WK1 unsupported op "+he.toString(16)):he<=30?console.error("WK1 invalid opcode "+he.toString(16)):he<=115?console.error("WK1 unsupported function opcode "+he.toString(16)):console.error("WK1 unrecognized opcode "+he.toString(16))}}B.length==1?K[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function A(T){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=T.read_shift(2),K[3]=T[T.l++],K[0].c=T[T.l++],K}function F(T,K){var B=A(T);return B[1].t="s",B[1].v=T.read_shift(K-4,"cstr"),B}function E(T,K,B,N){var ie=at(6+N.length);ie.write_shift(2,T),ie.write_shift(1,B),ie.write_shift(1,K),ie.write_shift(1,39);for(var pe=0;pe<N.length;++pe){var fe=N.charCodeAt(pe);ie.write_shift(1,fe>=128?95:fe)}return ie.write_shift(1,0),ie}function z(T,K){var B=A(T);B[1].v=T.read_shift(2);var N=B[1].v>>1;if(B[1].v&1)switch(N&7){case 0:N=(N>>3)*5e3;break;case 1:N=(N>>3)*500;break;case 2:N=(N>>3)/20;break;case 3:N=(N>>3)/200;break;case 4:N=(N>>3)/2e3;break;case 5:N=(N>>3)/2e4;break;case 6:N=(N>>3)/16;break;case 7:N=(N>>3)/64;break}return B[1].v=N,B}function C(T,K){var B=A(T),N=T.read_shift(4),ie=T.read_shift(4),pe=T.read_shift(2);if(pe==65535)return N===0&&ie===3221225472?(B[1].t="e",B[1].v=15):N===0&&ie===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var fe=pe&32768;return pe=(pe&32767)-16446,B[1].v=(1-fe*2)*(ie*Math.pow(2,pe+32)+N*Math.pow(2,pe)),B}function G(T,K,B,N){var ie=at(14);if(ie.write_shift(2,T),ie.write_shift(1,B),ie.write_shift(1,K),N==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var pe=0,fe=0,le=0,he=0;return N<0&&(pe=1,N=-N),fe=Math.log2(N)|0,N/=Math.pow(2,fe-31),he=N>>>0,(he&2147483648)==0&&(N/=2,++fe,he=N>>>0),N-=he,he|=2147483648,he>>>=0,N*=Math.pow(2,32),le=N>>>0,ie.write_shift(4,le),ie.write_shift(4,he),fe+=16383+(pe?32768:0),ie.write_shift(2,fe),ie}function H(T,K){var B=C(T);return T.l+=K-14,B}function b(T,K){var B=A(T),N=T.read_shift(4);return B[1].v=N>>6,B}function j(T,K){var B=A(T),N=T.read_shift(8,"f");return B[1].v=N,B}function _(T,K){var B=j(T);return T.l+=K-10,B}function W(T,K){return T[T.l+K-1]==0?T.read_shift(K,"cstr"):""}function q(T,K){var B=T[T.l++];B>K-1&&(B=K-1);for(var N="";N.length<B;)N+=String.fromCharCode(T[T.l++]);return N}function X(T,K,B){if(!(!B.qpro||K<21)){var N=T.read_shift(1);T.l+=17,T.l+=1,T.l+=2;var ie=T.read_shift(K-21,"cstr");return[N,ie]}}function ue(T,K){for(var B={},N=T.l+K;T.l<N;){var ie=T.read_shift(2);if(ie==14e3){for(B[ie]=[0,""],B[ie][0]=T.read_shift(2);T[T.l];)B[ie][1]+=String.fromCharCode(T[T.l]),T.l++;T.l++}}return B}function P(T,K){var B=at(5+T.length);B.write_shift(2,14e3),B.write_shift(2,K);for(var N=0;N<T.length;++N){var ie=T.charCodeAt(N);B[B.l++]=ie>127?95:ie}return B[B.l++]=0,B}var se={0:{n:"BOF",f:tt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:x},15:{n:"LABEL",f},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:W},222:{n:"SHEETNAMELP",f:q},65535:{n:""}},Y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ue},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:b},38:{n:"??"},39:{n:"NUMBER27",f:j},40:{n:"FORMULA28",f:_},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:W},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:X},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}}();function hw(e){var r={},t=e.match(bt),n=0,a=!1;if(t)for(;n!=t.length;++n){var i=Ce(t[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;r.cp=tc[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=i.val;break;case"<sz":r.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":i.rgb&&(r.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return r}var dw=function(){var e=Sa("t"),r=Sa("rPr");function t(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:ze(s[1])},c=i.match(r);return c&&(o.s=hw(c[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(t).filter(function(o){return o.v})}}(),pw=function(){var r=/(\r\n|\n)/g;function t(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&t(a.s,i[0],i[2]),i[0].join("")+i[1].replace(r,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),xw=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,mw=/<(?:\w+:)?r>/,gw=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function _c(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ze(Ve(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ve(e),t&&(n.h=cc(n.t))):e.match(mw)&&(n.r=Ve(e),n.t=ze(Ve((e.replace(gw,"").match(xw)||[]).join("").replace(bt,""))),t&&(n.h=pw(dw(n.r)))),n):{t:""}}var _w=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,vw=/<(?:\w+:)?(?:si|sstItem)>/g,ww=/<\/(?:\w+:)?(?:si|sstItem)>/;function yw(e,r){var t=[],n="";if(!e)return t;var a=e.match(_w);if(a){n=a[2].replace(vw,"").split(ww);for(var i=0;i!=n.length;++i){var s=_c(n[i].trim(),r);s!=null&&(t[t.length]=s)}a=Ce(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function kw(e){return[e.read_shift(4),e.read_shift(4)]}function Ew(e,r){var t=[],n=!1;return Or(e,function(i,s,o){switch(o){case 159:t.Count=i[0],t.Unique=i[1];break;case 19:t.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function zu(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function Fr(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function Tw(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Fr(e,4),r.U=Fr(e,4),r.W=Fr(e,4),r}function bw(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function Aw(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(bw(e));return r}function Sw(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function Cw(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Fr(e,4),r.U=Fr(e,4),r.W=Fr(e,4),r}function Fw(e){var r=Cw(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function $u(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function Hu(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function Rw(e){var r=Fr(e);switch(r.Minor){case 2:return[r.Minor,Iw(e)];case 3:return[r.Minor,Ow()];case 4:return[r.Minor,Dw(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function Iw(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=$u(e,t),a=Hu(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Ow(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Dw(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(bt,function(i){var s=Ce(i);switch(vr(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function Pw(e,r){var t={},n=t.EncryptionVersionInfo=Fr(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var a=e.read_shift(4);return r-=4,t.EncryptionHeader=$u(e,a),r-=a,t.EncryptionVerifier=Hu(e,r),t}function Nw(e){var r={},t=r.EncryptionVersionInfo=Fr(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function Lw(e){var r=0,t,n=zu(e),a=n.length+1,i,s,o,c,l;for(t=$r(a),t[0]=n.length,i=1;i!=a;++i)t[i]=n[i-1];for(i=a-1;i>=0;--i)s=t[i],o=(r&16384)===0?0:1,c=r<<1&32767,l=o|c,r=l^s;return r^52811}var Wu=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=r[s.length-1],c=104,l=s.length-1;l>=0;--l)for(var f=s[l],u=0;u!=7;++u)f&64&&(o^=t[c]),f*=2,--c;return o};return function(s){for(var o=zu(s),c=i(o),l=o.length,f=$r(16),u=0;u!=16;++u)f[u]=0;var d,h,x;for((l&1)===1&&(d=c>>8,f[l]=a(e[0],d),--l,d=c&255,h=o[o.length-1],f[l]=a(h,d));l>0;)--l,d=c>>8,f[l]=a(o[l],d),--l,d=c&255,f[l]=a(o[l],d);for(l=15,x=15-o.length;x>0;)d=c>>8,f[l]=a(e[x],d),--l,--x,d=c&255,f[l]=a(o[l],d),--l,--x;return f}}(),Mw=function(e,r,t,n,a){a||(a=r),n||(n=Wu(e));var i,s;for(i=0;i!=r.length;++i)s=r[i],s^=n[t],s=(s>>5|s<<3)&255,a[i]=s,++t;return[a,t,n]},Bw=function(e){var r=0,t=Wu(e);return function(n){var a=Mw("",n,r,t);return r=a[1],a[0]}};function Uw(e,r,t,n){var a={key:tt(e),verificationBytes:tt(e)};return t.password&&(a.verifier=Lw(t.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Bw(t.password)),a}function zw(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Nw(e):n.Data=Pw(e,r),n}function $w(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?zw(e,r-2,n):Uw(e,t.biff>=8?r:r-2,t,n),n}var Hw=function(){function e(a,i){switch(i.type){case"base64":return r(Ht(a),i);case"binary":return r(a,i);case"buffer":return r(Ne&&Buffer.isBuffer(a)?a.toString("binary"):un(a),i);case"array":return r(cn(a),i)}throw new Error("Unrecognized type "+i.type)}function r(a,i){var s=i||{},o=s.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,u){Array.isArray(o)&&(o[u]=[]);for(var d=/\\\w+\b/g,h=0,x,p=-1;x=d.exec(f);){switch(x[0]){case"\\cell":var m=f.slice(h,d.lastIndex-x[0].length);if(m[0]==" "&&(m=m.slice(1)),++p,m.length){var g={v:m,t:"s"};Array.isArray(o)?o[u][p]=g:o[Re({r:u,c:p})]=g}break}h=d.lastIndex}p>l.e.c&&(l.e.c=p)}),o["!ref"]=Be(l),o}function t(a,i){return Wr(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=Je(a["!ref"]),o,c=Array.isArray(a),l=s.s.r;l<=s.e.r;++l){i.push("\\trowd\\trautofit1");for(var f=s.s.c;f<=s.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=s.s.c;f<=s.e.c;++f){var u=Re({r:l,c:f});o=c?(a[l]||[])[f]:a[u],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Ir(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function Ww(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Ra(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function Vw(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,a=Math.max(r,t,n),i=Math.min(r,t,n),s=a-i;if(s===0)return[0,0,r];var o=0,c=0,l=a+i;switch(c=s/(l>1?2-l:l),a){case r:o=((t-n)/s+6)%6;break;case t:o=(n-r)/s+2;break;case n:o=(r-t)/s+4;break}return[o/6,c,l/2]}function Gw(e){var r=e[0],t=e[1],n=e[2],a=t*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*r,c;if(t!==0)switch(o|0){case 0:case 6:c=a*o,s[0]+=a,s[1]+=c;break;case 1:c=a*(2-o),s[0]+=c,s[1]+=a;break;case 2:c=a*(o-2),s[1]+=a,s[2]+=c;break;case 3:c=a*(4-o),s[1]+=c,s[2]+=a;break;case 4:c=a*(o-4),s[2]+=a,s[0]+=c;break;case 5:c=a*(6-o),s[2]+=c,s[0]+=a;break}for(var l=0;l!=3;++l)s[l]=Math.round(s[l]*255);return s}function es(e,r){if(r===0)return e;var t=Vw(Ww(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Ra(Gw(t))}var Vu=6,jw=15,Xw=1,Ct=Vu;function ts(e){return Math.floor((e+Math.round(128/Ct)/256)*Ct)}function rs(e){return Math.floor((e-5)/Ct*100+.5)/100}function Eo(e){return Math.round((e*Ct+5)/Ct*256)/256}function Bs(e){return Eo(rs(ts(e)))}function vc(e){var r=Math.abs(e-Bs(e)),t=Ct;if(r>.005)for(Ct=Xw;Ct<jw;++Ct)Math.abs(e-Bs(e))<=r&&(r=Math.abs(e-Bs(e)),t=Ct);Ct=t}function zn(e){e.width?(e.wpx=ts(e.width),e.wch=rs(e.wpx),e.MDW=Ct):e.wpx?(e.wch=rs(e.wpx),e.width=Eo(e.wch),e.MDW=Ct):typeof e.wch=="number"&&(e.width=Eo(e.wch),e.wpx=ts(e.width),e.MDW=Ct),e.customWidth&&delete e.customWidth}var Yw=96,Gu=Yw;function ju(e){return e*96/Gu}function Ia(e){return e*Gu/96}var Kw={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function qw(e,r,t,n){r.Borders=[];var a={},i=!1;(e[0].match(bt)||[]).forEach(function(s){var o=Ce(s);switch(vr(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Ge(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Ge(o.diagonalDown)),r.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function Jw(e,r,t,n){r.Fills=[];var a={},i=!1;(e[0].match(bt)||[]).forEach(function(s){var o=Ce(s);switch(vr(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},r.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function Zw(e,r,t,n){r.Fonts=[];var a={},i=!1;(e[0].match(bt)||[]).forEach(function(s){var o=Ce(s);switch(vr(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=Ve(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Ge(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Ge(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Ge(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Ge(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Ge(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Ge(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Ge(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=tc[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Ge(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=nn[a.color.index];a.color.index==81&&(c=nn[1]),c||(c=nn[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=es(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function Qw(e,r,t){r.NumberFmt=[];for(var n=gr(Oe),a=0;a<n.length;++a)r.NumberFmt[n[a]]=Oe[n[a]];var i=e[0].match(bt);if(i)for(a=0;a<i.length;++a){var s=Ce(i[a]);switch(vr(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ze(Ve(s.formatCode)),c=parseInt(s.numFmtId,10);if(r.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&r.NumberFmt[c]!=null;--c);r.NumberFmt[c]=o}rn(o,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var ui=["numFmtId","fillId","fontId","borderId","xfId"],hi=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function ey(e,r,t){r.CellXf=[];var n,a=!1;(e[0].match(bt)||[]).forEach(function(i){var s=Ce(i),o=0;switch(vr(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<ui.length;++o)n[ui[o]]&&(n[ui[o]]=parseInt(n[ui[o]],10));for(o=0;o<hi.length;++o)n[hi[o]]&&(n[hi[o]]=Ge(n[hi[o]]));if(r.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[o]){n.numFmtId=o;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=Ge(s.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var ty=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var u;return(u=o.match(r))&&Qw(u,f,l),(u=o.match(a))&&Zw(u,f,c,l),(u=o.match(n))&&Jw(u,f,c,l),(u=o.match(i))&&qw(u,f,c,l),(u=o.match(t))&&ey(u,f,l),f}}();function ry(e,r){var t=e.read_shift(2),n=Et(e);return[t,n]}function ny(e,r,t){var n={};n.sz=e.read_shift(2)/20;var a=dv(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=hv(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Et(e),n}var ay=Tt;function iy(e,r){var t=e.l+r,n=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:a}}var sy=Tt;function oy(e,r,t){var n={};n.NumberFmt=[];for(var a in Oe)n.NumberFmt[a]=Oe[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return Or(e,function(c,l,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],rn(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(c.color.rgb=es(r.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(f),s=!0;break;case 38:i.pop(),s=!1;break;default:if(l.T>0)i.push(f);else if(l.T<0)i.pop();else if(!s||t.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var cy=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function ly(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(bt)||[]).forEach(function(a){var i=Ce(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(r.themeElements.clrScheme[cy.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function fy(){}function uy(){}var hy=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,dy=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,py=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function xy(e,r,t){r.themeElements={};var n;[["clrScheme",hy,ly],["fontScheme",dy,fy],["fmtScheme",py,uy]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,r,t)})}var my=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Xu(e,r){(!e||e.length===0)&&(e=gy());var t,n={};if(!(t=e.match(my)))throw new Error("themeElements not found in theme");return xy(t[0],n,r),n.raw=e,n}function gy(e,r){var t=[au];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function _y(e,r,t){var n=e.l+r,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=nu(i,{type:"array"})}catch{return}var o=zt(s,"theme/theme/theme1.xml",!0);if(o)return Xu(o,t)}}function vy(e){return e.read_shift(4)}function wy(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=yy(e,4);break;case 2:r.xclrValue=Du(e);break;case 3:r.xclrValue=vy(e);break;case 4:e.l+=4;break}return e.l+=8,r}function yy(e,r){return Tt(e,r)}function ky(e,r){return Tt(e,r)}function Ey(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=wy(e);break;case 6:n[1]=ky(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function Ty(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(Ey(e,t-e.l));return{ixfe:n,ext:i}}function by(e,r){r.forEach(function(t){t[0]})}function Ay(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Et(e)}}function Sy(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function Cy(e){return e.l+=4,e.read_shift(4)!=0}function Fy(e,r,t){var n={Types:[],Cell:[],Value:[]},a=t||{},i=[],s=!1,o=2;return Or(e,function(c,l,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(u){o==1?n.Cell.push({type:n.Types[u[0]-1].name,index:u[1]}):o==0&&n.Value.push({type:n.Types[u[0]-1].name,index:u[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(f),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!l.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function Ry(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(bt,function(o){var c=Ce(o);switch(vr(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==c.name&&(s=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function Iy(e){var r=[];if(!e)return r;var t=1;return(e.match(bt)||[]).forEach(function(n){var a=Ce(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,r.push(a);break}}),r}function Oy(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Re(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function Dy(e,r,t){var n=[];return Or(e,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function Py(e,r,t,n){if(!e)return e;var a=n||{},i=!1;Or(e,function(o,c,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},a)}function Ny(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function dl(e,r,t,n){var a=Array.isArray(e),i;r.forEach(function(s){var o=Ft(s.ref);if(a?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e[o.r][o.c]=i:e[s.ref]=i;var c=Je(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=Be(c);l!==e["!ref"]&&(e["!ref"]=l)}i.c||(i.c=[]);var f={a:s.author,t:s.t,r:s.r,T:t};s.h&&(f.h=s.h);for(var u=i.c.length-1;u>=0;--u){if(!t&&i.c[u].T)return;t&&!i.c[u].T&&i.c.splice(u,1)}if(t&&n){for(u=0;u<n.length;++u)if(f.a==n[u].id){f.a=n[u].name||f.a;break}}i.c.push(f)})}function Ly(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Ce(o[0]),l={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=Ft(c.ref);if(!(r.sheetRows&&r.sheetRows<=f.r)){var u=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!u&&!!u[1]&&_c(u[1])||{r:"",t:"",h:""};l.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),l.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(l.h=d.h),n.push(l)}}}}),n}function My(e,r){var t=[],n=!1,a={},i=0;return e.replace(bt,function(o,c){var l=Ce(o);switch(vr(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":a.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function By(e,r){var t=[],n=!1;return e.replace(bt,function(i){var s=Ce(i);switch(vr(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),t}function Uy(e){var r={};r.iauthor=e.read_shift(4);var t=dn(e);return r.rfx=t.s,r.ref=Re(t.s),e.l+=16,r}var zy=Et;function $y(e,r){var t=[],n=[],a={},i=!1;return Or(e,function(o,c,l){switch(l){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),t}var Hy="application/vnd.ms-office.vbaProject";function Wy(e){var r=Me.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Me.utils.cfb_add(r,a,e.FileIndex[n].content)}}),Me.write(r)}function Vy(){return{"!type":"dialog"}}function Gy(){return{"!type":"dialog"}}function jy(){return{"!type":"macro"}}function Xy(){return{"!type":"macro"}}var Fn=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,a,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var l=i.length>0?parseInt(i,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return o?f+=r.c:--f,c?l+=r.r:--l,a+(o?"":"$")+it(f)+(c?"":"$")+xt(l)}return function(a,i){return r=i,a.replace(e,t)}}(),Yu=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Yy=function(){return function(r,t){return r.replace(Yu,function(n,a,i,s,o,c){var l=hc(s)-(i?0:t.c),f=uc(c)-(o?0:t.r),u=f==0?"":o?f+1:"["+f+"]",d=l==0?"":i?l+1:"["+l+"]";return a+"R"+u+"C"+d})}}();function Ku(e,r){return e.replace(Yu,function(t,n,a,i,s,o){return n+(a=="$"?a+i:it(hc(i)+r.c))+(s=="$"?s+o:xt(uc(o)+r.r))})}function Ky(e,r,t){var n=Vn(r),a=n.s,i=Ft(t),s={r:i.r-a.r,c:i.c-a.c};return Ku(e,s)}function qy(e){return e.length!=1}function pl(e){return e.replace(/_xlfn\./g,"")}function Qe(e){e.l+=1}function Hr(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function qu(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Ju(e);t.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=Hr(e),o=Hr(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Ju(e){var r=Hr(e),t=Hr(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function Jy(e,r,t){if(t.biff<8)return Ju(e);var n=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),i=Hr(e),s=Hr(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function Zu(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return Zy(e);var n=e.read_shift(t&&t.biff==12?4:2),a=Hr(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Zy(e){var r=Hr(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function Qy(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function ek(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return tk(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function tk(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:n}}function rk(e,r,t){var n=(e[e.l++]&96)>>5,a=qu(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function nk(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=qu(e,i,t);return[n,a,s]}function ak(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function ik(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function sk(e,r,t){var n=(e[e.l++]&96)>>5,a=Jy(e,r-1,t);return[n,a]}function ok(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function xl(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function ck(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function lk(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function fk(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function uk(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function hk(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function Qu(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function dk(e){return e.read_shift(2),Qu(e)}function pk(e){return e.read_shift(2),Qu(e)}function xk(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=Zu(e,0,t);return[n,a]}function mk(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=ek(e,0,t);return[n,a]}function gk(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var i=Zu(e,0,t);return[n,a,i]}function _k(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[vE[a],rh[a],n]}function vk(e,r,t){var n=e[e.l++],a=e.read_shift(1),i=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:wk(e);return[a,(i[0]===0?rh:_E)[i[1]]]}function wk(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function yk(e,r,t){e.l+=t&&t.biff==2?3:4}function kk(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function Ek(e){return e.l++,pn[e.read_shift(1)]}function Tk(e){return e.l++,e.read_shift(2)}function bk(e){return e.l++,e.read_shift(1)!==0}function Ak(e){return e.l++,yt(e)}function Sk(e,r,t){return e.l++,Ua(e,r-1,t)}function Ck(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Ze(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=pn[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=yt(e);break;case 2:t[1]=xn(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Fk(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((t.biff==12?dn:hs)(e));return a}function Rk(e,r,t){var n=0,a=0;t.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=Ck(e,t.biff);return s}function Ik(e,r,t){var n=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,i=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function Ok(e,r,t){if(t.biff==5)return Dk(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function Dk(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function Pk(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function Nk(e,r,t){var n=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function Lk(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function Mk(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var Bk=Tt,Uk=Tt,zk=Tt;function $a(e,r,t){return e.l+=2,[Qy(e)]}function wc(e){return e.l+=6,[]}var $k=$a,Hk=wc,Wk=wc,Vk=$a;function eh(e){return e.l+=2,[tt(e),e.read_shift(2)&1]}var Gk=$a,jk=eh,Xk=wc,Yk=$a,Kk=$a,qk=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Jk(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=qk[t>>2&31];return{ixti:r,coltype:t&3,rt:s,idx:n,c:a,C:i}}function Zk(e){return e.l+=2,[e.read_shift(4)]}function Qk(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function eE(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function tE(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function rE(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function nE(e){return e.l+=4,[0,0]}var ml={1:{n:"PtgExp",f:kk},2:{n:"PtgTbl",f:zk},3:{n:"PtgAdd",f:Qe},4:{n:"PtgSub",f:Qe},5:{n:"PtgMul",f:Qe},6:{n:"PtgDiv",f:Qe},7:{n:"PtgPower",f:Qe},8:{n:"PtgConcat",f:Qe},9:{n:"PtgLt",f:Qe},10:{n:"PtgLe",f:Qe},11:{n:"PtgEq",f:Qe},12:{n:"PtgGe",f:Qe},13:{n:"PtgGt",f:Qe},14:{n:"PtgNe",f:Qe},15:{n:"PtgIsect",f:Qe},16:{n:"PtgUnion",f:Qe},17:{n:"PtgRange",f:Qe},18:{n:"PtgUplus",f:Qe},19:{n:"PtgUminus",f:Qe},20:{n:"PtgPercent",f:Qe},21:{n:"PtgParen",f:Qe},22:{n:"PtgMissArg",f:Qe},23:{n:"PtgStr",f:Sk},26:{n:"PtgSheet",f:Qk},27:{n:"PtgEndSheet",f:eE},28:{n:"PtgErr",f:Ek},29:{n:"PtgBool",f:bk},30:{n:"PtgInt",f:Tk},31:{n:"PtgNum",f:Ak},32:{n:"PtgArray",f:ok},33:{n:"PtgFunc",f:_k},34:{n:"PtgFuncVar",f:vk},35:{n:"PtgName",f:Ik},36:{n:"PtgRef",f:xk},37:{n:"PtgArea",f:rk},38:{n:"PtgMemArea",f:Pk},39:{n:"PtgMemErr",f:Bk},40:{n:"PtgMemNoMem",f:Uk},41:{n:"PtgMemFunc",f:Nk},42:{n:"PtgRefErr",f:Lk},43:{n:"PtgAreaErr",f:ak},44:{n:"PtgRefN",f:mk},45:{n:"PtgAreaN",f:sk},46:{n:"PtgMemAreaN",f:tE},47:{n:"PtgMemNoMemN",f:rE},57:{n:"PtgNameX",f:Ok},58:{n:"PtgRef3d",f:gk},59:{n:"PtgArea3d",f:nk},60:{n:"PtgRefErr3d",f:Mk},61:{n:"PtgAreaErr3d",f:ik},255:{}},aE={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},iE={1:{n:"PtgElfLel",f:eh},2:{n:"PtgElfRw",f:Yk},3:{n:"PtgElfCol",f:$k},6:{n:"PtgElfRwV",f:Kk},7:{n:"PtgElfColV",f:Vk},10:{n:"PtgElfRadical",f:Gk},11:{n:"PtgElfRadicalS",f:Xk},13:{n:"PtgElfColS",f:Hk},15:{n:"PtgElfColSV",f:Wk},16:{n:"PtgElfRadicalLel",f:jk},25:{n:"PtgList",f:Jk},29:{n:"PtgSxName",f:Zk},255:{}},sE={0:{n:"PtgAttrNoop",f:nE},1:{n:"PtgAttrSemi",f:hk},2:{n:"PtgAttrIf",f:fk},4:{n:"PtgAttrChoose",f:ck},8:{n:"PtgAttrGoto",f:lk},16:{n:"PtgAttrSum",f:yk},32:{n:"PtgAttrBaxcel",f:xl},33:{n:"PtgAttrBaxcel",f:xl},64:{n:"PtgAttrSpace",f:dk},65:{n:"PtgAttrSpaceSemi",f:pk},128:{n:"PtgAttrIfError",f:uk},255:{}};function Ha(e,r,t,n){if(n.biff<8)return Tt(e,r);for(var a=e.l+r,i=[],s=0;s!==t.length;++s)switch(t[s][0]){case"PtgArray":t[s][1]=Rk(e,0,n),i.push(t[s][1]);break;case"PtgMemArea":t[s][2]=Fk(e,t[s][1],n),i.push(t[s][2]);break;case"PtgExp":n&&n.biff==12&&(t[s][1][1]=e.read_shift(4),i.push(t[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[s][0]}return r=a-e.l,r!==0&&i.push(Tt(e,r)),i}function Wa(e,r,t){for(var n=e.l+r,a,i,s=[];n!=e.l;)r=n-e.l,i=e[e.l],a=ml[i]||ml[aE[i]],(i===24||i===25)&&(a=(i===24?iE:sE)[e[e.l+1]]),!a||!a.f?Tt(e,r):s.push([a.n,a.f(e,r,t)]);return s}function oE(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var cE={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function lE(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function th(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function gl(e,r,t){var n=th(e,r,t);return n=="#REF"?n:lE(n,t)}function wt(e,r,t,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},o=[],c,l,f,u=0,d=0,h,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,m="",g=0,w=e[0].length;g<w;++g){var v=e[0][g];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:m=qe(" ",e[0][p][1][1]);break;case 1:m=qe("\r",e[0][p][1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}l=l+m,p=-1}o.push(l+cE[v[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=da(v[1][1],s,a),o.push(pa(f,i));break;case"PtgRefN":f=t?da(v[1][1],t,a):v[1][1],o.push(pa(f,i));break;case"PtgRef3d":u=v[1][1],f=da(v[1][2],s,a),x=gl(n,u,a),o.push(x+"!"+pa(f,i));break;case"PtgFunc":case"PtgFuncVar":var k=v[1][0],A=v[1][1];k||(k=0),k&=127;var F=k==0?[]:o.slice(-k);o.length-=k,A==="User"&&(A=F.shift()),o.push(A+"("+F.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":h=J0(v[1][1],t?{s:t}:s,a),o.push(Ls(h,a));break;case"PtgArea":h=J0(v[1][1],s,a),o.push(Ls(h,a));break;case"PtgArea3d":u=v[1][1],h=v[1][2],x=gl(n,u,a),o.push(x+"!"+Ls(h,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=v[1][2];var E=(n.names||[])[d-1]||(n[0]||[])[d],z=E?E.Name:"SH33TJSNAME"+String(d);z&&z.slice(0,6)=="_xlfn."&&!a.xlfn&&(z=z.slice(6)),o.push(z);break;case"PtgNameX":var C=v[1][1];d=v[1][2];var G;if(a.biff<=5)C<0&&(C=-C),n[C]&&(G=n[C][d]);else{var H="";if(((n[C]||[])[0]||[])[0]==14849||(((n[C]||[])[0]||[])[0]==1025?n[C][d]&&n[C][d].itab>0&&(H=n.SheetNames[n[C][d].itab-1]+"!"):H=n.SheetNames[d-1]+"!"),n[C]&&n[C][d])H+=n[C][d].Name;else if(n[0]&&n[0][d])H+=n[0][d].Name;else{var b=(th(n,C,a)||"").split(";;");b[d-1]?H=b[d-1]:H+="SH33TJSERRX"}o.push(H);break}G||(G={Name:"SH33TJSERRY"}),o.push(G.Name);break;case"PtgParen":var j="(",_=")";if(p>=0){switch(m="",e[0][p][1][0]){case 2:j=qe(" ",e[0][p][1][1])+j;break;case 3:j=qe("\r",e[0][p][1][1])+j;break;case 4:_=qe(" ",e[0][p][1][1])+_;break;case 5:_=qe("\r",e[0][p][1][1])+_;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(j+o.pop()+_);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:v[1][1],r:v[1][0]};var W={c:t.c,r:t.r};if(n.sharedf[Re(f)]){var q=n.sharedf[Re(f)];o.push(wt(q,s,W,n,a))}else{var X=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(f.c<l[0].s.c||f.c>l[0].e.c)&&!(f.r<l[0].s.r||f.r>l[0].e.r)){o.push(wt(l[1],s,W,n,a)),X=!0;break}X||o.push(v[1])}break;case"PtgArray":o.push("{"+oE(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var ue=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&ue.indexOf(e[0][g][0])==-1){v=e[0][p];var P=!0;switch(v[1][0]){case 4:P=!1;case 0:m=qe(" ",v[1][1]);break;case 5:P=!1;case 1:m=qe("\r",v[1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((P?m:"")+o.pop()+(P?"":m)),p=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function fE(e,r,t){var n=e.l+r,a=t.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Tt(e,r-2)];var o=Wa(e,s,t);return r!==s+a&&(i=Ha(e,r-s-a,o,t)),e.l=n,[o,i]}function uE(e,r,t){var n=e.l+r,a=t.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Tt(e,r-2)];var o=Wa(e,s,t);return r!==s+a&&(i=Ha(e,r-s-a,o,t)),e.l=n,[o,i]}function hE(e,r,t,n){var a=e.l+r,i=Wa(e,n,t),s;return a!==e.l&&(s=Ha(e,a-e.l,i,t)),[i,s]}function dE(e,r,t){var n=e.l+r,a,i=e.read_shift(2),s=Wa(e,i,t);return i==65535?[[],Tt(e,r-2)]:(r!==i+2&&(a=Ha(e,n-i-2,s,t)),[s,a])}function pE(e){var r;if(Sr(e,e.l+6)!==65535)return[yt(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Us(e,r,t){var n=e.l+r,a=wr(e);t.biff==2&&++e.l;var i=pE(e),s=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var o=uE(e,n-e.l,t);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function ds(e,r,t){var n=e.read_shift(4),a=Wa(e,n,t),i=e.read_shift(4),s=i>0?Ha(e,i,a,t):null;return[a,s]}var xE=ds,ps=ds,mE=ds,gE=ds,_E={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},rh={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},vE={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _l(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function zs(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var _a={},Rn={};function va(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function nh(e,r,t,n,a,i){try{n.cellNF&&(e.z=Oe[r])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ft(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Oe[r]==null&&rn(w_[r]||"General",r),e.t==="e")e.w=e.w||pn[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Aa(e.v);else if(e.t==="d"){var s=It(e.v);(s|0)===s?e.w=s.toString(10):e.w=Aa(s)}else{if(e.v===void 0)return"";e.w=on(e.v,Rn)}else e.t==="d"?e.w=Kt(r,It(e.v),Rn):e.w=Kt(r,e.v,Rn)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&t!=null)try{e.s=i.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=es(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=es(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function wE(e,r){var t=Je(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Be(t))}var yE=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,kE=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,EE=/<(?:\w:)?hyperlink [^>]*>/mg,TE=/"(\w*:\w*)"/,bE=/<(?:\w:)?col\b[^>]*[\/]?>/g,AE=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,SE=/<(?:\w:)?pageMargins[^>]*\/>/g,ah=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,CE=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,FE=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function RE(e,r,t,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o=r.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",f="",u=e.match(kE);u?(l=e.slice(0,u.index),f=e.slice(u.index+u[0].length)):l=f=e;var d=l.match(ah);d?yc(d[0],o,a,t):(d=l.match(CE))&&IE(d[0],d[1]||"",o,a,t);var h=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var x=l.slice(h,h+50).match(TE);x&&wE(o,x[1])}var p=l.match(FE);p&&p[1]&&ME(p[1],a);var m=[];if(r.cellStyles){var g=l.match(bE);g&&PE(m,g)}u&&BE(u[1],o,r,c,i,s);var w=f.match(AE);w&&(o["!autofilter"]=NE(w[0]));var v=[],k=f.match(yE);if(k)for(h=0;h!=k.length;++h)v[h]=Je(k[h].slice(k[h].indexOf('"')+1));var A=f.match(EE);A&&OE(o,A,n);var F=f.match(SE);if(F&&(o["!margins"]=DE(Ce(F[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Be(c)),r.sheetRows>0&&o["!ref"]){var E=Je(o["!ref"]);r.sheetRows<=+E.e.r&&(E.e.r=r.sheetRows-1,E.e.r>c.e.r&&(E.e.r=c.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>c.e.c&&(E.e.c=c.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Be(E))}return m.length>0&&(o["!cols"]=m),v.length>0&&(o["!merges"]=v),o}function yc(e,r,t,n){var a=Ce(e);t.Sheets[n]||(t.Sheets[n]={}),a.codeName&&(t.Sheets[n].CodeName=ze(Ve(a.codeName)))}function IE(e,r,t,n,a){yc(e.slice(0,e.indexOf(">")),t,n,a)}function OE(e,r,t){for(var n=Array.isArray(e),a=0;a!=r.length;++a){var i=Ce(Ve(r[a]),!0);if(!i.ref)return;var s=((t||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+ze(i.location))):(i.Target="#"+ze(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Je(i.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var f=Re({c:l,r:c});n?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=i):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=i)}}}function DE(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function PE(e,r){for(var t=!1,n=0;n!=r.length;++n){var a=Ce(r[n],!0);a.hidden&&(a.hidden=Ge(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,vc(a.width)),zn(a);i<=s;)e[i++]=pt(a)}}function NE(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var LE=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function ME(e,r){r.Views||(r.Views=[{}]),(e.match(LE)||[]).forEach(function(t,n){var a=Ce(t);r.Views[n]||(r.Views[n]={}),+a.zoomScale&&(r.Views[n].zoom=+a.zoomScale),Ge(a.rightToLeft)&&(r.Views[n].RTL=!0)})}var BE=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Sa("v"),s=Sa("f");return function(c,l,f,u,d,h){for(var x=0,p="",m=[],g=[],w=0,v=0,k=0,A="",F,E,z=0,C=0,G,H,b=0,j=0,_=Array.isArray(h.CellXf),W,q=[],X=[],ue=Array.isArray(l),P=[],se={},Y=!1,T=!!f.sheetStubs,K=c.split(r),B=0,N=K.length;B!=N;++B){p=K[B].trim();var ie=p.length;if(ie!==0){var pe=0;e:for(x=0;x<ie;++x)switch(p[x]){case">":if(p[x-1]!="/"){++x;break e}if(f&&f.cellStyles){if(E=Ce(p.slice(pe,x),!0),z=E.r!=null?parseInt(E.r,10):z+1,C=-1,f.sheetRows&&f.sheetRows<z)continue;se={},Y=!1,E.ht&&(Y=!0,se.hpt=parseFloat(E.ht),se.hpx=Ia(se.hpt)),E.hidden=="1"&&(Y=!0,se.hidden=!0),E.outlineLevel!=null&&(Y=!0,se.level=+E.outlineLevel),Y&&(P[z-1]=se)}break;case"<":pe=x;break}if(pe>=x)break;if(E=Ce(p.slice(pe,x),!0),z=E.r!=null?parseInt(E.r,10):z+1,C=-1,!(f.sheetRows&&f.sheetRows<z)){u.s.r>z-1&&(u.s.r=z-1),u.e.r<z-1&&(u.e.r=z-1),f&&f.cellStyles&&(se={},Y=!1,E.ht&&(Y=!0,se.hpt=parseFloat(E.ht),se.hpx=Ia(se.hpt)),E.hidden=="1"&&(Y=!0,se.hidden=!0),E.outlineLevel!=null&&(Y=!0,se.level=+E.outlineLevel),Y&&(P[z-1]=se)),m=p.slice(x).split(e);for(var fe=0;fe!=m.length&&m[fe].trim().charAt(0)=="<";++fe);for(m=m.slice(fe),x=0;x!=m.length;++x)if(p=m[x].trim(),p.length!==0){if(g=p.match(t),w=x,v=0,k=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,g!=null&&g.length===2){for(w=0,A=g[1],v=0;v!=A.length&&!((k=A.charCodeAt(v)-64)<1||k>26);++v)w=26*w+k;--w,C=w}else++C;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,E=Ce(p.slice(0,v),!0),E.r||(E.r=Re({r:z-1,c:C})),A=p.slice(v),F={t:""},(g=A.match(i))!=null&&g[1]!==""&&(F.v=ze(g[1])),f.cellFormula){if((g=A.match(s))!=null&&g[1]!==""){if(F.f=ze(Ve(g[1])).replace(/\r\n/g,`
`),f.xlfn||(F.f=pl(F.f)),g[0].indexOf('t="array"')>-1)F.F=(A.match(a)||[])[1],F.F.indexOf(":")>-1&&q.push([Je(F.F),F.F]);else if(g[0].indexOf('t="shared"')>-1){H=Ce(g[0]);var le=ze(Ve(g[1]));f.xlfn||(le=pl(le)),X[parseInt(H.si,10)]=[H,le,E.r]}}else(g=A.match(/<f[^>]*\/>/))&&(H=Ce(g[0]),X[H.si]&&(F.f=Ky(X[H.si][1],X[H.si][2],E.r)));var he=Ft(E.r);for(v=0;v<q.length;++v)he.r>=q[v][0].s.r&&he.r<=q[v][0].e.r&&he.c>=q[v][0].s.c&&he.c<=q[v][0].e.c&&(F.F=q[v][1])}if(E.t==null&&F.v===void 0)if(F.f||F.F)F.v=0,F.t="n";else if(T)F.t="z";else continue;else F.t=E.t||"n";switch(u.s.c>C&&(u.s.c=C),u.e.c<C&&(u.e.c=C),F.t){case"n":if(F.v==""||F.v==null){if(!T)continue;F.t="z"}else F.v=parseFloat(F.v);break;case"s":if(typeof F.v>"u"){if(!T)continue;F.t="z"}else G=_a[parseInt(F.v,10)],F.v=G.t,F.r=G.r,f.cellHTML&&(F.h=G.h);break;case"str":F.t="s",F.v=F.v!=null?Ve(F.v):"",f.cellHTML&&(F.h=cc(F.v));break;case"inlineStr":g=A.match(n),F.t="s",g!=null&&(G=_c(g[1]))?(F.v=G.t,f.cellHTML&&(F.h=G.h)):F.v="";break;case"b":F.v=Ge(F.v);break;case"d":f.cellDates?F.v=ft(F.v,1):(F.v=It(ft(F.v,1)),F.t="n");break;case"e":(!f||f.cellText!==!1)&&(F.w=F.v),F.v=bu[F.v];break}if(b=j=0,W=null,_&&E.s!==void 0&&(W=h.CellXf[E.s],W!=null&&(W.numFmtId!=null&&(b=W.numFmtId),f.cellStyles&&W.fillId!=null&&(j=W.fillId))),nh(F,b,j,f,d,h),f.cellDates&&_&&F.t=="n"&&Wn(Oe[b])&&(F.t="d",F.v=us(F.v)),E.cm&&f.xlmeta){var be=(f.xlmeta.Cell||[])[+E.cm-1];be&&be.type=="XLDAPR"&&(F.D=!0)}if(ue){var V=Ft(E.r);l[V.r]||(l[V.r]=[]),l[V.r][V.c]=F}else l[E.r]=F}}}}P.length>0&&(l["!rows"]=P)}}();function UE(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(t.level=i&7),i&16&&(t.hidden=!0),i&32&&(t.hpt=a/20),t}var zE=dn;function $E(){}function HE(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=fv(e),t}function WE(e){var r=qt(e);return[r]}function VE(e){var r=hn(e);return[r]}function GE(e){var r=qt(e),t=e.read_shift(1);return[r,t,"b"]}function jE(e){var r=hn(e),t=e.read_shift(1);return[r,t,"b"]}function XE(e){var r=qt(e),t=e.read_shift(1);return[r,t,"e"]}function YE(e){var r=hn(e),t=e.read_shift(1);return[r,t,"e"]}function KE(e){var r=qt(e),t=e.read_shift(4);return[r,t,"s"]}function qE(e){var r=hn(e),t=e.read_shift(4);return[r,t,"s"]}function JE(e){var r=qt(e),t=yt(e);return[r,t,"n"]}function ih(e){var r=hn(e),t=yt(e);return[r,t,"n"]}function ZE(e){var r=qt(e),t=xc(e);return[r,t,"n"]}function QE(e){var r=hn(e),t=xc(e);return[r,t,"n"]}function eT(e){var r=qt(e),t=dc(e);return[r,t,"is"]}function tT(e){var r=qt(e),t=Et(e);return[r,t,"str"]}function rT(e){var r=hn(e),t=Et(e);return[r,t,"str"]}function nT(e,r,t){var n=e.l+r,a=qt(e);a.r=t["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(t.cellFormula){e.l+=2;var o=ps(e,n-e.l,t);s[3]=wt(o,null,a,t.supbooks,t)}else e.l=n;return s}function aT(e,r,t){var n=e.l+r,a=qt(e);a.r=t["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(t.cellFormula){e.l+=2;var o=ps(e,n-e.l,t);s[3]=wt(o,null,a,t.supbooks,t)}else e.l=n;return s}function iT(e,r,t){var n=e.l+r,a=qt(e);a.r=t["!row"];var i=yt(e),s=[a,i,"n"];if(t.cellFormula){e.l+=2;var o=ps(e,n-e.l,t);s[3]=wt(o,null,a,t.supbooks,t)}else e.l=n;return s}function sT(e,r,t){var n=e.l+r,a=qt(e);a.r=t["!row"];var i=Et(e),s=[a,i,"str"];if(t.cellFormula){e.l+=2;var o=ps(e,n-e.l,t);s[3]=wt(o,null,a,t.supbooks,t)}else e.l=n;return s}var oT=dn;function cT(e,r){var t=e.l+r,n=dn(e),a=pc(e),i=Et(e),s=Et(e),o=Et(e);e.l=t;var c={rfx:n,relId:a,loc:i,display:o};return s&&(c.Tooltip=s),c}function lT(){}function fT(e,r,t){var n=e.l+r,a=ku(e),i=e.read_shift(1),s=[a];if(s[2]=i,t.cellFormula){var o=xE(e,n-e.l,t);s[1]=o}else e.l=n;return s}function uT(e,r,t){var n=e.l+r,a=dn(e),i=[a];if(t.cellFormula){var s=gE(e,n-e.l,t);i[1]=s,e.l=n}else e.l=n;return i}var hT=["left","right","top","bottom","header","footer"];function dT(e){var r={};return hT.forEach(function(t){r[t]=yt(e)}),r}function pT(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function xT(){}function mT(){}function gT(e,r,t,n,a,i,s){if(!e)return e;var o=r||{};n||(n={"!id":{}});var c=o.dense?[]:{},l,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=!1,d=!1,h,x,p,m,g,w,v,k,A,F=[];o.biff=12,o["!row"]=0;var E=0,z=!1,C=[],G={},H=o.supbooks||a.supbooks||[[]];if(H.sharedf=G,H.arrayf=C,H.SheetNames=a.SheetNames||a.Sheets.map(function(ue){return ue.name}),!o.supbooks&&(o.supbooks=H,a.Names))for(var b=0;b<a.Names.length;++b)H[0][b+1]=a.Names[b];var j=[],_=[],W=!1;ns[16]={n:"BrtShortReal",f:ih};var q;if(Or(e,function(P,se,Y){if(!d)switch(Y){case 148:l=P;break;case 0:h=P,o.sheetRows&&o.sheetRows<=h.r&&(d=!0),k=xt(m=h.r),o["!row"]=h.r,(P.hidden||P.hpt||P.level!=null)&&(P.hpt&&(P.hpx=Ia(P.hpt)),_[P.r]=P);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:P[2]},P[2]){case"n":x.v=P[1];break;case"s":v=_a[P[1]],x.v=v.t,x.r=v.r;break;case"b":x.v=!!P[1];break;case"e":x.v=P[1],o.cellText!==!1&&(x.w=pn[x.v]);break;case"str":x.t="s",x.v=P[1];break;case"is":x.t="s",x.v=P[1].t;break}if((p=s.CellXf[P[0].iStyleRef])&&nh(x,p.numFmtId,null,o,i,s),g=P[0].c==-1?g+1:P[0].c,o.dense?(c[m]||(c[m]=[]),c[m][g]=x):c[it(g)+k]=x,o.cellFormula){for(z=!1,E=0;E<C.length;++E){var T=C[E];h.r>=T[0].s.r&&h.r<=T[0].e.r&&g>=T[0].s.c&&g<=T[0].e.c&&(x.F=Be(T[0]),z=!0)}!z&&P.length>3&&(x.f=P[3])}if(f.s.r>h.r&&(f.s.r=h.r),f.s.c>g&&(f.s.c=g),f.e.r<h.r&&(f.e.r=h.r),f.e.c<g&&(f.e.c=g),o.cellDates&&p&&x.t=="n"&&Wn(Oe[p.numFmtId])){var K=Qr(x.v);K&&(x.t="d",x.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}q&&(q.type=="XLDAPR"&&(x.D=!0),q=void 0);break;case 1:case 12:if(!o.sheetStubs||u)break;x={t:"z",v:void 0},g=P[0].c==-1?g+1:P[0].c,o.dense?(c[m]||(c[m]=[]),c[m][g]=x):c[it(g)+k]=x,f.s.r>h.r&&(f.s.r=h.r),f.s.c>g&&(f.s.c=g),f.e.r<h.r&&(f.e.r=h.r),f.e.c<g&&(f.e.c=g),q&&(q.type=="XLDAPR"&&(x.D=!0),q=void 0);break;case 176:F.push(P);break;case 49:q=((o.xlmeta||{}).Cell||[])[P-1];break;case 494:var B=n["!id"][P.relId];for(B?(P.Target=B.Target,P.loc&&(P.Target+="#"+P.loc),P.Rel=B):P.relId==""&&(P.Target="#"+P.loc),m=P.rfx.s.r;m<=P.rfx.e.r;++m)for(g=P.rfx.s.c;g<=P.rfx.e.c;++g)o.dense?(c[m]||(c[m]=[]),c[m][g]||(c[m][g]={t:"z",v:void 0}),c[m][g].l=P):(w=Re({c:g,r:m}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=P);break;case 426:if(!o.cellFormula)break;C.push(P),A=o.dense?c[m][g]:c[it(g)+k],A.f=wt(P[1],f,{r:h.r,c:g},H,o),A.F=Be(P[0]);break;case 427:if(!o.cellFormula)break;G[Re(P[0].s)]=P[1],A=o.dense?c[m][g]:c[it(g)+k],A.f=wt(P[1],f,{r:h.r,c:g},H,o);break;case 60:if(!o.cellStyles)break;for(;P.e>=P.s;)j[P.e--]={width:P.w/256,hidden:!!(P.flags&1),level:P.level},W||(W=!0,vc(P.w/256)),zn(j[P.e+1]);break;case 161:c["!autofilter"]={ref:Be(P)};break;case 476:c["!margins"]=P;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),P.name&&(a.Sheets[t].CodeName=P.name),(P.above||P.left)&&(c["!outline"]={above:P.above,left:P.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),P.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:u=!0;break;case 38:u=!1;break;default:if(!se.T){if(!u||o.WTF)throw new Error("Unexpected record 0x"+Y.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=Be(l||f)),o.sheetRows&&c["!ref"]){var X=Je(c["!ref"]);o.sheetRows<=+X.e.r&&(X.e.r=o.sheetRows-1,X.e.r>f.e.r&&(X.e.r=f.e.r),X.e.r<X.s.r&&(X.s.r=X.e.r),X.e.c>f.e.c&&(X.e.c=f.e.c),X.e.c<X.s.c&&(X.s.c=X.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Be(X))}return F.length>0&&(c["!merges"]=F),j.length>0&&(c["!cols"]=j),_.length>0&&(c["!rows"]=_),c}function _T(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(r[+s[1]]=t?+s[2]:s[2])});var a=ze((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[r,a,n]}function vT(e,r,t,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,l="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var d=_T(u);f.s.r=f.s.c=0,f.e.c=o,l=it(o),d[0].forEach(function(h,x){s[l+xt(x)]={t:"n",v:h,z:d[1]},c=x}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(s["!ref"]=Be(f)),s}function wT(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(ah);return o&&yc(o[0],i,a,t),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function yT(e,r){e.l+=10;var t=Et(e);return{name:t}}function kT(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Or(e,function(c,l,f){switch(f){case 550:i["!rel"]=c;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),c.name&&(a.Sheets[t].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!s||r.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},r),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var sh=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ET=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],TT=[],bT=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function vl(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],a=0;a!=r.length;++a){var i=r[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Ge(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function wl(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ge(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function oh(e){wl(e.WBProps,sh),wl(e.CalcPr,bT),vl(e.WBView,ET),vl(e.Sheets,TT),Rn.date1904=Ge(e.WBProps.date1904)}var AT="][*?/\\".split("");function ST(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return AT.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var CT=/<\w+:workbook/;function FT(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(bt,function(c,l){var f=Ce(c);switch(vr(f[0])){case"<?xml":break;case"<workbook":c.match(CT)&&(a="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],t.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":sh.forEach(function(u){if(f[u[0]]!=null)switch(u[2]){case"bool":t.WBProps[u[0]]=Ge(f[u[0]]);break;case"int":t.WBProps[u[0]]=parseInt(f[u[0]],10);break;default:t.WBProps[u[0]]=f[u[0]]}}),f.codeName&&(t.WBProps.CodeName=Ve(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],t.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=ze(Ve(f.name)),delete f[0],t.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Ve(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),Ge(f.hidden||"0")&&(i.Hidden=!0),s=l+c.length;break;case"</definedName>":i.Ref=ze(Ve(e.slice(s,l))),t.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],t.CalcPr=f;break;case"<calcPr/>":delete f[0],t.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),X_.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return oh(t),t}function RT(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=wo(e),t.name=Et(e),t}function IT(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?Et(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function OT(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function DT(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var a=e.read_shift(4),i=uv(e),s=mE(e,0,t),o=pc(e);e.l=n;var c={Name:i,Ptg:s};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function PT(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;r||(r={}),r.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],ns[16]={n:"BrtFRTArchID$",f:OT},Or(e,function(c,l,f){switch(f){case 156:s.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(r.SID=c.Sheet),c.Ref=wt(c.Ptg,null,null,s,r),delete r.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([f,c]):s[0]=[f,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!l.T){if(!a||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},r),oh(t),t.Names=i,t.supbooks=s,t}function NT(e,r,t){return r.slice(-4)===".bin"?PT(e,t):FT(e,t)}function LT(e,r,t,n,a,i,s,o){return r.slice(-4)===".bin"?gT(e,n,t,a,i,s,o):RE(e,n,t,a,i,s,o)}function MT(e,r,t,n,a,i,s,o){return r.slice(-4)===".bin"?kT(e,n,t,a,i):wT(e,n,t,a,i)}function BT(e,r,t,n,a,i,s,o){return r.slice(-4)===".bin"?jy():Xy()}function UT(e,r,t,n,a,i,s,o){return r.slice(-4)===".bin"?Vy():Gy()}function zT(e,r,t,n){return r.slice(-4)===".bin"?oy(e,t,n):ty(e,t,n)}function $T(e,r,t){return Xu(e,t)}function HT(e,r,t){return r.slice(-4)===".bin"?Ew(e,t):yw(e,t)}function WT(e,r,t){return r.slice(-4)===".bin"?$y(e,t):Ly(e,t)}function VT(e,r,t){return r.slice(-4)===".bin"?Dy(e):Iy(e)}function GT(e,r,t,n){return t.slice(-4)===".bin"?Py(e,r,t,n):void 0}function jT(e,r,t){return r.slice(-4)===".bin"?Fy(e,r,t):Ry(e,r,t)}var ch=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,lh=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Zt(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var a=e.match(ch),i,s,o,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(lh),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function XT(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(ch),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(lh),(i=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),t[s]=a[2].slice(1,a[2].length-1));return t}var wa;function YT(e,r){var t=wa[e]||ze(e);return t==="General"?on(r):Kt(t,r)}function KT(e,r,t,n){var a=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Ge(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=ft(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[ze(r)]=a}function qT(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||pn[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Aa(e.v):e.w=on(e.v):e.w=YT(r||"General",e.v)}catch(i){if(t.WTF)throw i}try{var n=wa[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&Wn(n)){var a=Qr(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(t.WTF)throw i}}}function JT(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=Kw[n.Pattern]||n.Pattern)}e[r.ID]=r}function ZT(e,r,t,n,a,i,s,o,c,l){var f="General",u=n.StyleID,d={};l=l||{};var h=[],x=0;for(u===void 0&&o&&(u=o.StyleID),u===void 0&&s&&(u=s.StyleID);i[u]!==void 0&&(i[u].nf&&(f=i[u].nf),i[u].Interior&&h.push(i[u].Interior),!!i[u].Parent);)u=i[u].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=Ge(e);break;case"String":n.t="s",n.r=H0(ze(e)),n.v=e.indexOf("<")>-1?ze(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(ft(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ze(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=bu[e],l.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=H0(r||e));break}if(qT(n,f,l),l.cellFormula!==!1)if(n.Formula){var p=ze(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=Fn(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Fn("RC:RC",a):n.ArrayRange&&(n.F=Fn(n.ArrayRange,a),c.push([Je(n.F),n.F]))}else for(x=0;x<c.length;++x)a.r>=c[x][0].s.r&&a.r<=c[x][0].e.r&&a.c>=c[x][0].s.c&&a.c<=c[x][0].e.c&&(n.F=c[x][1]);l.cellStyles&&(h.forEach(function(m){!d.patternType&&m.patternType&&(d.patternType=m.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function QT(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function $s(e,r){var t=r||{};Jf();var n=ra(lc(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=Ve(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=pt(t);return s.type="string",Fa.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(O){a.indexOf("<"+O)>=0&&(i=!0)}),i)return c4(n,t);wa={"General Number":"General","General Date":Oe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Oe[15],"Short Date":Oe[14],"Long Time":Oe[19],"Medium Time":Oe[18],"Short Time":Oe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Oe[2],Standard:Oe[4],Percent:Oe[10],Scientific:Oe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l,f={},u=[],d=t.dense?[]:{},h="",x={},p={},m=Zt('<Data ss:Type="String">'),g=0,w=0,v=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},F={},E="",z=0,C=[],G={},H={},b=0,j=[],_=[],W={},q=[],X,ue=!1,P=[],se=[],Y={},T=0,K=0,B={Sheets:[],WBProps:{date1904:!1}},N={};Ca.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";o=Ca.exec(n);)switch(o[3]=(ie=o[3]).toLowerCase()){case"data":if(ie=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?ZT(n.slice(g,o.index),E,m,c[c.length-1][0]=="comment"?W:x,{c:w,r:v},A,q[w],p,P,t):(E="",m=Zt(o[0]),g=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(_.length>0&&(x.c=_),(!t.sheetRows||t.sheetRows>v)&&x.v!==void 0&&(t.dense?(d[v]||(d[v]=[]),d[v][w]=x):d[it(w)+xt(v)]=x),x.HRef&&(x.l={Target:ze(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(T=w+(parseInt(x.MergeAcross,10)|0),K=v+(parseInt(x.MergeDown,10)|0),C.push({s:{c:w,r:v},e:{c:T,r:K}})),!t.sheetStubs)x.MergeAcross?w=T+1:++w;else if(x.MergeAcross||x.MergeDown){for(var pe=w;pe<=T;++pe)for(var fe=v;fe<=K;++fe)(pe>w||fe>v)&&(t.dense?(d[fe]||(d[fe]=[]),d[fe][pe]={t:"z"}):d[it(pe)+xt(fe)]={t:"z"});w=T+1}else++w;else x=XT(o[0]),x.Index&&(w=+x.Index-1),w<k.s.c&&(k.s.c=w),w>k.e.c&&(k.e.c=w),o[0].slice(-2)==="/>"&&++w,_=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<k.s.r&&(k.s.r=v),v>k.e.r&&(k.e.r=v),o[0].slice(-2)==="/>"&&(p=Zt(o[0]),p.Index&&(v=+p.Index-1)),w=0,++v):(p=Zt(o[0]),p.Index&&(v=+p.Index-1),Y={},(p.AutoFitHeight=="0"||p.Height)&&(Y.hpx=parseInt(p.Height,10),Y.hpt=ju(Y.hpx),se[v]=Y),p.Hidden=="1"&&(Y.hidden=!0,se[v]=Y));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));u.push(h),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(d["!ref"]=Be(k),t.sheetRows&&t.sheetRows<=k.e.r&&(d["!fullref"]=d["!ref"],k.e.r=t.sheetRows-1,d["!ref"]=Be(k))),C.length&&(d["!merges"]=C),q.length>0&&(d["!cols"]=q),se.length>0&&(d["!rows"]=se),f[h]=d}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=w=0,c.push([o[3],!1]),l=Zt(o[0]),h=ze(l.Name),d=t.dense?[]:{},C=[],P=[],se=[],N={name:h,Hidden:0},B.Sheets.push(N);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),q=[],ue=!1}break;case"style":o[1]==="/"?JT(A,F,t):F=Zt(o[0]);break;case"numberformat":F.nf=ze(Zt(o[0]).Format||"General"),wa[F.nf]&&(F.nf=wa[F.nf]);for(var le=0;le!=392&&Oe[le]!=F.nf;++le);if(le==392){for(le=57;le!=392;++le)if(Oe[le]==null){rn(F.nf,le);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(X=Zt(o[0]),X.Hidden&&(X.hidden=!0,delete X.Hidden),X.Width&&(X.wpx=parseInt(X.Width,10)),!ue&&X.wpx>10){ue=!0,Ct=Vu;for(var he=0;he<q.length;++he)q[he]&&zn(q[he])}ue&&zn(X),q[X.Index-1||q.length]=X;for(var be=0;be<+X.Span;++be)q[q.length]=pt(X);break;case"namedrange":if(o[1]==="/")break;B.Names||(B.Names=[]);var V=Ce(o[0]),Ue={Name:V.Name,Ref:Fn(V.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(Ue.Sheet=B.Sheets.length-1),B.Names.push(Ue);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=n.slice(z,o.index):z=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;F.Interior=Zt(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?Lv(G,ie,n.slice(b,o.index)):b=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));QT(W),_.push(W)}else c.push([o[3],!1]),l=Zt(o[0]),W={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var y=Zt(o[0]);d["!autofilter"]={ref:Fn(y.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Al(n,t);var ae=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ae=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ae=!1}break;case"excelworkbook":switch(o[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ae=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ae=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(b,o.index)){case"SheetHidden":N.Hidden=1;break;case"SheetVeryHidden":N.Hidden=2;break}else b=o.index+o[0].length;break;case"header":d["!margins"]||va(d["!margins"]={},"xlml"),isNaN(+Ce(o[0]).Margin)||(d["!margins"].header=+Ce(o[0]).Margin);break;case"footer":d["!margins"]||va(d["!margins"]={},"xlml"),isNaN(+Ce(o[0]).Margin)||(d["!margins"].footer=+Ce(o[0]).Margin);break;case"pagemargins":var Z=Ce(o[0]);d["!margins"]||va(d["!margins"]={},"xlml"),isNaN(+Z.Top)||(d["!margins"].top=+Z.Top),isNaN(+Z.Left)||(d["!margins"].left=+Z.Left),isNaN(+Z.Right)||(d["!margins"].right=+Z.Right),isNaN(+Z.Bottom)||(d["!margins"].bottom=+Z.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ae=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ae=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ae=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ae=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ae=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ae=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ae=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ae=!1}break;case"smarttags":break;default:ae=!1;break}if(ae||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?KT(H,ie,j,n.slice(b,o.index)):(j=o,b=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var R={};return!t.bookSheets&&!t.bookProps&&(R.Sheets=f),R.SheetNames=u,R.Workbook=B,R.SSF=pt(Oe),R.Props=G,R.Custprops=H,R}function To(e,r){switch(Tc(r=r||{}),r.type||"base64"){case"base64":return $s(Ht(e),r);case"binary":case"buffer":case"file":return $s(e,r);case"array":return $s(un(e),r)}}function e4(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=pv(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=xv(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var t4=[60,1084,2066,2165,2175];function r4(e,r,t,n,a){var i=n,s=[],o=t.slice(t.l,t.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),t.l+=i;for(var c=Sr(t,t.l),l=bo[c],f=0;l!=null&&t4.indexOf(c)>-1;)i=Sr(t,t.l+2),f=t.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=t.slice(f,t.l+4+i),s.push(o),t.l+=4+i,l=bo[c=Sr(t,t.l)];var u=Mr(s);dt(u,0);var d=0;u.lens=[];for(var h=0;h<s.length;++h)u.lens.push(d),d+=s[h].length;if(u.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+n;return r.f(u,u.length,a)}function lr(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=Oe[n])}catch(i){if(r.WTF)throw i}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||pn[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Aa(e.v):e.w=on(e.v):e.w=Kt(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(i){if(r.WTF)throw i}if(r.cellDates&&n&&e.t=="n"&&Wn(Oe[n]||String(n))){var a=Qr(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function di(e,r,t){return{v:e,ixfe:r,t}}function n4(e,r){var t={opts:{}},n={},a=r.dense?[]:{},i={},s={},o=null,c=[],l="",f={},u,d="",h,x,p,m,g={},w=[],v,k,A=[],F=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},z={},C=function(Fe){return Fe<8?nn[Fe]:Fe<64&&F[Fe-8]||nn[Fe]},G=function(Fe,He,ot){var De=He.XF.data;if(!(!De||!De.patternType||!ot||!ot.cellStyles)){He.s={},He.s.patternType=De.patternType;var Wt;(Wt=Ra(C(De.icvFore)))&&(He.s.fgColor={rgb:Wt}),(Wt=Ra(C(De.icvBack)))&&(He.s.bgColor={rgb:Wt})}},H=function(Fe,He,ot){if(!(Y>1)&&!(ot.sheetRows&&Fe.r>=ot.sheetRows)){if(ot.cellStyles&&He.XF&&He.XF.data&&G(Fe,He,ot),delete He.ixfe,delete He.XF,u=Fe,d=Re(Fe),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Fe.r<s.s.r&&(s.s.r=Fe.r),Fe.c<s.s.c&&(s.s.c=Fe.c),Fe.r+1>s.e.r&&(s.e.r=Fe.r+1),Fe.c+1>s.e.c&&(s.e.c=Fe.c+1),ot.cellFormula&&He.f){for(var De=0;De<w.length;++De)if(!(w[De][0].s.c>Fe.c||w[De][0].s.r>Fe.r)&&!(w[De][0].e.c<Fe.c||w[De][0].e.r<Fe.r)){He.F=Be(w[De][0]),(w[De][0].s.c!=Fe.c||w[De][0].s.r!=Fe.r)&&delete He.f,He.f&&(He.f=""+wt(w[De][1],s,Fe,P,b));break}}ot.dense?(a[Fe.r]||(a[Fe.r]=[]),a[Fe.r][Fe.c]=He):a[d]=He}},b={enc:!1,sbcch:0,snames:[],sharedf:g,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(b.password=r.password);var j,_=[],W=[],q=[],X=[],ue=!1,P=[];P.SheetNames=b.snames,P.sharedf=b.sharedf,P.arrayf=b.arrayf,P.names=[],P.XTI=[];var se=0,Y=0,T=0,K=[],B=[],N;b.codepage=1200,ar(1200);for(var ie=!1;e.l<e.length-1;){var pe=e.l,fe=e.read_shift(2);if(fe===0&&se===10)break;var le=e.l===e.length?0:e.read_shift(2),he=bo[fe];if(he&&he.f){if(r.bookSheets&&se===133&&fe!==133)break;if(se=fe,he.r===2||he.r==12){var be=e.read_shift(2);if(le-=2,!b.enc&&be!==fe&&((be&255)<<8|be>>8)!==fe)throw new Error("rt mismatch: "+be+"!="+fe);he.r==12&&(e.l+=10,le-=10)}var V={};if(fe===10?V=he.f(e,le,b):V=r4(fe,he,e,le,b),Y==0&&[9,521,1033,2057].indexOf(se)===-1)continue;switch(fe){case 34:t.opts.Date1904=E.WBProps.date1904=V;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(b.enc||(e.l=0),b.enc=V,!r.password)throw new Error("File is password-protected");if(V.valid==null)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:b.lastuser=V;break;case 66:var Ue=Number(V);switch(Ue){case 21010:Ue=1200;break;case 32768:Ue=1e4;break;case 32769:Ue=1252;break}ar(b.codepage=Ue),ie=!0;break;case 317:b.rrtabid=V;break;case 25:b.winlocked=V;break;case 439:t.opts.RefreshAll=V;break;case 12:t.opts.CalcCount=V;break;case 16:t.opts.CalcDelta=V;break;case 17:t.opts.CalcIter=V;break;case 13:t.opts.CalcMode=V;break;case 14:t.opts.CalcPrecision=V;break;case 95:t.opts.CalcSaveRecalc=V;break;case 15:b.CalcRefMode=V;break;case 2211:t.opts.FullCalc=V;break;case 129:V.fDialog&&(a["!type"]="dialog"),V.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),V.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:A.push(V);break;case 430:P.push([V]),P[P.length-1].XTI=[];break;case 35:case 547:P[P.length-1].push(V);break;case 24:case 536:N={Name:V.Name,Ref:wt(V.rgce,s,null,P,b)},V.itab>0&&(N.Sheet=V.itab-1),P.names.push(N),P[0]||(P[0]=[],P[0].XTI=[]),P[P.length-1].push(V),V.Name=="_xlnm._FilterDatabase"&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&V.rgce[0][0][0]=="PtgArea3d"&&(B[V.itab-1]={ref:Be(V.rgce[0][0][1][2])});break;case 22:b.ExternCount=V;break;case 23:P.length==0&&(P[0]=[],P[0].XTI=[]),P[P.length-1].XTI=P[P.length-1].XTI.concat(V),P.XTI=P.XTI.concat(V);break;case 2196:if(b.biff<8)break;N!=null&&(N.Comment=V[1]);break;case 18:a["!protect"]=V;break;case 19:V!==0&&b.WTF&&console.error("Password verifier: "+V);break;case 133:i[V.pos]=V,b.snames.push(V.name);break;case 10:{if(--Y)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=Be(s),r.sheetRows&&r.sheetRows<=s.e.r){var y=s.e.r;s.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Be(s),s.e.r=y}s.e.r++,s.e.c++}_.length>0&&(a["!merges"]=_),W.length>0&&(a["!objects"]=W),q.length>0&&(a["!cols"]=q),X.length>0&&(a["!rows"]=X),E.Sheets.push(z)}l===""?f=a:n[l]=a,a=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(b.biff===8&&(b.biff={9:2,521:3,1033:4}[fe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),b.biffguess=V.BIFFVer==0,V.BIFFVer==0&&V.dt==4096&&(b.biff=5,ie=!0,ar(b.codepage=28591)),b.biff==8&&V.BIFFVer==0&&V.dt==16&&(b.biff=2),Y++)break;if(a=r.dense?[]:{},b.biff<8&&!ie&&(ie=!0,ar(b.codepage=r.codepage||1252)),b.biff<5||V.BIFFVer==0&&V.dt==4096){l===""&&(l="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var ae={pos:e.l-le,name:l};i[ae.pos]=ae,b.snames.push(l)}else l=(i[pe]||{name:""}).name;V.dt==32&&(a["!type"]="chart"),V.dt==64&&(a["!type"]="macro"),_=[],W=[],b.arrayf=w=[],q=[],X=[],ue=!1,z={Hidden:(i[pe]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(r.dense?(a[V.r]||[])[V.c]:a[Re({c:V.c,r:V.r})])&&++V.c,v={ixfe:V.ixfe,XF:A[V.ixfe]||{},v:V.val,t:"n"},T>0&&(v.z=K[v.ixfe>>8&63]),lr(v,r,t.opts.Date1904),H({c:V.c,r:V.r},v,r);break;case 5:case 517:v={ixfe:V.ixfe,XF:A[V.ixfe],v:V.val,t:V.t},T>0&&(v.z=K[v.ixfe>>8&63]),lr(v,r,t.opts.Date1904),H({c:V.c,r:V.r},v,r);break;case 638:v={ixfe:V.ixfe,XF:A[V.ixfe],v:V.rknum,t:"n"},T>0&&(v.z=K[v.ixfe>>8&63]),lr(v,r,t.opts.Date1904),H({c:V.c,r:V.r},v,r);break;case 189:for(var Z=V.c;Z<=V.C;++Z){var R=V.rkrec[Z-V.c][0];v={ixfe:R,XF:A[R],v:V.rkrec[Z-V.c][1],t:"n"},T>0&&(v.z=K[v.ixfe>>8&63]),lr(v,r,t.opts.Date1904),H({c:Z,r:V.r},v,r)}break;case 6:case 518:case 1030:{if(V.val=="String"){o=V;break}if(v=di(V.val,V.cell.ixfe,V.tt),v.XF=A[v.ixfe],r.cellFormula){var O=V.formula;if(O&&O[0]&&O[0][0]&&O[0][0][0]=="PtgExp"){var J=O[0][0][1][0],ce=O[0][0][1][1],de=Re({r:J,c:ce});g[de]?v.f=""+wt(V.formula,s,V.cell,P,b):v.F=((r.dense?(a[J]||[])[ce]:a[de])||{}).F}else v.f=""+wt(V.formula,s,V.cell,P,b)}T>0&&(v.z=K[v.ixfe>>8&63]),lr(v,r,t.opts.Date1904),H(V.cell,v,r),o=V}break;case 7:case 519:if(o)o.val=V,v=di(V,o.cell.ixfe,"s"),v.XF=A[v.ixfe],r.cellFormula&&(v.f=""+wt(o.formula,s,o.cell,P,b)),T>0&&(v.z=K[v.ixfe>>8&63]),lr(v,r,t.opts.Date1904),H(o.cell,v,r),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(V);var Q=Re(V[0].s);if(h=r.dense?(a[V[0].s.r]||[])[V[0].s.c]:a[Q],r.cellFormula&&h){if(!o||!Q||!h)break;h.f=""+wt(V[1],s,V[0],P,b),h.F=Be(V[0])}}break;case 1212:{if(!r.cellFormula)break;if(d){if(!o)break;g[Re(o.cell)]=V[0],h=r.dense?(a[o.cell.r]||[])[o.cell.c]:a[Re(o.cell)],(h||{}).f=""+wt(V[0],s,u,P,b)}}break;case 253:v=di(c[V.isst].t,V.ixfe,"s"),c[V.isst].h&&(v.h=c[V.isst].h),v.XF=A[v.ixfe],T>0&&(v.z=K[v.ixfe>>8&63]),lr(v,r,t.opts.Date1904),H({c:V.c,r:V.r},v,r);break;case 513:r.sheetStubs&&(v={ixfe:V.ixfe,XF:A[V.ixfe],t:"z"},T>0&&(v.z=K[v.ixfe>>8&63]),lr(v,r,t.opts.Date1904),H({c:V.c,r:V.r},v,r));break;case 190:if(r.sheetStubs)for(var xe=V.c;xe<=V.C;++xe){var ve=V.ixfe[xe-V.c];v={ixfe:ve,XF:A[ve],t:"z"},T>0&&(v.z=K[v.ixfe>>8&63]),lr(v,r,t.opts.Date1904),H({c:xe,r:V.r},v,r)}break;case 214:case 516:case 4:v=di(V.val,V.ixfe,"s"),v.XF=A[v.ixfe],T>0&&(v.z=K[v.ixfe>>8&63]),lr(v,r,t.opts.Date1904),H({c:V.c,r:V.r},v,r);break;case 0:case 512:Y===1&&(s=V);break;case 252:c=V;break;case 1054:if(b.biff==4){K[T++]=V[1];for(var me=0;me<T+163&&Oe[me]!=V[1];++me);me>=163&&rn(V[1],T+163)}else rn(V[1],V[0]);break;case 30:{K[T++]=V;for(var Ee=0;Ee<T+163&&Oe[Ee]!=V;++Ee);Ee>=163&&rn(V,T+163)}break;case 229:_=_.concat(V);break;case 93:W[V.cmo[0]]=b.lastobj=V;break;case 438:b.lastobj.TxO=V;break;case 127:b.lastobj.ImData=V;break;case 440:for(m=V[0].s.r;m<=V[0].e.r;++m)for(p=V[0].s.c;p<=V[0].e.c;++p)h=r.dense?(a[m]||[])[p]:a[Re({c:p,r:m})],h&&(h.l=V[1]);break;case 2048:for(m=V[0].s.r;m<=V[0].e.r;++m)for(p=V[0].s.c;p<=V[0].e.c;++p)h=r.dense?(a[m]||[])[p]:a[Re({c:p,r:m})],h&&h.l&&(h.l.Tooltip=V[1]);break;case 28:{if(b.biff<=5&&b.biff>=2)break;h=r.dense?(a[V[0].r]||[])[V[0].c]:a[Re(V[0])];var $e=W[V[2]];h||(r.dense?(a[V[0].r]||(a[V[0].r]=[]),h=a[V[0].r][V[0].c]={t:"z"}):h=a[Re(V[0])]={t:"z"},s.e.r=Math.max(s.e.r,V[0].r),s.s.r=Math.min(s.s.r,V[0].r),s.e.c=Math.max(s.e.c,V[0].c),s.s.c=Math.min(s.s.c,V[0].c)),h.c||(h.c=[]),x={a:V[1],t:$e.TxO.t},h.c.push(x)}break;case 2173:by(A[V.ixfe],V.ext);break;case 125:{if(!b.cellStyles)break;for(;V.e>=V.s;)q[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(V.flags&1)},ue||(ue=!0,vc(V.w/256)),zn(q[V.e+1])}break;case 520:{var Ae={};V.level!=null&&(X[V.r]=Ae,Ae.level=V.level),V.hidden&&(X[V.r]=Ae,Ae.hidden=!0),V.hpt&&(X[V.r]=Ae,Ae.hpt=V.hpt,Ae.hpx=Ia(V.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||va(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[fe]]=V;break;case 161:a["!margins"]||va(a["!margins"]={}),a["!margins"].header=V.header,a["!margins"].footer=V.footer;break;case 574:V.RTL&&(E.Views[0].RTL=!0);break;case 146:F=V;break;case 2198:j=V;break;case 140:k=V;break;case 442:l?z.CodeName=V||z.name:E.WBProps.CodeName=V||"ThisWorkbook";break}}else he||console.error("Missing Info for XLS Record 0x"+fe.toString(16)),e.l+=le}return t.SheetNames=gr(i).sort(function(je,Fe){return Number(je)-Number(Fe)}).map(function(je){return i[je].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&f["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=f)):t.Preamble=f,t.Sheets&&B.forEach(function(je,Fe){t.Sheets[t.SheetNames[Fe]]["!autofilter"]=je}),t.Strings=c,t.SSF=pt(Oe),b.enc&&(t.Encryption=b.enc),j&&(t.Themes=j),t.Metadata={},k!==void 0&&(t.Metadata.Country=k),P.names.length>0&&(E.Names=P.names),t.Workbook=E,t}var yl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function a4(e,r,t){var n=Me.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=al(n,yv,yl.DSI);for(var i in a)r[i]=a[i]}catch(l){if(t.WTF)throw l}var s=Me.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=al(s,kv,yl.SI);for(var c in o)r[c]==null&&(r[c]=o[c])}catch(l){if(t.WTF)throw l}r.HeadingPairs&&r.TitlesOfParts&&(Su(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function fh(e,r){r||(r={}),Tc(r),Uf(),r.codepage&&rc(r.codepage);var t,n;if(e.FullPaths){if(Me.find(e,"/encryption"))throw new Error("File is password-protected");t=Me.find(e,"!CompObj"),n=Me.find(e,"/Workbook")||Me.find(e,"/Book")}else{switch(r.type){case"base64":e=nr(Ht(e));break;case"binary":e=nr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}dt(e,0),n={content:e}}var a,i;if(t&&e4(t),r.bookProps&&!r.bookSheets)a={};else{var s=Ne?"buffer":"array";if(n&&n.content)a=n4(n.content,r);else if((i=Me.find(e,"PerfectOffice_MAIN"))&&i.content)a=ga.to_workbook(i.content,(r.type=s,r));else if((i=Me.find(e,"NativeContent_MAIN"))&&i.content)a=ga.to_workbook(i.content,(r.type=s,r));else throw(i=Me.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&Me.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=Wy(e))}var o={};return e.FullPaths&&a4(e,o,r),a.Props=a.Custprops=o,r.bookFiles&&(a.cfb=e),a}var ns={0:{f:UE},1:{f:WE},2:{f:ZE},3:{f:XE},4:{f:GE},5:{f:JE},6:{f:tT},7:{f:KE},8:{f:sT},9:{f:iT},10:{f:nT},11:{f:aT},12:{f:VE},13:{f:QE},14:{f:YE},15:{f:jE},16:{f:ih},17:{f:rT},18:{f:qE},19:{f:dc},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:DT},40:{},42:{},43:{f:ny},44:{f:ry},45:{f:ay},46:{f:sy},47:{f:iy},48:{},49:{f:ov},50:{},51:{f:Sy},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Uu},62:{f:eT},63:{f:Oy},64:{f:xT},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Tt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:pT},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:HE},148:{f:zE,p:16},151:{f:lT},152:{},153:{f:IT},154:{},155:{},156:{f:RT},157:{},158:{},159:{T:1,f:kw},160:{T:-1},161:{T:1,f:dn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:oT},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Ay},336:{T:-1},337:{f:Cy,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:wo},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Bu},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:fT},427:{f:uT},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:dT},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:$E},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:cT},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:wo},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zy},633:{T:1},634:{T:-1},635:{T:1,f:Uy},636:{T:-1},637:{f:lv},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:yT},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:mT},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},bo={6:{f:Us},10:{f:Dr},12:{f:tt},13:{f:tt},14:{f:Ze},15:{f:Ze},16:{f:yt},17:{f:Ze},18:{f:Ze},19:{f:tt},20:{f:cl},21:{f:cl},23:{f:Bu},24:{f:fl},25:{f:Ze},26:{},27:{},28:{f:M2},29:{},34:{f:Ze},35:{f:ll},38:{f:yt},39:{f:yt},40:{f:yt},41:{f:yt},42:{f:Ze},43:{f:Ze},47:{f:$w},49:{f:_2},51:{f:tt},60:{},61:{f:x2},64:{f:Ze},65:{f:g2},66:{f:tt},77:{},80:{},81:{},82:{},85:{f:tt},89:{},90:{},91:{},92:{f:o2},93:{f:U2},94:{},95:{f:Ze},96:{},97:{},99:{f:Ze},125:{f:Uu},128:{f:C2},129:{f:c2},130:{f:tt},131:{f:Ze},132:{f:Ze},133:{f:l2},134:{},140:{f:G2},141:{f:tt},144:{},146:{f:X2},151:{},152:{},153:{},154:{},155:{},156:{f:tt},157:{},158:{},160:{f:Z2},161:{f:K2},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:T2},190:{f:b2},193:{f:Dr},197:{},198:{},199:{},200:{},201:{},202:{f:Ze},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:tt},220:{},221:{f:Ze},222:{},224:{f:S2},225:{f:s2},226:{f:Dr},227:{},229:{f:B2},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:f2},253:{f:v2},255:{f:u2},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Ou},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ze},353:{f:Dr},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:R2},431:{f:Ze},432:{},433:{},434:{},437:{},438:{f:H2},439:{f:Ze},440:{f:W2},441:{},442:{f:za},443:{},444:{f:tt},445:{},446:{},448:{f:Dr},449:{f:p2,r:2},450:{f:Dr},512:{f:sl},513:{f:J2},515:{f:F2},516:{f:w2},517:{f:ol},519:{f:Q2},520:{f:h2},523:{},545:{f:ul},549:{f:il},566:{},574:{f:m2},638:{f:E2},659:{},1048:{},1054:{f:y2},1084:{},1212:{f:P2},2048:{f:V2},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:fi},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Dr},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Y2,r:12},2173:{f:Ty,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ze,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:D2,r:12},2197:{},2198:{f:_y,r:12},2199:{},2200:{},2201:{},2202:{f:N2,r:12},2203:{f:Dr},2204:{},2205:{},2206:{},2207:{},2211:{f:d2},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:tt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:q2},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:j2},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:sl},1:{},2:{f:nw},3:{f:rw},4:{f:tw},5:{f:ol},7:{f:aw},8:{},9:{f:fi},11:{},22:{f:tt},30:{f:k2},31:{},32:{},33:{f:ul},36:{},37:{f:il},50:{f:iw},62:{},52:{},67:{},68:{f:tt},69:{},86:{},126:{},127:{f:ew},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:sw},223:{},234:{},354:{},421:{},518:{f:Us},521:{f:fi},536:{f:fl},547:{f:ll},561:{},579:{},1030:{f:Us},1033:{f:fi},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Qt(e,r,t,n){var a=r;if(!isNaN(a)){var i=(t||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&vu(t)&&e.push(t)}}function kl(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,c=F_(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,f=0,u=0,d=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(s=0;s<c.length;++s){var p=c[s].trim(),m=p.slice(0,3).toLowerCase();if(m=="<tr"){if(++l,t.sheetRows&&t.sheetRows<=l){--l;break}f=0;continue}if(!(m!="<td"&&m!="<th")){var g=p.split(/<\/t[dh]>/i);for(o=0;o<g.length;++o){var w=g[o].trim();if(w.match(/<t[dh]/i)){for(var v=w,k=0;v.charAt(0)=="<"&&(k=v.indexOf(">"))>-1;)v=v.slice(k+1);for(var A=0;A<x.length;++A){var F=x[A];F.s.c==f&&F.s.r<l&&l<=F.e.r&&(f=F.e.c+1,A=-1)}var E=Ce(w.slice(0,w.indexOf(">")));d=E.colspan?+E.colspan:1,((u=+E.rowspan)>1||d>1)&&x.push({s:{r:l,c:f},e:{r:l+(u||1)-1,c:f+d-1}});var z=E.t||E["data-t"]||"";if(!v.length){f+=d;continue}if(v=su(v),h.s.r>l&&(h.s.r=l),h.e.r<l&&(h.e.r=l),h.s.c>f&&(h.s.c=f),h.e.c<f&&(h.e.c=f),!v.length){f+=d;continue}var C={t:"s",v};t.raw||!v.trim().length||z=="s"||(v==="TRUE"?C={t:"b",v:!0}:v==="FALSE"?C={t:"b",v:!1}:isNaN(or(v))?isNaN(Un(v).getDate())||(C={t:"d",v:ft(v)},t.cellDates||(C={t:"n",v:It(C.v)}),C.z=t.dateNF||Oe[14]):C={t:"n",v:or(v)}),t.dense?(n[l]||(n[l]=[]),n[l][f]=C):n[Re({r:l,c:f})]=C,f+=d}}}}return n["!ref"]=Be(h),x.length&&(n["!merges"]=x),n}function i4(e,r,t,n){for(var a=e["!merges"]||[],i=[],s=r.s.c;s<=r.e.c;++s){for(var o=0,c=0,l=0;l<a.length;++l)if(!(a[l].s.r>t||a[l].s.c>s)&&!(a[l].e.r<t||a[l].e.c<s)){if(a[l].s.r<t||a[l].s.c<s){o=-1;break}o=a[l].e.r-a[l].s.r+1,c=a[l].e.c-a[l].s.c+1;break}if(!(o<0)){var f=Re({r:t,c:s}),u=n.dense?(e[t]||[])[s]:e[f],d=u&&u.v!=null&&(u.h||cc(u.w||(Ir(u),u.w)||""))||"",h={};o>1&&(h.rowspan=o),c>1&&(h.colspan=c),n.editable?d='<span contenteditable="true">'+d+"</span>":u&&(h["data-t"]=u&&u.t||"z",u.v!=null&&(h["data-v"]=u.v),u.z!=null&&(h["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+u.l.Target+'">'+d+"</a>")),h.id=(n.id||"sjs")+"-"+f,i.push(G_("td",d,h))}}var x="<tr>";return x+i.join("")+"</tr>"}var s4='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',o4="</body></html>";function c4(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Wr(kl(t[0],r),r);var n=Ac();return t.forEach(function(a,i){Sc(n,kl(a,r),"Sheet"+(i+1))}),n}function l4(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function f4(e,r){var t=r||{},n=t.header!=null?t.header:s4,a=t.footer!=null?t.footer:o4,i=[n],s=Vn(e["!ref"]);t.dense=Array.isArray(e),i.push(l4(e,s,t));for(var o=s.s.r;o<=s.e.r;++o)i.push(i4(e,s,o,t));return i.push("</table>"+a),i.join("")}function uh(e,r,t){var n=t||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Ft(n.origin):n.origin;a=s.r,i=s.c}var o=r.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var f=Vn(e["!ref"]);l.s.r=Math.min(l.s.r,f.s.r),l.s.c=Math.min(l.s.c,f.s.c),l.e.r=Math.max(l.e.r,f.e.r),l.e.c=Math.max(l.e.c,f.e.c),a==-1&&(l.e.r=a=f.e.r+1)}var u=[],d=0,h=e["!rows"]||(e["!rows"]=[]),x=0,p=0,m=0,g=0,w=0,v=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&p<c;++x){var k=o[x];if(El(k)){if(n.display)continue;h[p]={hidden:!0}}var A=k.children;for(m=g=0;m<A.length;++m){var F=A[m];if(!(n.display&&El(F))){var E=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):su(F.innerHTML),z=F.getAttribute("data-z")||F.getAttribute("z");for(d=0;d<u.length;++d){var C=u[d];C.s.c==g+i&&C.s.r<p+a&&p+a<=C.e.r&&(g=C.e.c+1-i,d=-1)}v=+F.getAttribute("colspan")||1,((w=+F.getAttribute("rowspan")||1)>1||v>1)&&u.push({s:{r:p+a,c:g+i},e:{r:p+a+(w||1)-1,c:g+i+(v||1)-1}});var G={t:"s",v:E},H=F.getAttribute("data-t")||F.getAttribute("t")||"";E!=null&&(E.length==0?G.t=H||"z":n.raw||E.trim().length==0||H=="s"||(E==="TRUE"?G={t:"b",v:!0}:E==="FALSE"?G={t:"b",v:!1}:isNaN(or(E))?isNaN(Un(E).getDate())||(G={t:"d",v:ft(E)},n.cellDates||(G={t:"n",v:It(G.v)}),G.z=n.dateNF||Oe[14]):G={t:"n",v:or(E)})),G.z===void 0&&z!=null&&(G.z=z);var b="",j=F.getElementsByTagName("A");if(j&&j.length)for(var _=0;_<j.length&&!(j[_].hasAttribute("href")&&(b=j[_].getAttribute("href"),b.charAt(0)!="#"));++_);b&&b.charAt(0)!="#"&&(G.l={Target:b}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][g+i]=G):e[Re({c:g+i,r:p+a})]=G,l.e.c<g+i&&(l.e.c=g+i),g+=v}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),l.e.r=Math.max(l.e.r,p-1+a),e["!ref"]=Be(l),p>=c&&(e["!fullref"]=Be((l.e.r=o.length-x+p-1+a,l))),e}function hh(e,r){var t=r||{},n=t.dense?[]:{};return uh(n,e,r)}function u4(e,r){return Wr(hh(e,r),r)}function El(e){var r="",t=h4(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function h4(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function d4(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=ze(r.replace(/<[^>]*>/g,""));return[t]}var Tl={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function dh(e,r){var t=r||{},n=lc(e),a=[],i,s,o={name:""},c="",l=0,f,u,d={},h=[],x=t.dense?[]:{},p,m,g={value:""},w="",v=0,k=[],A=-1,F=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},z=0,C={},G=[],H={},b=0,j=0,_=[],W=1,q=1,X=[],ue={Names:[]},P={},se=["",""],Y=[],T={},K="",B=0,N=!1,ie=!1,pe=0;for(Ca.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Ca.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?x["!ref"]=Be(E):x["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=E.e.r&&(x["!fullref"]=x["!ref"],E.e.r=t.sheetRows-1,x["!ref"]=Be(E)),G.length&&(x["!merges"]=G),_.length&&(x["!rows"]=_),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),h.push(f.name),d[f.name]=x,ie=!1):p[0].charAt(p[0].length-2)!=="/"&&(f=Ce(p[0],!1),A=F=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,x=t.dense?[]:{},G=[],_=[],ie=!0);break;case"table-row-group":p[1]==="/"?--z:++z;break;case"table-row":case"行":if(p[1]==="/"){A+=W,W=1;break}if(u=Ce(p[0],!1),u.行号?A=u.行号-1:A==-1&&(A=0),W=+u["number-rows-repeated"]||1,W<10)for(pe=0;pe<W;++pe)z>0&&(_[A+pe]={level:z});F=-1;break;case"covered-table-cell":p[1]!=="/"&&++F,t.sheetStubs&&(t.dense?(x[A]||(x[A]=[]),x[A][F]={t:"z"}):x[Re({r:A,c:F})]={t:"z"}),w="",k=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++F,g=Ce(p[0],!1),q=parseInt(g["number-columns-repeated"]||"1",10),m={t:"z",v:null},g.formula&&t.cellFormula!=!1&&(m.f=_l(ze(g.formula))),(g.数据类型||g["value-type"])=="string"&&(m.t="s",m.v=ze(g["string-value"]||""),t.dense?(x[A]||(x[A]=[]),x[A][F]=m):x[Re({r:A,c:F})]=m),F+=q-1;else if(p[1]!=="/"){++F,w="",v=0,k=[],q=1;var fe=W?A+W-1:A;if(F>E.e.c&&(E.e.c=F),F<E.s.c&&(E.s.c=F),A<E.s.r&&(E.s.r=A),fe>E.e.r&&(E.e.r=fe),g=Ce(p[0],!1),Y=[],T={},m={t:g.数据类型||g["value-type"],v:null},t.cellFormula)if(g.formula&&(g.formula=ze(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(b=parseInt(g["number-matrix-rows-spanned"],10)||0,j=parseInt(g["number-matrix-columns-spanned"],10)||0,H={s:{r:A,c:F},e:{r:A+b-1,c:F+j-1}},m.F=Be(H),X.push([H,m.F])),g.formula)m.f=_l(g.formula);else for(pe=0;pe<X.length;++pe)A>=X[pe][0].s.r&&A<=X[pe][0].e.r&&F>=X[pe][0].s.c&&F<=X[pe][0].e.c&&(m.F=X[pe][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(b=parseInt(g["number-rows-spanned"],10)||0,j=parseInt(g["number-columns-spanned"],10)||0,H={s:{r:A,c:F},e:{r:A+b-1,c:F+j-1}},G.push(H)),g["number-columns-repeated"]&&(q=parseInt(g["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=Ge(g["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(g.value);break;case"percentage":m.t="n",m.v=parseFloat(g.value);break;case"currency":m.t="n",m.v=parseFloat(g.value);break;case"date":m.t="d",m.v=ft(g["date-value"]),t.cellDates||(m.t="n",m.v=It(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=A_(g["time-value"])/86400,t.cellDates&&(m.t="d",m.v=us(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(g.数据数值);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",g["string-value"]!=null&&(w=ze(g["string-value"]),k=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(N=!1,m.t==="s"&&(m.v=w||"",k.length&&(m.R=k),N=v==0),P.Target&&(m.l=P),Y.length>0&&(m.c=Y,Y=[]),w&&t.cellText!==!1&&(m.w=w),N&&(m.t="z",delete m.v),(!N||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=A))for(var le=0;le<W;++le){if(q=parseInt(g["number-columns-repeated"]||"1",10),t.dense)for(x[A+le]||(x[A+le]=[]),x[A+le][F]=le==0?m:pt(m);--q>0;)x[A+le][F+q]=pt(m);else for(x[Re({r:A+le,c:F})]=m;--q>0;)x[Re({r:A+le,c:F+q})]=pt(m);E.e.c<=F&&(E.e.c=F)}q=parseInt(g["number-columns-repeated"]||"1",10),F+=q-1,q=0,m={},w="",k=[]}P={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i;T.t=w,k.length&&(T.R=k),T.a=K,Y.push(T)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);K="",B=0,w="",v=0,k=[];break;case"creator":p[1]==="/"?K=n.slice(B,p.index):B=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);w="",v=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(C[o.name]=c,(i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(c="",o=Ce(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Ce(p[0],!1),c+=Tl[p[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Ce(p[0],!1),c+=Tl[p[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(l,p.index);break}else l=p.index+p[0].length;break;case"named-range":s=Ce(p[0],!1),se=zs(s["cell-range-address"]);var he={Name:s.name,Ref:se[0]+"!"+se[1]};ie&&(he.Sheet=h.length),ue.Names.push(he);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!g||!g["string-value"])){var be=d4(n.slice(v,p.index));w=(w.length>0?w+`
`:"")+be[0]}else Ce(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{se=zs(Ce(p[0])["target-range-address"]),d[se[0]]["!autofilter"]={ref:se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(P=Ce(p[0],!1),!P.href)break;P.Target=ze(P.href),delete P.href,P.Target.charAt(0)=="#"&&P.Target.indexOf(".")>-1?(se=zs(P.Target.slice(1)),P.Target="#"+se[0]+"!"+se[1]):P.Target.match(/^\.\.[\\\/]/)&&(P.Target=P.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(p)}}var V={Sheets:d,SheetNames:h,Workbook:ue};return t.bookSheets&&delete V.Sheets,V}function bl(e,r){r=r||{},jt(e,"META-INF/manifest.xml")&&Fv(et(e,"META-INF/manifest.xml"),r);var t=zt(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=dh(Ve(t),r);return jt(e,"meta.xml")&&(n.Props=Au(et(e,"meta.xml"))),n}function Al(e,r){return dh(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function kc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ao(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ve(un(e))}function So(e){var r=e.reduce(function(a,i){return a+i.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(a){t.set(a,n),n+=a.length}),t}function Sl(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function p4(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,a=r+13;a>=r;--a)n=n*256+e[a];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function Oa(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function st(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function kt(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],a=Oa(e,t),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var c=t[0];e[t[0]++]>=128;);o=e.slice(c,t[0])}break;case 5:s=4,o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 1:s=8,o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 2:s=Oa(e,t),o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var l={data:o,type:i};r[a]==null?r[a]=[l]:r[a].push(l)}return r}function Ec(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function x4(e){for(var r,t=[],n=[0];n[0]<e.length;){var a=Oa(e,n),i=kt(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:st(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=kt(o.data),l=st(c[3][0].data);s.messages.push({meta:c,data:e.slice(n[0],n[0]+l)}),n[0]+=l}),(r=i[3])!=null&&r[0]&&(s.merge=st(i[3][0].data)>>>0>0),t.push(s)}return t}function m4(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=Oa(r,t),a=[];t[0]<r.length;){var i=r[t[0]]&3;if(i==0){var s=r[t[0]++]>>2;if(s<60)++s;else{var o=s-59;s=r[t[0]],o>1&&(s|=r[t[0]+1]<<8),o>2&&(s|=r[t[0]+2]<<16),o>3&&(s|=r[t[0]+3]<<24),s>>>=0,s++,t[0]+=o}a.push(r.slice(t[0],t[0]+s)),t[0]+=s;continue}else{var c=0,l=0;if(i==1?(l=(r[t[0]]>>2&7)+4,c=(r[t[0]++]&224)<<3,c|=r[t[0]++]):(l=(r[t[0]++]>>2)+1,i==2?(c=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(c=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),a=[So(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(a.push(a[0].slice(-c)),l-=c;l>=a[a.length-1].length;)a.push(a[a.length-1]),l-=a[a.length-1].length;a.push(a[0].slice(-c,-c+l))}}var f=So(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function g4(e){for(var r=[],t=0;t<e.length;){var n=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(m4(n,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return So(r)}function _4(e,r,t,n){var a=kc(e),i=a.getUint32(4,!0),s=(n>1?12:8)+Sl(i&(n>1?3470:398))*4,o=-1,c=-1,l=NaN,f=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=Sl(i&(n>1?12288:4096))*4,i&16&&(c=a.getUint32(s,!0),s+=4),i&32&&(l=a.getFloat64(s,!0),s+=8),i&64&&(f.setTime(f.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var u;switch(e[2]){case 0:break;case 2:u={t:"n",v:l};break;case 3:u={t:"s",v:r[c]};break;case 5:u={t:"d",v:f};break;case 6:u={t:"b",v:l>0};break;case 7:u={t:"n",v:l/86400};break;case 8:u={t:"e",v:0};break;case 9:if(o>-1)u={t:"s",v:t[o]};else if(c>-1)u={t:"s",v:r[c]};else if(!isNaN(l))u={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return u}function v4(e,r,t){var n=kc(e),a=n.getUint32(8,!0),i=12,s=-1,o=-1,c=NaN,l=NaN,f=new Date(2001,0,1);a&1&&(c=p4(e,i),i+=16),a&2&&(l=n.getFloat64(i,!0),i+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var u;switch(e[1]){case 0:break;case 2:u={t:"n",v:c};break;case 3:u={t:"s",v:r[o]};break;case 5:u={t:"d",v:f};break;case 6:u={t:"b",v:l>0};break;case 7:u={t:"n",v:l/86400};break;case 8:u={t:"e",v:0};break;case 9:if(s>-1)u={t:"s",v:t[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:u={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return u}function w4(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return _4(e,r,t,e[0]);case 5:return v4(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function zr(e){var r=kt(e);return Oa(r[1][0].data)}function Cl(e,r){var t=kt(r.data),n=st(t[1][0].data),a=t[3],i=[];return(a||[]).forEach(function(s){var o=kt(s.data),c=st(o[1][0].data)>>>0;switch(n){case 1:i[c]=Ao(o[3][0].data);break;case 8:{var l=e[zr(o[9][0].data)][0],f=kt(l.data),u=e[zr(f[1][0].data)][0],d=st(u.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var h=kt(u.data);i[c]=h[3].map(function(x){return Ao(x.data)}).join("")}break}}),i}function y4(e,r){var t,n,a,i,s,o,c,l,f,u,d,h,x,p,m=kt(e),g=st(m[1][0].data)>>>0,w=st(m[2][0].data)>>>0,v=((n=(t=m[8])==null?void 0:t[0])==null?void 0:n.data)&&st(m[8][0].data)>0||!1,k,A;if((i=(a=m[7])==null?void 0:a[0])!=null&&i.data&&r!=0)k=(o=(s=m[7])==null?void 0:s[0])==null?void 0:o.data,A=(l=(c=m[6])==null?void 0:c[0])==null?void 0:l.data;else if((u=(f=m[4])==null?void 0:f[0])!=null&&u.data&&r!=1)k=(h=(d=m[4])==null?void 0:d[0])==null?void 0:h.data,A=(p=(x=m[3])==null?void 0:x[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var F=v?4:1,E=kc(k),z=[],C=0;C<k.length/2;++C){var G=E.getUint16(C*2,!0);G<65535&&z.push([C,G])}if(z.length!=w)throw"Expected ".concat(w," cells, found ").concat(z.length);var H=[];for(C=0;C<z.length-1;++C)H[z[C][0]]=A.subarray(z[C][1]*F,z[C+1][1]*F);return z.length>=1&&(H[z[z.length-1][0]]=A.subarray(z[z.length-1][1]*F)),{R:g,cells:H}}function k4(e,r){var t,n=kt(r.data),a=(t=n==null?void 0:n[7])!=null&&t[0]?st(n[7][0].data)>>>0>0?1:0:-1,i=Ec(n[5],function(s){return y4(s,a)});return{nrows:st(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(c,l){if(s[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));s[o.R][l]=c}),s},[])}}function E4(e,r,t){var n,a=kt(r.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(st(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(st(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=Be(i);var s=kt(a[4][0].data),o=Cl(e,e[zr(s[4][0].data)][0]),c=(n=s[17])!=null&&n[0]?Cl(e,e[zr(s[17][0].data)][0]):[],l=kt(s[3][0].data),f=0;l[1].forEach(function(u){var d=kt(u.data),h=e[zr(d[2][0].data)][0],x=st(h.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var p=k4(e,h);p.data.forEach(function(m,g){m.forEach(function(w,v){var k=Re({r:f+g,c:v}),A=w4(w,o,c);A&&(t[k]=A)})}),f+=p.nrows})}function T4(e,r){var t=kt(r.data),n={"!ref":"A1"},a=e[zr(t[2][0].data)],i=st(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return E4(e,a[0],n),n}function b4(e,r){var t,n=kt(r.data),a={name:(t=n[1])!=null&&t[0]?Ao(n[1][0].data):"",sheets:[]},i=Ec(n[2],zr);return i.forEach(function(s){e[s].forEach(function(o){var c=st(o.meta[1][0].data);c==6e3&&a.sheets.push(T4(e,o))})}),a}function A4(e,r){var t=Ac(),n=kt(r.data),a=Ec(n[1],zr);if(a.forEach(function(i){e[i].forEach(function(s){var o=st(s.meta[1][0].data);if(o==2){var c=b4(e,s);c.sheets.forEach(function(l,f){Sc(t,l,f==0?c.name:c.name+"_"+f,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Hs(e){var r,t,n,a,i={},s=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=g4(c.content)}catch(u){return console.log("?? "+c.content.length+" "+(u.message||u))}var f;try{f=x4(l)}catch(u){return console.log("## "+(u.message||u))}f.forEach(function(u){i[u.id]=u.messages,s.push(u.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(t=(r=i==null?void 0:i[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&st(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(c){i[c].forEach(function(l){var f=st(l.meta[1][0].data)>>>0;if(f==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return A4(i,o)}function S4(e){return function(t){for(var n=0;n!=e.length;++n){var a=e[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function Tc(e){S4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function C4(e){return bn.WS.indexOf(e)>-1?"sheet":e==bn.CS?"chart":e==bn.DS?"dialog":e==bn.MS?"macro":e&&e.length?e:"sheet"}function F4(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,C4(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function R4(e,r,t,n,a,i,s,o,c,l,f,u){try{i[n]=xa(zt(e,t,!0),r);var d=et(e,r),h;switch(o){case"sheet":h=LT(d,r,a,c,i[n],l,f,u);break;case"chart":if(h=MT(d,r,a,c,i[n],l,f,u),!h||!h["!drawel"])break;var x=aa(h["!drawel"].Target,r),p=yo(x),m=Ny(zt(e,x,!0),xa(zt(e,p,!0),x)),g=aa(m,x),w=yo(g);h=vT(zt(e,g,!0),g,c,xa(zt(e,w,!0),g),l,h);break;case"macro":h=BT(d,r,a,c,i[n],l,f,u);break;case"dialog":h=UT(d,r,a,c,i[n],l,f,u);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=h;var v=[];i&&i[n]&&gr(i[n]).forEach(function(k){var A="";if(i[n][k].Type==bn.CMNT){A=aa(i[n][k].Target,r);var F=WT(et(e,A,!0),A,c);if(!F||!F.length)return;dl(h,F,!1)}i[n][k].Type==bn.TCMNT&&(A=aa(i[n][k].Target,r),v=v.concat(My(et(e,A,!0),c)))}),v&&v.length&&dl(h,v,!0,c.people||[])}catch(k){if(c.WTF)throw k}}function Vt(e){return e.charAt(0)=="/"?e.slice(1):e}function I4(e,r){if(Jf(),r=r||{},Tc(r),jt(e,"META-INF/manifest.xml")||jt(e,"objectdata.xml"))return bl(e,r);if(jt(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Hs<"u"){if(e.FileIndex)return Hs(e);var t=Me.utils.cfb_new();return z0(e).forEach(function(_){O_(t,_,I_(e,_))}),Hs(t)}throw new Error("Unsupported NUMBERS file")}if(!jt(e,"[Content_Types].xml"))throw jt(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):jt(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=z0(e),a=Sv(zt(e,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",et(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!et(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},l={};if(!r.bookSheets&&!r.bookProps){if(_a=[],a.sst)try{_a=HT(et(e,Vt(a.sst)),a.sst,r)}catch(_){if(r.WTF)throw _}r.cellStyles&&a.themes.length&&(c=$T(zt(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(l=zT(et(e,Vt(a.style)),a.style,c,r))}a.links.map(function(_){try{var W=xa(zt(e,yo(Vt(_))),_);return GT(et(e,Vt(_)),W,_,r)}catch{}});var f=NT(et(e,Vt(a.workbooks[0])),a.workbooks[0],r),u={},d="";a.coreprops.length&&(d=et(e,Vt(a.coreprops[0]),!0),d&&(u=Au(d)),a.extprops.length!==0&&(d=et(e,Vt(a.extprops[0]),!0),d&&Ov(d,u,r)));var h={};(!r.bookSheets||r.bookProps)&&a.custprops.length!==0&&(d=zt(e,Vt(a.custprops[0]),!0),d&&(h=Pv(d,r)));var x={};if((r.bookSheets||r.bookProps)&&(f.Sheets?s=f.Sheets.map(function(W){return W.name}):u.Worksheets&&u.SheetNames.length>0&&(s=u.SheetNames),r.bookProps&&(x.Props=u,x.Custprops=h),r.bookSheets&&typeof s<"u"&&(x.SheetNames=s),r.bookSheets?x.SheetNames:r.bookProps))return x;s={};var p={};r.bookDeps&&a.calcchain&&(p=VT(et(e,Vt(a.calcchain)),a.calcchain));var m=0,g={},w,v;{var k=f.Sheets;u.Worksheets=k.length,u.SheetNames=[];for(var A=0;A!=k.length;++A)u.SheetNames[A]=k[A].name}var F=i?"bin":"xml",E=a.workbooks[0].lastIndexOf("/"),z=(a.workbooks[0].slice(0,E+1)+"_rels/"+a.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");jt(e,z)||(z="xl/_rels/workbook."+F+".rels");var C=xa(zt(e,z,!0),z.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=jT(et(e,Vt(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=By(et(e,Vt(a.people[0])),r)),C&&(C=F4(C,f.Sheets));var G=et(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=u.Worksheets;++m){var H="sheet";if(C&&C[m]?(w="xl/"+C[m][1].replace(/[\/]?xl\//,""),jt(e,w)||(w=C[m][1]),jt(e,w)||(w=z.replace(/_rels\/.*$/,"")+C[m][1]),H=C[m][2]):(w="xl/worksheets/sheet"+(m+1-G)+"."+F,w=w.replace(/sheet0\./,"sheet.")),v=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(m!=r.sheets)continue e;break;case"string":if(u.SheetNames[m].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var b=!1,j=0;j!=r.sheets.length;++j)typeof r.sheets[j]=="number"&&r.sheets[j]==m&&(b=1),typeof r.sheets[j]=="string"&&r.sheets[j].toLowerCase()==u.SheetNames[m].toLowerCase()&&(b=1);if(!b)continue e}}R4(e,w,v,u.SheetNames[m],m,g,s,H,r,f,c,l)}return x={Directory:a,Workbook:f,Props:u,Custprops:h,Deps:p,Sheets:s,SheetNames:u.SheetNames,Strings:_a,Styles:l,Themes:c,SSF:pt(Oe)},r&&r.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(_,W){_=_.replace(/^Root Entry[\/]/,""),x.keys.push(_),x.files[_]=e.FileIndex[W]}))),r&&r.bookVBA&&(a.vba.length>0?x.vbaraw=et(e,Vt(a.vba[0]),!0):a.defaults&&a.defaults.bin===Hy&&(x.vbaraw=et(e,"xl/vbaProject.bin",!0))),x}function O4(e,r){var t=r||{},n="Workbook",a=Me.find(e,n);try{if(n="/!DataSpaces/Version",a=Me.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Tw(a.content),n="/!DataSpaces/DataSpaceMap",a=Me.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Aw(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Me.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Sw(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Me.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Fw(a.content)}catch{}if(n="/EncryptionInfo",a=Me.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Rw(a.content);if(n="/EncryptedPackage",a=Me.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function bc(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Ht(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function D4(e,r){return Me.find(e,"EncryptedPackage")?O4(e,r):fh(e,r)}function P4(e,r){var t,n=e,a=r||{};return a.type||(a.type=Ne&&Buffer.isBuffer(e)?"buffer":"base64"),t=nu(n,a),I4(t,a)}function ph(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return To(e.slice(t),r);default:break e}return Fa.to_workbook(e,r)}function N4(e,r){var t="",n=bc(e,r);switch(r.type){case"base64":t=Ht(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=cn(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=Ve(t)),r.type="binary",ph(t,r)}function L4(e,r){var t=e;return r.type=="base64"&&(t=Ht(t)),t=_o.utils.decode(1200,t.slice(2),"str"),r.type="binary",ph(t,r)}function M4(e){return e.match(/[^\x00-\x7F]/)?ia(e):e}function Ws(e,r,t,n){return n?(t.type="string",Fa.to_workbook(e,t)):Fa.to_workbook(r,t)}function Co(e,r){Uf();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Co(new Uint8Array(e),(t=pt(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Rn={},t.dateNF&&(Rn.dateNF=t.dateNF),t.type||(t.type=Ne&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Ne?"buffer":"binary",n=T_(e),typeof Uint8Array<"u"&&!Ne&&(t.type="array")),t.type=="string"&&(i=!0,t.type="binary",t.codepage=65001,n=M4(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return t=pt(t),t.type="array",Co(nc(n),t)}switch((a=bc(n,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return D4(Me.read(n,t),t);break;case 9:if(a[1]<=8)return fh(n,t);break;case 60:return To(n,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return uw(n,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return lw.to_workbook(n,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?P4(n,t):Ws(e,n,t,i);case 239:return a[3]===60?To(n,t):Ws(e,n,t,i);case 255:if(a[1]===254)return L4(n,t);if(a[1]===0&&a[2]===2&&a[3]===0)return ga.to_workbook(n,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return ga.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return hl.to_workbook(n,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Hw.to_workbook(n,t);break;case 10:case 13:case 32:return N4(n,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return ow.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?hl.to_workbook(n,t):Ws(e,n,t,i)}function B4(e,r,t,n,a,i,s,o){var c=xt(t),l=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,d=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:t,enumerable:!1})}catch{d.__rowNum__=t}else d.__rowNum__=t;if(!s||e[t])for(var h=r.s.c;h<=r.e.c;++h){var x=s?e[t][h]:e[n[h]+c];if(x===void 0||x.t===void 0){if(l===void 0)continue;i[h]!=null&&(d[i[h]]=l);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[h]!=null){if(p==null)if(x.t=="e"&&p===null)d[i[h]]=null;else if(l!==void 0)d[i[h]]=l;else if(f&&p===null)d[i[h]]=null;else continue;else d[i[h]]=f&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?p:Ir(x,p,o);p!=null&&(u=!1)}}return{row:d,isempty:u}}function Fo(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=r||{},f=l.range!=null?l.range:e["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof f){case"string":c=Je(f);break;case"number":c=Je(e["!ref"]),c.s.r=f;break;default:c=f}n>0&&(a=0);var u=xt(c.s.r),d=[],h=[],x=0,p=0,m=Array.isArray(e),g=c.s.r,w=0,v={};m&&!e[g]&&(e[g]=[]);var k=l.skipHidden&&e["!cols"]||[],A=l.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(k[w]||{}).hidden)switch(d[w]=it(w),t=m?e[g][w]:e[d[w]+u],n){case 1:i[w]=w-c.s.c;break;case 2:i[w]=d[w];break;case 3:i[w]=l.header[w-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=s=Ir(t,null,l),p=v[s]||0,!p)v[s]=1;else{do o=s+"_"+p++;while(v[o]);v[s]=p,v[o]=1}i[w]=o}for(g=c.s.r+a;g<=c.e.r;++g)if(!(A[g]||{}).hidden){var F=B4(e,c,g,d,n,i,m,l);(F.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(h[x++]=F.row)}return h.length=x,h}var Fl=/"/g;function U4(e,r,t,n,a,i,s,o){for(var c=!0,l=[],f="",u=xt(t),d=r.s.c;d<=r.e.c;++d)if(n[d]){var h=o.dense?(e[t]||[])[d]:e[n[d]+u];if(h==null)f="";else if(h.v!=null){c=!1,f=""+(o.rawNumbers&&h.t=="n"?h.v:Ir(h,null,o));for(var x=0,p=0;x!==f.length;++x)if((p=f.charCodeAt(x))===a||p===i||p===34||o.forceQuotes){f='"'+f.replace(Fl,'""')+'"';break}f=="ID"&&(f='"ID"')}else h.f!=null&&!h.F?(c=!1,f="="+h.f,f.indexOf(",")>=0&&(f='"'+f.replace(Fl,'""')+'"')):f="";l.push(f)}return o.blankrows===!1&&c?null:l.join(s)}function xh(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var a=Je(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((i=="|"?"\\|":i)+"+$"),f="",u=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(d[x]||{}).hidden||(u[x]=it(x));for(var p=0,m=a.s.r;m<=a.e.r;++m)(h[m]||{}).hidden||(f=U4(e,a,m,u,s,c,i,n),f!=null&&(n.strip&&(f=f.replace(l,"")),(f||n.blankrows!==!1)&&t.push((p++?o:"")+f)));return delete n.dense,t.join("")}function z4(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=xh(e,r);return t}function $4(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var a=Je(e["!ref"]),i="",s=[],o,c=[],l=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=it(o);for(var f=a.s.r;f<=a.e.r;++f)for(i=xt(f),o=a.s.c;o<=a.e.c;++o)if(r=s[o]+i,t=l?(e[f]||[])[o]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}c[c.length]=r+"="+n}return c}function mh(e,r,t){var n=t||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Ft(n.origin):n.origin;s=c.r,o=c.c}var l,f={s:{c:0,r:0},e:{c:o,r:s+r.length-1+a}};if(i["!ref"]){var u=Je(i["!ref"]);f.e.c=Math.max(f.e.c,u.e.c),f.e.r=Math.max(f.e.r,u.e.r),s==-1&&(s=u.e.r+1,f.e.r=s+r.length-1+a)}else s==-1&&(s=0,f.e.r=r.length-1+a);var d=n.header||[],h=0;r.forEach(function(p,m){gr(p).forEach(function(g){(h=d.indexOf(g))==-1&&(d[h=d.length]=g);var w=p[g],v="z",k="",A=Re({c:o+h,r:s+m+a});l=Da(i,A),w&&typeof w=="object"&&!(w instanceof Date)?i[A]=w:(typeof w=="number"?v="n":typeof w=="boolean"?v="b":typeof w=="string"?v="s":w instanceof Date?(v="d",n.cellDates||(v="n",w=It(w)),k=n.dateNF||Oe[14]):w===null&&n.nullError&&(v="e",w=0),l?(l.t=v,l.v=w,delete l.w,delete l.R,k&&(l.z=k)):i[A]=l={t:v,v:w},k&&(l.z=k))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var x=xt(s);if(a)for(h=0;h<d.length;++h)i[it(h+o)+x]={t:"s",v:d[h]};return i["!ref"]=Be(f),i}function H4(e,r){return mh(null,e,r)}function Da(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=Ft(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Da(e,Re(r)):Da(e,Re({r,c:t||0}))}function W4(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Ac(){return{SheetNames:[],Sheets:{}}}function Sc(e,r,t,n){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var i=t.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=s+a)!=-1;++a);}if(ST(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function V4(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=W4(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function G4(e,r){return e.z=r,e}function gh(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function j4(e,r,t){return gh(e,"#"+r,t)}function X4(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function Y4(e,r,t,n){for(var a=typeof r!="string"?r:Je(r),i=typeof r=="string"?r:Be(r),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var c=Da(e,s,o);c.t="n",c.F=i,delete c.v,s==a.s.r&&o==a.s.c&&(c.f=t,n&&(c.D=!0))}return e}var K4={encode_col:it,encode_row:xt,encode_cell:Re,encode_range:Be,decode_col:hc,decode_row:uc,split_cell:sv,decode_cell:Ft,decode_range:Vn,format_cell:Ir,sheet_add_aoa:yu,sheet_add_json:mh,sheet_add_dom:uh,aoa_to_sheet:Gn,json_to_sheet:H4,table_to_sheet:hh,table_to_book:u4,sheet_to_csv:xh,sheet_to_txt:z4,sheet_to_json:Fo,sheet_to_html:f4,sheet_to_formulae:$4,sheet_to_row_object_array:Fo,sheet_get_cell:Da,book_new:Ac,book_append_sheet:Sc,book_set_sheet_visibility:V4,cell_set_number_format:G4,cell_set_hyperlink:gh,cell_set_internal_link:j4,cell_add_comment:X4,sheet_set_array_formula:Y4,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class q4 extends HTMLElement{constructor(){super();At(this,"chartContainer");At(this,"tooltipContainer");const t=this.attachShadow({mode:"open"});t.innerHTML=`
      <style>
        #container { display: flex; 
          background:var(--container-bg);
          color: var(--color-text);
          padding: 5px;
        }
        #settings { 
          width: 300px; 
          padding-right: 10px; 
          margin-top: 10px;
          margin-left: 10px;
          margin-bottom: 10px;
          margin-right: 10px;
        }
        #tooltipContainer {
          flex: 1;
          border: 1px solid #ddd;
          padding: 10px;
          min-height: 100px;
          margin-left: 10px;
          margin-right: 10px;
          margin-top: 10px;
          border-radius: 10px;
          background: #353d46;
          color: white;
          overflow-y: auto;
          opacity: 1;
          transition: opacity 0.2s ease-in-out;
        }
        #chart { height: 600px; border: 1px solid #ccc; margin-top: 10px; 
          background: #353d46;
          margin-bottom: 20px;
          position: relative;
          border-radius: 20px;
          margin-left: 10px;
          margin-right: 10px;

        }
        #chart svg { width: 100%; height: 100%; }
      </style>

      <div id="container">
        <div id="settings">
          <input type="file" id="fileUpload" accept=".xlsx, .csv" />
          <button id="retryUpload">🔄 Retry</button>

          <div id="column-selectors" style="display:none;">
            <label>Parent Column:</label>
            <select id="parentSelect"></select>
            <label>Child Column:</label>
            <select id="childSelect"></select>
            <button id="renderButton">Render Tree</button>

            <div>
              <label>Tooltip Fields (Ctrl+Click for multiple):</label>
              <select id="tooltipFields" multiple style="height:100px;width:200px;"></select>
            </div>
          </div>
        </div>

        <div id="tooltipContainer">Hover a node to see details here.</div>
      </div>

      <div id="chart"></div>
    `}connectedCallback(){const t=this.shadowRoot,n=t.getElementById("fileUpload"),a=t.getElementById("retryUpload"),i=t.getElementById("parentSelect"),s=t.getElementById("childSelect"),o=t.getElementById("renderButton"),c=t.getElementById("column-selectors"),l=t.getElementById("tooltipFields");this.chartContainer=t.getElementById("chart"),this.tooltipContainer=t.getElementById("tooltipContainer");let f=[];a.onclick=()=>{n.value="",c.style.display="none",this.chartContainer.innerHTML="",this.tooltipContainer.textContent="Hover a node to see details here.",f=[]},n.onchange=()=>{var h;const u=(h=n.files)==null?void 0:h[0];if(!u)return;const d=new FileReader;d.onload=x=>{var v;const p=new Uint8Array((v=x.target)==null?void 0:v.result),m=Co(p,{type:"array"}),g=m.Sheets[m.SheetNames[0]];f=K4.sheet_to_json(g,{header:0,defval:""});const w=Object.keys(f[0]);i.innerHTML=s.innerHTML=l.innerHTML="",w.forEach(k=>{[i,s,l].forEach(A=>{const F=document.createElement("option");F.value=F.textContent=k,A.appendChild(F.cloneNode(!0))})}),c.style.display="block"},d.readAsArrayBuffer(u)},o.onclick=()=>{const u=i.value,d=s.value,h=Array.from(l.selectedOptions).map(x=>x.value);if(u===d){alert("Parent and Child columns must be different.");return}this.renderTree(f,u,d,h)}}renderTree(t,n,a,i){const s=pg().id((d,h)=>`${d[a]}_${h}`).parentId(d=>t.find(h=>h[a]===d[n])?`${d[n]}_${t.indexOf(t.find(h=>h[a]===d[n]))}`:null)(t);yg().nodeSize([160,100])(s),s.eachAfter(d=>d.data.nodeCount=d.children?d.children.reduce((h,x)=>h+(x.data.nodeCount||0),0)+d.children.length:0);const c=Lf(Rg).domain([Qd(s.descendants(),d=>d.data.nodeCount)||1,0]),l=Np("svg").attr("viewBox",[-1e3,-500,2e3,2e3]),f=l.append("g");l.call(Xg().on("zoom",d=>{const{transform:h}=d;f.attr("transform",h.toString())})),f.selectAll("path").data(s.links()).enter().append("path").attr("fill","none").attr("stroke","#ccc").attr("stroke-width",4).attr("d",zg().source(d=>[d.source.x,d.source.y]).target(d=>[d.target.x,d.target.y]));const u=f.selectAll("g").data(s.descendants()).enter().append("g").attr("transform",d=>`translate(${d.x},${d.y})`).style("cursor","pointer").on("mouseover",(d,h)=>{Xt(this.tooltipContainer).transition().duration(200).style("opacity",0).on("end",()=>{this.tooltipContainer.innerHTML=i.map(x=>`<strong>${x}</strong>: ${h.data[x]}`).join("<br>"),Xt(this.tooltipContainer).transition().duration(200).style("opacity",1)}),Xt(d.currentTarget).select("rect").transition().duration(200).attr("stroke-width",5).attr("stroke","white")}).on("mouseout",(d,h)=>{Xt(d.currentTarget).select("rect").transition().duration(200).attr("stroke-width",1).attr("stroke","#333")});u.append("rect").attr("width",120).attr("height",50).attr("x",-60).attr("y",-25).attr("rx",10).attr("ry",10).attr("fill",d=>c(d.data.nodeCount??0)).attr("stroke","#333").attr("stroke-width",1),u.append("text").attr("text-anchor","middle").attr("dy",".35em").attr("fill","white").style("font-weight","bold").style("font-size","14px").text(d=>String(d.data[a]).slice(0,15)),this.chartContainer.innerHTML="",this.chartContainer.append(l.node())}}customElements.define("tree-bom-page",q4);async function _h(){const e="https://partsmanual.blob.core.windows.net/authenticationhash/credentials.json?sp=racwdli&st=2025-03-10T16:47:55Z&se=2025-08-01T00:47:55Z&sv=2022-11-02&sr=c&sig=4BjCw6SBZmI606wTM3GEQUYRcuhRQMlgKrj0Wy%2B4Y8g%3D";try{const r=await fetch(e,{cache:"no-cache"});if(!r.ok)throw new Error(`Failed to fetch whitelisted emails: ${r.statusText}`);const t=await r.json(),n=new Set;return t.forEach(a=>{n.add(a.Email.toLowerCase())}),console.log("Fetched whitelisted emails:",n),n}catch(r){return console.error("Error fetching whitelist. Returning fallback set:",r),new Set(["hshields@trebro.com"])}}let vh=[];(async()=>{const e=await _h();vh=Array.from(e)})();function J4(e){const r=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));return r?decodeURIComponent(r[2]):null}class Z4{async isAuthenticated(){return!!J4("auth")}async setUserData(r){const t=r.email.toLowerCase();if(!vh.includes(t))throw new Error("Email not registered. Please request access.");window.localStorage.zeaUserData=JSON.stringify({email:t})}async getUserData(){const{zeaUserData:r}=window.localStorage;return r?JSON.parse(r):null}async signOut(){localStorage.removeItem("zeaUserData"),document.cookie="auth=; Path=/; Max-Age=0"}}const Ro=new Z4;let Vs=null;function Q4(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}class eb extends HTMLElement{constructor(){super();At(this,"modal");At(this,"content");At(this,"onCloseCallback");At(this,"initialBtnHTML");const t=this.attachShadow({mode:"open"});this.modal=document.createElement("div"),this.modal.classList.add("modal"),t.appendChild(this.modal),this.content=document.createElement("div"),this.content.classList.add("modal-content"),this.modal.appendChild(this.content),this.content.innerHTML=`
      <div class="container">
        <div class="imgcontainer">
          <img src="data/Crescent1.png" alt="Logo" class="logo">
        </div>
        <label for="uname"><b>Email</b></label>
        <input id="uname" type="text" placeholder="Enter Email" name="uname" required>

        <!-- CHANGED: remove password container entirely -->
        <button id="sendLinkBtn" class="btn">
          <span class="icon-text">
            <i class="fas fa-paper-plane"></i>
            <span class="text">Send Magic Link</span>
          </span>
          <span class="wave-spinner">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </span>
        </button>

        <!-- Microsoft Form container (unchanged) -->
        <div id="msFormContainer" style="display: none; margin-top: 1rem;">
          <p>If you don’t have an account, please fill out the form below:</p>
          <iframe id="msForm"
            width="640px"
            height="480px"
            frameborder="0"
            marginwidth="0"
            marginheight="0"
            style="border: none; max-width: 100%; max-height: 100vh;"
            allowfullscreen
            webkitallowfullscreen
            mozallowfullscreen
            msallowfullscreen
          ></iframe>
        </div>
      </div>
    `;const n=this.shadowRoot.getElementById("uname"),a=this.shadowRoot.getElementById("sendLinkBtn"),i=this.shadowRoot.getElementById("msFormContainer"),s=[{step0:"rgb(255, 255, 255)",step40:"rgb(255, 160, 105)",step50:"#f36f21"},{step0:"rgb(255, 255, 255)",step40:"rgb(255, 228, 141)",step50:"#FABF35"},{step0:"rgb(255, 255, 255)",step40:"rgb(255, 143, 143)",step50:"#EA3546"},{step0:"rgb(255, 255, 255)",step40:"rgb(136, 148, 255)",step50:"#345995"}];a.querySelectorAll(".wave-spinner > div").forEach(u=>{const d=s[Math.floor(Math.random()*s.length)];u.style.setProperty("--wave-color-0",d.step0),u.style.setProperty("--wave-color-40",d.step40),u.style.setProperty("--wave-color-50",d.step50)}),a.style.display="none",n.addEventListener("input",async()=>{const u=n.value.trim().toLowerCase();Vs||(Vs=await _h()),Q4(u)?Array.from(Vs).some(h=>h.startsWith(u))?(a.style.display="block",i.style.display="none"):(a.style.display="none",i.style.display="block"):(a.style.display="none",i.style.display="none")}),this.initialBtnHTML=a.innerHTML;const c=a.innerHTML,l=async()=>{const u=n.value.trim().toLowerCase();await Ro.setUserData({email:u}),a.disabled=!0,a.classList.add("loading"),setTimeout(()=>{a.classList.remove("loading"),a.classList.add("success"),a.textContent="Success! Check your email",document.cookie="auth=testing; path=/;",a.innerHTML=c,a.classList.add("success"),a.textContent="Success! Check your email",this.content.classList.add("minimized"),a.onclick=l,setTimeout(()=>{document.dispatchEvent(new CustomEvent("login-success"))},1e3)},1500)};a.onclick=l;const f=document.createElement("style");f.appendChild(document.createTextNode(`
        @keyframes slideDown {
          0% {
            opacity: 0;
            transform: translateY(-50px);
          }
          100% {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes slideUp {
          0% {
            opacity: 1;
            transform: translateY(0);
          }
          100% {
            opacity: 0;
            transform: translateY(-50px);
          }
        }
        /* The Modal (background) */
        .modal {
          display: none; /* Hidden by default */
          position: fixed; /* Stay in place */
          z-index: 1; /* Sit on top */
          left: 0;
          top: 0;
          width: 100%; /* Full width */
          height: 100%; /* Full height */
          overflow: auto; /* Enable scroll if needed */
          background-color: rgb(0,0,0); /* Fallback color */
          background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        }

        /* Modal Content initial state */
        .modal-content {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          transition: transform 1.5s ease-in-out, top 1.5s ease-in-out, left 1.5s ease-in-out, width 1.5s ease-in-out, height 1.5s ease-in-out, opacity 1.5s ease-in-out;
          width: 80%;
          max-width: 600px;
          border-radius: 10px;
          z-index: 1000;
          background:var(--container-bg);
        }
        label {
          color: var(--color-text);
          display: block; /* So it sits on its own line */
        }
        .modal-content.minimized {
          opacity: 0;
        }

        /* Transition for the logo image */
        .logo {
          transition: transform 0.6s ease-in-out, width 0.6s ease-in-out;
        }

        /* When modal-content is minimized, the logo scales down */
        .modal-content.minimized .logo {
          transform: scale(0.5) rotate(-90deg);
          /* Alternatively, you can set a new width:
            width: 100px; 
          */
        }
        /* By default, hide animations (unless class is added) */
        opacity: 0;
        transform: translateY(-50px);
       }

        /* Opening animation */
        .opening-animation {
          animation: slideDown 0.4s ease forwards;
        }

        /* Closing animation */
        .closing-animation {
          animation: slideUp 0.4s ease forwards;
        }

        /* The Close Button */
        .close {
          color: #aaa;
          float: right;
          font-size: 28px;
          font-weight: bold;
        }

        .close:hover,
        .close:focus {
          color: black;
          text-decoration: none;
          cursor: pointer;
        }

        /* Full-width inputs */
        input[type=text], input[type=password] {
          width: 100%;
          padding: 12px 20px;
          margin: 12px 0;
          display: inline-block;
          border: 1px solid #ccc;
          box-sizing: border-box;
          border-radius: 12px;
        }

        /* Set a style for all buttons */
        button {
          background-color: #f36f21;
          color: black;
          padding: 14px 20px;
          margin: 8px 0;
          border: none;
          cursor: pointer;
          width: 100%;
        }

        /* Add a hover effect for buttons */
        button:hover {
          opacity: 0.8;
        }

        /* Extra style for the cancel button (red) */
        .cancelbtn {
          width: auto;
          padding: 10px 18px;
          background-color: #f44336;
        }

        /* Center the avatar image inside this container */
        .imgcontainer {
          text-align: center;
          margin: 24px 0 12px 0;
        }

        /* Avatar image */
        img.avatar {
          height: 40px;
        }

        /* Add padding to containers */
        .container {
          padding: 16px;
        }

        /* The "Forgot password" text */
        span.psw {
          float: right;
          padding-top: 16px;
        }

        /* Change styles for span and cancel button on extra small screens */
        @media screen and (max-width: 300px) {
          span.psw {
            display: block;
            float: none;
          }
          .cancelbtn {
            width: 100%;
          }
        }

        /* Style for the logo image */
        .logo {
          width: 200px; /* Adjust the width as needed */
          height: auto;
        }
              /* Base Button Styles */
      .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background:var(--container-bg);
      color: var(--color-text);
      font-size: 14px;
      font-weight: bold;
      border-radius: 12px;
      cursor: pointer;
      height: 45px;
      border: 3px solid var(--color-text);
      margin: auto;
      padding: 0 16px;
      transition: width 0.25s ease, height 0.25s ease, padding 0.25s ease;
      overflow: hidden;
      }
      

      .btn:hover {
      background-color: #e36a1e;
      color: white;
      border: none;
      
      }

      /* Container for Icon and Text */
      .btn .icon-text {
      display: absolute;
      align-items: center;
      justify-content: center;
      transition: opacity 0.25s ease;
      }

      .btn .icon-text i {
      margin-right: 8px;
      }

      /* Wave Spinner Container (hidden by default) */
      .btn .wave-spinner {
      display: none;
      }

      /* Loading State: Button shrinks to a specific size */
      .btn.loading {
      width: 140px;
      height: 60px;
      border-radius: 25px;
      border: none;
      background:var(--container-bg);
      padding: 0; /* Remove extra padding */
      animation: colorTransition 0.5s ease forwards; /* Add color transition */
      }

      /* In Loading State, remove the icon/text and reveal the spinner */
      .btn.loading .icon-text {
      display: none;
      }

      .btn.loading .wave-spinner {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      }

      /* Wave Spinner Dot Styles */
      .wave-spinner {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      }

      .wave-spinner > div {
      width: 6px;
      height: 8px;
      margin: 0 6px;
      border-radius: 20%; /* Rotate to form diamond shape */
      background:var(--container-bg);
      animation: scaling 1.2s ease-in-out infinite;
      }

      /* Set staggered animation delays for a wave effect */
      .wave-spinner > div:nth-child(1) {
      animation-delay: -0.6s;
      }
      .wave-spinner > div:nth-child(2) {
      animation-delay: -0.4s;
      }
      .wave-spinner > div:nth-child(3) {
      animation-delay: -0.2s;
      }
      .wave-spinner > div:nth-child(4) {
      animation-delay: 0s;
      }
      .wave-spinner > div:nth-child(5) {
      animation-delay: 0.2s;
      }

      @keyframes scaling {
        0%, 100% {
          transform: scaleY(0.5);
          background-color: var( --container-bg);
        }
        40% {
          transform: scaleY(1.5);
          background-color: var(--wave-color-40, rgb(255, 160, 105));
        }
        50% {
          transform: scaleY(3);
          background-color: var(--wave-color-50, #f36f21);
        }
      }

      /* Color Transition Animation */
      @keyframes colorTransition {
      0% {
      background-color: #f36f21;
      }
      100% {
      background:var(--container-bg);
      }
      }

      @keyframes successTransition {
        0% {
         background:var(--container-bg);
        }
        50% {
         background:var(--container-bg);
        }
        100% {
          background-color: #28a745;
        }
      }

      /* Success State Styling */
      .btn.success {
        animation: successTransition 0.7s ease forwards;
        background-color: #28a745;  /* Green */
        border: none;
        color: #fff;
      }
      `)),t.appendChild(f)}minimizeAndClose(){const t=document.querySelector(".modal-content");t&&t.classList.add("minimized"),setTimeout(()=>{t&&(t.style.display="none"),document.dispatchEvent(new CustomEvent("login-success"))},1500)}resetSendLinkButton(){const t=this.shadowRoot.getElementById("sendLinkBtn");t.disabled=!1,t.classList.remove("loading","success"),t.innerHTML=this.initialBtnHTML}show(t){console.log("login-dialog show() invoked"),this.content.classList.remove("minimized"),this.onCloseCallback=t,this.style.display="block",this.hidden=!1,this.modal.style.display="block"}close(){console.log("login-dialog close() invoked"),this.modal.style.display="none",this.style.display="none",this.hidden=!0,this.onCloseCallback&&this.onCloseCallback()}}customElements.define("login-dialog",eb);let Rl=!1;class tb extends HTMLElement{constructor(){super();At(this,"modal");At(this,"content");At(this,"loadFileCallback");const t=this.attachShadow({mode:"open"});this.modal=document.createElement("div"),this.modal.classList.add("modal"),t.appendChild(this.modal),this.content=document.createElement("div"),this.content.classList.add("modal-content"),this.modal.appendChild(this.content),this.content.innerHTML=`<div id="fileDropZone" class="fixed w-full flex h-screen">
    <input
      accept=".zcad, .gltf, .glb, gltf, .obj"
      multiple
      type="file"
      class="absolute inset-0 z-50 m-0 p-0 w-full h-full outline-none opacity-0"
      id="dropHotSpot"
    />
      <div
        class="border-2 border-gray-400 py-12 justify-center items-center p-4 m-auto rounded-lg w-3/12 h-1/3 bg-gray-200 bg-opacity-25 hover:bg-blue-200 hover:bg-opacity-25 text-black grid justify-items-center"
      >
        <div class="m-auto">
          <div class="flex flex-col space-y-2 items-center justify-center">
            <i class="fas fa-cloud-upload-alt fa-3x text-currentColor" />
            <p class="text-gray-700 text-center">Drag your gltf, obj or zcad files here or click in this area.</p>
          </div>
        </div>
      </div>
  </div>`;const n=f=>{Rl&&this.shadowRoot.getElementById("fileDropZone").classList.remove("pointer-events-none"),f.preventDefault()},a=f=>{f.preventDefault()},i=f=>{if(f.dataTransfer){for(var u=0;u<f.dataTransfer.items.length;u++)if(f.dataTransfer.items[u].kind==="file"){const d=f.dataTransfer.items[u].getAsFile();d&&o(d)}}f.preventDefault()},s=f=>{for(var u=0;u<f.target.files.length;u++){let d=f.target.files[u];o(d)}f.preventDefault()},o=f=>{const u=new FileReader;u.addEventListener("load",()=>{const d=u.result,h=f.name;this.loadFile(d,h)},!1),u.readAsDataURL(f)},c=this.shadowRoot.getElementById("dropHotSpot");c.addEventListener("change",s),c.addEventListener("drop",i),document.body.addEventListener("dragover",a),document.body.addEventListener("dragenter",n),document.body.addEventListener("drop",i);const l=document.createElement("style");l.appendChild(document.createTextNode(`
/* The Modal (background) */
.modal {
  display: block; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content/Box */
.modal-content {
  background-color: #eeeeee88;
  margin: 15% auto; /* 15% from the top and centered */
  padding: 20px;
  border: 1px solid #888;
  width: 80%; /* Could be more or less, depending on screen size */
  max-width: 600px;
}

`)),t.appendChild(l),this.hide()}display(t){this.loadFileCallback=t,this.modal.style.setProperty("pointer-events","auto"),this.modal.style.setProperty("display","block")}hide(){this.modal.style.setProperty("pointer-events","none"),this.modal.style.setProperty("display","none")}loadFile(t,n){this.hide(),Rl=!0,this.loadFileCallback&&this.loadFileCallback(t,n)}}customElements.define("drop-zone",tb);class rb extends HTMLElement{constructor(){super();const r=this.attachShadow({mode:"open"});r.innerHTML=`
        <style>
          header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: var(--container-bg);
            padding: 10px 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            font-family: sans-serif;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 5px 10px black (0, 0, 0, 0.2);
          }
            .logo-container {
            display: flex;
            align-items: center;
            color: var(--color-text);
            }

          #darkModeToggle {
            margin-left: 10px;
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            transition: transform 0.3s ease;
          }

          #darkModeToggle:hover {
            transform: rotate(20deg) scale(1.2);
          }
            
            @keyframes slideRight {
            to {
                transform: translateX(0) rotate(90);
                opacity: 1;
            }
            }

            .logo {
            height: 40px;
            margin-right: 10px;
            transform: scale(0.5) rotate(-90deg);
            opacity: 0;
            animation: logoScaleIn 1.4s ease forwards;
            }

            @keyframes logoScaleIn {
            to {
                transform: scale(1);
                opacity: 1;
            }
            }
          .header-buttons {
            display: flex;
            gap: 10px;
          }
          /* Style header buttons similar to sendmagiclinkbtn */
          .header-btn {
            background-color: var(--container-bg);
            color: var(--color-text);
            font-size: 14px;
            font-weight: bold;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            padding: 10px 16px;
            transition: background-color 0.25s ease;
          }

          .header-btn:hover {
            background-color: #e36a1e;
            transform: scale(1.1);
            transition: transform 0.1s ease;
            color: white;
          }
          /* Initially hide the logout button; you'll show it when needed */
          .header-btn#logoutButton {
            background-color: red
            color: white;
          }
          .header-btn#logoutButton {
            background-color:rgb(194, 69, 47);  /* or a different base color if you prefer */
            color: white;
            /* Don’t forget the semicolon! */
          }
          .header-btn#logoutButton:hover {
            background-color: darkred; /* or just 'red' if you want no change */
            transform: scale(1.1);
            color: white;
          }
          .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 28px;
            margin-left: 10px;
          }

          .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
          }

          .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0;
            right: 0; bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 34px;
          }

          .slider::before {
            position: absolute;
            content: "☀️";
            height: 22px;
            width: 22px;
            left: 3px;
            bottom: 3px;
            background-color: var(--container-bg);
            border-radius: 50%;
            transition: 0.4s;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
          }

          input:checked + .slider {
            background-color: #555;
          }

          input:checked + .slider::before {
            transform: translateX(22px);
            content: "🌙";
          }

            
        </style>
        <header>
          <div class="logo-container">
            <img src="data/Crescent1.png" alt="Logo" class="logo">
            <span>fettle</span>
            <label class="toggle-switch" title="Toggle Dark Mode">
              <input type="checkbox" id="darkModeToggle" />
              <span class="slider"></span>
            </label>
          </div>
          <div class="header-buttons">
            <button class="header-btn" id="homeButton">Home</button>
            <button class="header-btn" id="goCluster">Cluster</button>
            <button class="header-btn" id="goLogo">Logo</button>
            <button class="header-btn" id="goTreeBOM">TreeBOM</button>
            <button class="header-btn" id="featuresButton">Features</button>
            <button class="header-btn" id="logoutButton">Logout</button>
          </div>
        </header>
      `}connectedCallback(){const r=this.shadowRoot,t=r.getElementById("darkModeToggle"),n=localStorage.getItem("darkMode")==="true";t.checked=n,t.addEventListener("change",()=>{document.dispatchEvent(new CustomEvent("toggleDarkMode"))}),r.getElementById("homeButton").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"home"})),r.getElementById("featuresButton").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"features"})),r.getElementById("goCluster").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"cluster"})),r.getElementById("goTreeBOM").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"treebom"})),r.getElementById("goLogo").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"logo"})),r.getElementById("logoutButton").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"logout"}))}}customElements.define("main-header",rb);function Gs(){const e=20+Math.random()*40,r=20+Math.random()*40,t=20+Math.random()*40,n=20+Math.random()*40,a=20+Math.random()*40,i=20+Math.random()*40;return`polygon(
      0% ${e}%,
      15% ${n}%,
      33% ${r}%,
      50% ${a}%,
      66% ${t}%,
      82% ${i}%,
      100% ${e}%,
      100% 100%,
      0 100%
    )`}function Il(){const e=document.body.style,r=Gs(),t=Gs(),n=Gs();e.setProperty("--wave1-clip",r),e.setProperty("--wave2-clip",t),e.setProperty("--wave3-clip",n)}function nb(){Il(),setInterval(Il,3e3)}const Io="RFC3986",Oo={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},ab="RFC1738",ib=Array.isArray,fr=(()=>{const e=[];for(let r=0;r<256;++r)e.push("%"+((r<16?"0":"")+r.toString(16)).toUpperCase());return e})(),js=1024,sb=(e,r,t,n,a)=>{if(e.length===0)return e;let i=e;if(typeof e=="symbol"?i=Symbol.prototype.toString.call(e):typeof e!="string"&&(i=String(e)),t==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let s="";for(let o=0;o<i.length;o+=js){const c=i.length>=js?i.slice(o,o+js):i,l=[];for(let f=0;f<c.length;++f){let u=c.charCodeAt(f);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||a===ab&&(u===40||u===41)){l[l.length]=c.charAt(f);continue}if(u<128){l[l.length]=fr[u];continue}if(u<2048){l[l.length]=fr[192|u>>6]+fr[128|u&63];continue}if(u<55296||u>=57344){l[l.length]=fr[224|u>>12]+fr[128|u>>6&63]+fr[128|u&63];continue}f+=1,u=65536+((u&1023)<<10|c.charCodeAt(f)&1023),l[l.length]=fr[240|u>>18]+fr[128|u>>12&63]+fr[128|u>>6&63]+fr[128|u&63]}s+=l.join("")}return s};function ob(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function Ol(e,r){if(ib(e)){const t=[];for(let n=0;n<e.length;n+=1)t.push(r(e[n]));return t}return r(e)}const cb=Object.prototype.hasOwnProperty,wh={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,r){return String(e)+"["+r+"]"},repeat(e){return String(e)}},hr=Array.isArray,lb=Array.prototype.push,yh=function(e,r){lb.apply(e,hr(r)?r:[r])},fb=Date.prototype.toISOString,nt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:sb,encodeValuesOnly:!1,format:Io,formatter:Oo[Io],indices:!1,serializeDate(e){return fb.call(e)},skipNulls:!1,strictNullHandling:!1};function ub(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const Xs={};function kh(e,r,t,n,a,i,s,o,c,l,f,u,d,h,x,p,m,g){let w=e,v=g,k=0,A=!1;for(;(v=v.get(Xs))!==void 0&&!A;){const G=v.get(e);if(k+=1,typeof G<"u"){if(G===k)throw new RangeError("Cyclic object value");A=!0}typeof v.get(Xs)>"u"&&(k=0)}if(typeof l=="function"?w=l(r,w):w instanceof Date?w=d==null?void 0:d(w):t==="comma"&&hr(w)&&(w=Ol(w,function(G){return G instanceof Date?d==null?void 0:d(G):G})),w===null){if(i)return c&&!p?c(r,nt.encoder,m,"key",h):r;w=""}if(ub(w)||ob(w)){if(c){const G=p?r:c(r,nt.encoder,m,"key",h);return[(x==null?void 0:x(G))+"="+(x==null?void 0:x(c(w,nt.encoder,m,"value",h)))]}return[(x==null?void 0:x(r))+"="+(x==null?void 0:x(String(w)))]}const F=[];if(typeof w>"u")return F;let E;if(t==="comma"&&hr(w))p&&c&&(w=Ol(w,c)),E=[{value:w.length>0?w.join(",")||null:void 0}];else if(hr(l))E=l;else{const G=Object.keys(w);E=f?G.sort(f):G}const z=o?String(r).replace(/\./g,"%2E"):String(r),C=n&&hr(w)&&w.length===1?z+"[]":z;if(a&&hr(w)&&w.length===0)return C+"[]";for(let G=0;G<E.length;++G){const H=E[G],b=typeof H=="object"&&typeof H.value<"u"?H.value:w[H];if(s&&b===null)continue;const j=u&&o?H.replace(/\./g,"%2E"):H,_=hr(w)?typeof t=="function"?t(C,j):C:C+(u?"."+j:"["+j+"]");g.set(e,k);const W=new WeakMap;W.set(Xs,g),yh(F,kh(b,_,t,n,a,i,s,o,t==="comma"&&p&&hr(w)?null:c,l,f,u,d,h,x,p,m,W))}return F}function hb(e=nt){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const r=e.charset||nt.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=Io;if(typeof e.format<"u"){if(!cb.call(Oo,e.format))throw new TypeError("Unknown format option provided.");t=e.format}const n=Oo[t];let a=nt.filter;(typeof e.filter=="function"||hr(e.filter))&&(a=e.filter);let i;if(e.arrayFormat&&e.arrayFormat in wh?i=e.arrayFormat:"indices"in e?i=e.indices?"indices":"repeat":i=nt.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const s=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:nt.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:nt.addQueryPrefix,allowDots:s,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:nt.allowEmptyArrays,arrayFormat:i,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:nt.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?nt.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:nt.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:nt.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:nt.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:nt.encodeValuesOnly,filter:a,format:t,formatter:n,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:nt.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:nt.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:nt.strictNullHandling}}function db(e,r={}){let t=e;const n=hb(r);let a,i;typeof n.filter=="function"?(i=n.filter,t=i("",t)):hr(n.filter)&&(i=n.filter,a=i);const s=[];if(typeof t!="object"||t===null)return"";const o=wh[n.arrayFormat],c=o==="comma"&&n.commaRoundTrip;a||(a=Object.keys(t)),n.sort&&a.sort(n.sort);const l=new WeakMap;for(let d=0;d<a.length;++d){const h=a[d];n.skipNulls&&t[h]===null||yh(s,kh(t[h],h,o,c,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,l))}const f=s.join(n.delimiter);let u=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?u+="utf8=%26%2310003%3B&":u+="utf8=%E2%9C%93&"),f.length>0?u+f:""}const En="4.90.0";let Dl=!1,ya,Eh,Th,Do,bh,Ah,Sh,Ch,Fh;function pb(e,r={auto:!1}){if(Dl)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(ya)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${ya}'\``);Dl=r.auto,ya=e.kind,Eh=e.fetch,Th=e.FormData,Do=e.File,bh=e.ReadableStream,Ah=e.getMultipartRequestOptions,Sh=e.getDefaultAgent,Ch=e.fileFromPath,Fh=e.isFsReadStream}class xb{constructor(r){this.body=r}get[Symbol.toStringTag](){return"MultipartBody"}}function mb({manuallyImported:e}={}){const r=e?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,n,a,i;try{t=fetch,n=Request,a=Response,i=Headers}catch(s){throw new Error(`this environment is missing the following Web Fetch API type: ${s.message}. ${r}`)}return{kind:"web",fetch:t,Request:n,Response:a,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${r}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${r}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${r}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${r}`)}},getMultipartRequestOptions:async(s,o)=>({...o,body:new xb(s)}),getDefaultAgent:s=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:s=>!1}}const Rh=()=>{ya||pb(mb(),{auto:!0})};Rh();class Se extends Error{}class mt extends Se{constructor(r,t,n,a){super(`${mt.makeMessage(r,t,n)}`),this.status=r,this.headers=a,this.request_id=a==null?void 0:a["x-request-id"],this.error=t;const i=t;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(r,t,n){const a=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return r&&a?`${r} ${a}`:r?`${r} status code (no body)`:a||"(no status code or body)"}static generate(r,t,n,a){if(!r||!a)return new xs({message:n,cause:No(t)});const i=t==null?void 0:t.error;return r===400?new Ih(r,i,n,a):r===401?new Oh(r,i,n,a):r===403?new Dh(r,i,n,a):r===404?new Ph(r,i,n,a):r===409?new Nh(r,i,n,a):r===422?new Lh(r,i,n,a):r===429?new Mh(r,i,n,a):r>=500?new Bh(r,i,n,a):new mt(r,i,n,a)}}class Yt extends mt{constructor({message:r}={}){super(void 0,void 0,r||"Request was aborted.",void 0)}}class xs extends mt{constructor({message:r,cause:t}){super(void 0,void 0,r||"Connection error.",void 0),t&&(this.cause=t)}}class Cc extends xs{constructor({message:r}={}){super({message:r??"Request timed out."})}}class Ih extends mt{}class Oh extends mt{}class Dh extends mt{}class Ph extends mt{}class Nh extends mt{}class Lh extends mt{}class Mh extends mt{}class Bh extends mt{}class Uh extends Se{constructor(){super("Could not parse response content as the length limit was reached")}}class zh extends Se{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var pi=function(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t},Yr=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},Mt;class ms{constructor(){Mt.set(this,void 0),this.buffer=new Uint8Array,pi(this,Mt,null,"f")}decode(r){if(r==null)return[];const t=r instanceof ArrayBuffer?new Uint8Array(r):typeof r=="string"?new TextEncoder().encode(r):r;let n=new Uint8Array(this.buffer.length+t.length);n.set(this.buffer),n.set(t,this.buffer.length),this.buffer=n;const a=[];let i;for(;(i=gb(this.buffer,Yr(this,Mt,"f")))!=null;){if(i.carriage&&Yr(this,Mt,"f")==null){pi(this,Mt,i.index,"f");continue}if(Yr(this,Mt,"f")!=null&&(i.index!==Yr(this,Mt,"f")+1||i.carriage)){a.push(this.decodeText(this.buffer.slice(0,Yr(this,Mt,"f")-1))),this.buffer=this.buffer.slice(Yr(this,Mt,"f")),pi(this,Mt,null,"f");continue}const s=Yr(this,Mt,"f")!==null?i.preceding-1:i.preceding,o=this.decodeText(this.buffer.slice(0,s));a.push(o),this.buffer=this.buffer.slice(i.index),pi(this,Mt,null,"f")}return a}decodeText(r){if(r==null)return"";if(typeof r=="string")return r;if(typeof Buffer<"u"){if(r instanceof Buffer)return r.toString();if(r instanceof Uint8Array)return Buffer.from(r).toString();throw new Se(`Unexpected: received non-Uint8Array (${r.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(r instanceof Uint8Array||r instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(r);throw new Se(`Unexpected: received non-Uint8Array/ArrayBuffer (${r.constructor.name}) in a web platform. Please report this error.`)}throw new Se("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}Mt=new WeakMap;ms.NEWLINE_CHARS=new Set([`
`,"\r"]);ms.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function gb(e,r){for(let a=r??0;a<e.length;a++){if(e[a]===10)return{preceding:a,index:a+1,carriage:!1};if(e[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function _b(e){for(let n=0;n<e.length-1;n++){if(e[n]===10&&e[n+1]===10||e[n]===13&&e[n+1]===13)return n+2;if(e[n]===13&&e[n+1]===10&&n+3<e.length&&e[n+2]===13&&e[n+3]===10)return n+4}return-1}function $h(e){if(e[Symbol.asyncIterator])return e;const r=e.getReader();return{async next(){try{const t=await r.read();return t!=null&&t.done&&r.releaseLock(),t}catch(t){throw r.releaseLock(),t}},async return(){const t=r.cancel();return r.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class xr{constructor(r,t){this.iterator=r,this.controller=t}static fromSSEResponse(r,t){let n=!1;async function*a(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let i=!1;try{for await(const s of vb(r,t))if(!i){if(s.data.startsWith("[DONE]")){i=!0;continue}if(s.event===null||s.event.startsWith("response.")||s.event.startsWith("transcript.")){let o;try{o=JSON.parse(s.data)}catch(c){throw console.error("Could not parse message into JSON:",s.data),console.error("From chunk:",s.raw),c}if(o&&o.error)throw new mt(void 0,o.error,void 0,Yh(r.headers));yield o}else{let o;try{o=JSON.parse(s.data)}catch(c){throw console.error("Could not parse message into JSON:",s.data),console.error("From chunk:",s.raw),c}if(s.event=="error")throw new mt(void 0,o.error,o.message,void 0);yield{event:s.event,data:o}}}i=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{i||t.abort()}}return new xr(a,t)}static fromReadableStream(r,t){let n=!1;async function*a(){const s=new ms,o=$h(r);for await(const c of o)for(const l of s.decode(c))yield l;for(const c of s.flush())yield c}async function*i(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let s=!1;try{for await(const o of a())s||o&&(yield JSON.parse(o));s=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{s||t.abort()}}return new xr(i,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const r=[],t=[],n=this.iterator(),a=i=>({next:()=>{if(i.length===0){const s=n.next();r.push(s),t.push(s)}return i.shift()}});return[new xr(()=>a(r),this.controller),new xr(()=>a(t),this.controller)]}toReadableStream(){const r=this;let t;const n=new TextEncoder;return new bh({async start(){t=r[Symbol.asyncIterator]()},async pull(a){try{const{value:i,done:s}=await t.next();if(s)return a.close();const o=n.encode(JSON.stringify(i)+`
`);a.enqueue(o)}catch(i){a.error(i)}},async cancel(){var a;await((a=t.return)==null?void 0:a.call(t))}})}}async function*vb(e,r){if(!e.body)throw r.abort(),new Se("Attempted to iterate over a response with no body");const t=new yb,n=new ms,a=$h(e.body);for await(const i of wb(a))for(const s of n.decode(i)){const o=t.decode(s);o&&(yield o)}for(const i of n.flush()){const s=t.decode(i);s&&(yield s)}}async function*wb(e){let r=new Uint8Array;for await(const t of e){if(t==null)continue;const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let a=new Uint8Array(r.length+n.length);a.set(r),a.set(n,r.length),r=a;let i;for(;(i=_b(r))!==-1;)yield r.slice(0,i),r=r.slice(i)}r.length>0&&(yield r)}class yb{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(r){if(r.endsWith("\r")&&(r=r.substring(0,r.length-1)),!r){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(r),r.startsWith(":"))return null;let[t,n,a]=kb(r,":");return a.startsWith(" ")&&(a=a.substring(1)),t==="event"?this.event=a:t==="data"&&this.data.push(a),null}}function kb(e,r){const t=e.indexOf(r);return t!==-1?[e.substring(0,t),r,e.substring(t+r.length)]:[e,"",""]}const Hh=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",Wh=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&gs(e),gs=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",Eb=e=>Wh(e)||Hh(e)||Fh(e);async function Vh(e,r,t){var a;if(e=await e,Wh(e))return e;if(Hh(e)){const i=await e.blob();r||(r=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const s=gs(i)?[await i.arrayBuffer()]:[i];return new Do(s,r,t)}const n=await Tb(e);if(r||(r=Ab(e)??"unknown_file"),!(t!=null&&t.type)){const i=(a=n[0])==null?void 0:a.type;typeof i=="string"&&(t={...t,type:i})}return new Do(n,r,t)}async function Tb(e){var t;let r=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)r.push(e);else if(gs(e))r.push(await e.arrayBuffer());else if(Sb(e))for await(const n of e)r.push(n);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(t=e==null?void 0:e.constructor)==null?void 0:t.name}; props: ${bb(e)}`);return r}function bb(e){return`[${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}function Ab(e){var r;return Ys(e.name)||Ys(e.filename)||((r=Ys(e.path))==null?void 0:r.split(/[\\/]/).pop())}const Ys=e=>{if(typeof e=="string")return e;if(typeof Buffer<"u"&&e instanceof Buffer)return String(e)},Sb=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",Pl=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",$n=async e=>{const r=await Cb(e.body);return Ah(r,e)},Cb=async e=>{const r=new Th;return await Promise.all(Object.entries(e||{}).map(([t,n])=>Po(r,t,n))),r},Po=async(e,r,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${r}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")e.append(r,String(t));else if(Eb(t)){const n=await Vh(t);e.append(r,n)}else if(Array.isArray(t))await Promise.all(t.map(n=>Po(e,r+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,a])=>Po(e,`${r}[${n}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var In={},Fb=function(e,r,t,n,a){if(typeof r=="function"?e!==r||!0:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r.set(e,t),t},Rb=function(e,r,t,n){if(typeof r=="function"?e!==r||!0:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},xi;Rh();async function Gh(e){var s;const{response:r}=e;if(e.options.stream)return On("response",r.status,r.url,r.headers,r.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(r,e.controller):xr.fromSSEResponse(r,e.controller);if(r.status===204)return null;if(e.options.__binaryResponse)return r;const t=r.headers.get("content-type"),n=(s=t==null?void 0:t.split(";")[0])==null?void 0:s.trim();if((n==null?void 0:n.includes("application/json"))||(n==null?void 0:n.endsWith("+json"))){const o=await r.json();return On("response",r.status,r.url,r.headers,o),jh(o,r)}const i=await r.text();return On("response",r.status,r.url,r.headers,i),i}function jh(e,r){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:r.headers.get("x-request-id"),enumerable:!1})}class _s extends Promise{constructor(r,t=Gh){super(n=>{n(null)}),this.responsePromise=r,this.parseResponse=t}_thenUnwrap(r){return new _s(this.responsePromise,async t=>jh(r(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(r=>r.response)}async withResponse(){const[r,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:r,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(r,t){return this.parse().then(r,t)}catch(r){return this.parse().catch(r)}finally(r){return this.parse().finally(r)}}class Ib{constructor({baseURL:r,maxRetries:t=2,timeout:n=6e5,httpAgent:a,fetch:i}){this.baseURL=r,this.maxRetries=Ks("maxRetries",t),this.timeout=Ks("timeout",n),this.httpAgent=a,this.fetch=i??Eh}authHeaders(r){return{}}defaultHeaders(r){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Lb(),...this.authHeaders(r)}}validateHeaders(r,t){}defaultIdempotencyKey(){return`stainless-node-retry-${zb()}`}get(r,t){return this.methodRequest("get",r,t)}post(r,t){return this.methodRequest("post",r,t)}patch(r,t){return this.methodRequest("patch",r,t)}put(r,t){return this.methodRequest("put",r,t)}delete(r,t){return this.methodRequest("delete",r,t)}methodRequest(r,t,n){return this.request(Promise.resolve(n).then(async a=>{const i=a&&gs(a==null?void 0:a.body)?new DataView(await a.body.arrayBuffer()):(a==null?void 0:a.body)instanceof DataView?a.body:(a==null?void 0:a.body)instanceof ArrayBuffer?new DataView(a.body):a&&ArrayBuffer.isView(a==null?void 0:a.body)?new DataView(a.body.buffer):a==null?void 0:a.body;return{method:r,path:t,...a,body:i}}))}getAPIList(r,t,n){return this.requestAPIList(t,{method:"get",path:r,...n})}calculateContentLength(r){if(typeof r=="string"){if(typeof Buffer<"u")return Buffer.byteLength(r,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(r).length.toString()}else if(ArrayBuffer.isView(r))return r.byteLength.toString();return null}buildRequest(r,{retryCount:t=0}={}){var x;r={...r};const{method:n,path:a,query:i,headers:s={}}=r,o=ArrayBuffer.isView(r.body)||r.__binaryRequest&&typeof r.body=="string"?r.body:Pl(r.body)?r.body.body:r.body?JSON.stringify(r.body,null,2):null,c=this.calculateContentLength(o),l=this.buildURL(a,i);"timeout"in r&&Ks("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const f=r.httpAgent??this.httpAgent??Sh(l),u=r.timeout+1e3;typeof((x=f==null?void 0:f.options)==null?void 0:x.timeout)=="number"&&u>(f.options.timeout??0)&&(f.options.timeout=u),this.idempotencyHeader&&n!=="get"&&(r.idempotencyKey||(r.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=r.idempotencyKey);const d=this.buildHeaders({options:r,headers:s,contentLength:c,retryCount:t});return{req:{method:n,...o&&{body:o},headers:d,...f&&{agent:f},signal:r.signal??null},url:l,timeout:r.timeout}}buildHeaders({options:r,headers:t,contentLength:n,retryCount:a}){const i={};n&&(i["content-length"]=n);const s=this.defaultHeaders(r);return Bl(i,s),Bl(i,t),Pl(r.body)&&ya!=="node"&&delete i["content-type"],gi(s,"x-stainless-retry-count")===void 0&&gi(t,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(a)),gi(s,"x-stainless-timeout")===void 0&&gi(t,"x-stainless-timeout")===void 0&&r.timeout&&(i["x-stainless-timeout"]=String(r.timeout)),this.validateHeaders(i,t),i}async prepareOptions(r){}async prepareRequest(r,{url:t,options:n}){}parseHeaders(r){return r?Symbol.iterator in r?Object.fromEntries(Array.from(r).map(t=>[...t])):{...r}:{}}makeStatusError(r,t,n,a){return mt.generate(r,t,n,a)}request(r,t=null){return new _s(this.makeRequest(r,t))}async makeRequest(r,t){var u,d;const n=await r,a=n.maxRetries??this.maxRetries;t==null&&(t=a),await this.prepareOptions(n);const{req:i,url:s,timeout:o}=this.buildRequest(n,{retryCount:a-t});if(await this.prepareRequest(i,{url:s,options:n}),On("request",s,n,i.headers),(u=n.signal)!=null&&u.aborted)throw new Yt;const c=new AbortController,l=await this.fetchWithTimeout(s,i,o,c).catch(No);if(l instanceof Error){if((d=n.signal)!=null&&d.aborted)throw new Yt;if(t)return this.retryRequest(n,t);throw l.name==="AbortError"?new Cc:new xs({cause:l})}const f=Yh(l.headers);if(!l.ok){if(t&&this.shouldRetry(l)){const w=`retrying, ${t} attempts remaining`;return On(`response (error; ${w})`,l.status,s,f),this.retryRequest(n,t,f)}const h=await l.text().catch(w=>No(w).message),x=Mb(h),p=x?void 0:h;throw On(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,l.status,s,f,p),this.makeStatusError(l.status,x,p,f)}return{response:l,options:n,controller:c}}requestAPIList(r,t){const n=this.makeRequest(t,null);return new Ob(this,n,r)}buildURL(r,t){const n=Ub(r)?new URL(r):new URL(this.baseURL+(this.baseURL.endsWith("/")&&r.startsWith("/")?r.slice(1):r)),a=this.defaultQuery();return Kh(a)||(t={...a,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(r){return Object.entries(r).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new Se(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(r,t,n,a){const{signal:i,...s}=t||{};i&&i.addEventListener("abort",()=>a.abort());const o=setTimeout(()=>a.abort(),n),c={signal:a.signal,...s};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,r,c).finally(()=>{clearTimeout(o)})}shouldRetry(r){const t=r.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:r.status===408||r.status===409||r.status===429||r.status>=500}async retryRequest(r,t,n){let a;const i=n==null?void 0:n["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(a=o)}const s=n==null?void 0:n["retry-after"];if(s&&!a){const o=parseFloat(s);Number.isNaN(o)?a=Date.parse(s)-Date.now():a=o*1e3}if(!(a&&0<=a&&a<60*1e3)){const o=r.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(t,o)}return await Va(a),this.makeRequest(r,t-1)}calculateDefaultRetryTimeoutMillis(r,t){const i=t-r,s=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return s*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${En}`}}class Xh{constructor(r,t,n,a){xi.set(this,void 0),Fb(this,xi,r),this.options=a,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const r=this.nextPageInfo();if(!r)throw new Se("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in r&&typeof t.query=="object")t.query={...t.query,...r.params};else if("url"in r){const n=[...Object.entries(t.query||{}),...r.url.searchParams.entries()];for(const[a,i]of n)r.url.searchParams.set(a,i);t.query=void 0,t.path=r.url.toString()}return await Rb(this,xi,"f").requestAPIList(this.constructor,t)}async*iterPages(){let r=this;for(yield r;r.hasNextPage();)r=await r.getNextPage(),yield r}async*[(xi=new WeakMap,Symbol.asyncIterator)](){for await(const r of this.iterPages())for(const t of r.getPaginatedItems())yield t}}class Ob extends _s{constructor(r,t,n){super(t,async a=>new n(r,a.response,await Gh(a),a.options))}async*[Symbol.asyncIterator](){const r=await this;for await(const t of r)yield t}}const Yh=e=>new Proxy(Object.fromEntries(e.entries()),{get(r,t){const n=t.toString();return r[n.toLowerCase()]||r[n]}}),Db={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},ut=e=>typeof e=="object"&&e!==null&&!Kh(e)&&Object.keys(e).every(r=>qh(Db,r)),Pb=()=>{var r;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":En,"X-Stainless-OS":Ll(Deno.build.os),"X-Stainless-Arch":Nl(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((r=Deno.version)==null?void 0:r.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":En,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":En,"X-Stainless-OS":Ll(process.platform),"X-Stainless-Arch":Nl(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const e=Nb();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":En,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":En,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Nb(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:r,pattern:t}of e){const n=t.exec(navigator.userAgent);if(n){const a=n[1]||0,i=n[2]||0,s=n[3]||0;return{browser:r,version:`${a}.${i}.${s}`}}}return null}const Nl=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",Ll=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let Ml;const Lb=()=>Ml??(Ml=Pb()),Mb=e=>{try{return JSON.parse(e)}catch{return}},Bb=/^[a-z][a-z0-9+.-]*:/i,Ub=e=>Bb.test(e),Va=e=>new Promise(r=>setTimeout(r,e)),Ks=(e,r)=>{if(typeof r!="number"||!Number.isInteger(r))throw new Se(`${e} must be an integer`);if(r<0)throw new Se(`${e} must be a positive integer`);return r},No=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},mi=e=>{var r,t,n,a;if(typeof process<"u")return((r=In==null?void 0:In[e])==null?void 0:r.trim())??void 0;if(typeof Deno<"u")return(a=(n=(t=Deno.env)==null?void 0:t.get)==null?void 0:n.call(t,e))==null?void 0:a.trim()};function Kh(e){if(!e)return!0;for(const r in e)return!1;return!0}function qh(e,r){return Object.prototype.hasOwnProperty.call(e,r)}function Bl(e,r){for(const t in r){if(!qh(r,t))continue;const n=t.toLowerCase();if(!n)continue;const a=r[t];a===null?delete e[n]:a!==void 0&&(e[n]=a)}}const Ul=new Set(["authorization","api-key"]);function On(e,...r){if(typeof process<"u"&&(In==null?void 0:In.DEBUG)==="true"){const t=r.map(n=>{if(!n)return n;if(n.headers){const i={...n,headers:{...n.headers}};for(const s in n.headers)Ul.has(s.toLowerCase())&&(i.headers[s]="REDACTED");return i}let a=null;for(const i in n)Ul.has(i.toLowerCase())&&(a??(a={...n}),a[i]="REDACTED");return a??n});console.log(`OpenAI:DEBUG:${e}`,...t)}}const zb=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const r=Math.random()*16|0;return(e==="x"?r:r&3|8).toString(16)}),$b=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Hb=e=>typeof(e==null?void 0:e.get)=="function",gi=(e,r)=>{var n;const t=r.toLowerCase();if(Hb(e)){const a=((n=r[0])==null?void 0:n.toUpperCase())+r.substring(1).replace(/([^\w])(\w)/g,(i,s,o)=>s+o.toUpperCase());for(const i of[r,t,r.toUpperCase(),a]){const s=e.get(i);if(s)return s}}for(const[a,i]of Object.entries(e))if(a.toLowerCase()===t)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${r} header, using the first entry.`),i[0]):i};function qs(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}class Fc extends Xh{constructor(r,t,n,a){super(r,t,n,a),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Nt extends Xh{constructor(r,t,n,a){super(r,t,n,a),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const r=this.nextPageInfo();if(!r)return null;if("params"in r)return r.params;const t=Object.fromEntries(r.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var n;const r=this.getPaginatedItems();if(!r.length)return null;const t=(n=r[r.length-1])==null?void 0:n.id;return t?{params:{after:t}}:null}}class Le{constructor(r){this._client=r}}let Jh=class extends Le{list(r,t={},n){return ut(t)?this.list(r,{},t):this._client.getAPIList(`/chat/completions/${r}/messages`,Wb,{query:t,...n})}},vs=class extends Le{constructor(){super(...arguments),this.messages=new Jh(this._client)}create(r,t){return this._client.post("/chat/completions",{body:r,...t,stream:r.stream??!1})}retrieve(r,t){return this._client.get(`/chat/completions/${r}`,t)}update(r,t,n){return this._client.post(`/chat/completions/${r}`,{body:t,...n})}list(r={},t){return ut(r)?this.list({},r):this._client.getAPIList("/chat/completions",ws,{query:r,...t})}del(r,t){return this._client.delete(`/chat/completions/${r}`,t)}};class ws extends Nt{}class Wb extends Nt{}vs.ChatCompletionsPage=ws;vs.Messages=Jh;let ys=class extends Le{constructor(){super(...arguments),this.completions=new vs(this._client)}};ys.Completions=vs;ys.ChatCompletionsPage=ws;class Zh extends Le{create(r,t){return this._client.post("/audio/speech",{body:r,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}class Qh extends Le{create(r,t){return this._client.post("/audio/transcriptions",$n({body:r,...t,stream:r.stream??!1,__metadata:{model:r.model}}))}}class ed extends Le{create(r,t){return this._client.post("/audio/translations",$n({body:r,...t,__metadata:{model:r.model}}))}}class Ga extends Le{constructor(){super(...arguments),this.transcriptions=new Qh(this._client),this.translations=new ed(this._client),this.speech=new Zh(this._client)}}Ga.Transcriptions=Qh;Ga.Translations=ed;Ga.Speech=Zh;class Rc extends Le{create(r,t){return this._client.post("/batches",{body:r,...t})}retrieve(r,t){return this._client.get(`/batches/${r}`,t)}list(r={},t){return ut(r)?this.list({},r):this._client.getAPIList("/batches",Ic,{query:r,...t})}cancel(r,t){return this._client.post(`/batches/${r}/cancel`,t)}}class Ic extends Nt{}Rc.BatchesPage=Ic;class Oc extends Le{create(r,t){return this._client.post("/assistants",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(r,t){return this._client.get(`/assistants/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(r,t,n){return this._client.post(`/assistants/${r}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(r={},t){return ut(r)?this.list({},r):this._client.getAPIList("/assistants",Dc,{query:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(r,t){return this._client.delete(`/assistants/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Dc extends Nt{}Oc.AssistantsPage=Dc;function zl(e){return typeof e.parse=="function"}const Dn=e=>(e==null?void 0:e.role)==="assistant",td=e=>(e==null?void 0:e.role)==="function",rd=e=>(e==null?void 0:e.role)==="tool";var er=function(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t},Ke=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},Lo,Ri,Ii,sa,oa,Oi,ca,br,la,as,is,Tn,nd;class Pc{constructor(){Lo.add(this),this.controller=new AbortController,Ri.set(this,void 0),Ii.set(this,()=>{}),sa.set(this,()=>{}),oa.set(this,void 0),Oi.set(this,()=>{}),ca.set(this,()=>{}),br.set(this,{}),la.set(this,!1),as.set(this,!1),is.set(this,!1),Tn.set(this,!1),er(this,Ri,new Promise((r,t)=>{er(this,Ii,r,"f"),er(this,sa,t,"f")}),"f"),er(this,oa,new Promise((r,t)=>{er(this,Oi,r,"f"),er(this,ca,t,"f")}),"f"),Ke(this,Ri,"f").catch(()=>{}),Ke(this,oa,"f").catch(()=>{})}_run(r){setTimeout(()=>{r().then(()=>{this._emitFinal(),this._emit("end")},Ke(this,Lo,"m",nd).bind(this))},0)}_connected(){this.ended||(Ke(this,Ii,"f").call(this),this._emit("connect"))}get ended(){return Ke(this,la,"f")}get errored(){return Ke(this,as,"f")}get aborted(){return Ke(this,is,"f")}abort(){this.controller.abort()}on(r,t){return(Ke(this,br,"f")[r]||(Ke(this,br,"f")[r]=[])).push({listener:t}),this}off(r,t){const n=Ke(this,br,"f")[r];if(!n)return this;const a=n.findIndex(i=>i.listener===t);return a>=0&&n.splice(a,1),this}once(r,t){return(Ke(this,br,"f")[r]||(Ke(this,br,"f")[r]=[])).push({listener:t,once:!0}),this}emitted(r){return new Promise((t,n)=>{er(this,Tn,!0,"f"),r!=="error"&&this.once("error",n),this.once(r,t)})}async done(){er(this,Tn,!0,"f"),await Ke(this,oa,"f")}_emit(r,...t){if(Ke(this,la,"f"))return;r==="end"&&(er(this,la,!0,"f"),Ke(this,Oi,"f").call(this));const n=Ke(this,br,"f")[r];if(n&&(Ke(this,br,"f")[r]=n.filter(a=>!a.once),n.forEach(({listener:a})=>a(...t))),r==="abort"){const a=t[0];!Ke(this,Tn,"f")&&!(n!=null&&n.length)&&Promise.reject(a),Ke(this,sa,"f").call(this,a),Ke(this,ca,"f").call(this,a),this._emit("end");return}if(r==="error"){const a=t[0];!Ke(this,Tn,"f")&&!(n!=null&&n.length)&&Promise.reject(a),Ke(this,sa,"f").call(this,a),Ke(this,ca,"f").call(this,a),this._emit("end")}}_emitFinal(){}}Ri=new WeakMap,Ii=new WeakMap,sa=new WeakMap,oa=new WeakMap,Oi=new WeakMap,ca=new WeakMap,br=new WeakMap,la=new WeakMap,as=new WeakMap,is=new WeakMap,Tn=new WeakMap,Lo=new WeakSet,nd=function(r){if(er(this,as,!0,"f"),r instanceof Error&&r.name==="AbortError"&&(r=new Yt),r instanceof Yt)return er(this,is,!0,"f"),this._emit("abort",r);if(r instanceof Se)return this._emit("error",r);if(r instanceof Error){const t=new Se(r.message);return t.cause=r,this._emit("error",t)}return this._emit("error",new Se(String(r)))};function Nc(e){return(e==null?void 0:e.$brand)==="auto-parseable-response-format"}function ja(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function Vb(e,r){return!r||!ad(r)?{...e,choices:e.choices.map(t=>({...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:Lc(e,r)}function Lc(e,r){const t=e.choices.map(n=>{var a;if(n.finish_reason==="length")throw new Uh;if(n.finish_reason==="content_filter")throw new zh;return{...n,message:{...n.message,...n.message.tool_calls?{tool_calls:((a=n.message.tool_calls)==null?void 0:a.map(i=>jb(r,i)))??void 0}:void 0,parsed:n.message.content&&!n.message.refusal?Gb(r,n.message.content):null}}});return{...e,choices:t}}function Gb(e,r){var t,n;return((t=e.response_format)==null?void 0:t.type)!=="json_schema"?null:((n=e.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(r):JSON.parse(r):null}function jb(e,r){var n;const t=(n=e.tools)==null?void 0:n.find(a=>{var i;return((i=a.function)==null?void 0:i.name)===r.function.name});return{...r,function:{...r.function,parsed_arguments:ja(t)?t.$parseRaw(r.function.arguments):t!=null&&t.function.strict?JSON.parse(r.function.arguments):null}}}function Xb(e,r){var n;if(!e)return!1;const t=(n=e.tools)==null?void 0:n.find(a=>{var i;return((i=a.function)==null?void 0:i.name)===r.function.name});return ja(t)||(t==null?void 0:t.function.strict)||!1}function ad(e){var r;return Nc(e.response_format)?!0:((r=e.tools)==null?void 0:r.some(t=>ja(t)||t.type==="function"&&t.function.strict===!0))??!1}function Yb(e){for(const r of e??[]){if(r.type!=="function")throw new Se(`Currently only \`function\` tool types support auto-parsing; Received \`${r.type}\``);if(r.function.strict!==!0)throw new Se(`The \`${r.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Ot=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},vt,Mo,ss,Bo,Uo,zo,id,$o;const $l=10;class sd extends Pc{constructor(){super(...arguments),vt.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(r){var n;this._chatCompletions.push(r),this._emit("chatCompletion",r);const t=(n=r.choices[0])==null?void 0:n.message;return t&&this._addMessage(t),r}_addMessage(r,t=!0){if("content"in r||(r.content=null),this.messages.push(r),t){if(this._emit("message",r),(td(r)||rd(r))&&r.content)this._emit("functionCallResult",r.content);else if(Dn(r)&&r.function_call)this._emit("functionCall",r.function_call);else if(Dn(r)&&r.tool_calls)for(const n of r.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();const r=this._chatCompletions[this._chatCompletions.length-1];if(!r)throw new Se("stream ended without producing a ChatCompletion");return r}async finalContent(){return await this.done(),Ot(this,vt,"m",Mo).call(this)}async finalMessage(){return await this.done(),Ot(this,vt,"m",ss).call(this)}async finalFunctionCall(){return await this.done(),Ot(this,vt,"m",Bo).call(this)}async finalFunctionCallResult(){return await this.done(),Ot(this,vt,"m",Uo).call(this)}async totalUsage(){return await this.done(),Ot(this,vt,"m",zo).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const r=this._chatCompletions[this._chatCompletions.length-1];r&&this._emit("finalChatCompletion",r);const t=Ot(this,vt,"m",ss).call(this);t&&this._emit("finalMessage",t);const n=Ot(this,vt,"m",Mo).call(this);n&&this._emit("finalContent",n);const a=Ot(this,vt,"m",Bo).call(this);a&&this._emit("finalFunctionCall",a);const i=Ot(this,vt,"m",Uo).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(s=>s.usage)&&this._emit("totalUsage",Ot(this,vt,"m",zo).call(this))}async _createChatCompletion(r,t,n){const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Ot(this,vt,"m",id).call(this,t);const i=await r.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Lc(i,t))}async _runChatCompletion(r,t,n){for(const a of t.messages)this._addMessage(a,!1);return await this._createChatCompletion(r,t,n)}async _runFunctions(r,t,n){var d;const a="function",{function_call:i="auto",stream:s,...o}=t,c=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:l=$l}=n||{},f={};for(const h of t.functions)f[h.name||h.function.name]=h;const u=t.functions.map(h=>({name:h.name||h.function.name,parameters:h.parameters,description:h.description}));for(const h of t.messages)this._addMessage(h,!1);for(let h=0;h<l;++h){const p=(d=(await this._createChatCompletion(r,{...o,function_call:i,functions:u,messages:[...this.messages]},n)).choices[0])==null?void 0:d.message;if(!p)throw new Se("missing message in ChatCompletion response");if(!p.function_call)return;const{name:m,arguments:g}=p.function_call,w=f[m];if(w){if(c&&c!==m){const F=`Invalid function_call: ${JSON.stringify(m)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,name:m,content:F});continue}}else{const F=`Invalid function_call: ${JSON.stringify(m)}. Available options are: ${u.map(E=>JSON.stringify(E.name)).join(", ")}. Please try again`;this._addMessage({role:a,name:m,content:F});continue}let v;try{v=zl(w)?await w.parse(g):g}catch(F){this._addMessage({role:a,name:m,content:F instanceof Error?F.message:String(F)});continue}const k=await w.function(v,this),A=Ot(this,vt,"m",$o).call(this,k);if(this._addMessage({role:a,name:m,content:A}),c)return}}async _runTools(r,t,n){var h,x,p;const a="tool",{tool_choice:i="auto",stream:s,...o}=t,c=typeof i!="string"&&((h=i==null?void 0:i.function)==null?void 0:h.name),{maxChatCompletions:l=$l}=n||{},f=t.tools.map(m=>{if(ja(m)){if(!m.$callback)throw new Se("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:m.$callback,name:m.function.name,description:m.function.description||"",parameters:m.function.parameters,parse:m.$parseRaw,strict:!0}}}return m}),u={};for(const m of f)m.type==="function"&&(u[m.function.name||m.function.function.name]=m.function);const d="tools"in t?f.map(m=>m.type==="function"?{type:"function",function:{name:m.function.name||m.function.function.name,parameters:m.function.parameters,description:m.function.description,strict:m.function.strict}}:m):void 0;for(const m of t.messages)this._addMessage(m,!1);for(let m=0;m<l;++m){const w=(x=(await this._createChatCompletion(r,{...o,tool_choice:i,tools:d,messages:[...this.messages]},n)).choices[0])==null?void 0:x.message;if(!w)throw new Se("missing message in ChatCompletion response");if(!((p=w.tool_calls)!=null&&p.length))return;for(const v of w.tool_calls){if(v.type!=="function")continue;const k=v.id,{name:A,arguments:F}=v.function,E=u[A];if(E){if(c&&c!==A){const H=`Invalid tool_call: ${JSON.stringify(A)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,tool_call_id:k,content:H});continue}}else{const H=`Invalid tool_call: ${JSON.stringify(A)}. Available options are: ${Object.keys(u).map(b=>JSON.stringify(b)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:k,content:H});continue}let z;try{z=zl(E)?await E.parse(F):F}catch(H){const b=H instanceof Error?H.message:String(H);this._addMessage({role:a,tool_call_id:k,content:b});continue}const C=await E.function(z,this),G=Ot(this,vt,"m",$o).call(this,C);if(this._addMessage({role:a,tool_call_id:k,content:G}),c)return}}}}vt=new WeakSet,Mo=function(){return Ot(this,vt,"m",ss).call(this).content??null},ss=function(){let r=this.messages.length;for(;r-- >0;){const t=this.messages[r];if(Dn(t)){const{function_call:n,...a}=t,i={...a,content:t.content??null,refusal:t.refusal??null};return n&&(i.function_call=n),i}}throw new Se("stream ended without producing a ChatCompletionMessage with role=assistant")},Bo=function(){var r,t;for(let n=this.messages.length-1;n>=0;n--){const a=this.messages[n];if(Dn(a)&&(a!=null&&a.function_call))return a.function_call;if(Dn(a)&&((r=a==null?void 0:a.tool_calls)!=null&&r.length))return(t=a.tool_calls.at(-1))==null?void 0:t.function}},Uo=function(){for(let r=this.messages.length-1;r>=0;r--){const t=this.messages[r];if(td(t)&&t.content!=null||rd(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var a;return n.role==="assistant"&&((a=n.tool_calls)==null?void 0:a.some(i=>i.type==="function"&&i.id===t.tool_call_id))}))return t.content}},zo=function(){const r={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(r.completion_tokens+=t.completion_tokens,r.prompt_tokens+=t.prompt_tokens,r.total_tokens+=t.total_tokens);return r},id=function(r){if(r.n!=null&&r.n>1)throw new Se("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},$o=function(r){return typeof r=="string"?r:r===void 0?"undefined":JSON.stringify(r)};class Pa extends sd{static runFunctions(r,t,n){const a=new Pa,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(r,t,i)),a}static runTools(r,t,n){const a=new Pa,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(r,t,i)),a}_addMessage(r,t=!0){super._addMessage(r,t),Dn(r)&&r.content&&this._emit("content",r.content)}}const od=1,cd=2,ld=4,fd=8,ud=16,hd=32,dd=64,pd=128,xd=256,md=pd|xd,gd=ud|hd|md|dd,_d=od|cd|gd,vd=ld|fd,Kb=_d|vd,ct={STR:od,NUM:cd,ARR:ld,OBJ:fd,NULL:ud,BOOL:hd,NAN:dd,INFINITY:pd,MINUS_INFINITY:xd,INF:md,SPECIAL:gd,ATOM:_d,COLLECTION:vd,ALL:Kb};class qb extends Error{}class Jb extends Error{}function Zb(e,r=ct.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return Qb(e.trim(),r)}const Qb=(e,r)=>{const t=e.length;let n=0;const a=d=>{throw new qb(`${d} at position ${n}`)},i=d=>{throw new Jb(`${d} at position ${n}`)},s=()=>(u(),n>=t&&a("Unexpected end of input"),e[n]==='"'?o():e[n]==="{"?c():e[n]==="["?l():e.substring(n,n+4)==="null"||ct.NULL&r&&t-n<4&&"null".startsWith(e.substring(n))?(n+=4,null):e.substring(n,n+4)==="true"||ct.BOOL&r&&t-n<4&&"true".startsWith(e.substring(n))?(n+=4,!0):e.substring(n,n+5)==="false"||ct.BOOL&r&&t-n<5&&"false".startsWith(e.substring(n))?(n+=5,!1):e.substring(n,n+8)==="Infinity"||ct.INFINITY&r&&t-n<8&&"Infinity".startsWith(e.substring(n))?(n+=8,1/0):e.substring(n,n+9)==="-Infinity"||ct.MINUS_INFINITY&r&&1<t-n&&t-n<9&&"-Infinity".startsWith(e.substring(n))?(n+=9,-1/0):e.substring(n,n+3)==="NaN"||ct.NAN&r&&t-n<3&&"NaN".startsWith(e.substring(n))?(n+=3,NaN):f()),o=()=>{const d=n;let h=!1;for(n++;n<t&&(e[n]!=='"'||h&&e[n-1]==="\\");)h=e[n]==="\\"?!h:!1,n++;if(e.charAt(n)=='"')try{return JSON.parse(e.substring(d,++n-Number(h)))}catch(x){i(String(x))}else if(ct.STR&r)try{return JSON.parse(e.substring(d,n-Number(h))+'"')}catch{return JSON.parse(e.substring(d,e.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},c=()=>{n++,u();const d={};try{for(;e[n]!=="}";){if(u(),n>=t&&ct.OBJ&r)return d;const h=o();u(),n++;try{const x=s();Object.defineProperty(d,h,{value:x,writable:!0,enumerable:!0,configurable:!0})}catch(x){if(ct.OBJ&r)return d;throw x}u(),e[n]===","&&n++}}catch{if(ct.OBJ&r)return d;a("Expected '}' at end of object")}return n++,d},l=()=>{n++;const d=[];try{for(;e[n]!=="]";)d.push(s()),u(),e[n]===","&&n++}catch{if(ct.ARR&r)return d;a("Expected ']' at end of array")}return n++,d},f=()=>{if(n===0){e==="-"&&ct.NUM&r&&a("Not sure what '-' is");try{return JSON.parse(e)}catch(h){if(ct.NUM&r)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}i(String(h))}}const d=n;for(e[n]==="-"&&n++;e[n]&&!",]}".includes(e[n]);)n++;n==t&&!(ct.NUM&r)&&a("Unterminated number literal");try{return JSON.parse(e.substring(d,n))}catch{e.substring(d,n)==="-"&&ct.NUM&r&&a("Not sure what '-' is");try{return JSON.parse(e.substring(d,e.lastIndexOf("e")))}catch(x){i(String(x))}}},u=()=>{for(;n<t&&` 
\r	`.includes(e[n]);)n++};return s()},Hl=e=>Zb(e,ct.ALL^ct.NUM);var _n=function(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t},We=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},rt,Tr,vn,Pr,Js,_i,Zs,Qs,eo,vi,to,Wl;class Na extends sd{constructor(r){super(),rt.add(this),Tr.set(this,void 0),vn.set(this,void 0),Pr.set(this,void 0),_n(this,Tr,r,"f"),_n(this,vn,[],"f")}get currentChatCompletionSnapshot(){return We(this,Pr,"f")}static fromReadableStream(r){const t=new Na(null);return t._run(()=>t._fromReadableStream(r)),t}static createChatCompletion(r,t,n){const a=new Na(t);return a._run(()=>a._runChatCompletion(r,{...t,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(r,t,n){var s;super._createChatCompletion;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),We(this,rt,"m",Js).call(this);const i=await r.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of i)We(this,rt,"m",Zs).call(this,o);if((s=i.controller.signal)!=null&&s.aborted)throw new Yt;return this._addChatCompletion(We(this,rt,"m",vi).call(this))}async _fromReadableStream(r,t){var s;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),We(this,rt,"m",Js).call(this),this._connected();const a=xr.fromReadableStream(r,this.controller);let i;for await(const o of a)i&&i!==o.id&&this._addChatCompletion(We(this,rt,"m",vi).call(this)),We(this,rt,"m",Zs).call(this,o),i=o.id;if((s=a.controller.signal)!=null&&s.aborted)throw new Yt;return this._addChatCompletion(We(this,rt,"m",vi).call(this))}[(Tr=new WeakMap,vn=new WeakMap,Pr=new WeakMap,rt=new WeakSet,Js=function(){this.ended||_n(this,Pr,void 0,"f")},_i=function(t){let n=We(this,vn,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},We(this,vn,"f")[t.index]=n,n)},Zs=function(t){var a,i,s,o,c,l,f,u,d,h,x,p,m,g,w;if(this.ended)return;const n=We(this,rt,"m",Wl).call(this,t);this._emit("chunk",t,n);for(const v of t.choices){const k=n.choices[v.index];v.delta.content!=null&&((a=k.message)==null?void 0:a.role)==="assistant"&&((i=k.message)!=null&&i.content)&&(this._emit("content",v.delta.content,k.message.content),this._emit("content.delta",{delta:v.delta.content,snapshot:k.message.content,parsed:k.message.parsed})),v.delta.refusal!=null&&((s=k.message)==null?void 0:s.role)==="assistant"&&((o=k.message)!=null&&o.refusal)&&this._emit("refusal.delta",{delta:v.delta.refusal,snapshot:k.message.refusal}),((c=v.logprobs)==null?void 0:c.content)!=null&&((l=k.message)==null?void 0:l.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(f=v.logprobs)==null?void 0:f.content,snapshot:((u=k.logprobs)==null?void 0:u.content)??[]}),((d=v.logprobs)==null?void 0:d.refusal)!=null&&((h=k.message)==null?void 0:h.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(x=v.logprobs)==null?void 0:x.refusal,snapshot:((p=k.logprobs)==null?void 0:p.refusal)??[]});const A=We(this,rt,"m",_i).call(this,k);k.finish_reason&&(We(this,rt,"m",eo).call(this,k),A.current_tool_call_index!=null&&We(this,rt,"m",Qs).call(this,k,A.current_tool_call_index));for(const F of v.delta.tool_calls??[])A.current_tool_call_index!==F.index&&(We(this,rt,"m",eo).call(this,k),A.current_tool_call_index!=null&&We(this,rt,"m",Qs).call(this,k,A.current_tool_call_index)),A.current_tool_call_index=F.index;for(const F of v.delta.tool_calls??[]){const E=(m=k.message.tool_calls)==null?void 0:m[F.index];E!=null&&E.type&&((E==null?void 0:E.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(g=E.function)==null?void 0:g.name,index:F.index,arguments:E.function.arguments,parsed_arguments:E.function.parsed_arguments,arguments_delta:((w=F.function)==null?void 0:w.arguments)??""}):(E==null||E.type,void 0))}}},Qs=function(t,n){var s,o,c;if(We(this,rt,"m",_i).call(this,t).done_tool_calls.has(n))return;const i=(s=t.message.tool_calls)==null?void 0:s[n];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const l=(c=(o=We(this,Tr,"f"))==null?void 0:o.tools)==null?void 0:c.find(f=>f.type==="function"&&f.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:n,arguments:i.function.arguments,parsed_arguments:ja(l)?l.$parseRaw(i.function.arguments):l!=null&&l.function.strict?JSON.parse(i.function.arguments):null})}else i.type},eo=function(t){var a,i;const n=We(this,rt,"m",_i).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const s=We(this,rt,"m",to).call(this);this._emit("content.done",{content:t.message.content,parsed:s?s.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(a=t.logprobs)!=null&&a.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(i=t.logprobs)!=null&&i.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},vi=function(){if(this.ended)throw new Se("stream has ended, this shouldn't happen");const t=We(this,Pr,"f");if(!t)throw new Se("request ended without sending any chunks");return _n(this,Pr,void 0,"f"),_n(this,vn,[],"f"),eA(t,We(this,Tr,"f"))},to=function(){var n;const t=(n=We(this,Tr,"f"))==null?void 0:n.response_format;return Nc(t)?t:null},Wl=function(t){var n,a,i,s;let o=We(this,Pr,"f");const{choices:c,...l}=t;o?Object.assign(o,l):o=_n(this,Pr,{...l,choices:[]},"f");for(const{delta:f,finish_reason:u,index:d,logprobs:h=null,...x}of t.choices){let p=o.choices[d];if(p||(p=o.choices[d]={finish_reason:u,index:d,message:{},logprobs:h,...x}),h)if(!p.logprobs)p.logprobs=Object.assign({},h);else{const{content:F,refusal:E,...z}=h;Object.assign(p.logprobs,z),F&&((n=p.logprobs).content??(n.content=[]),p.logprobs.content.push(...F)),E&&((a=p.logprobs).refusal??(a.refusal=[]),p.logprobs.refusal.push(...E))}if(u&&(p.finish_reason=u,We(this,Tr,"f")&&ad(We(this,Tr,"f")))){if(u==="length")throw new Uh;if(u==="content_filter")throw new zh}if(Object.assign(p,x),!f)continue;const{content:m,refusal:g,function_call:w,role:v,tool_calls:k,...A}=f;if(Object.assign(p.message,A),g&&(p.message.refusal=(p.message.refusal||"")+g),v&&(p.message.role=v),w&&(p.message.function_call?(w.name&&(p.message.function_call.name=w.name),w.arguments&&((i=p.message.function_call).arguments??(i.arguments=""),p.message.function_call.arguments+=w.arguments)):p.message.function_call=w),m&&(p.message.content=(p.message.content||"")+m,!p.message.refusal&&We(this,rt,"m",to).call(this)&&(p.message.parsed=Hl(p.message.content))),k){p.message.tool_calls||(p.message.tool_calls=[]);for(const{index:F,id:E,type:z,function:C,...G}of k){const H=(s=p.message.tool_calls)[F]??(s[F]={});Object.assign(H,G),E&&(H.id=E),z&&(H.type=z),C&&(H.function??(H.function={name:C.name??"",arguments:""})),C!=null&&C.name&&(H.function.name=C.name),C!=null&&C.arguments&&(H.function.arguments+=C.arguments,Xb(We(this,Tr,"f"),H)&&(H.function.parsed_arguments=Hl(H.function.arguments)))}}}return o},Symbol.asyncIterator)](){const r=[],t=[];let n=!1;return this.on("chunk",a=>{const i=t.shift();i?i.resolve(a):r.push(a)}),this.on("end",()=>{n=!0;for(const a of t)a.resolve(void 0);t.length=0}),this.on("abort",a=>{n=!0;for(const i of t)i.reject(a);t.length=0}),this.on("error",a=>{n=!0;for(const i of t)i.reject(a);t.length=0}),{next:async()=>r.length?{value:r.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,s)=>t.push({resolve:i,reject:s})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new xr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function eA(e,r){const{id:t,choices:n,created:a,model:i,system_fingerprint:s,...o}=e,c={...o,id:t,choices:n.map(({message:l,finish_reason:f,index:u,logprobs:d,...h})=>{if(!f)throw new Se(`missing finish_reason for choice ${u}`);const{content:x=null,function_call:p,tool_calls:m,...g}=l,w=l.role;if(!w)throw new Se(`missing role for choice ${u}`);if(p){const{arguments:v,name:k}=p;if(v==null)throw new Se(`missing function_call.arguments for choice ${u}`);if(!k)throw new Se(`missing function_call.name for choice ${u}`);return{...h,message:{content:x,function_call:{arguments:v,name:k},role:w,refusal:l.refusal??null},finish_reason:f,index:u,logprobs:d}}return m?{...h,index:u,finish_reason:f,logprobs:d,message:{...g,role:w,content:x,refusal:l.refusal??null,tool_calls:m.map((v,k)=>{const{function:A,type:F,id:E,...z}=v,{arguments:C,name:G,...H}=A||{};if(E==null)throw new Se(`missing choices[${u}].tool_calls[${k}].id
${wi(e)}`);if(F==null)throw new Se(`missing choices[${u}].tool_calls[${k}].type
${wi(e)}`);if(G==null)throw new Se(`missing choices[${u}].tool_calls[${k}].function.name
${wi(e)}`);if(C==null)throw new Se(`missing choices[${u}].tool_calls[${k}].function.arguments
${wi(e)}`);return{...z,id:E,type:F,function:{...H,name:G,arguments:C}}})}}:{...h,message:{...g,content:x,role:w,refusal:l.refusal??null},finish_reason:f,index:u,logprobs:d}}),created:a,model:i,object:"chat.completion",...s?{system_fingerprint:s}:{}};return Vb(c,r)}function wi(e){return JSON.stringify(e)}class Pn extends Na{static fromReadableStream(r){const t=new Pn(null);return t._run(()=>t._fromReadableStream(r)),t}static runFunctions(r,t,n){const a=new Pn(null),i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(r,t,i)),a}static runTools(r,t,n){const a=new Pn(t),i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(r,t,i)),a}}let wd=class extends Le{parse(r,t){return Yb(r.tools),this._client.chat.completions.create(r,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>Lc(n,r))}runFunctions(r,t){return r.stream?Pn.runFunctions(this._client,r,t):Pa.runFunctions(this._client,r,t)}runTools(r,t){return r.stream?Pn.runTools(this._client,r,t):Pa.runTools(this._client,r,t)}stream(r,t){return Na.createChatCompletion(this._client,r,t)}};class Ho extends Le{constructor(){super(...arguments),this.completions=new wd(this._client)}}(function(e){e.Completions=wd})(Ho||(Ho={}));class yd extends Le{create(r,t){return this._client.post("/realtime/sessions",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class kd extends Le{create(r,t){return this._client.post("/realtime/transcription_sessions",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class ks extends Le{constructor(){super(...arguments),this.sessions=new yd(this._client),this.transcriptionSessions=new kd(this._client)}}ks.Sessions=yd;ks.TranscriptionSessions=kd;var Te=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},Lt=function(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t},ht,Wo,dr,Di,tr,en,An,Jr,os,Bt,Pi,Ni,ka,fa,ua,Vl,Gl,jl,Xl,Yl,Kl,ql;class sr extends Pc{constructor(){super(...arguments),ht.add(this),Wo.set(this,[]),dr.set(this,{}),Di.set(this,{}),tr.set(this,void 0),en.set(this,void 0),An.set(this,void 0),Jr.set(this,void 0),os.set(this,void 0),Bt.set(this,void 0),Pi.set(this,void 0),Ni.set(this,void 0),ka.set(this,void 0)}[(Wo=new WeakMap,dr=new WeakMap,Di=new WeakMap,tr=new WeakMap,en=new WeakMap,An=new WeakMap,Jr=new WeakMap,os=new WeakMap,Bt=new WeakMap,Pi=new WeakMap,Ni=new WeakMap,ka=new WeakMap,ht=new WeakSet,Symbol.asyncIterator)](){const r=[],t=[];let n=!1;return this.on("event",a=>{const i=t.shift();i?i.resolve(a):r.push(a)}),this.on("end",()=>{n=!0;for(const a of t)a.resolve(void 0);t.length=0}),this.on("abort",a=>{n=!0;for(const i of t)i.reject(a);t.length=0}),this.on("error",a=>{n=!0;for(const i of t)i.reject(a);t.length=0}),{next:async()=>r.length?{value:r.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,s)=>t.push({resolve:i,reject:s})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(r){const t=new sr;return t._run(()=>t._fromReadableStream(r)),t}async _fromReadableStream(r,t){var i;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=xr.fromReadableStream(r,this.controller);for await(const s of a)Te(this,ht,"m",fa).call(this,s);if((i=a.controller.signal)!=null&&i.aborted)throw new Yt;return this._addRun(Te(this,ht,"m",ua).call(this))}toReadableStream(){return new xr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(r,t,n,a,i){const s=new sr;return s._run(()=>s._runToolAssistantStream(r,t,n,a,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createToolAssistantStream(r,t,n,a,i){var l;const s=i==null?void 0:i.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const o={...a,stream:!0},c=await r.submitToolOutputs(t,n,o,{...i,signal:this.controller.signal});this._connected();for await(const f of c)Te(this,ht,"m",fa).call(this,f);if((l=c.controller.signal)!=null&&l.aborted)throw new Yt;return this._addRun(Te(this,ht,"m",ua).call(this))}static createThreadAssistantStream(r,t,n){const a=new sr;return a._run(()=>a._threadAssistantStream(r,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(r,t,n,a){const i=new sr;return i._run(()=>i._runAssistantStream(r,t,n,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return Te(this,Pi,"f")}currentRun(){return Te(this,Ni,"f")}currentMessageSnapshot(){return Te(this,tr,"f")}currentRunStepSnapshot(){return Te(this,ka,"f")}async finalRunSteps(){return await this.done(),Object.values(Te(this,dr,"f"))}async finalMessages(){return await this.done(),Object.values(Te(this,Di,"f"))}async finalRun(){if(await this.done(),!Te(this,en,"f"))throw Error("Final run was not received.");return Te(this,en,"f")}async _createThreadAssistantStream(r,t,n){var o;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...t,stream:!0},s=await r.createAndRun(i,{...n,signal:this.controller.signal});this._connected();for await(const c of s)Te(this,ht,"m",fa).call(this,c);if((o=s.controller.signal)!=null&&o.aborted)throw new Yt;return this._addRun(Te(this,ht,"m",ua).call(this))}async _createAssistantStream(r,t,n,a){var c;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const s={...n,stream:!0},o=await r.create(t,s,{...a,signal:this.controller.signal});this._connected();for await(const l of o)Te(this,ht,"m",fa).call(this,l);if((c=o.controller.signal)!=null&&c.aborted)throw new Yt;return this._addRun(Te(this,ht,"m",ua).call(this))}static accumulateDelta(r,t){for(const[n,a]of Object.entries(t)){if(!r.hasOwnProperty(n)){r[n]=a;continue}let i=r[n];if(i==null){r[n]=a;continue}if(n==="index"||n==="type"){r[n]=a;continue}if(typeof i=="string"&&typeof a=="string")i+=a;else if(typeof i=="number"&&typeof a=="number")i+=a;else if(qs(i)&&qs(a))i=this.accumulateDelta(i,a);else if(Array.isArray(i)&&Array.isArray(a)){if(i.every(s=>typeof s=="string"||typeof s=="number")){i.push(...a);continue}for(const s of a){if(!qs(s))throw new Error(`Expected array delta entry to be an object but got: ${s}`);const o=s.index;if(o==null)throw console.error(s),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const c=i[o];c==null?i.push(s):i[o]=this.accumulateDelta(c,s)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${a}, accValue: ${i}`);r[n]=i}return r}_addRun(r){return r}async _threadAssistantStream(r,t,n){return await this._createThreadAssistantStream(t,r,n)}async _runAssistantStream(r,t,n,a){return await this._createAssistantStream(t,r,n,a)}async _runToolAssistantStream(r,t,n,a,i){return await this._createToolAssistantStream(n,r,t,a,i)}}fa=function(r){if(!this.ended)switch(Lt(this,Pi,r,"f"),Te(this,ht,"m",jl).call(this,r),r.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Te(this,ht,"m",ql).call(this,r);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Te(this,ht,"m",Gl).call(this,r);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Te(this,ht,"m",Vl).call(this,r);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},ua=function(){if(this.ended)throw new Se("stream has ended, this shouldn't happen");if(!Te(this,en,"f"))throw Error("Final run has not been received");return Te(this,en,"f")},Vl=function(r){const[t,n]=Te(this,ht,"m",Yl).call(this,r,Te(this,tr,"f"));Lt(this,tr,t,"f"),Te(this,Di,"f")[t.id]=t;for(const a of n){const i=t.content[a.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(r.event){case"thread.message.created":this._emit("messageCreated",r.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",r.data.delta,t),r.data.delta.content)for(const a of r.data.delta.content){if(a.type=="text"&&a.text){let i=a.text,s=t.content[a.index];if(s&&s.type=="text")this._emit("textDelta",i,s.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=Te(this,An,"f")){if(Te(this,Jr,"f"))switch(Te(this,Jr,"f").type){case"text":this._emit("textDone",Te(this,Jr,"f").text,Te(this,tr,"f"));break;case"image_file":this._emit("imageFileDone",Te(this,Jr,"f").image_file,Te(this,tr,"f"));break}Lt(this,An,a.index,"f")}Lt(this,Jr,t.content[a.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(Te(this,An,"f")!==void 0){const a=r.data.content[Te(this,An,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,Te(this,tr,"f"));break;case"text":this._emit("textDone",a.text,Te(this,tr,"f"));break}}Te(this,tr,"f")&&this._emit("messageDone",r.data),Lt(this,tr,void 0,"f")}},Gl=function(r){const t=Te(this,ht,"m",Xl).call(this,r);switch(Lt(this,ka,t,"f"),r.event){case"thread.run.step.created":this._emit("runStepCreated",r.data);break;case"thread.run.step.delta":const n=r.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const i of n.step_details.tool_calls)i.index==Te(this,os,"f")?this._emit("toolCallDelta",i,t.step_details.tool_calls[i.index]):(Te(this,Bt,"f")&&this._emit("toolCallDone",Te(this,Bt,"f")),Lt(this,os,i.index,"f"),Lt(this,Bt,t.step_details.tool_calls[i.index],"f"),Te(this,Bt,"f")&&this._emit("toolCallCreated",Te(this,Bt,"f")));this._emit("runStepDelta",r.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Lt(this,ka,void 0,"f"),r.data.step_details.type=="tool_calls"&&Te(this,Bt,"f")&&(this._emit("toolCallDone",Te(this,Bt,"f")),Lt(this,Bt,void 0,"f")),this._emit("runStepDone",r.data,t);break}},jl=function(r){Te(this,Wo,"f").push(r),this._emit("event",r)},Xl=function(r){switch(r.event){case"thread.run.step.created":return Te(this,dr,"f")[r.data.id]=r.data,r.data;case"thread.run.step.delta":let t=Te(this,dr,"f")[r.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=r.data;if(n.delta){const a=sr.accumulateDelta(t,n.delta);Te(this,dr,"f")[r.data.id]=a}return Te(this,dr,"f")[r.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Te(this,dr,"f")[r.data.id]=r.data;break}if(Te(this,dr,"f")[r.data.id])return Te(this,dr,"f")[r.data.id];throw new Error("No snapshot available")},Yl=function(r,t){let n=[];switch(r.event){case"thread.message.created":return[r.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=r.data;if(a.delta.content)for(const i of a.delta.content)if(i.index in t.content){let s=t.content[i.index];t.content[i.index]=Te(this,ht,"m",Kl).call(this,i,s)}else t.content[i.index]=i,n.push(i);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Kl=function(r,t){return sr.accumulateDelta(t,r)},ql=function(r){switch(Lt(this,Ni,r.data,"f"),r.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Lt(this,en,r.data,"f"),Te(this,Bt,"f")&&(this._emit("toolCallDone",Te(this,Bt,"f")),Lt(this,Bt,void 0,"f"));break}};class Mc extends Le{create(r,t,n){return this._client.post(`/threads/${r}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(r,t,n){return this._client.get(`/threads/${r}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(r,t,n,a){return this._client.post(`/threads/${r}/messages/${t}`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(r,t={},n){return ut(t)?this.list(r,{},t):this._client.getAPIList(`/threads/${r}/messages`,Bc,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(r,t,n){return this._client.delete(`/threads/${r}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Bc extends Nt{}Mc.MessagesPage=Bc;class Uc extends Le{retrieve(r,t,n,a={},i){return ut(a)?this.retrieve(r,t,n,{},a):this._client.get(`/threads/${r}/runs/${t}/steps/${n}`,{query:a,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(r,t,n={},a){return ut(n)?this.list(r,t,{},n):this._client.getAPIList(`/threads/${r}/runs/${t}/steps`,zc,{query:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class zc extends Nt{}Uc.RunStepsPage=zc;class Xa extends Le{constructor(){super(...arguments),this.steps=new Uc(this._client)}create(r,t,n){const{include:a,...i}=t;return this._client.post(`/threads/${r}/runs`,{query:{include:a},body:i,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}retrieve(r,t,n){return this._client.get(`/threads/${r}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(r,t,n,a){return this._client.post(`/threads/${r}/runs/${t}`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(r,t={},n){return ut(t)?this.list(r,{},t):this._client.getAPIList(`/threads/${r}/runs`,$c,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(r,t,n){return this._client.post(`/threads/${r}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(r,t,n){const a=await this.create(r,t,n);return await this.poll(r,a.id,n)}createAndStream(r,t,n){return sr.createAssistantStream(r,this._client.beta.threads.runs,t,n)}async poll(r,t,n){const a={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:i,response:s}=await this.retrieve(r,t,{...n,headers:{...n==null?void 0:n.headers,...a}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const c=s.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(o=l)}}await Va(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(r,t,n){return sr.createAssistantStream(r,this._client.beta.threads.runs,t,n)}submitToolOutputs(r,t,n,a){return this._client.post(`/threads/${r}/runs/${t}/submit_tool_outputs`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(r,t,n,a){const i=await this.submitToolOutputs(r,t,n,a);return await this.poll(r,i.id,a)}submitToolOutputsStream(r,t,n,a){return sr.createToolAssistantStream(r,t,this._client.beta.threads.runs,n,a)}}class $c extends Nt{}Xa.RunsPage=$c;Xa.Steps=Uc;Xa.RunStepsPage=zc;class jn extends Le{constructor(){super(...arguments),this.runs=new Xa(this._client),this.messages=new Mc(this._client)}create(r={},t){return ut(r)?this.create({},r):this._client.post("/threads",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(r,t){return this._client.get(`/threads/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(r,t,n){return this._client.post(`/threads/${r}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(r,t){return this._client.delete(`/threads/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(r,t){return this._client.post("/threads/runs",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:r.stream??!1})}async createAndRunPoll(r,t){const n=await this.createAndRun(r,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(r,t){return sr.createThreadAssistantStream(r,this._client.beta.threads,t)}}jn.Runs=Xa;jn.RunsPage=$c;jn.Messages=Mc;jn.MessagesPage=Bc;class Xn extends Le{constructor(){super(...arguments),this.realtime=new ks(this._client),this.chat=new Ho(this._client),this.assistants=new Oc(this._client),this.threads=new jn(this._client)}}Xn.Realtime=ks;Xn.Assistants=Oc;Xn.AssistantsPage=Dc;Xn.Threads=jn;class Ed extends Le{create(r,t){return this._client.post("/completions",{body:r,...t,stream:r.stream??!1})}}class Td extends Le{create(r,t){return this._client.post("/embeddings",{body:r,...t})}}let Hc=class extends Le{create(r,t){return this._client.post("/files",$n({body:r,...t}))}retrieve(r,t){return this._client.get(`/files/${r}`,t)}list(r={},t){return ut(r)?this.list({},r):this._client.getAPIList("/files",Wc,{query:r,...t})}del(r,t){return this._client.delete(`/files/${r}`,t)}content(r,t){return this._client.get(`/files/${r}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(r,t){return this._client.get(`/files/${r}/content`,t)}async waitForProcessing(r,{pollInterval:t=5e3,maxWait:n=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),i=Date.now();let s=await this.retrieve(r);for(;!s.status||!a.has(s.status);)if(await Va(t),s=await this.retrieve(r),Date.now()-i>n)throw new Cc({message:`Giving up on waiting for file ${r} to finish processing after ${n} milliseconds.`});return s}};class Wc extends Nt{}Hc.FileObjectsPage=Wc;class Vc extends Le{list(r,t={},n){return ut(t)?this.list(r,{},t):this._client.getAPIList(`/fine_tuning/jobs/${r}/checkpoints`,Gc,{query:t,...n})}}class Gc extends Nt{}Vc.FineTuningJobCheckpointsPage=Gc;class Yn extends Le{constructor(){super(...arguments),this.checkpoints=new Vc(this._client)}create(r,t){return this._client.post("/fine_tuning/jobs",{body:r,...t})}retrieve(r,t){return this._client.get(`/fine_tuning/jobs/${r}`,t)}list(r={},t){return ut(r)?this.list({},r):this._client.getAPIList("/fine_tuning/jobs",jc,{query:r,...t})}cancel(r,t){return this._client.post(`/fine_tuning/jobs/${r}/cancel`,t)}listEvents(r,t={},n){return ut(t)?this.listEvents(r,{},t):this._client.getAPIList(`/fine_tuning/jobs/${r}/events`,Xc,{query:t,...n})}}class jc extends Nt{}class Xc extends Nt{}Yn.FineTuningJobsPage=jc;Yn.FineTuningJobEventsPage=Xc;Yn.Checkpoints=Vc;Yn.FineTuningJobCheckpointsPage=Gc;class Ya extends Le{constructor(){super(...arguments),this.jobs=new Yn(this._client)}}Ya.Jobs=Yn;Ya.FineTuningJobsPage=jc;Ya.FineTuningJobEventsPage=Xc;class bd extends Le{createVariation(r,t){return this._client.post("/images/variations",$n({body:r,...t}))}edit(r,t){return this._client.post("/images/edits",$n({body:r,...t}))}generate(r,t){return this._client.post("/images/generations",{body:r,...t})}}class Yc extends Le{retrieve(r,t){return this._client.get(`/models/${r}`,t)}list(r){return this._client.getAPIList("/models",Kc,r)}del(r,t){return this._client.delete(`/models/${r}`,t)}}class Kc extends Fc{}Yc.ModelsPage=Kc;class Ad extends Le{create(r,t){return this._client.post("/moderations",{body:r,...t})}}function tA(e,r){return!r||!nA(r)?{...e,output_parsed:null,output:e.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(n=>({...n,parsed:null}))}:t)}:Sd(e,r)}function Sd(e,r){const t=e.output.map(a=>{if(a.type==="function_call")return{...a,parsed_arguments:sA(r,a)};if(a.type==="message"){const i=a.content.map(s=>s.type==="output_text"?{...s,parsed:rA(r,s.text)}:s);return{...a,content:i}}return a}),n=Object.assign({},e,{output:t});return Object.getOwnPropertyDescriptor(e,"output_text")||Cd(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(const a of n.output)if(a.type==="message"){for(const i of a.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),n}function rA(e,r){var t,n,a,i;return((n=(t=e.text)==null?void 0:t.format)==null?void 0:n.type)!=="json_schema"?null:"$parseRaw"in((a=e.text)==null?void 0:a.format)?((i=e.text)==null?void 0:i.format).$parseRaw(r):JSON.parse(r)}function nA(e){var r;return!!Nc((r=e.text)==null?void 0:r.format)}function aA(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function iA(e,r){return e.find(t=>t.type==="function"&&t.name===r)}function sA(e,r){const t=iA(e.tools??[],r.name);return{...r,...r,parsed_arguments:aA(t)?t.$parseRaw(r.arguments):t!=null&&t.strict?JSON.parse(r.arguments):null}}function Cd(e){const r=[];for(const t of e.output)if(t.type==="message")for(const n of t.content)n.type==="output_text"&&r.push(n.text);e.output_text=r.join("")}class Fd extends Le{list(r,t={},n){return ut(t)?this.list(r,{},t):this._client.getAPIList(`/responses/${r}/input_items`,cA,{query:t,...n})}}var wn=function(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t},Nr=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},yn,yi,Lr,ki,Jl,Zl,Ql,ef;class qc extends Pc{constructor(r){super(),yn.add(this),yi.set(this,void 0),Lr.set(this,void 0),ki.set(this,void 0),wn(this,yi,r,"f")}static createResponse(r,t,n){const a=new qc(t);return a._run(()=>a._createResponse(r,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createResponse(r,t,n){var s;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Nr(this,yn,"m",Jl).call(this);const i=await r.responses.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of i)Nr(this,yn,"m",Zl).call(this,o);if((s=i.controller.signal)!=null&&s.aborted)throw new Yt;return Nr(this,yn,"m",Ql).call(this)}[(yi=new WeakMap,Lr=new WeakMap,ki=new WeakMap,yn=new WeakSet,Jl=function(){this.ended||wn(this,Lr,void 0,"f")},Zl=function(t){if(this.ended)return;const n=Nr(this,yn,"m",ef).call(this,t);switch(this._emit("event",t),t.type){case"response.output_text.delta":{const a=n.output[t.output_index];if(!a)throw new Se(`missing output at index ${t.output_index}`);if(a.type==="message"){const i=a.content[t.content_index];if(!i)throw new Se(`missing content at index ${t.content_index}`);if(i.type!=="output_text")throw new Se(`expected content to be 'output_text', got ${i.type}`);this._emit("response.output_text.delta",{...t,snapshot:i.text})}break}case"response.function_call_arguments.delta":{const a=n.output[t.output_index];if(!a)throw new Se(`missing output at index ${t.output_index}`);a.type==="function_call"&&this._emit("response.function_call_arguments.delta",{...t,snapshot:a.arguments});break}default:this._emit(t.type,t);break}},Ql=function(){if(this.ended)throw new Se("stream has ended, this shouldn't happen");const t=Nr(this,Lr,"f");if(!t)throw new Se("request ended without sending any events");wn(this,Lr,void 0,"f");const n=oA(t,Nr(this,yi,"f"));return wn(this,ki,n,"f"),n},ef=function(t){let n=Nr(this,Lr,"f");if(!n){if(t.type!=="response.created")throw new Se(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return n=wn(this,Lr,t.response,"f"),n}switch(t.type){case"response.output_item.added":{n.output.push(t.item);break}case"response.content_part.added":{const a=n.output[t.output_index];if(!a)throw new Se(`missing output at index ${t.output_index}`);a.type==="message"&&a.content.push(t.part);break}case"response.output_text.delta":{const a=n.output[t.output_index];if(!a)throw new Se(`missing output at index ${t.output_index}`);if(a.type==="message"){const i=a.content[t.content_index];if(!i)throw new Se(`missing content at index ${t.content_index}`);if(i.type!=="output_text")throw new Se(`expected content to be 'output_text', got ${i.type}`);i.text+=t.delta}break}case"response.function_call_arguments.delta":{const a=n.output[t.output_index];if(!a)throw new Se(`missing output at index ${t.output_index}`);a.type==="function_call"&&(a.arguments+=t.delta);break}case"response.completed":{wn(this,Lr,t.response,"f");break}}return n},Symbol.asyncIterator)](){const r=[],t=[];let n=!1;return this.on("event",a=>{const i=t.shift();i?i.resolve(a):r.push(a)}),this.on("end",()=>{n=!0;for(const a of t)a.resolve(void 0);t.length=0}),this.on("abort",a=>{n=!0;for(const i of t)i.reject(a);t.length=0}),this.on("error",a=>{n=!0;for(const i of t)i.reject(a);t.length=0}),{next:async()=>r.length?{value:r.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,s)=>t.push({resolve:i,reject:s})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const r=Nr(this,ki,"f");if(!r)throw new Se("stream ended without producing a ChatCompletion");return r}}function oA(e,r){return tA(e,r)}class Jc extends Le{constructor(){super(...arguments),this.inputItems=new Fd(this._client)}create(r,t){return this._client.post("/responses",{body:r,...t,stream:r.stream??!1})._thenUnwrap(n=>("object"in n&&n.object==="response"&&Cd(n),n))}retrieve(r,t={},n){return ut(t)?this.retrieve(r,{},t):this._client.get(`/responses/${r}`,{query:t,...n})}del(r,t){return this._client.delete(`/responses/${r}`,{...t,headers:{Accept:"*/*",...t==null?void 0:t.headers}})}parse(r,t){return this._client.responses.create(r,t)._thenUnwrap(n=>Sd(n,r))}stream(r,t){return qc.createResponse(this._client,r,t)}}class cA extends Nt{}Jc.InputItems=Fd;class Rd extends Le{create(r,t,n){return this._client.post(`/uploads/${r}/parts`,$n({body:t,...n}))}}class Zc extends Le{constructor(){super(...arguments),this.parts=new Rd(this._client)}create(r,t){return this._client.post("/uploads",{body:r,...t})}cancel(r,t){return this._client.post(`/uploads/${r}/cancel`,t)}complete(r,t,n){return this._client.post(`/uploads/${r}/complete`,{body:t,...n})}}Zc.Parts=Rd;const lA=async e=>{const r=await Promise.allSettled(e),t=r.filter(a=>a.status==="rejected");if(t.length){for(const a of t)console.error(a.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const n=[];for(const a of r)a.status==="fulfilled"&&n.push(a.value);return n};class Es extends Le{create(r,t,n){return this._client.post(`/vector_stores/${r}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(r,t,n){return this._client.get(`/vector_stores/${r}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(r,t,n,a){return this._client.post(`/vector_stores/${r}/files/${t}`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(r,t={},n){return ut(t)?this.list(r,{},t):this._client.getAPIList(`/vector_stores/${r}/files`,Ts,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(r,t,n){return this._client.delete(`/vector_stores/${r}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(r,t,n){const a=await this.create(r,t,n);return await this.poll(r,a.id,n)}async poll(r,t,n){const a={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const i=await this.retrieve(r,t,{...n,headers:a}).withResponse(),s=i.data;switch(s.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const c=i.response.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(o=l)}}await Va(o);break;case"failed":case"completed":return s}}}async upload(r,t,n){const a=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(r,{file_id:a.id},n)}async uploadAndPoll(r,t,n){const a=await this.upload(r,t,n);return await this.poll(r,a.id,n)}content(r,t,n){return this._client.getAPIList(`/vector_stores/${r}/files/${t}/content`,Qc,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Ts extends Nt{}class Qc extends Fc{}Es.VectorStoreFilesPage=Ts;Es.FileContentResponsesPage=Qc;class Id extends Le{create(r,t,n){return this._client.post(`/vector_stores/${r}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(r,t,n){return this._client.get(`/vector_stores/${r}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(r,t,n){return this._client.post(`/vector_stores/${r}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(r,t,n){const a=await this.create(r,t);return await this.poll(r,a.id,n)}listFiles(r,t,n={},a){return ut(n)?this.listFiles(r,t,{},n):this._client.getAPIList(`/vector_stores/${r}/file_batches/${t}/files`,Ts,{query:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async poll(r,t,n){const a={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:i,response:s}=await this.retrieve(r,t,{...n,headers:a}).withResponse();switch(i.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const c=s.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(o=l)}}await Va(o);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(r,{files:t,fileIds:n=[]},a){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(a==null?void 0:a.maxConcurrency)??5,s=Math.min(i,t.length),o=this._client,c=t.values(),l=[...n];async function f(d){for(let h of d){const x=await o.files.create({file:h,purpose:"assistants"},a);l.push(x.id)}}const u=Array(s).fill(c).map(f);return await lA(u),await this.createAndPoll(r,{file_ids:l})}}class Vr extends Le{constructor(){super(...arguments),this.files=new Es(this._client),this.fileBatches=new Id(this._client)}create(r,t){return this._client.post("/vector_stores",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(r,t){return this._client.get(`/vector_stores/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(r,t,n){return this._client.post(`/vector_stores/${r}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(r={},t){return ut(r)?this.list({},r):this._client.getAPIList("/vector_stores",e0,{query:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(r,t){return this._client.delete(`/vector_stores/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}search(r,t,n){return this._client.getAPIList(`/vector_stores/${r}/search`,t0,{body:t,method:"post",...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class e0 extends Nt{}class t0 extends Fc{}Vr.VectorStoresPage=e0;Vr.VectorStoreSearchResponsesPage=t0;Vr.Files=Es;Vr.VectorStoreFilesPage=Ts;Vr.FileContentResponsesPage=Qc;Vr.FileBatches=Id;var Od;class Pe extends Ib{constructor({baseURL:r=mi("OPENAI_BASE_URL"),apiKey:t=mi("OPENAI_API_KEY"),organization:n=mi("OPENAI_ORG_ID")??null,project:a=mi("OPENAI_PROJECT_ID")??null,...i}={}){if(t===void 0)throw new Se("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const s={apiKey:t,organization:n,project:a,...i,baseURL:r||"https://api.openai.com/v1"};if(!s.dangerouslyAllowBrowser&&$b())throw new Se(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:s.baseURL,timeout:s.timeout??6e5,httpAgent:s.httpAgent,maxRetries:s.maxRetries,fetch:s.fetch}),this.completions=new Ed(this),this.chat=new ys(this),this.embeddings=new Td(this),this.files=new Hc(this),this.images=new bd(this),this.audio=new Ga(this),this.moderations=new Ad(this),this.models=new Yc(this),this.fineTuning=new Ya(this),this.vectorStores=new Vr(this),this.beta=new Xn(this),this.batches=new Rc(this),this.uploads=new Zc(this),this.responses=new Jc(this),this._options=s,this.apiKey=t,this.organization=n,this.project=a}defaultQuery(){return this._options.defaultQuery}defaultHeaders(r){return{...super.defaultHeaders(r),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(r){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(r){return db(r,{arrayFormat:"brackets"})}}Od=Pe;Pe.OpenAI=Od;Pe.DEFAULT_TIMEOUT=6e5;Pe.OpenAIError=Se;Pe.APIError=mt;Pe.APIConnectionError=xs;Pe.APIConnectionTimeoutError=Cc;Pe.APIUserAbortError=Yt;Pe.NotFoundError=Ph;Pe.ConflictError=Nh;Pe.RateLimitError=Mh;Pe.BadRequestError=Ih;Pe.AuthenticationError=Oh;Pe.InternalServerError=Bh;Pe.PermissionDeniedError=Dh;Pe.UnprocessableEntityError=Lh;Pe.toFile=Vh;Pe.fileFromPath=Ch;Pe.Completions=Ed;Pe.Chat=ys;Pe.ChatCompletionsPage=ws;Pe.Embeddings=Td;Pe.Files=Hc;Pe.FileObjectsPage=Wc;Pe.Images=bd;Pe.Audio=Ga;Pe.Moderations=Ad;Pe.Models=Yc;Pe.ModelsPage=Kc;Pe.FineTuning=Ya;Pe.VectorStores=Vr;Pe.VectorStoresPage=e0;Pe.VectorStoreSearchResponsesPage=t0;Pe.Beta=Xn;Pe.Batches=Rc;Pe.BatchesPage=Ic;Pe.Uploads=Zc;Pe.Responses=Jc;const Hn=new Pe({apiKey:void 0,dangerouslyAllowBrowser:!0}),Dd="o3-mini";async function fA(e,r,t,n,a=!1,i=!1){let s="";if(n){const f="fileSearch";r(f,`[FileSearch] Searching in "${n}" for context...`);try{const u=await Hn.responses.create({model:"gpt-3.5-turbo",input:`Summarize any relevant info about: ${e}`,tools:[{type:"file_search",vector_store_ids:[n]}]});t(f,`[FileSearch] Done searching in "${n}".`),s=u.output_text||""}catch(u){t(f,`[FileSearch] Failed: ${String(u)}`)}}const o="planProject";r(o,"[planProject] Requesting structured plan...");const c=await uA(e,s,a);t(o,"[planProject] Plan generated & parsed.");const l={};for(const f of c){const u=`generateFile:${f.filePath}`;r(u,`[Orchestrator] Generating file "${f.filePath}"...`);const d=await hA(f,s),h=await pA(f,d);t(u,`[Orchestrator] Finished "${f.filePath}".`),l[f.filePath]=h}if(i){const f="multiPassValidation";r(f,"[Validation] Starting multi-pass fix process...");const u=await xA(l,(d,h)=>r(d,h),(d,h)=>t(d,h));return t(f,"[Validation] Multi-pass fix complete."),u}else return l}async function uA(e,r,t=!1){if(t){const n=`
      The user wants: ${e}
      Additional context:
      ${r}

      Act as a project manager. Return a JSON array of "ProjectFileSpec" objects, where:
        - "filePath" is the name of the file
        - "description" is a short summary of that file
        - "functions" is an array of function specs. Each function spec has:
            { 
              "name": string,
              "description": string,
              "inputs": [ { "name": string, "type": string } ],
              "outputs": [ { "name": string, "type": string } ] 
            }

      The user wants to build an end-to-end project that might involve front-end (TS/HTML),
      Azure Python functions, or JS-based functions, etc. Provide function-level details
      so that a smaller GPT model can generate the actual code for each function. 
      
      Return valid JSON only, no extra text.
    `,a=await Hn.responses.create({model:"o1",input:n,reasoning:{effort:"high"}});try{return JSON.parse(a.output_text||"[]")}catch(i){return console.warn("[planProject] Advanced plan parse error:",i),[]}}else{const n=`
      The user wants: ${e}
      Additional context:
      ${r}

      Return a JSON array of "ProjectFileSpec":
      [
        {
          "filePath": "someFile",
          "description": "...",
          "functions": [
            {
              "name": "functionOne",
              "description": "desc",
              "inputs": [],
              "outputs": []
            }
          ]
        }
      ]
      Return valid JSON only, no commentary.
    `,a=await Hn.responses.create({model:"o3-mini",input:n,reasoning:{effort:"medium"}});try{return JSON.parse(a.output_text||"[]")}catch(i){return console.warn("[planProject] Simple plan parse error:",i),[]}}}async function hA(e,r){if(!e.functions||e.functions.length===0)return[];const t=[];for(const n of e.functions){const a=await dA(e,n,r);t.push(a)}return t}async function dA(e,r,t){const n=`
    You are a code generator. 
    We have a file: ${e.filePath}.
    The file's overall role: ${e.description}
    Now implement the following function:

    Name: ${r.name}
    Description: ${r.description}
    Inputs: ${JSON.stringify(r.inputs)}
    Outputs: ${JSON.stringify(r.outputs)}

    - Show function signature
    - Include docstrings or inline comments 
    - Return only the function's code (no extra commentary).
    
    Additional context: 
    ${t}
  `;return(await Hn.responses.create({model:"o3-mini",input:n,reasoning:{effort:"medium"}})).output_text||""}async function pA(e,r){return e.filePath.endsWith(".py")?`
"""
File: ${e.filePath}
Description: ${e.description}
"""

# Example of your imports:
import logging
import azure.functions as func

${r.join(`

`)}
`:e.filePath.endsWith(".ts")||e.filePath.endsWith(".js")?`
// File: ${e.filePath}
// Description: ${e.description}

${r.join(`

`)}
`:r.join(`

`)}async function tf(e,r){const t=`
    You are a code reviewer focusing on a single file at a time. Here is the file:
    FILE PATH: ${e}
    CONTENT:
    ${r}

    If you see major errors, missing references, or poor usage of code components,
    or if there's style or best-practice improvement, return:
    {
      "valid": false,
      "fix": "the entire updated file content"
    }
    Otherwise return:
    {
      "valid": true
    }

    Return only valid JSON, with no extra commentary.
  `;let n;try{n=await Hn.responses.create({model:Dd,input:t,reasoning:{effort:"low"}})}catch(i){return console.warn("[fixSingleFile] Model call failed for file:",e,i),r}let a;try{a=JSON.parse(n.output_text||"")}catch(i){return console.warn("[fixSingleFile] JSON parse error for file:",e,i),r}return a.valid===!1&&typeof a.fix=="string"?a.fix:r}async function rf(e){const t=`
    You are a code reviewer focusing on the entire project at once. Below are all the files:
    ${Object.entries(e).map(([i,s])=>`FILE PATH: ${i}
CONTENT:
${s}`).join(`

---

`)}

    If you see cross-file errors or best-practice improvements requiring multi-file changes,
    return a JSON:
    {
      "valid": false,
      "fixes": {
        "<filePath>": "new content",
        ...
      }
    }
    Otherwise return:
    {
      "valid": true
    }

    Return only valid JSON, no extra commentary.
  `;let n;try{n=await Hn.responses.create({model:Dd,input:t,reasoning:{effort:"low"}})}catch(i){return console.warn("[fixAllFilesTogether] Model call failed.",i),e}let a;try{a=JSON.parse(n.output_text||"")}catch(i){return console.warn("[fixAllFilesTogether] JSON parse error.",i),e}if(a.valid===!1&&a.fixes)for(const[i,s]of Object.entries(a.fixes))typeof s=="string"&&(e[i]=s);return e}async function xA(e,r,t){r==null||r("pass1","[Validation] Pass 1: Individual fixes...");for(const n of Object.keys(e))e[n]=await tf(n,e[n]);t==null||t("pass1","[Validation] Pass 1 complete."),r==null||r("pass2","[Validation] Pass 2: Global fix..."),e=await rf(e),t==null||t("pass2","[Validation] Pass 2 complete."),r==null||r("pass3","[Validation] Pass 3: Another individual pass...");for(const n of Object.keys(e))e[n]=await tf(n,e[n]);return t==null||t("pass3","[Validation] Pass 3 complete."),r==null||r("pass4","[Validation] Pass 4: Final global pass..."),e=await rf(e),t==null||t("pass4","[Validation] Pass 4 complete."),e}var Ei=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mA(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ti(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ro={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var nf;function gA(){return nf||(nf=1,function(e,r){(function(t){e.exports=t()})(function(){return function t(n,a,i){function s(l,f){if(!a[l]){if(!n[l]){var u=typeof Ti=="function"&&Ti;if(!f&&u)return u(l,!0);if(o)return o(l,!0);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}var h=a[l]={exports:{}};n[l][0].call(h.exports,function(x){var p=n[l][1][x];return s(p||x)},h,h.exports,t,n,a,i)}return a[l].exports}for(var o=typeof Ti=="function"&&Ti,c=0;c<i.length;c++)s(i[c]);return s}({1:[function(t,n,a){var i=t("./utils"),s=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(c){for(var l,f,u,d,h,x,p,m=[],g=0,w=c.length,v=w,k=i.getTypeOf(c)!=="string";g<c.length;)v=w-g,u=k?(l=c[g++],f=g<w?c[g++]:0,g<w?c[g++]:0):(l=c.charCodeAt(g++),f=g<w?c.charCodeAt(g++):0,g<w?c.charCodeAt(g++):0),d=l>>2,h=(3&l)<<4|f>>4,x=1<v?(15&f)<<2|u>>6:64,p=2<v?63&u:64,m.push(o.charAt(d)+o.charAt(h)+o.charAt(x)+o.charAt(p));return m.join("")},a.decode=function(c){var l,f,u,d,h,x,p=0,m=0,g="data:";if(c.substr(0,g.length)===g)throw new Error("Invalid base64 input, it looks like a data url.");var w,v=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===o.charAt(64)&&v--,c.charAt(c.length-2)===o.charAt(64)&&v--,v%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=s.uint8array?new Uint8Array(0|v):new Array(0|v);p<c.length;)l=o.indexOf(c.charAt(p++))<<2|(d=o.indexOf(c.charAt(p++)))>>4,f=(15&d)<<4|(h=o.indexOf(c.charAt(p++)))>>2,u=(3&h)<<6|(x=o.indexOf(c.charAt(p++))),w[m++]=l,h!==64&&(w[m++]=f),x!==64&&(w[m++]=u);return w}},{"./support":30,"./utils":32}],2:[function(t,n,a){var i=t("./external"),s=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),c=t("./stream/DataLengthProbe");function l(f,u,d,h,x){this.compressedSize=f,this.uncompressedSize=u,this.crc32=d,this.compression=h,this.compressedContent=x}l.prototype={getContentWorker:function(){var f=new s(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),u=this;return f.on("end",function(){if(this.streamInfo.data_length!==u.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),f},getCompressedWorker:function(){return new s(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},l.createWorkerFrom=function(f,u,d){return f.pipe(new o).pipe(new c("uncompressedSize")).pipe(u.compressWorker(d)).pipe(new c("compressedSize")).withStreamInfo("compression",u)},n.exports=l},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,n,a){var i=t("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},a.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,n,a){var i=t("./utils"),s=function(){for(var o,c=[],l=0;l<256;l++){o=l;for(var f=0;f<8;f++)o=1&o?3988292384^o>>>1:o>>>1;c[l]=o}return c}();n.exports=function(o,c){return o!==void 0&&o.length?i.getTypeOf(o)!=="string"?function(l,f,u,d){var h=s,x=d+u;l^=-1;for(var p=d;p<x;p++)l=l>>>8^h[255&(l^f[p])];return-1^l}(0|c,o,o.length,0):function(l,f,u,d){var h=s,x=d+u;l^=-1;for(var p=d;p<x;p++)l=l>>>8^h[255&(l^f.charCodeAt(p))];return-1^l}(0|c,o,o.length,0):0}},{"./utils":32}],5:[function(t,n,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(t,n,a){var i=null;i=typeof Promise<"u"?Promise:t("lie"),n.exports={Promise:i}},{lie:37}],7:[function(t,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=t("pako"),o=t("./utils"),c=t("./stream/GenericWorker"),l=i?"uint8array":"array";function f(u,d){c.call(this,"FlateWorker/"+u),this._pako=null,this._pakoAction=u,this._pakoOptions=d,this.meta={}}a.magic="\b\0",o.inherits(f,c),f.prototype.processChunk=function(u){this.meta=u.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(l,u.data),!1)},f.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},f.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},f.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var u=this;this._pako.onData=function(d){u.push({data:d,meta:u.meta})}},a.compressWorker=function(u){return new f("Deflate",u)},a.uncompressWorker=function(){return new f("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,n,a){function i(h,x){var p,m="";for(p=0;p<x;p++)m+=String.fromCharCode(255&h),h>>>=8;return m}function s(h,x,p,m,g,w){var v,k,A=h.file,F=h.compression,E=w!==l.utf8encode,z=o.transformTo("string",w(A.name)),C=o.transformTo("string",l.utf8encode(A.name)),G=A.comment,H=o.transformTo("string",w(G)),b=o.transformTo("string",l.utf8encode(G)),j=C.length!==A.name.length,_=b.length!==G.length,W="",q="",X="",ue=A.dir,P=A.date,se={crc32:0,compressedSize:0,uncompressedSize:0};x&&!p||(se.crc32=h.crc32,se.compressedSize=h.compressedSize,se.uncompressedSize=h.uncompressedSize);var Y=0;x&&(Y|=8),E||!j&&!_||(Y|=2048);var T=0,K=0;ue&&(T|=16),g==="UNIX"?(K=798,T|=function(N,ie){var pe=N;return N||(pe=ie?16893:33204),(65535&pe)<<16}(A.unixPermissions,ue)):(K=20,T|=function(N){return 63&(N||0)}(A.dosPermissions)),v=P.getUTCHours(),v<<=6,v|=P.getUTCMinutes(),v<<=5,v|=P.getUTCSeconds()/2,k=P.getUTCFullYear()-1980,k<<=4,k|=P.getUTCMonth()+1,k<<=5,k|=P.getUTCDate(),j&&(q=i(1,1)+i(f(z),4)+C,W+="up"+i(q.length,2)+q),_&&(X=i(1,1)+i(f(H),4)+b,W+="uc"+i(X.length,2)+X);var B="";return B+=`
\0`,B+=i(Y,2),B+=F.magic,B+=i(v,2),B+=i(k,2),B+=i(se.crc32,4),B+=i(se.compressedSize,4),B+=i(se.uncompressedSize,4),B+=i(z.length,2),B+=i(W.length,2),{fileRecord:u.LOCAL_FILE_HEADER+B+z+W,dirRecord:u.CENTRAL_FILE_HEADER+i(K,2)+B+i(H.length,2)+"\0\0\0\0"+i(T,4)+i(m,4)+z+W+H}}var o=t("../utils"),c=t("../stream/GenericWorker"),l=t("../utf8"),f=t("../crc32"),u=t("../signature");function d(h,x,p,m){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=x,this.zipPlatform=p,this.encodeFileName=m,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(d,c),d.prototype.push=function(h){var x=h.meta.percent||0,p=this.entriesCount,m=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,c.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:p?(x+100*(p-m-1))/p:100}}))},d.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var x=this.streamFiles&&!h.file.dir;if(x){var p=s(h,x,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:p.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(h){this.accumulate=!1;var x=this.streamFiles&&!h.file.dir,p=s(h,x,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(p.dirRecord),x)this.push({data:function(m){return u.DATA_DESCRIPTOR+i(m.crc32,4)+i(m.compressedSize,4)+i(m.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:p.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var h=this.bytesWritten,x=0;x<this.dirRecords.length;x++)this.push({data:this.dirRecords[x],meta:{percent:100}});var p=this.bytesWritten-h,m=function(g,w,v,k,A){var F=o.transformTo("string",A(k));return u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(g,2)+i(g,2)+i(w,4)+i(v,4)+i(F.length,2)+F}(this.dirRecords.length,p,h,this.zipComment,this.encodeFileName);this.push({data:m,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(h){this._sources.push(h);var x=this;return h.on("data",function(p){x.processChunk(p)}),h.on("end",function(){x.closedSource(x.previous.streamInfo),x._sources.length?x.prepareNextSource():x.end()}),h.on("error",function(p){x.error(p)}),this},d.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(h){var x=this._sources;if(!c.prototype.error.call(this,h))return!1;for(var p=0;p<x.length;p++)try{x[p].error(h)}catch{}return!0},d.prototype.lock=function(){c.prototype.lock.call(this);for(var h=this._sources,x=0;x<h.length;x++)h[x].lock()},n.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,n,a){var i=t("../compressions"),s=t("./ZipFileWorker");a.generateWorker=function(o,c,l){var f=new s(c.streamFiles,l,c.platform,c.encodeFileName),u=0;try{o.forEach(function(d,h){u++;var x=function(w,v){var k=w||v,A=i[k];if(!A)throw new Error(k+" is not a valid compression method !");return A}(h.options.compression,c.compression),p=h.options.compressionOptions||c.compressionOptions||{},m=h.dir,g=h.date;h._compressWorker(x,p).withStreamInfo("file",{name:d,dir:m,date:g,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(f)}),f.entriesCount=u}catch(d){f.error(d)}return f}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,n,a){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new i;for(var o in this)typeof this[o]!="function"&&(s[o]=this[o]);return s}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.10.1",i.loadAsync=function(s,o){return new i().loadAsync(s,o)},i.external=t("./external"),n.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,n,a){var i=t("./utils"),s=t("./external"),o=t("./utf8"),c=t("./zipEntries"),l=t("./stream/Crc32Probe"),f=t("./nodejsUtils");function u(d){return new s.Promise(function(h,x){var p=d.decompressed.getContentWorker().pipe(new l);p.on("error",function(m){x(m)}).on("end",function(){p.streamInfo.crc32!==d.decompressed.crc32?x(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}n.exports=function(d,h){var x=this;return h=i.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),f.isNode&&f.isStream(d)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",d,!0,h.optimizedBinaryString,h.base64).then(function(p){var m=new c(h);return m.load(p),m}).then(function(p){var m=[s.Promise.resolve(p)],g=p.files;if(h.checkCRC32)for(var w=0;w<g.length;w++)m.push(u(g[w]));return s.Promise.all(m)}).then(function(p){for(var m=p.shift(),g=m.files,w=0;w<g.length;w++){var v=g[w],k=v.fileNameStr,A=i.resolve(v.fileNameStr);x.file(A,v.decompressed,{binary:!0,optimizedBinaryString:!0,date:v.date,dir:v.dir,comment:v.fileCommentStr.length?v.fileCommentStr:null,unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions,createFolders:h.createFolders}),v.dir||(x.file(A).unsafeOriginalName=k)}return m.zipComment.length&&(x.comment=m.zipComment),x})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,n,a){var i=t("../utils"),s=t("../stream/GenericWorker");function o(c,l){s.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(l)}i.inherits(o,s),o.prototype._bindStream=function(c){var l=this;(this._stream=c).pause(),c.on("data",function(f){l.push({data:f,meta:{percent:0}})}).on("error",function(f){l.isPaused?this.generatedError=f:l.error(f)}).on("end",function(){l.isPaused?l._upstreamEnded=!0:l.end()})},o.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,n,a){var i=t("readable-stream").Readable;function s(o,c,l){i.call(this,c),this._helper=o;var f=this;o.on("data",function(u,d){f.push(u)||f._helper.pause(),l&&l(d)}).on("error",function(u){f.emit("error",u)}).on("end",function(){f.push(null)})}t("../utils").inherits(s,i),s.prototype._read=function(){this._helper.resume()},n.exports=s},{"../utils":32,"readable-stream":16}],14:[function(t,n,a){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,s);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,s)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var s=new Buffer(i);return s.fill(0),s},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(t,n,a){function i(A,F,E){var z,C=o.getTypeOf(F),G=o.extend(E||{},f);G.date=G.date||new Date,G.compression!==null&&(G.compression=G.compression.toUpperCase()),typeof G.unixPermissions=="string"&&(G.unixPermissions=parseInt(G.unixPermissions,8)),G.unixPermissions&&16384&G.unixPermissions&&(G.dir=!0),G.dosPermissions&&16&G.dosPermissions&&(G.dir=!0),G.dir&&(A=g(A)),G.createFolders&&(z=m(A))&&w.call(this,z,!0);var H=C==="string"&&G.binary===!1&&G.base64===!1;E&&E.binary!==void 0||(G.binary=!H),(F instanceof u&&F.uncompressedSize===0||G.dir||!F||F.length===0)&&(G.base64=!1,G.binary=!0,F="",G.compression="STORE",C="string");var b=null;b=F instanceof u||F instanceof c?F:x.isNode&&x.isStream(F)?new p(A,F):o.prepareContent(A,F,G.binary,G.optimizedBinaryString,G.base64);var j=new d(A,b,G);this.files[A]=j}var s=t("./utf8"),o=t("./utils"),c=t("./stream/GenericWorker"),l=t("./stream/StreamHelper"),f=t("./defaults"),u=t("./compressedObject"),d=t("./zipObject"),h=t("./generate"),x=t("./nodejsUtils"),p=t("./nodejs/NodejsStreamInputAdapter"),m=function(A){A.slice(-1)==="/"&&(A=A.substring(0,A.length-1));var F=A.lastIndexOf("/");return 0<F?A.substring(0,F):""},g=function(A){return A.slice(-1)!=="/"&&(A+="/"),A},w=function(A,F){return F=F!==void 0?F:f.createFolders,A=g(A),this.files[A]||i.call(this,A,null,{dir:!0,createFolders:F}),this.files[A]};function v(A){return Object.prototype.toString.call(A)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(A){var F,E,z;for(F in this.files)z=this.files[F],(E=F.slice(this.root.length,F.length))&&F.slice(0,this.root.length)===this.root&&A(E,z)},filter:function(A){var F=[];return this.forEach(function(E,z){A(E,z)&&F.push(z)}),F},file:function(A,F,E){if(arguments.length!==1)return A=this.root+A,i.call(this,A,F,E),this;if(v(A)){var z=A;return this.filter(function(G,H){return!H.dir&&z.test(G)})}var C=this.files[this.root+A];return C&&!C.dir?C:null},folder:function(A){if(!A)return this;if(v(A))return this.filter(function(C,G){return G.dir&&A.test(C)});var F=this.root+A,E=w.call(this,F),z=this.clone();return z.root=E.name,z},remove:function(A){A=this.root+A;var F=this.files[A];if(F||(A.slice(-1)!=="/"&&(A+="/"),F=this.files[A]),F&&!F.dir)delete this.files[A];else for(var E=this.filter(function(C,G){return G.name.slice(0,A.length)===A}),z=0;z<E.length;z++)delete this.files[E[z].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(A){var F,E={};try{if((E=o.extend(A||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=E.type.toLowerCase(),E.compression=E.compression.toUpperCase(),E.type==="binarystring"&&(E.type="string"),!E.type)throw new Error("No output type specified.");o.checkSupport(E.type),E.platform!=="darwin"&&E.platform!=="freebsd"&&E.platform!=="linux"&&E.platform!=="sunos"||(E.platform="UNIX"),E.platform==="win32"&&(E.platform="DOS");var z=E.comment||this.comment||"";F=h.generateWorker(this,E,z)}catch(C){(F=new c("error")).error(C)}return new l(F,E.type||"string",E.mimeType)},generateAsync:function(A,F){return this.generateInternalStream(A).accumulate(F)},generateNodeStream:function(A,F){return(A=A||{}).type||(A.type="nodebuffer"),this.generateInternalStream(A).toNodejsStream(F)}};n.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,n,a){n.exports=t("stream")},{stream:void 0}],17:[function(t,n,a){var i=t("./DataReader");function s(o){i.call(this,o);for(var c=0;c<this.data.length;c++)o[c]=255&o[c]}t("../utils").inherits(s,i),s.prototype.byteAt=function(o){return this.data[this.zero+o]},s.prototype.lastIndexOfSignature=function(o){for(var c=o.charCodeAt(0),l=o.charCodeAt(1),f=o.charCodeAt(2),u=o.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===c&&this.data[d+1]===l&&this.data[d+2]===f&&this.data[d+3]===u)return d-this.zero;return-1},s.prototype.readAndCheckSignature=function(o){var c=o.charCodeAt(0),l=o.charCodeAt(1),f=o.charCodeAt(2),u=o.charCodeAt(3),d=this.readData(4);return c===d[0]&&l===d[1]&&f===d[2]&&u===d[3]},s.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=s},{"../utils":32,"./DataReader":18}],18:[function(t,n,a){var i=t("../utils");function s(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var c,l=0;for(this.checkOffset(o),c=this.index+o-1;c>=this.index;c--)l=(l<<8)+this.byteAt(c);return this.index+=o,l},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},n.exports=s},{"../utils":32}],19:[function(t,n,a){var i=t("./Uint8ArrayReader");function s(o){i.call(this,o)}t("../utils").inherits(s,i),s.prototype.readData=function(o){this.checkOffset(o);var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,n,a){var i=t("./DataReader");function s(o){i.call(this,o)}t("../utils").inherits(s,i),s.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},s.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},s.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},s.prototype.readData=function(o){this.checkOffset(o);var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=s},{"../utils":32,"./DataReader":18}],21:[function(t,n,a){var i=t("./ArrayReader");function s(o){i.call(this,o)}t("../utils").inherits(s,i),s.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(t,n,a){var i=t("../utils"),s=t("../support"),o=t("./ArrayReader"),c=t("./StringReader"),l=t("./NodeBufferReader"),f=t("./Uint8ArrayReader");n.exports=function(u){var d=i.getTypeOf(u);return i.checkSupport(d),d!=="string"||s.uint8array?d==="nodebuffer"?new l(u):s.uint8array?new f(i.transformTo("uint8array",u)):new o(i.transformTo("array",u)):new c(u)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,n,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,n,a){var i=t("./GenericWorker"),s=t("../utils");function o(c){i.call(this,"ConvertWorker to "+c),this.destType=c}s.inherits(o,i),o.prototype.processChunk=function(c){this.push({data:s.transformTo(this.destType,c.data),meta:c.meta})},n.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,n,a){var i=t("./GenericWorker"),s=t("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,i),o.prototype.processChunk=function(c){this.streamInfo.crc32=s(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,n,a){var i=t("../utils"),s=t("./GenericWorker");function o(c){s.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}i.inherits(o,s),o.prototype.processChunk=function(c){if(c){var l=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=l+c.data.length}s.prototype.processChunk.call(this,c)},n.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,n,a){var i=t("../utils"),s=t("./GenericWorker");function o(c){s.call(this,"DataWorker");var l=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(f){l.dataIsReady=!0,l.data=f,l.max=f&&f.length||0,l.type=i.getTypeOf(f),l.isPaused||l._tickAndRepeat()},function(f){l.error(f)})}i.inherits(o,s),o.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,l=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,l);break;case"uint8array":c=this.data.subarray(this.index,l);break;case"array":case"nodebuffer":c=this.data.slice(this.index,l)}return this.index=l,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,n,a){function i(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,o){return this._listeners[s].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,o){if(this._listeners[s])for(var c=0;c<this._listeners[s].length;c++)this._listeners[s][c].call(this,o)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var o=this;return s.on("data",function(c){o.processChunk(c)}),s.on("end",function(){o.end()}),s.on("error",function(c){o.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,o){return this.extraStreamInfo[s]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},n.exports=i},{}],29:[function(t,n,a){var i=t("../utils"),s=t("./ConvertWorker"),o=t("./GenericWorker"),c=t("../base64"),l=t("../support"),f=t("../external"),u=null;if(l.nodestream)try{u=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(x,p){return new f.Promise(function(m,g){var w=[],v=x._internalType,k=x._outputType,A=x._mimeType;x.on("data",function(F,E){w.push(F),p&&p(E)}).on("error",function(F){w=[],g(F)}).on("end",function(){try{var F=function(E,z,C){switch(E){case"blob":return i.newBlob(i.transformTo("arraybuffer",z),C);case"base64":return c.encode(z);default:return i.transformTo(E,z)}}(k,function(E,z){var C,G=0,H=null,b=0;for(C=0;C<z.length;C++)b+=z[C].length;switch(E){case"string":return z.join("");case"array":return Array.prototype.concat.apply([],z);case"uint8array":for(H=new Uint8Array(b),C=0;C<z.length;C++)H.set(z[C],G),G+=z[C].length;return H;case"nodebuffer":return Buffer.concat(z);default:throw new Error("concat : unsupported type '"+E+"'")}}(v,w),A);m(F)}catch(E){g(E)}w=[]}).resume()})}function h(x,p,m){var g=p;switch(p){case"blob":case"arraybuffer":g="uint8array";break;case"base64":g="string"}try{this._internalType=g,this._outputType=p,this._mimeType=m,i.checkSupport(g),this._worker=x.pipe(new s(g)),x.lock()}catch(w){this._worker=new o("error"),this._worker.error(w)}}h.prototype={accumulate:function(x){return d(this,x)},on:function(x,p){var m=this;return x==="data"?this._worker.on(x,function(g){p.call(m,g.data,g.meta)}):this._worker.on(x,function(){i.delay(p,arguments,m)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(x){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:this._outputType!=="nodebuffer"},x)}},n.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,n,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var i=new ArrayBuffer(0);try{a.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(i),a.blob=s.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!t("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(t,n,a){for(var i=t("./utils"),s=t("./support"),o=t("./nodejsUtils"),c=t("./stream/GenericWorker"),l=new Array(256),f=0;f<256;f++)l[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;l[254]=l[254]=1;function u(){c.call(this,"utf-8 decode"),this.leftOver=null}function d(){c.call(this,"utf-8 encode")}a.utf8encode=function(h){return s.nodebuffer?o.newBufferFrom(h,"utf-8"):function(x){var p,m,g,w,v,k=x.length,A=0;for(w=0;w<k;w++)(64512&(m=x.charCodeAt(w)))==55296&&w+1<k&&(64512&(g=x.charCodeAt(w+1)))==56320&&(m=65536+(m-55296<<10)+(g-56320),w++),A+=m<128?1:m<2048?2:m<65536?3:4;for(p=s.uint8array?new Uint8Array(A):new Array(A),w=v=0;v<A;w++)(64512&(m=x.charCodeAt(w)))==55296&&w+1<k&&(64512&(g=x.charCodeAt(w+1)))==56320&&(m=65536+(m-55296<<10)+(g-56320),w++),m<128?p[v++]=m:(m<2048?p[v++]=192|m>>>6:(m<65536?p[v++]=224|m>>>12:(p[v++]=240|m>>>18,p[v++]=128|m>>>12&63),p[v++]=128|m>>>6&63),p[v++]=128|63&m);return p}(h)},a.utf8decode=function(h){return s.nodebuffer?i.transformTo("nodebuffer",h).toString("utf-8"):function(x){var p,m,g,w,v=x.length,k=new Array(2*v);for(p=m=0;p<v;)if((g=x[p++])<128)k[m++]=g;else if(4<(w=l[g]))k[m++]=65533,p+=w-1;else{for(g&=w===2?31:w===3?15:7;1<w&&p<v;)g=g<<6|63&x[p++],w--;1<w?k[m++]=65533:g<65536?k[m++]=g:(g-=65536,k[m++]=55296|g>>10&1023,k[m++]=56320|1023&g)}return k.length!==m&&(k.subarray?k=k.subarray(0,m):k.length=m),i.applyFromCharCode(k)}(h=i.transformTo(s.uint8array?"uint8array":"array",h))},i.inherits(u,c),u.prototype.processChunk=function(h){var x=i.transformTo(s.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var p=x;(x=new Uint8Array(p.length+this.leftOver.length)).set(this.leftOver,0),x.set(p,this.leftOver.length)}else x=this.leftOver.concat(x);this.leftOver=null}var m=function(w,v){var k;for((v=v||w.length)>w.length&&(v=w.length),k=v-1;0<=k&&(192&w[k])==128;)k--;return k<0||k===0?v:k+l[w[k]]>v?k:v}(x),g=x;m!==x.length&&(s.uint8array?(g=x.subarray(0,m),this.leftOver=x.subarray(m,x.length)):(g=x.slice(0,m),this.leftOver=x.slice(m,x.length))),this.push({data:a.utf8decode(g),meta:h.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=u,i.inherits(d,c),d.prototype.processChunk=function(h){this.push({data:a.utf8encode(h.data),meta:h.meta})},a.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,n,a){var i=t("./support"),s=t("./base64"),o=t("./nodejsUtils"),c=t("./external");function l(p){return p}function f(p,m){for(var g=0;g<p.length;++g)m[g]=255&p.charCodeAt(g);return m}t("setimmediate"),a.newBlob=function(p,m){a.checkSupport("blob");try{return new Blob([p],{type:m})}catch{try{var g=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return g.append(p),g.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(p,m,g){var w=[],v=0,k=p.length;if(k<=g)return String.fromCharCode.apply(null,p);for(;v<k;)m==="array"||m==="nodebuffer"?w.push(String.fromCharCode.apply(null,p.slice(v,Math.min(v+g,k)))):w.push(String.fromCharCode.apply(null,p.subarray(v,Math.min(v+g,k)))),v+=g;return w.join("")},stringifyByChar:function(p){for(var m="",g=0;g<p.length;g++)m+=String.fromCharCode(p[g]);return m},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function d(p){var m=65536,g=a.getTypeOf(p),w=!0;if(g==="uint8array"?w=u.applyCanBeUsed.uint8array:g==="nodebuffer"&&(w=u.applyCanBeUsed.nodebuffer),w)for(;1<m;)try{return u.stringifyByChunk(p,g,m)}catch{m=Math.floor(m/2)}return u.stringifyByChar(p)}function h(p,m){for(var g=0;g<p.length;g++)m[g]=p[g];return m}a.applyFromCharCode=d;var x={};x.string={string:l,array:function(p){return f(p,new Array(p.length))},arraybuffer:function(p){return x.string.uint8array(p).buffer},uint8array:function(p){return f(p,new Uint8Array(p.length))},nodebuffer:function(p){return f(p,o.allocBuffer(p.length))}},x.array={string:d,array:l,arraybuffer:function(p){return new Uint8Array(p).buffer},uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return o.newBufferFrom(p)}},x.arraybuffer={string:function(p){return d(new Uint8Array(p))},array:function(p){return h(new Uint8Array(p),new Array(p.byteLength))},arraybuffer:l,uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return o.newBufferFrom(new Uint8Array(p))}},x.uint8array={string:d,array:function(p){return h(p,new Array(p.length))},arraybuffer:function(p){return p.buffer},uint8array:l,nodebuffer:function(p){return o.newBufferFrom(p)}},x.nodebuffer={string:d,array:function(p){return h(p,new Array(p.length))},arraybuffer:function(p){return x.nodebuffer.uint8array(p).buffer},uint8array:function(p){return h(p,new Uint8Array(p.length))},nodebuffer:l},a.transformTo=function(p,m){if(m=m||"",!p)return m;a.checkSupport(p);var g=a.getTypeOf(m);return x[g][p](m)},a.resolve=function(p){for(var m=p.split("/"),g=[],w=0;w<m.length;w++){var v=m[w];v==="."||v===""&&w!==0&&w!==m.length-1||(v===".."?g.pop():g.push(v))}return g.join("/")},a.getTypeOf=function(p){return typeof p=="string"?"string":Object.prototype.toString.call(p)==="[object Array]"?"array":i.nodebuffer&&o.isBuffer(p)?"nodebuffer":i.uint8array&&p instanceof Uint8Array?"uint8array":i.arraybuffer&&p instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(p){if(!i[p.toLowerCase()])throw new Error(p+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(p){var m,g,w="";for(g=0;g<(p||"").length;g++)w+="\\x"+((m=p.charCodeAt(g))<16?"0":"")+m.toString(16).toUpperCase();return w},a.delay=function(p,m,g){setImmediate(function(){p.apply(g||null,m||[])})},a.inherits=function(p,m){function g(){}g.prototype=m.prototype,p.prototype=new g},a.extend=function(){var p,m,g={};for(p=0;p<arguments.length;p++)for(m in arguments[p])Object.prototype.hasOwnProperty.call(arguments[p],m)&&g[m]===void 0&&(g[m]=arguments[p][m]);return g},a.prepareContent=function(p,m,g,w,v){return c.Promise.resolve(m).then(function(k){return i.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new c.Promise(function(A,F){var E=new FileReader;E.onload=function(z){A(z.target.result)},E.onerror=function(z){F(z.target.error)},E.readAsArrayBuffer(k)}):k}).then(function(k){var A=a.getTypeOf(k);return A?(A==="arraybuffer"?k=a.transformTo("uint8array",k):A==="string"&&(v?k=s.decode(k):g&&w!==!0&&(k=function(F){return f(F,i.uint8array?new Uint8Array(F.length):new Array(F.length))}(k))),k):c.Promise.reject(new Error("Can't read the data of '"+p+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,n,a){var i=t("./reader/readerFor"),s=t("./utils"),o=t("./signature"),c=t("./zipEntry"),l=t("./support");function f(u){this.files=[],this.loadOptions=u}f.prototype={checkSignature:function(u){if(!this.reader.readAndCheckSignature(u)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(d)+", expected "+s.pretty(u)+")")}},isSignature:function(u,d){var h=this.reader.index;this.reader.setIndex(u);var x=this.reader.readString(4)===d;return this.reader.setIndex(h),x},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var u=this.reader.readData(this.zipCommentLength),d=l.uint8array?"uint8array":"array",h=s.transformTo(d,u);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var u,d,h,x=this.zip64EndOfCentralSize-44;0<x;)u=this.reader.readInt(2),d=this.reader.readInt(4),h=this.reader.readData(d),this.zip64ExtensibleData[u]={id:u,length:d,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var u,d;for(u=0;u<this.files.length;u++)d=this.files[u],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var u;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(u=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(u);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var u=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(u<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(u);var d=u;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(u=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(u),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var x=d-h;if(0<x)this.isSignature(d,o.CENTRAL_FILE_HEADER)||(this.reader.zero=x);else if(x<0)throw new Error("Corrupted zip: missing "+Math.abs(x)+" bytes.")},prepareReader:function(u){this.reader=i(u)},load:function(u){this.prepareReader(u),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=f},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,n,a){var i=t("./reader/readerFor"),s=t("./utils"),o=t("./compressedObject"),c=t("./crc32"),l=t("./utf8"),f=t("./compressions"),u=t("./support");function d(h,x){this.options=h,this.loadOptions=x}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var x,p;if(h.skip(22),this.fileNameLength=h.readInt(2),p=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(p),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((x=function(m){for(var g in f)if(Object.prototype.hasOwnProperty.call(f,g)&&f[g].magic===m)return f[g];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,x,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var x=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(x),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=i(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var x,p,m,g=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<g;)x=h.readInt(2),p=h.readInt(2),m=h.readData(p),this.extraFields[x]={id:x,length:p,value:m};h.setIndex(g)},handleUTF8:function(){var h=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var x=this.findExtraFieldUnicodePath();if(x!==null)this.fileNameStr=x;else{var p=s.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(p)}var m=this.findExtraFieldUnicodeComment();if(m!==null)this.fileCommentStr=m;else{var g=s.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(g)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var x=i(h.value);return x.readInt(1)!==1||c(this.fileName)!==x.readInt(4)?null:l.utf8decode(x.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var x=i(h.value);return x.readInt(1)!==1||c(this.fileComment)!==x.readInt(4)?null:l.utf8decode(x.readData(h.length-5))}return null}},n.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,n,a){function i(x,p,m){this.name=x,this.dir=m.dir,this.date=m.date,this.comment=m.comment,this.unixPermissions=m.unixPermissions,this.dosPermissions=m.dosPermissions,this._data=p,this._dataBinary=m.binary,this.options={compression:m.compression,compressionOptions:m.compressionOptions}}var s=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),c=t("./utf8"),l=t("./compressedObject"),f=t("./stream/GenericWorker");i.prototype={internalStream:function(x){var p=null,m="string";try{if(!x)throw new Error("No output type specified.");var g=(m=x.toLowerCase())==="string"||m==="text";m!=="binarystring"&&m!=="text"||(m="string"),p=this._decompressWorker();var w=!this._dataBinary;w&&!g&&(p=p.pipe(new c.Utf8EncodeWorker)),!w&&g&&(p=p.pipe(new c.Utf8DecodeWorker))}catch(v){(p=new f("error")).error(v)}return new s(p,m,"")},async:function(x,p){return this.internalStream(x).accumulate(p)},nodeStream:function(x,p){return this.internalStream(x||"nodebuffer").toNodejsStream(p)},_compressWorker:function(x,p){if(this._data instanceof l&&this._data.compression.magic===x.magic)return this._data.getCompressedWorker();var m=this._decompressWorker();return this._dataBinary||(m=m.pipe(new c.Utf8EncodeWorker)),l.createWorkerFrom(m,x,p)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof f?this._data:new o(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<u.length;h++)i.prototype[u[h]]=d;n.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,n,a){(function(i){var s,o,c=i.MutationObserver||i.WebKitMutationObserver;if(c){var l=0,f=new c(x),u=i.document.createTextNode("");f.observe(u,{characterData:!0}),s=function(){u.data=l=++l%2}}else if(i.setImmediate||i.MessageChannel===void 0)s="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var p=i.document.createElement("script");p.onreadystatechange=function(){x(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},i.document.documentElement.appendChild(p)}:function(){setTimeout(x,0)};else{var d=new i.MessageChannel;d.port1.onmessage=x,s=function(){d.port2.postMessage(0)}}var h=[];function x(){var p,m;o=!0;for(var g=h.length;g;){for(m=h,h=[],p=-1;++p<g;)m[p]();g=h.length}o=!1}n.exports=function(p){h.push(p)!==1||o||s()}}).call(this,typeof Ei<"u"?Ei:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,n,a){var i=t("immediate");function s(){}var o={},c=["REJECTED"],l=["FULFILLED"],f=["PENDING"];function u(g){if(typeof g!="function")throw new TypeError("resolver must be a function");this.state=f,this.queue=[],this.outcome=void 0,g!==s&&p(this,g)}function d(g,w,v){this.promise=g,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof v=="function"&&(this.onRejected=v,this.callRejected=this.otherCallRejected)}function h(g,w,v){i(function(){var k;try{k=w(v)}catch(A){return o.reject(g,A)}k===g?o.reject(g,new TypeError("Cannot resolve promise with itself")):o.resolve(g,k)})}function x(g){var w=g&&g.then;if(g&&(typeof g=="object"||typeof g=="function")&&typeof w=="function")return function(){w.apply(g,arguments)}}function p(g,w){var v=!1;function k(E){v||(v=!0,o.reject(g,E))}function A(E){v||(v=!0,o.resolve(g,E))}var F=m(function(){w(A,k)});F.status==="error"&&k(F.value)}function m(g,w){var v={};try{v.value=g(w),v.status="success"}catch(k){v.status="error",v.value=k}return v}(n.exports=u).prototype.finally=function(g){if(typeof g!="function")return this;var w=this.constructor;return this.then(function(v){return w.resolve(g()).then(function(){return v})},function(v){return w.resolve(g()).then(function(){throw v})})},u.prototype.catch=function(g){return this.then(null,g)},u.prototype.then=function(g,w){if(typeof g!="function"&&this.state===l||typeof w!="function"&&this.state===c)return this;var v=new this.constructor(s);return this.state!==f?h(v,this.state===l?g:w,this.outcome):this.queue.push(new d(v,g,w)),v},d.prototype.callFulfilled=function(g){o.resolve(this.promise,g)},d.prototype.otherCallFulfilled=function(g){h(this.promise,this.onFulfilled,g)},d.prototype.callRejected=function(g){o.reject(this.promise,g)},d.prototype.otherCallRejected=function(g){h(this.promise,this.onRejected,g)},o.resolve=function(g,w){var v=m(x,w);if(v.status==="error")return o.reject(g,v.value);var k=v.value;if(k)p(g,k);else{g.state=l,g.outcome=w;for(var A=-1,F=g.queue.length;++A<F;)g.queue[A].callFulfilled(w)}return g},o.reject=function(g,w){g.state=c,g.outcome=w;for(var v=-1,k=g.queue.length;++v<k;)g.queue[v].callRejected(w);return g},u.resolve=function(g){return g instanceof this?g:o.resolve(new this(s),g)},u.reject=function(g){var w=new this(s);return o.reject(w,g)},u.all=function(g){var w=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=g.length,k=!1;if(!v)return this.resolve([]);for(var A=new Array(v),F=0,E=-1,z=new this(s);++E<v;)C(g[E],E);return z;function C(G,H){w.resolve(G).then(function(b){A[H]=b,++F!==v||k||(k=!0,o.resolve(z,A))},function(b){k||(k=!0,o.reject(z,b))})}},u.race=function(g){var w=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=g.length,k=!1;if(!v)return this.resolve([]);for(var A=-1,F=new this(s);++A<v;)E=g[A],w.resolve(E).then(function(z){k||(k=!0,o.resolve(F,z))},function(z){k||(k=!0,o.reject(F,z))});var E;return F}},{immediate:36}],38:[function(t,n,a){var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),n.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,n,a){var i=t("./zlib/deflate"),s=t("./utils/common"),o=t("./utils/strings"),c=t("./zlib/messages"),l=t("./zlib/zstream"),f=Object.prototype.toString,u=0,d=-1,h=0,x=8;function p(g){if(!(this instanceof p))return new p(g);this.options=s.assign({level:d,method:x,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},g||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var v=i.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(v!==u)throw new Error(c[v]);if(w.header&&i.deflateSetHeader(this.strm,w.header),w.dictionary){var k;if(k=typeof w.dictionary=="string"?o.string2buf(w.dictionary):f.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(v=i.deflateSetDictionary(this.strm,k))!==u)throw new Error(c[v]);this._dict_set=!0}}function m(g,w){var v=new p(w);if(v.push(g,!0),v.err)throw v.msg||c[v.err];return v.result}p.prototype.push=function(g,w){var v,k,A=this.strm,F=this.options.chunkSize;if(this.ended)return!1;k=w===~~w?w:w===!0?4:0,typeof g=="string"?A.input=o.string2buf(g):f.call(g)==="[object ArrayBuffer]"?A.input=new Uint8Array(g):A.input=g,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new s.Buf8(F),A.next_out=0,A.avail_out=F),(v=i.deflate(A,k))!==1&&v!==u)return this.onEnd(v),!(this.ended=!0);A.avail_out!==0&&(A.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(s.shrinkBuf(A.output,A.next_out))):this.onData(s.shrinkBuf(A.output,A.next_out)))}while((0<A.avail_in||A.avail_out===0)&&v!==1);return k===4?(v=i.deflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===u):k!==2||(this.onEnd(u),!(A.avail_out=0))},p.prototype.onData=function(g){this.chunks.push(g)},p.prototype.onEnd=function(g){g===u&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},a.Deflate=p,a.deflate=m,a.deflateRaw=function(g,w){return(w=w||{}).raw=!0,m(g,w)},a.gzip=function(g,w){return(w=w||{}).gzip=!0,m(g,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,n,a){var i=t("./zlib/inflate"),s=t("./utils/common"),o=t("./utils/strings"),c=t("./zlib/constants"),l=t("./zlib/messages"),f=t("./zlib/zstream"),u=t("./zlib/gzheader"),d=Object.prototype.toString;function h(p){if(!(this instanceof h))return new h(p);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},p||{});var m=this.options;m.raw&&0<=m.windowBits&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),!(0<=m.windowBits&&m.windowBits<16)||p&&p.windowBits||(m.windowBits+=32),15<m.windowBits&&m.windowBits<48&&(15&m.windowBits)==0&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var g=i.inflateInit2(this.strm,m.windowBits);if(g!==c.Z_OK)throw new Error(l[g]);this.header=new u,i.inflateGetHeader(this.strm,this.header)}function x(p,m){var g=new h(m);if(g.push(p,!0),g.err)throw g.msg||l[g.err];return g.result}h.prototype.push=function(p,m){var g,w,v,k,A,F,E=this.strm,z=this.options.chunkSize,C=this.options.dictionary,G=!1;if(this.ended)return!1;w=m===~~m?m:m===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof p=="string"?E.input=o.binstring2buf(p):d.call(p)==="[object ArrayBuffer]"?E.input=new Uint8Array(p):E.input=p,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new s.Buf8(z),E.next_out=0,E.avail_out=z),(g=i.inflate(E,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&C&&(F=typeof C=="string"?o.string2buf(C):d.call(C)==="[object ArrayBuffer]"?new Uint8Array(C):C,g=i.inflateSetDictionary(this.strm,F)),g===c.Z_BUF_ERROR&&G===!0&&(g=c.Z_OK,G=!1),g!==c.Z_STREAM_END&&g!==c.Z_OK)return this.onEnd(g),!(this.ended=!0);E.next_out&&(E.avail_out!==0&&g!==c.Z_STREAM_END&&(E.avail_in!==0||w!==c.Z_FINISH&&w!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(v=o.utf8border(E.output,E.next_out),k=E.next_out-v,A=o.buf2string(E.output,v),E.next_out=k,E.avail_out=z-k,k&&s.arraySet(E.output,E.output,v,k,0),this.onData(A)):this.onData(s.shrinkBuf(E.output,E.next_out)))),E.avail_in===0&&E.avail_out===0&&(G=!0)}while((0<E.avail_in||E.avail_out===0)&&g!==c.Z_STREAM_END);return g===c.Z_STREAM_END&&(w=c.Z_FINISH),w===c.Z_FINISH?(g=i.inflateEnd(this.strm),this.onEnd(g),this.ended=!0,g===c.Z_OK):w!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(E.avail_out=0))},h.prototype.onData=function(p){this.chunks.push(p)},h.prototype.onEnd=function(p){p===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},a.Inflate=h,a.inflate=x,a.inflateRaw=function(p,m){return(m=m||{}).raw=!0,x(p,m)},a.ungzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(c){for(var l=Array.prototype.slice.call(arguments,1);l.length;){var f=l.shift();if(f){if(typeof f!="object")throw new TypeError(f+"must be non-object");for(var u in f)f.hasOwnProperty(u)&&(c[u]=f[u])}}return c},a.shrinkBuf=function(c,l){return c.length===l?c:c.subarray?c.subarray(0,l):(c.length=l,c)};var s={arraySet:function(c,l,f,u,d){if(l.subarray&&c.subarray)c.set(l.subarray(f,f+u),d);else for(var h=0;h<u;h++)c[d+h]=l[f+h]},flattenChunks:function(c){var l,f,u,d,h,x;for(l=u=0,f=c.length;l<f;l++)u+=c[l].length;for(x=new Uint8Array(u),l=d=0,f=c.length;l<f;l++)h=c[l],x.set(h,d),d+=h.length;return x}},o={arraySet:function(c,l,f,u,d){for(var h=0;h<u;h++)c[d+h]=l[f+h]},flattenChunks:function(c){return[].concat.apply([],c)}};a.setTyped=function(c){c?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,s)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,o))},a.setTyped(i)},{}],42:[function(t,n,a){var i=t("./common"),s=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var c=new i.Buf8(256),l=0;l<256;l++)c[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function f(u,d){if(d<65537&&(u.subarray&&o||!u.subarray&&s))return String.fromCharCode.apply(null,i.shrinkBuf(u,d));for(var h="",x=0;x<d;x++)h+=String.fromCharCode(u[x]);return h}c[254]=c[254]=1,a.string2buf=function(u){var d,h,x,p,m,g=u.length,w=0;for(p=0;p<g;p++)(64512&(h=u.charCodeAt(p)))==55296&&p+1<g&&(64512&(x=u.charCodeAt(p+1)))==56320&&(h=65536+(h-55296<<10)+(x-56320),p++),w+=h<128?1:h<2048?2:h<65536?3:4;for(d=new i.Buf8(w),p=m=0;m<w;p++)(64512&(h=u.charCodeAt(p)))==55296&&p+1<g&&(64512&(x=u.charCodeAt(p+1)))==56320&&(h=65536+(h-55296<<10)+(x-56320),p++),h<128?d[m++]=h:(h<2048?d[m++]=192|h>>>6:(h<65536?d[m++]=224|h>>>12:(d[m++]=240|h>>>18,d[m++]=128|h>>>12&63),d[m++]=128|h>>>6&63),d[m++]=128|63&h);return d},a.buf2binstring=function(u){return f(u,u.length)},a.binstring2buf=function(u){for(var d=new i.Buf8(u.length),h=0,x=d.length;h<x;h++)d[h]=u.charCodeAt(h);return d},a.buf2string=function(u,d){var h,x,p,m,g=d||u.length,w=new Array(2*g);for(h=x=0;h<g;)if((p=u[h++])<128)w[x++]=p;else if(4<(m=c[p]))w[x++]=65533,h+=m-1;else{for(p&=m===2?31:m===3?15:7;1<m&&h<g;)p=p<<6|63&u[h++],m--;1<m?w[x++]=65533:p<65536?w[x++]=p:(p-=65536,w[x++]=55296|p>>10&1023,w[x++]=56320|1023&p)}return f(w,x)},a.utf8border=function(u,d){var h;for((d=d||u.length)>u.length&&(d=u.length),h=d-1;0<=h&&(192&u[h])==128;)h--;return h<0||h===0?d:h+c[u[h]]>d?h:d}},{"./common":41}],43:[function(t,n,a){n.exports=function(i,s,o,c){for(var l=65535&i|0,f=i>>>16&65535|0,u=0;o!==0;){for(o-=u=2e3<o?2e3:o;f=f+(l=l+s[c++]|0)|0,--u;);l%=65521,f%=65521}return l|f<<16|0}},{}],44:[function(t,n,a){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,n,a){var i=function(){for(var s,o=[],c=0;c<256;c++){s=c;for(var l=0;l<8;l++)s=1&s?3988292384^s>>>1:s>>>1;o[c]=s}return o}();n.exports=function(s,o,c,l){var f=i,u=l+c;s^=-1;for(var d=l;d<u;d++)s=s>>>8^f[255&(s^o[d])];return-1^s}},{}],46:[function(t,n,a){var i,s=t("../utils/common"),o=t("./trees"),c=t("./adler32"),l=t("./crc32"),f=t("./messages"),u=0,d=4,h=0,x=-2,p=-1,m=4,g=2,w=8,v=9,k=286,A=30,F=19,E=2*k+1,z=15,C=3,G=258,H=G+C+1,b=42,j=113,_=1,W=2,q=3,X=4;function ue(y,ae){return y.msg=f[ae],ae}function P(y){return(y<<1)-(4<y?9:0)}function se(y){for(var ae=y.length;0<=--ae;)y[ae]=0}function Y(y){var ae=y.state,Z=ae.pending;Z>y.avail_out&&(Z=y.avail_out),Z!==0&&(s.arraySet(y.output,ae.pending_buf,ae.pending_out,Z,y.next_out),y.next_out+=Z,ae.pending_out+=Z,y.total_out+=Z,y.avail_out-=Z,ae.pending-=Z,ae.pending===0&&(ae.pending_out=0))}function T(y,ae){o._tr_flush_block(y,0<=y.block_start?y.block_start:-1,y.strstart-y.block_start,ae),y.block_start=y.strstart,Y(y.strm)}function K(y,ae){y.pending_buf[y.pending++]=ae}function B(y,ae){y.pending_buf[y.pending++]=ae>>>8&255,y.pending_buf[y.pending++]=255&ae}function N(y,ae){var Z,R,O=y.max_chain_length,J=y.strstart,ce=y.prev_length,de=y.nice_match,Q=y.strstart>y.w_size-H?y.strstart-(y.w_size-H):0,xe=y.window,ve=y.w_mask,me=y.prev,Ee=y.strstart+G,$e=xe[J+ce-1],Ae=xe[J+ce];y.prev_length>=y.good_match&&(O>>=2),de>y.lookahead&&(de=y.lookahead);do if(xe[(Z=ae)+ce]===Ae&&xe[Z+ce-1]===$e&&xe[Z]===xe[J]&&xe[++Z]===xe[J+1]){J+=2,Z++;do;while(xe[++J]===xe[++Z]&&xe[++J]===xe[++Z]&&xe[++J]===xe[++Z]&&xe[++J]===xe[++Z]&&xe[++J]===xe[++Z]&&xe[++J]===xe[++Z]&&xe[++J]===xe[++Z]&&xe[++J]===xe[++Z]&&J<Ee);if(R=G-(Ee-J),J=Ee-G,ce<R){if(y.match_start=ae,de<=(ce=R))break;$e=xe[J+ce-1],Ae=xe[J+ce]}}while((ae=me[ae&ve])>Q&&--O!=0);return ce<=y.lookahead?ce:y.lookahead}function ie(y){var ae,Z,R,O,J,ce,de,Q,xe,ve,me=y.w_size;do{if(O=y.window_size-y.lookahead-y.strstart,y.strstart>=me+(me-H)){for(s.arraySet(y.window,y.window,me,me,0),y.match_start-=me,y.strstart-=me,y.block_start-=me,ae=Z=y.hash_size;R=y.head[--ae],y.head[ae]=me<=R?R-me:0,--Z;);for(ae=Z=me;R=y.prev[--ae],y.prev[ae]=me<=R?R-me:0,--Z;);O+=me}if(y.strm.avail_in===0)break;if(ce=y.strm,de=y.window,Q=y.strstart+y.lookahead,xe=O,ve=void 0,ve=ce.avail_in,xe<ve&&(ve=xe),Z=ve===0?0:(ce.avail_in-=ve,s.arraySet(de,ce.input,ce.next_in,ve,Q),ce.state.wrap===1?ce.adler=c(ce.adler,de,ve,Q):ce.state.wrap===2&&(ce.adler=l(ce.adler,de,ve,Q)),ce.next_in+=ve,ce.total_in+=ve,ve),y.lookahead+=Z,y.lookahead+y.insert>=C)for(J=y.strstart-y.insert,y.ins_h=y.window[J],y.ins_h=(y.ins_h<<y.hash_shift^y.window[J+1])&y.hash_mask;y.insert&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[J+C-1])&y.hash_mask,y.prev[J&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=J,J++,y.insert--,!(y.lookahead+y.insert<C)););}while(y.lookahead<H&&y.strm.avail_in!==0)}function pe(y,ae){for(var Z,R;;){if(y.lookahead<H){if(ie(y),y.lookahead<H&&ae===u)return _;if(y.lookahead===0)break}if(Z=0,y.lookahead>=C&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+C-1])&y.hash_mask,Z=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),Z!==0&&y.strstart-Z<=y.w_size-H&&(y.match_length=N(y,Z)),y.match_length>=C)if(R=o._tr_tally(y,y.strstart-y.match_start,y.match_length-C),y.lookahead-=y.match_length,y.match_length<=y.max_lazy_match&&y.lookahead>=C){for(y.match_length--;y.strstart++,y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+C-1])&y.hash_mask,Z=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart,--y.match_length!=0;);y.strstart++}else y.strstart+=y.match_length,y.match_length=0,y.ins_h=y.window[y.strstart],y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+1])&y.hash_mask;else R=o._tr_tally(y,0,y.window[y.strstart]),y.lookahead--,y.strstart++;if(R&&(T(y,!1),y.strm.avail_out===0))return _}return y.insert=y.strstart<C-1?y.strstart:C-1,ae===d?(T(y,!0),y.strm.avail_out===0?q:X):y.last_lit&&(T(y,!1),y.strm.avail_out===0)?_:W}function fe(y,ae){for(var Z,R,O;;){if(y.lookahead<H){if(ie(y),y.lookahead<H&&ae===u)return _;if(y.lookahead===0)break}if(Z=0,y.lookahead>=C&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+C-1])&y.hash_mask,Z=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),y.prev_length=y.match_length,y.prev_match=y.match_start,y.match_length=C-1,Z!==0&&y.prev_length<y.max_lazy_match&&y.strstart-Z<=y.w_size-H&&(y.match_length=N(y,Z),y.match_length<=5&&(y.strategy===1||y.match_length===C&&4096<y.strstart-y.match_start)&&(y.match_length=C-1)),y.prev_length>=C&&y.match_length<=y.prev_length){for(O=y.strstart+y.lookahead-C,R=o._tr_tally(y,y.strstart-1-y.prev_match,y.prev_length-C),y.lookahead-=y.prev_length-1,y.prev_length-=2;++y.strstart<=O&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+C-1])&y.hash_mask,Z=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),--y.prev_length!=0;);if(y.match_available=0,y.match_length=C-1,y.strstart++,R&&(T(y,!1),y.strm.avail_out===0))return _}else if(y.match_available){if((R=o._tr_tally(y,0,y.window[y.strstart-1]))&&T(y,!1),y.strstart++,y.lookahead--,y.strm.avail_out===0)return _}else y.match_available=1,y.strstart++,y.lookahead--}return y.match_available&&(R=o._tr_tally(y,0,y.window[y.strstart-1]),y.match_available=0),y.insert=y.strstart<C-1?y.strstart:C-1,ae===d?(T(y,!0),y.strm.avail_out===0?q:X):y.last_lit&&(T(y,!1),y.strm.avail_out===0)?_:W}function le(y,ae,Z,R,O){this.good_length=y,this.max_lazy=ae,this.nice_length=Z,this.max_chain=R,this.func=O}function he(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*E),this.dyn_dtree=new s.Buf16(2*(2*A+1)),this.bl_tree=new s.Buf16(2*(2*F+1)),se(this.dyn_ltree),se(this.dyn_dtree),se(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(z+1),this.heap=new s.Buf16(2*k+1),se(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*k+1),se(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function be(y){var ae;return y&&y.state?(y.total_in=y.total_out=0,y.data_type=g,(ae=y.state).pending=0,ae.pending_out=0,ae.wrap<0&&(ae.wrap=-ae.wrap),ae.status=ae.wrap?b:j,y.adler=ae.wrap===2?0:1,ae.last_flush=u,o._tr_init(ae),h):ue(y,x)}function V(y){var ae=be(y);return ae===h&&function(Z){Z.window_size=2*Z.w_size,se(Z.head),Z.max_lazy_match=i[Z.level].max_lazy,Z.good_match=i[Z.level].good_length,Z.nice_match=i[Z.level].nice_length,Z.max_chain_length=i[Z.level].max_chain,Z.strstart=0,Z.block_start=0,Z.lookahead=0,Z.insert=0,Z.match_length=Z.prev_length=C-1,Z.match_available=0,Z.ins_h=0}(y.state),ae}function Ue(y,ae,Z,R,O,J){if(!y)return x;var ce=1;if(ae===p&&(ae=6),R<0?(ce=0,R=-R):15<R&&(ce=2,R-=16),O<1||v<O||Z!==w||R<8||15<R||ae<0||9<ae||J<0||m<J)return ue(y,x);R===8&&(R=9);var de=new he;return(y.state=de).strm=y,de.wrap=ce,de.gzhead=null,de.w_bits=R,de.w_size=1<<de.w_bits,de.w_mask=de.w_size-1,de.hash_bits=O+7,de.hash_size=1<<de.hash_bits,de.hash_mask=de.hash_size-1,de.hash_shift=~~((de.hash_bits+C-1)/C),de.window=new s.Buf8(2*de.w_size),de.head=new s.Buf16(de.hash_size),de.prev=new s.Buf16(de.w_size),de.lit_bufsize=1<<O+6,de.pending_buf_size=4*de.lit_bufsize,de.pending_buf=new s.Buf8(de.pending_buf_size),de.d_buf=1*de.lit_bufsize,de.l_buf=3*de.lit_bufsize,de.level=ae,de.strategy=J,de.method=Z,V(y)}i=[new le(0,0,0,0,function(y,ae){var Z=65535;for(Z>y.pending_buf_size-5&&(Z=y.pending_buf_size-5);;){if(y.lookahead<=1){if(ie(y),y.lookahead===0&&ae===u)return _;if(y.lookahead===0)break}y.strstart+=y.lookahead,y.lookahead=0;var R=y.block_start+Z;if((y.strstart===0||y.strstart>=R)&&(y.lookahead=y.strstart-R,y.strstart=R,T(y,!1),y.strm.avail_out===0)||y.strstart-y.block_start>=y.w_size-H&&(T(y,!1),y.strm.avail_out===0))return _}return y.insert=0,ae===d?(T(y,!0),y.strm.avail_out===0?q:X):(y.strstart>y.block_start&&(T(y,!1),y.strm.avail_out),_)}),new le(4,4,8,4,pe),new le(4,5,16,8,pe),new le(4,6,32,32,pe),new le(4,4,16,16,fe),new le(8,16,32,32,fe),new le(8,16,128,128,fe),new le(8,32,128,256,fe),new le(32,128,258,1024,fe),new le(32,258,258,4096,fe)],a.deflateInit=function(y,ae){return Ue(y,ae,w,15,8,0)},a.deflateInit2=Ue,a.deflateReset=V,a.deflateResetKeep=be,a.deflateSetHeader=function(y,ae){return y&&y.state?y.state.wrap!==2?x:(y.state.gzhead=ae,h):x},a.deflate=function(y,ae){var Z,R,O,J;if(!y||!y.state||5<ae||ae<0)return y?ue(y,x):x;if(R=y.state,!y.output||!y.input&&y.avail_in!==0||R.status===666&&ae!==d)return ue(y,y.avail_out===0?-5:x);if(R.strm=y,Z=R.last_flush,R.last_flush=ae,R.status===b)if(R.wrap===2)y.adler=0,K(R,31),K(R,139),K(R,8),R.gzhead?(K(R,(R.gzhead.text?1:0)+(R.gzhead.hcrc?2:0)+(R.gzhead.extra?4:0)+(R.gzhead.name?8:0)+(R.gzhead.comment?16:0)),K(R,255&R.gzhead.time),K(R,R.gzhead.time>>8&255),K(R,R.gzhead.time>>16&255),K(R,R.gzhead.time>>24&255),K(R,R.level===9?2:2<=R.strategy||R.level<2?4:0),K(R,255&R.gzhead.os),R.gzhead.extra&&R.gzhead.extra.length&&(K(R,255&R.gzhead.extra.length),K(R,R.gzhead.extra.length>>8&255)),R.gzhead.hcrc&&(y.adler=l(y.adler,R.pending_buf,R.pending,0)),R.gzindex=0,R.status=69):(K(R,0),K(R,0),K(R,0),K(R,0),K(R,0),K(R,R.level===9?2:2<=R.strategy||R.level<2?4:0),K(R,3),R.status=j);else{var ce=w+(R.w_bits-8<<4)<<8;ce|=(2<=R.strategy||R.level<2?0:R.level<6?1:R.level===6?2:3)<<6,R.strstart!==0&&(ce|=32),ce+=31-ce%31,R.status=j,B(R,ce),R.strstart!==0&&(B(R,y.adler>>>16),B(R,65535&y.adler)),y.adler=1}if(R.status===69)if(R.gzhead.extra){for(O=R.pending;R.gzindex<(65535&R.gzhead.extra.length)&&(R.pending!==R.pending_buf_size||(R.gzhead.hcrc&&R.pending>O&&(y.adler=l(y.adler,R.pending_buf,R.pending-O,O)),Y(y),O=R.pending,R.pending!==R.pending_buf_size));)K(R,255&R.gzhead.extra[R.gzindex]),R.gzindex++;R.gzhead.hcrc&&R.pending>O&&(y.adler=l(y.adler,R.pending_buf,R.pending-O,O)),R.gzindex===R.gzhead.extra.length&&(R.gzindex=0,R.status=73)}else R.status=73;if(R.status===73)if(R.gzhead.name){O=R.pending;do{if(R.pending===R.pending_buf_size&&(R.gzhead.hcrc&&R.pending>O&&(y.adler=l(y.adler,R.pending_buf,R.pending-O,O)),Y(y),O=R.pending,R.pending===R.pending_buf_size)){J=1;break}J=R.gzindex<R.gzhead.name.length?255&R.gzhead.name.charCodeAt(R.gzindex++):0,K(R,J)}while(J!==0);R.gzhead.hcrc&&R.pending>O&&(y.adler=l(y.adler,R.pending_buf,R.pending-O,O)),J===0&&(R.gzindex=0,R.status=91)}else R.status=91;if(R.status===91)if(R.gzhead.comment){O=R.pending;do{if(R.pending===R.pending_buf_size&&(R.gzhead.hcrc&&R.pending>O&&(y.adler=l(y.adler,R.pending_buf,R.pending-O,O)),Y(y),O=R.pending,R.pending===R.pending_buf_size)){J=1;break}J=R.gzindex<R.gzhead.comment.length?255&R.gzhead.comment.charCodeAt(R.gzindex++):0,K(R,J)}while(J!==0);R.gzhead.hcrc&&R.pending>O&&(y.adler=l(y.adler,R.pending_buf,R.pending-O,O)),J===0&&(R.status=103)}else R.status=103;if(R.status===103&&(R.gzhead.hcrc?(R.pending+2>R.pending_buf_size&&Y(y),R.pending+2<=R.pending_buf_size&&(K(R,255&y.adler),K(R,y.adler>>8&255),y.adler=0,R.status=j)):R.status=j),R.pending!==0){if(Y(y),y.avail_out===0)return R.last_flush=-1,h}else if(y.avail_in===0&&P(ae)<=P(Z)&&ae!==d)return ue(y,-5);if(R.status===666&&y.avail_in!==0)return ue(y,-5);if(y.avail_in!==0||R.lookahead!==0||ae!==u&&R.status!==666){var de=R.strategy===2?function(Q,xe){for(var ve;;){if(Q.lookahead===0&&(ie(Q),Q.lookahead===0)){if(xe===u)return _;break}if(Q.match_length=0,ve=o._tr_tally(Q,0,Q.window[Q.strstart]),Q.lookahead--,Q.strstart++,ve&&(T(Q,!1),Q.strm.avail_out===0))return _}return Q.insert=0,xe===d?(T(Q,!0),Q.strm.avail_out===0?q:X):Q.last_lit&&(T(Q,!1),Q.strm.avail_out===0)?_:W}(R,ae):R.strategy===3?function(Q,xe){for(var ve,me,Ee,$e,Ae=Q.window;;){if(Q.lookahead<=G){if(ie(Q),Q.lookahead<=G&&xe===u)return _;if(Q.lookahead===0)break}if(Q.match_length=0,Q.lookahead>=C&&0<Q.strstart&&(me=Ae[Ee=Q.strstart-1])===Ae[++Ee]&&me===Ae[++Ee]&&me===Ae[++Ee]){$e=Q.strstart+G;do;while(me===Ae[++Ee]&&me===Ae[++Ee]&&me===Ae[++Ee]&&me===Ae[++Ee]&&me===Ae[++Ee]&&me===Ae[++Ee]&&me===Ae[++Ee]&&me===Ae[++Ee]&&Ee<$e);Q.match_length=G-($e-Ee),Q.match_length>Q.lookahead&&(Q.match_length=Q.lookahead)}if(Q.match_length>=C?(ve=o._tr_tally(Q,1,Q.match_length-C),Q.lookahead-=Q.match_length,Q.strstart+=Q.match_length,Q.match_length=0):(ve=o._tr_tally(Q,0,Q.window[Q.strstart]),Q.lookahead--,Q.strstart++),ve&&(T(Q,!1),Q.strm.avail_out===0))return _}return Q.insert=0,xe===d?(T(Q,!0),Q.strm.avail_out===0?q:X):Q.last_lit&&(T(Q,!1),Q.strm.avail_out===0)?_:W}(R,ae):i[R.level].func(R,ae);if(de!==q&&de!==X||(R.status=666),de===_||de===q)return y.avail_out===0&&(R.last_flush=-1),h;if(de===W&&(ae===1?o._tr_align(R):ae!==5&&(o._tr_stored_block(R,0,0,!1),ae===3&&(se(R.head),R.lookahead===0&&(R.strstart=0,R.block_start=0,R.insert=0))),Y(y),y.avail_out===0))return R.last_flush=-1,h}return ae!==d?h:R.wrap<=0?1:(R.wrap===2?(K(R,255&y.adler),K(R,y.adler>>8&255),K(R,y.adler>>16&255),K(R,y.adler>>24&255),K(R,255&y.total_in),K(R,y.total_in>>8&255),K(R,y.total_in>>16&255),K(R,y.total_in>>24&255)):(B(R,y.adler>>>16),B(R,65535&y.adler)),Y(y),0<R.wrap&&(R.wrap=-R.wrap),R.pending!==0?h:1)},a.deflateEnd=function(y){var ae;return y&&y.state?(ae=y.state.status)!==b&&ae!==69&&ae!==73&&ae!==91&&ae!==103&&ae!==j&&ae!==666?ue(y,x):(y.state=null,ae===j?ue(y,-3):h):x},a.deflateSetDictionary=function(y,ae){var Z,R,O,J,ce,de,Q,xe,ve=ae.length;if(!y||!y.state||(J=(Z=y.state).wrap)===2||J===1&&Z.status!==b||Z.lookahead)return x;for(J===1&&(y.adler=c(y.adler,ae,ve,0)),Z.wrap=0,ve>=Z.w_size&&(J===0&&(se(Z.head),Z.strstart=0,Z.block_start=0,Z.insert=0),xe=new s.Buf8(Z.w_size),s.arraySet(xe,ae,ve-Z.w_size,Z.w_size,0),ae=xe,ve=Z.w_size),ce=y.avail_in,de=y.next_in,Q=y.input,y.avail_in=ve,y.next_in=0,y.input=ae,ie(Z);Z.lookahead>=C;){for(R=Z.strstart,O=Z.lookahead-(C-1);Z.ins_h=(Z.ins_h<<Z.hash_shift^Z.window[R+C-1])&Z.hash_mask,Z.prev[R&Z.w_mask]=Z.head[Z.ins_h],Z.head[Z.ins_h]=R,R++,--O;);Z.strstart=R,Z.lookahead=C-1,ie(Z)}return Z.strstart+=Z.lookahead,Z.block_start=Z.strstart,Z.insert=Z.lookahead,Z.lookahead=0,Z.match_length=Z.prev_length=C-1,Z.match_available=0,y.next_in=de,y.input=Q,y.avail_in=ce,Z.wrap=J,h},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,n,a){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,n,a){n.exports=function(i,s){var o,c,l,f,u,d,h,x,p,m,g,w,v,k,A,F,E,z,C,G,H,b,j,_,W;o=i.state,c=i.next_in,_=i.input,l=c+(i.avail_in-5),f=i.next_out,W=i.output,u=f-(s-i.avail_out),d=f+(i.avail_out-257),h=o.dmax,x=o.wsize,p=o.whave,m=o.wnext,g=o.window,w=o.hold,v=o.bits,k=o.lencode,A=o.distcode,F=(1<<o.lenbits)-1,E=(1<<o.distbits)-1;e:do{v<15&&(w+=_[c++]<<v,v+=8,w+=_[c++]<<v,v+=8),z=k[w&F];t:for(;;){if(w>>>=C=z>>>24,v-=C,(C=z>>>16&255)===0)W[f++]=65535&z;else{if(!(16&C)){if((64&C)==0){z=k[(65535&z)+(w&(1<<C)-1)];continue t}if(32&C){o.mode=12;break e}i.msg="invalid literal/length code",o.mode=30;break e}G=65535&z,(C&=15)&&(v<C&&(w+=_[c++]<<v,v+=8),G+=w&(1<<C)-1,w>>>=C,v-=C),v<15&&(w+=_[c++]<<v,v+=8,w+=_[c++]<<v,v+=8),z=A[w&E];r:for(;;){if(w>>>=C=z>>>24,v-=C,!(16&(C=z>>>16&255))){if((64&C)==0){z=A[(65535&z)+(w&(1<<C)-1)];continue r}i.msg="invalid distance code",o.mode=30;break e}if(H=65535&z,v<(C&=15)&&(w+=_[c++]<<v,(v+=8)<C&&(w+=_[c++]<<v,v+=8)),h<(H+=w&(1<<C)-1)){i.msg="invalid distance too far back",o.mode=30;break e}if(w>>>=C,v-=C,(C=f-u)<H){if(p<(C=H-C)&&o.sane){i.msg="invalid distance too far back",o.mode=30;break e}if(j=g,(b=0)===m){if(b+=x-C,C<G){for(G-=C;W[f++]=g[b++],--C;);b=f-H,j=W}}else if(m<C){if(b+=x+m-C,(C-=m)<G){for(G-=C;W[f++]=g[b++],--C;);if(b=0,m<G){for(G-=C=m;W[f++]=g[b++],--C;);b=f-H,j=W}}}else if(b+=m-C,C<G){for(G-=C;W[f++]=g[b++],--C;);b=f-H,j=W}for(;2<G;)W[f++]=j[b++],W[f++]=j[b++],W[f++]=j[b++],G-=3;G&&(W[f++]=j[b++],1<G&&(W[f++]=j[b++]))}else{for(b=f-H;W[f++]=W[b++],W[f++]=W[b++],W[f++]=W[b++],2<(G-=3););G&&(W[f++]=W[b++],1<G&&(W[f++]=W[b++]))}break}}break}}while(c<l&&f<d);c-=G=v>>3,w&=(1<<(v-=G<<3))-1,i.next_in=c,i.next_out=f,i.avail_in=c<l?l-c+5:5-(c-l),i.avail_out=f<d?d-f+257:257-(f-d),o.hold=w,o.bits=v}},{}],49:[function(t,n,a){var i=t("../utils/common"),s=t("./adler32"),o=t("./crc32"),c=t("./inffast"),l=t("./inftrees"),f=1,u=2,d=0,h=-2,x=1,p=852,m=592;function g(b){return(b>>>24&255)+(b>>>8&65280)+((65280&b)<<8)+((255&b)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function v(b){var j;return b&&b.state?(j=b.state,b.total_in=b.total_out=j.total=0,b.msg="",j.wrap&&(b.adler=1&j.wrap),j.mode=x,j.last=0,j.havedict=0,j.dmax=32768,j.head=null,j.hold=0,j.bits=0,j.lencode=j.lendyn=new i.Buf32(p),j.distcode=j.distdyn=new i.Buf32(m),j.sane=1,j.back=-1,d):h}function k(b){var j;return b&&b.state?((j=b.state).wsize=0,j.whave=0,j.wnext=0,v(b)):h}function A(b,j){var _,W;return b&&b.state?(W=b.state,j<0?(_=0,j=-j):(_=1+(j>>4),j<48&&(j&=15)),j&&(j<8||15<j)?h:(W.window!==null&&W.wbits!==j&&(W.window=null),W.wrap=_,W.wbits=j,k(b))):h}function F(b,j){var _,W;return b?(W=new w,(b.state=W).window=null,(_=A(b,j))!==d&&(b.state=null),_):h}var E,z,C=!0;function G(b){if(C){var j;for(E=new i.Buf32(512),z=new i.Buf32(32),j=0;j<144;)b.lens[j++]=8;for(;j<256;)b.lens[j++]=9;for(;j<280;)b.lens[j++]=7;for(;j<288;)b.lens[j++]=8;for(l(f,b.lens,0,288,E,0,b.work,{bits:9}),j=0;j<32;)b.lens[j++]=5;l(u,b.lens,0,32,z,0,b.work,{bits:5}),C=!1}b.lencode=E,b.lenbits=9,b.distcode=z,b.distbits=5}function H(b,j,_,W){var q,X=b.state;return X.window===null&&(X.wsize=1<<X.wbits,X.wnext=0,X.whave=0,X.window=new i.Buf8(X.wsize)),W>=X.wsize?(i.arraySet(X.window,j,_-X.wsize,X.wsize,0),X.wnext=0,X.whave=X.wsize):(W<(q=X.wsize-X.wnext)&&(q=W),i.arraySet(X.window,j,_-W,q,X.wnext),(W-=q)?(i.arraySet(X.window,j,_-W,W,0),X.wnext=W,X.whave=X.wsize):(X.wnext+=q,X.wnext===X.wsize&&(X.wnext=0),X.whave<X.wsize&&(X.whave+=q))),0}a.inflateReset=k,a.inflateReset2=A,a.inflateResetKeep=v,a.inflateInit=function(b){return F(b,15)},a.inflateInit2=F,a.inflate=function(b,j){var _,W,q,X,ue,P,se,Y,T,K,B,N,ie,pe,fe,le,he,be,V,Ue,y,ae,Z,R,O=0,J=new i.Buf8(4),ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!b||!b.state||!b.output||!b.input&&b.avail_in!==0)return h;(_=b.state).mode===12&&(_.mode=13),ue=b.next_out,q=b.output,se=b.avail_out,X=b.next_in,W=b.input,P=b.avail_in,Y=_.hold,T=_.bits,K=P,B=se,ae=d;e:for(;;)switch(_.mode){case x:if(_.wrap===0){_.mode=13;break}for(;T<16;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}if(2&_.wrap&&Y===35615){J[_.check=0]=255&Y,J[1]=Y>>>8&255,_.check=o(_.check,J,2,0),T=Y=0,_.mode=2;break}if(_.flags=0,_.head&&(_.head.done=!1),!(1&_.wrap)||(((255&Y)<<8)+(Y>>8))%31){b.msg="incorrect header check",_.mode=30;break}if((15&Y)!=8){b.msg="unknown compression method",_.mode=30;break}if(T-=4,y=8+(15&(Y>>>=4)),_.wbits===0)_.wbits=y;else if(y>_.wbits){b.msg="invalid window size",_.mode=30;break}_.dmax=1<<y,b.adler=_.check=1,_.mode=512&Y?10:12,T=Y=0;break;case 2:for(;T<16;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}if(_.flags=Y,(255&_.flags)!=8){b.msg="unknown compression method",_.mode=30;break}if(57344&_.flags){b.msg="unknown header flags set",_.mode=30;break}_.head&&(_.head.text=Y>>8&1),512&_.flags&&(J[0]=255&Y,J[1]=Y>>>8&255,_.check=o(_.check,J,2,0)),T=Y=0,_.mode=3;case 3:for(;T<32;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}_.head&&(_.head.time=Y),512&_.flags&&(J[0]=255&Y,J[1]=Y>>>8&255,J[2]=Y>>>16&255,J[3]=Y>>>24&255,_.check=o(_.check,J,4,0)),T=Y=0,_.mode=4;case 4:for(;T<16;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}_.head&&(_.head.xflags=255&Y,_.head.os=Y>>8),512&_.flags&&(J[0]=255&Y,J[1]=Y>>>8&255,_.check=o(_.check,J,2,0)),T=Y=0,_.mode=5;case 5:if(1024&_.flags){for(;T<16;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}_.length=Y,_.head&&(_.head.extra_len=Y),512&_.flags&&(J[0]=255&Y,J[1]=Y>>>8&255,_.check=o(_.check,J,2,0)),T=Y=0}else _.head&&(_.head.extra=null);_.mode=6;case 6:if(1024&_.flags&&(P<(N=_.length)&&(N=P),N&&(_.head&&(y=_.head.extra_len-_.length,_.head.extra||(_.head.extra=new Array(_.head.extra_len)),i.arraySet(_.head.extra,W,X,N,y)),512&_.flags&&(_.check=o(_.check,W,N,X)),P-=N,X+=N,_.length-=N),_.length))break e;_.length=0,_.mode=7;case 7:if(2048&_.flags){if(P===0)break e;for(N=0;y=W[X+N++],_.head&&y&&_.length<65536&&(_.head.name+=String.fromCharCode(y)),y&&N<P;);if(512&_.flags&&(_.check=o(_.check,W,N,X)),P-=N,X+=N,y)break e}else _.head&&(_.head.name=null);_.length=0,_.mode=8;case 8:if(4096&_.flags){if(P===0)break e;for(N=0;y=W[X+N++],_.head&&y&&_.length<65536&&(_.head.comment+=String.fromCharCode(y)),y&&N<P;);if(512&_.flags&&(_.check=o(_.check,W,N,X)),P-=N,X+=N,y)break e}else _.head&&(_.head.comment=null);_.mode=9;case 9:if(512&_.flags){for(;T<16;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}if(Y!==(65535&_.check)){b.msg="header crc mismatch",_.mode=30;break}T=Y=0}_.head&&(_.head.hcrc=_.flags>>9&1,_.head.done=!0),b.adler=_.check=0,_.mode=12;break;case 10:for(;T<32;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}b.adler=_.check=g(Y),T=Y=0,_.mode=11;case 11:if(_.havedict===0)return b.next_out=ue,b.avail_out=se,b.next_in=X,b.avail_in=P,_.hold=Y,_.bits=T,2;b.adler=_.check=1,_.mode=12;case 12:if(j===5||j===6)break e;case 13:if(_.last){Y>>>=7&T,T-=7&T,_.mode=27;break}for(;T<3;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}switch(_.last=1&Y,T-=1,3&(Y>>>=1)){case 0:_.mode=14;break;case 1:if(G(_),_.mode=20,j!==6)break;Y>>>=2,T-=2;break e;case 2:_.mode=17;break;case 3:b.msg="invalid block type",_.mode=30}Y>>>=2,T-=2;break;case 14:for(Y>>>=7&T,T-=7&T;T<32;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}if((65535&Y)!=(Y>>>16^65535)){b.msg="invalid stored block lengths",_.mode=30;break}if(_.length=65535&Y,T=Y=0,_.mode=15,j===6)break e;case 15:_.mode=16;case 16:if(N=_.length){if(P<N&&(N=P),se<N&&(N=se),N===0)break e;i.arraySet(q,W,X,N,ue),P-=N,X+=N,se-=N,ue+=N,_.length-=N;break}_.mode=12;break;case 17:for(;T<14;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}if(_.nlen=257+(31&Y),Y>>>=5,T-=5,_.ndist=1+(31&Y),Y>>>=5,T-=5,_.ncode=4+(15&Y),Y>>>=4,T-=4,286<_.nlen||30<_.ndist){b.msg="too many length or distance symbols",_.mode=30;break}_.have=0,_.mode=18;case 18:for(;_.have<_.ncode;){for(;T<3;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}_.lens[ce[_.have++]]=7&Y,Y>>>=3,T-=3}for(;_.have<19;)_.lens[ce[_.have++]]=0;if(_.lencode=_.lendyn,_.lenbits=7,Z={bits:_.lenbits},ae=l(0,_.lens,0,19,_.lencode,0,_.work,Z),_.lenbits=Z.bits,ae){b.msg="invalid code lengths set",_.mode=30;break}_.have=0,_.mode=19;case 19:for(;_.have<_.nlen+_.ndist;){for(;le=(O=_.lencode[Y&(1<<_.lenbits)-1])>>>16&255,he=65535&O,!((fe=O>>>24)<=T);){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}if(he<16)Y>>>=fe,T-=fe,_.lens[_.have++]=he;else{if(he===16){for(R=fe+2;T<R;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}if(Y>>>=fe,T-=fe,_.have===0){b.msg="invalid bit length repeat",_.mode=30;break}y=_.lens[_.have-1],N=3+(3&Y),Y>>>=2,T-=2}else if(he===17){for(R=fe+3;T<R;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}T-=fe,y=0,N=3+(7&(Y>>>=fe)),Y>>>=3,T-=3}else{for(R=fe+7;T<R;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}T-=fe,y=0,N=11+(127&(Y>>>=fe)),Y>>>=7,T-=7}if(_.have+N>_.nlen+_.ndist){b.msg="invalid bit length repeat",_.mode=30;break}for(;N--;)_.lens[_.have++]=y}}if(_.mode===30)break;if(_.lens[256]===0){b.msg="invalid code -- missing end-of-block",_.mode=30;break}if(_.lenbits=9,Z={bits:_.lenbits},ae=l(f,_.lens,0,_.nlen,_.lencode,0,_.work,Z),_.lenbits=Z.bits,ae){b.msg="invalid literal/lengths set",_.mode=30;break}if(_.distbits=6,_.distcode=_.distdyn,Z={bits:_.distbits},ae=l(u,_.lens,_.nlen,_.ndist,_.distcode,0,_.work,Z),_.distbits=Z.bits,ae){b.msg="invalid distances set",_.mode=30;break}if(_.mode=20,j===6)break e;case 20:_.mode=21;case 21:if(6<=P&&258<=se){b.next_out=ue,b.avail_out=se,b.next_in=X,b.avail_in=P,_.hold=Y,_.bits=T,c(b,B),ue=b.next_out,q=b.output,se=b.avail_out,X=b.next_in,W=b.input,P=b.avail_in,Y=_.hold,T=_.bits,_.mode===12&&(_.back=-1);break}for(_.back=0;le=(O=_.lencode[Y&(1<<_.lenbits)-1])>>>16&255,he=65535&O,!((fe=O>>>24)<=T);){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}if(le&&(240&le)==0){for(be=fe,V=le,Ue=he;le=(O=_.lencode[Ue+((Y&(1<<be+V)-1)>>be)])>>>16&255,he=65535&O,!(be+(fe=O>>>24)<=T);){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}Y>>>=be,T-=be,_.back+=be}if(Y>>>=fe,T-=fe,_.back+=fe,_.length=he,le===0){_.mode=26;break}if(32&le){_.back=-1,_.mode=12;break}if(64&le){b.msg="invalid literal/length code",_.mode=30;break}_.extra=15&le,_.mode=22;case 22:if(_.extra){for(R=_.extra;T<R;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}_.length+=Y&(1<<_.extra)-1,Y>>>=_.extra,T-=_.extra,_.back+=_.extra}_.was=_.length,_.mode=23;case 23:for(;le=(O=_.distcode[Y&(1<<_.distbits)-1])>>>16&255,he=65535&O,!((fe=O>>>24)<=T);){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}if((240&le)==0){for(be=fe,V=le,Ue=he;le=(O=_.distcode[Ue+((Y&(1<<be+V)-1)>>be)])>>>16&255,he=65535&O,!(be+(fe=O>>>24)<=T);){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}Y>>>=be,T-=be,_.back+=be}if(Y>>>=fe,T-=fe,_.back+=fe,64&le){b.msg="invalid distance code",_.mode=30;break}_.offset=he,_.extra=15&le,_.mode=24;case 24:if(_.extra){for(R=_.extra;T<R;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}_.offset+=Y&(1<<_.extra)-1,Y>>>=_.extra,T-=_.extra,_.back+=_.extra}if(_.offset>_.dmax){b.msg="invalid distance too far back",_.mode=30;break}_.mode=25;case 25:if(se===0)break e;if(N=B-se,_.offset>N){if((N=_.offset-N)>_.whave&&_.sane){b.msg="invalid distance too far back",_.mode=30;break}ie=N>_.wnext?(N-=_.wnext,_.wsize-N):_.wnext-N,N>_.length&&(N=_.length),pe=_.window}else pe=q,ie=ue-_.offset,N=_.length;for(se<N&&(N=se),se-=N,_.length-=N;q[ue++]=pe[ie++],--N;);_.length===0&&(_.mode=21);break;case 26:if(se===0)break e;q[ue++]=_.length,se--,_.mode=21;break;case 27:if(_.wrap){for(;T<32;){if(P===0)break e;P--,Y|=W[X++]<<T,T+=8}if(B-=se,b.total_out+=B,_.total+=B,B&&(b.adler=_.check=_.flags?o(_.check,q,B,ue-B):s(_.check,q,B,ue-B)),B=se,(_.flags?Y:g(Y))!==_.check){b.msg="incorrect data check",_.mode=30;break}T=Y=0}_.mode=28;case 28:if(_.wrap&&_.flags){for(;T<32;){if(P===0)break e;P--,Y+=W[X++]<<T,T+=8}if(Y!==(4294967295&_.total)){b.msg="incorrect length check",_.mode=30;break}T=Y=0}_.mode=29;case 29:ae=1;break e;case 30:ae=-3;break e;case 31:return-4;case 32:default:return h}return b.next_out=ue,b.avail_out=se,b.next_in=X,b.avail_in=P,_.hold=Y,_.bits=T,(_.wsize||B!==b.avail_out&&_.mode<30&&(_.mode<27||j!==4))&&H(b,b.output,b.next_out,B-b.avail_out)?(_.mode=31,-4):(K-=b.avail_in,B-=b.avail_out,b.total_in+=K,b.total_out+=B,_.total+=B,_.wrap&&B&&(b.adler=_.check=_.flags?o(_.check,q,B,b.next_out-B):s(_.check,q,B,b.next_out-B)),b.data_type=_.bits+(_.last?64:0)+(_.mode===12?128:0)+(_.mode===20||_.mode===15?256:0),(K==0&&B===0||j===4)&&ae===d&&(ae=-5),ae)},a.inflateEnd=function(b){if(!b||!b.state)return h;var j=b.state;return j.window&&(j.window=null),b.state=null,d},a.inflateGetHeader=function(b,j){var _;return b&&b.state?(2&(_=b.state).wrap)==0?h:((_.head=j).done=!1,d):h},a.inflateSetDictionary=function(b,j){var _,W=j.length;return b&&b.state?(_=b.state).wrap!==0&&_.mode!==11?h:_.mode===11&&s(1,j,W,0)!==_.check?-3:H(b,j,W,W)?(_.mode=31,-4):(_.havedict=1,d):h},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,n,a){var i=t("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(f,u,d,h,x,p,m,g){var w,v,k,A,F,E,z,C,G,H=g.bits,b=0,j=0,_=0,W=0,q=0,X=0,ue=0,P=0,se=0,Y=0,T=null,K=0,B=new i.Buf16(16),N=new i.Buf16(16),ie=null,pe=0;for(b=0;b<=15;b++)B[b]=0;for(j=0;j<h;j++)B[u[d+j]]++;for(q=H,W=15;1<=W&&B[W]===0;W--);if(W<q&&(q=W),W===0)return x[p++]=20971520,x[p++]=20971520,g.bits=1,0;for(_=1;_<W&&B[_]===0;_++);for(q<_&&(q=_),b=P=1;b<=15;b++)if(P<<=1,(P-=B[b])<0)return-1;if(0<P&&(f===0||W!==1))return-1;for(N[1]=0,b=1;b<15;b++)N[b+1]=N[b]+B[b];for(j=0;j<h;j++)u[d+j]!==0&&(m[N[u[d+j]]++]=j);if(E=f===0?(T=ie=m,19):f===1?(T=s,K-=257,ie=o,pe-=257,256):(T=c,ie=l,-1),b=_,F=p,ue=j=Y=0,k=-1,A=(se=1<<(X=q))-1,f===1&&852<se||f===2&&592<se)return 1;for(;;){for(z=b-ue,G=m[j]<E?(C=0,m[j]):m[j]>E?(C=ie[pe+m[j]],T[K+m[j]]):(C=96,0),w=1<<b-ue,_=v=1<<X;x[F+(Y>>ue)+(v-=w)]=z<<24|C<<16|G|0,v!==0;);for(w=1<<b-1;Y&w;)w>>=1;if(w!==0?(Y&=w-1,Y+=w):Y=0,j++,--B[b]==0){if(b===W)break;b=u[d+m[j]]}if(q<b&&(Y&A)!==k){for(ue===0&&(ue=q),F+=_,P=1<<(X=b-ue);X+ue<W&&!((P-=B[X+ue])<=0);)X++,P<<=1;if(se+=1<<X,f===1&&852<se||f===2&&592<se)return 1;x[k=Y&A]=q<<24|X<<16|F-p|0}}return Y!==0&&(x[F+Y]=b-ue<<24|64<<16|0),g.bits=q,0}},{"../utils/common":41}],51:[function(t,n,a){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,n,a){var i=t("../utils/common"),s=0,o=1;function c(O){for(var J=O.length;0<=--J;)O[J]=0}var l=0,f=29,u=256,d=u+1+f,h=30,x=19,p=2*d+1,m=15,g=16,w=7,v=256,k=16,A=17,F=18,E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=new Array(2*(d+2));c(H);var b=new Array(2*h);c(b);var j=new Array(512);c(j);var _=new Array(256);c(_);var W=new Array(f);c(W);var q,X,ue,P=new Array(h);function se(O,J,ce,de,Q){this.static_tree=O,this.extra_bits=J,this.extra_base=ce,this.elems=de,this.max_length=Q,this.has_stree=O&&O.length}function Y(O,J){this.dyn_tree=O,this.max_code=0,this.stat_desc=J}function T(O){return O<256?j[O]:j[256+(O>>>7)]}function K(O,J){O.pending_buf[O.pending++]=255&J,O.pending_buf[O.pending++]=J>>>8&255}function B(O,J,ce){O.bi_valid>g-ce?(O.bi_buf|=J<<O.bi_valid&65535,K(O,O.bi_buf),O.bi_buf=J>>g-O.bi_valid,O.bi_valid+=ce-g):(O.bi_buf|=J<<O.bi_valid&65535,O.bi_valid+=ce)}function N(O,J,ce){B(O,ce[2*J],ce[2*J+1])}function ie(O,J){for(var ce=0;ce|=1&O,O>>>=1,ce<<=1,0<--J;);return ce>>>1}function pe(O,J,ce){var de,Q,xe=new Array(m+1),ve=0;for(de=1;de<=m;de++)xe[de]=ve=ve+ce[de-1]<<1;for(Q=0;Q<=J;Q++){var me=O[2*Q+1];me!==0&&(O[2*Q]=ie(xe[me]++,me))}}function fe(O){var J;for(J=0;J<d;J++)O.dyn_ltree[2*J]=0;for(J=0;J<h;J++)O.dyn_dtree[2*J]=0;for(J=0;J<x;J++)O.bl_tree[2*J]=0;O.dyn_ltree[2*v]=1,O.opt_len=O.static_len=0,O.last_lit=O.matches=0}function le(O){8<O.bi_valid?K(O,O.bi_buf):0<O.bi_valid&&(O.pending_buf[O.pending++]=O.bi_buf),O.bi_buf=0,O.bi_valid=0}function he(O,J,ce,de){var Q=2*J,xe=2*ce;return O[Q]<O[xe]||O[Q]===O[xe]&&de[J]<=de[ce]}function be(O,J,ce){for(var de=O.heap[ce],Q=ce<<1;Q<=O.heap_len&&(Q<O.heap_len&&he(J,O.heap[Q+1],O.heap[Q],O.depth)&&Q++,!he(J,de,O.heap[Q],O.depth));)O.heap[ce]=O.heap[Q],ce=Q,Q<<=1;O.heap[ce]=de}function V(O,J,ce){var de,Q,xe,ve,me=0;if(O.last_lit!==0)for(;de=O.pending_buf[O.d_buf+2*me]<<8|O.pending_buf[O.d_buf+2*me+1],Q=O.pending_buf[O.l_buf+me],me++,de===0?N(O,Q,J):(N(O,(xe=_[Q])+u+1,J),(ve=E[xe])!==0&&B(O,Q-=W[xe],ve),N(O,xe=T(--de),ce),(ve=z[xe])!==0&&B(O,de-=P[xe],ve)),me<O.last_lit;);N(O,v,J)}function Ue(O,J){var ce,de,Q,xe=J.dyn_tree,ve=J.stat_desc.static_tree,me=J.stat_desc.has_stree,Ee=J.stat_desc.elems,$e=-1;for(O.heap_len=0,O.heap_max=p,ce=0;ce<Ee;ce++)xe[2*ce]!==0?(O.heap[++O.heap_len]=$e=ce,O.depth[ce]=0):xe[2*ce+1]=0;for(;O.heap_len<2;)xe[2*(Q=O.heap[++O.heap_len]=$e<2?++$e:0)]=1,O.depth[Q]=0,O.opt_len--,me&&(O.static_len-=ve[2*Q+1]);for(J.max_code=$e,ce=O.heap_len>>1;1<=ce;ce--)be(O,xe,ce);for(Q=Ee;ce=O.heap[1],O.heap[1]=O.heap[O.heap_len--],be(O,xe,1),de=O.heap[1],O.heap[--O.heap_max]=ce,O.heap[--O.heap_max]=de,xe[2*Q]=xe[2*ce]+xe[2*de],O.depth[Q]=(O.depth[ce]>=O.depth[de]?O.depth[ce]:O.depth[de])+1,xe[2*ce+1]=xe[2*de+1]=Q,O.heap[1]=Q++,be(O,xe,1),2<=O.heap_len;);O.heap[--O.heap_max]=O.heap[1],function(Ae,je){var Fe,He,ot,De,Wt,mn,Jt=je.dyn_tree,Ka=je.max_code,qa=je.stat_desc.static_tree,Ja=je.stat_desc.has_stree,Za=je.stat_desc.extra_bits,Qa=je.stat_desc.extra_base,Gr=je.stat_desc.max_length,yr=0;for(De=0;De<=m;De++)Ae.bl_count[De]=0;for(Jt[2*Ae.heap[Ae.heap_max]+1]=0,Fe=Ae.heap_max+1;Fe<p;Fe++)Gr<(De=Jt[2*Jt[2*(He=Ae.heap[Fe])+1]+1]+1)&&(De=Gr,yr++),Jt[2*He+1]=De,Ka<He||(Ae.bl_count[De]++,Wt=0,Qa<=He&&(Wt=Za[He-Qa]),mn=Jt[2*He],Ae.opt_len+=mn*(De+Wt),Ja&&(Ae.static_len+=mn*(qa[2*He+1]+Wt)));if(yr!==0){do{for(De=Gr-1;Ae.bl_count[De]===0;)De--;Ae.bl_count[De]--,Ae.bl_count[De+1]+=2,Ae.bl_count[Gr]--,yr-=2}while(0<yr);for(De=Gr;De!==0;De--)for(He=Ae.bl_count[De];He!==0;)Ka<(ot=Ae.heap[--Fe])||(Jt[2*ot+1]!==De&&(Ae.opt_len+=(De-Jt[2*ot+1])*Jt[2*ot],Jt[2*ot+1]=De),He--)}}(O,J),pe(xe,$e,O.bl_count)}function y(O,J,ce){var de,Q,xe=-1,ve=J[1],me=0,Ee=7,$e=4;for(ve===0&&(Ee=138,$e=3),J[2*(ce+1)+1]=65535,de=0;de<=ce;de++)Q=ve,ve=J[2*(de+1)+1],++me<Ee&&Q===ve||(me<$e?O.bl_tree[2*Q]+=me:Q!==0?(Q!==xe&&O.bl_tree[2*Q]++,O.bl_tree[2*k]++):me<=10?O.bl_tree[2*A]++:O.bl_tree[2*F]++,xe=Q,$e=(me=0)===ve?(Ee=138,3):Q===ve?(Ee=6,3):(Ee=7,4))}function ae(O,J,ce){var de,Q,xe=-1,ve=J[1],me=0,Ee=7,$e=4;for(ve===0&&(Ee=138,$e=3),de=0;de<=ce;de++)if(Q=ve,ve=J[2*(de+1)+1],!(++me<Ee&&Q===ve)){if(me<$e)for(;N(O,Q,O.bl_tree),--me!=0;);else Q!==0?(Q!==xe&&(N(O,Q,O.bl_tree),me--),N(O,k,O.bl_tree),B(O,me-3,2)):me<=10?(N(O,A,O.bl_tree),B(O,me-3,3)):(N(O,F,O.bl_tree),B(O,me-11,7));xe=Q,$e=(me=0)===ve?(Ee=138,3):Q===ve?(Ee=6,3):(Ee=7,4)}}c(P);var Z=!1;function R(O,J,ce,de){B(O,(l<<1)+(de?1:0),3),function(Q,xe,ve,me){le(Q),K(Q,ve),K(Q,~ve),i.arraySet(Q.pending_buf,Q.window,xe,ve,Q.pending),Q.pending+=ve}(O,J,ce)}a._tr_init=function(O){Z||(function(){var J,ce,de,Q,xe,ve=new Array(m+1);for(Q=de=0;Q<f-1;Q++)for(W[Q]=de,J=0;J<1<<E[Q];J++)_[de++]=Q;for(_[de-1]=Q,Q=xe=0;Q<16;Q++)for(P[Q]=xe,J=0;J<1<<z[Q];J++)j[xe++]=Q;for(xe>>=7;Q<h;Q++)for(P[Q]=xe<<7,J=0;J<1<<z[Q]-7;J++)j[256+xe++]=Q;for(ce=0;ce<=m;ce++)ve[ce]=0;for(J=0;J<=143;)H[2*J+1]=8,J++,ve[8]++;for(;J<=255;)H[2*J+1]=9,J++,ve[9]++;for(;J<=279;)H[2*J+1]=7,J++,ve[7]++;for(;J<=287;)H[2*J+1]=8,J++,ve[8]++;for(pe(H,d+1,ve),J=0;J<h;J++)b[2*J+1]=5,b[2*J]=ie(J,5);q=new se(H,E,u+1,d,m),X=new se(b,z,0,h,m),ue=new se(new Array(0),C,0,x,w)}(),Z=!0),O.l_desc=new Y(O.dyn_ltree,q),O.d_desc=new Y(O.dyn_dtree,X),O.bl_desc=new Y(O.bl_tree,ue),O.bi_buf=0,O.bi_valid=0,fe(O)},a._tr_stored_block=R,a._tr_flush_block=function(O,J,ce,de){var Q,xe,ve=0;0<O.level?(O.strm.data_type===2&&(O.strm.data_type=function(me){var Ee,$e=4093624447;for(Ee=0;Ee<=31;Ee++,$e>>>=1)if(1&$e&&me.dyn_ltree[2*Ee]!==0)return s;if(me.dyn_ltree[18]!==0||me.dyn_ltree[20]!==0||me.dyn_ltree[26]!==0)return o;for(Ee=32;Ee<u;Ee++)if(me.dyn_ltree[2*Ee]!==0)return o;return s}(O)),Ue(O,O.l_desc),Ue(O,O.d_desc),ve=function(me){var Ee;for(y(me,me.dyn_ltree,me.l_desc.max_code),y(me,me.dyn_dtree,me.d_desc.max_code),Ue(me,me.bl_desc),Ee=x-1;3<=Ee&&me.bl_tree[2*G[Ee]+1]===0;Ee--);return me.opt_len+=3*(Ee+1)+5+5+4,Ee}(O),Q=O.opt_len+3+7>>>3,(xe=O.static_len+3+7>>>3)<=Q&&(Q=xe)):Q=xe=ce+5,ce+4<=Q&&J!==-1?R(O,J,ce,de):O.strategy===4||xe===Q?(B(O,2+(de?1:0),3),V(O,H,b)):(B(O,4+(de?1:0),3),function(me,Ee,$e,Ae){var je;for(B(me,Ee-257,5),B(me,$e-1,5),B(me,Ae-4,4),je=0;je<Ae;je++)B(me,me.bl_tree[2*G[je]+1],3);ae(me,me.dyn_ltree,Ee-1),ae(me,me.dyn_dtree,$e-1)}(O,O.l_desc.max_code+1,O.d_desc.max_code+1,ve+1),V(O,O.dyn_ltree,O.dyn_dtree)),fe(O),de&&le(O)},a._tr_tally=function(O,J,ce){return O.pending_buf[O.d_buf+2*O.last_lit]=J>>>8&255,O.pending_buf[O.d_buf+2*O.last_lit+1]=255&J,O.pending_buf[O.l_buf+O.last_lit]=255&ce,O.last_lit++,J===0?O.dyn_ltree[2*ce]++:(O.matches++,J--,O.dyn_ltree[2*(_[ce]+u+1)]++,O.dyn_dtree[2*T(J)]++),O.last_lit===O.lit_bufsize-1},a._tr_align=function(O){B(O,2,3),N(O,v,H),function(J){J.bi_valid===16?(K(J,J.bi_buf),J.bi_buf=0,J.bi_valid=0):8<=J.bi_valid&&(J.pending_buf[J.pending++]=255&J.bi_buf,J.bi_buf>>=8,J.bi_valid-=8)}(O)}},{"../utils/common":41}],53:[function(t,n,a){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,n,a){(function(i){(function(s,o){if(!s.setImmediate){var c,l,f,u,d=1,h={},x=!1,p=s.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(s);m=m&&m.setTimeout?m:s,c={}.toString.call(s.process)==="[object process]"?function(k){process.nextTick(function(){w(k)})}:function(){if(s.postMessage&&!s.importScripts){var k=!0,A=s.onmessage;return s.onmessage=function(){k=!1},s.postMessage("","*"),s.onmessage=A,k}}()?(u="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",v,!1):s.attachEvent("onmessage",v),function(k){s.postMessage(u+k,"*")}):s.MessageChannel?((f=new MessageChannel).port1.onmessage=function(k){w(k.data)},function(k){f.port2.postMessage(k)}):p&&"onreadystatechange"in p.createElement("script")?(l=p.documentElement,function(k){var A=p.createElement("script");A.onreadystatechange=function(){w(k),A.onreadystatechange=null,l.removeChild(A),A=null},l.appendChild(A)}):function(k){setTimeout(w,0,k)},m.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var A=new Array(arguments.length-1),F=0;F<A.length;F++)A[F]=arguments[F+1];var E={callback:k,args:A};return h[d]=E,c(d),d++},m.clearImmediate=g}function g(k){delete h[k]}function w(k){if(x)setTimeout(w,0,k);else{var A=h[k];if(A){x=!0;try{(function(F){var E=F.callback,z=F.args;switch(z.length){case 0:E();break;case 1:E(z[0]);break;case 2:E(z[0],z[1]);break;case 3:E(z[0],z[1],z[2]);break;default:E.apply(o,z)}})(A)}finally{g(k),x=!1}}}}function v(k){k.source===s&&typeof k.data=="string"&&k.data.indexOf(u)===0&&w(+k.data.slice(u.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Ei<"u"?Ei:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(ro)),ro.exports}var _A=gA();const vA=mA(_A);class wA extends HTMLElement{constructor(){super();At(this,"shadow");At(this,"stepCards",new Map);At(this,"isFilesVisible",!1);At(this,"_projectResultCache",{});this.shadow=this.attachShadow({mode:"open"}),this.shadow.innerHTML=`
      <style>
        .cluster-container {
          display: flex;
          flex-direction: column;
          padding: 16px;
          font-family: sans-serif;
          overflow-x: hidden;
        }
        .actions {
          margin-top: 12px;
          display: flex;
          flex-wrap: wrap;
          align-items: center;
          gap: 8px; /* spacing between elements */
          width: auto;
        }
        .results {
          margin-top: 16px;
          white-space: pre-wrap;
          font-size: 0.9rem;
          background: #e36a1e;
          color: white;
          padding: 12px;
          border-radius: 6px;
        }
        button {
          background-color: var(--container-bg);
          color: var(--color-text);
          font-size: 14px;
          font-weight: bold;
          border: black 3px solid;
          border-radius: 12px;
          cursor: pointer;
          transform: scale(0.9);
          padding: 10px 16px;
          transition: background-color 0.25s ease, transform 0.1s ease;
        }
        button:hover {
          background-color: #e36a1e;
          border: #e36a1e 3px solid;
          transform: scale(1);
          color: white;
        }

        button.active {
            transition: background-color 0.25s ease;
            background-color:rgb(35, 88, 202);
            border: rgb(35, 88, 202) 3px solid;
            color: white;
        }

        /* Distinct styling for "Download All" button */
        .download-all-btn {
          background-color: #128712;
          border-color: #128712;
          color: #fff;
        }
        .download-all-btn:hover {
          background-color: #0f6b0f;
          border-color: #0f6b0f;
        }

        /* Hidden container for individual file downloads */
        .file-downloads-container {
          margin-top: 16px;
          display: none; /* hidden by default */
          flex-wrap: wrap;
          gap: 8px;
        }
        .file-downloads-container.show {
          display: flex; /* show it when toggled */
        }

        /* The store selector styling */
        select.store-selector {
          background-color: var(--container-bg);
          color: var(--color-text);
          font-size: 14px;
          font-weight: bold;
          border: black 3px solid;
          border-radius: 12px;
          cursor: pointer;
          transform: scale(0.9);
          padding: 8px 16px;
          transition: background-color 0.25s ease;
        }
        select.store-selector:hover {
          background-color: #e36a1e;
          border: #e36a1e 3px solid;
          transform: scale(1);
          color: white;
        }

        textarea {
          padding: 12px;
          min-height: 100px;
        }

        .download-buttons {
          margin-top: 16px;
        }

        /* Carousel: new cards on the left, older cards fade out right */
        .carousel {
          display: flex;
          flex-direction: row;
          overflow-x: auto;
          gap: 16px;
          margin-top: 16px;
          padding-bottom: 8px;
          overflow-x: hidden;
        }
        .log-card {
        min-width: 240px;
        background: var(--container-bg);
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.15);
        flex-shrink: 0;
        padding: 12px;
        display: flex;
        flex-direction: row;
        align-items: center;
        transition: transform 0.6s ease, opacity 0.6s ease;
        transform: translateX(0); /* Default position */
        opacity: 1;
        }

        .log-card.enter {
        transform: translateX(-50px); /* Adjust the value as needed */
        opacity: 0;
        }
        .pulse-hex {
          width: 60px;
          height: 60px;
          margin-right: 12px;
        }
        .log-text {
          font-size: 0.85rem;
          color: var(--color-text);
          line-height: 1.4;
          display: inline-block;
        }
        /* Wave animation (continuous) */
        @keyframes waveUpDown {
          0%, 100% { transform: translateY(0); }
          50%      { transform: translateY(-8px); }
        }
        .wave-char {
          display: inline-block;
          animation: waveUpDown 1s ease-in-out infinite;
        }
        /* On finish, we transition from mid-wave back to baseline */
        @keyframes waveFadeOut {
          from { transform: translateY(-8px); }
          to   { transform: translateY(0); }
        }
        .wave-char-final {
          display: inline-block;
          animation: waveFadeOut 0.4s ease forwards;
        }

        /* Pulse for the hex polygons */
        @keyframes flashOrange {
          0%, 100% { fill: var(--original-fill); transform: scale(1); }
          50%      { fill: var(--container-bg); transform: scale(1); }
        }
        .pulse {
          animation: flashOrange 1.2s ease-in-out infinite;
        }
        @keyframes pulseStop {
        0%   { /* start from whatever color is currently used by flashOrange mid-cycle */
                /* but we can't know it exactly, so we assume it's close to var(--color-bg) or the mid-cycle color. */
                fill: var(--container-bg);
                transform: scale(1);
            }
        100% { fill: var(--original-fill);
                transform: scale(1);
            }
        }
        /* We apply this once the .pulse class is removed. */
        .pulse-stop {
            animation: pulseStop 0.6s forwards;
        }

        /* 
         * NEW: #loweractions container. Initially hidden (with transition).
         * We'll fade+scale it in once files are ready.
         */
        #loweractions {
          display: flex;            /* so it's in the layout, but invisible */
          opacity: 0;
          pointer-events: none;
          transform: scale(0.95);
          transition: opacity 0.4s ease, transform 0.4s ease;
          margin-top: 16px;
          gap: 12px;
        }
        #loweractions.show {
          opacity: 1;
          pointer-events: auto;
          transform: scale(1);
        }
      </style>

      <div class="cluster-container">
        <h2>Cluster Page</h2>
        <p>Describe your desired project:</p>
        <textarea id="projectDescription" placeholder="e.g., 'Build an Azure Function backend...'"></textarea>

        <div class="actions">
          <!-- The store selector -->
          <button id="validationToggle">Validation Mode</button>
          <button id="advancedToggle">Advanced Mode</button>
          <select class="store-selector" id="storeSelector">
            <option value="">Null</option>
            <option value="vector_store_1">Vector Store 1</option>
            <option value="vector_store_2">Vector Store 2</option>
            <option value="vector_store_3">Vector Store 3</option>
          </select>

          <!-- Normal generate button -->
          <button id="generateBtn">Generate Project</button>
        </div>

        <div class="carousel" id="logCarousel"></div>
        
        <div class="results" id="results"></div>

        <!-- 
          The new loweractions container that will be hidden 
          until files exist, then fade in.
        -->
        <div class="actions" id="loweractions">
          <!-- Distinct "Download All" button -->
          <button id="downloadAllBtn" class="download-all-btn">Download All (ZIP)</button>

          <!-- Toggle button for showing/hiding the individual file downloads -->
          <button id="toggleFilesBtn">See All Project Files</button>
        </div>

        <!-- The hidden container for the individual file download buttons -->
        <div class="file-downloads-container" id="fileDownloadsContainer">
          <!-- We'll fill this dynamically after generation -->
        </div>
      </div>
    `}connectedCallback(){this.shadow.getElementById("generateBtn").addEventListener("click",()=>this.onGenerateProject()),this.shadow.getElementById("toggleFilesBtn").addEventListener("click",()=>this.onToggleFiles()),this.shadow.getElementById("downloadAllBtn").addEventListener("click",()=>this.downloadAllAsZip());const i=this.shadow.getElementById("advancedToggle");i.addEventListener("click",()=>{i.classList.toggle("active"),console.log("Toggled active",i.classList)});const s=this.shadow.getElementById("validationToggle");s.addEventListener("click",()=>{s.classList.toggle("active"),console.log("Toggled active",s.classList)})}async onGenerateProject(){const t=this.shadow.getElementById("projectDescription"),n=this.shadow.getElementById("results"),a=this.shadow.getElementById("logCarousel"),i=this.shadow.getElementById("fileDownloadsContainer"),o=this.shadow.getElementById("storeSelector").value;n.innerText="",i.innerHTML="",a.innerHTML="",this.stepCards.clear(),this._projectResultCache={};const c=this.shadow.getElementById("loweractions");c.classList.remove("show");const l=t.value.trim();if(!l){n.innerText="Please provide a project description.";return}n.innerText=`Generating project...
`;try{const u=this.shadow.getElementById("advancedToggle").classList.contains("active"),h=this.shadow.getElementById("validationToggle").classList.contains("active"),x=await fA(l,(g,w)=>this.startLogCard(g,w),(g,w)=>this.finishLogCard(g,w),o,u,h),p=Object.keys(x);let m=`Project successfully generated!

Files:`;if(p.length===0)m+=`
(No files were generated)`;else{c.classList.add("show");for(const g of p)m+=`
- ${g}`}n.textContent="",yA(n,m,40),p.forEach(g=>{const w=x[g],v=document.createElement("button");v.innerText=`Download ${g}`,v.addEventListener("click",()=>{const k=new Blob([w],{type:"text/plain"}),A=URL.createObjectURL(k),F=document.createElement("a");F.href=A,F.download=g,F.click(),URL.revokeObjectURL(A)}),i.appendChild(v)}),this._projectResultCache=x}catch(f){n.innerText=`Error: ${f}`}}onToggleFiles(){const t=this.shadow.getElementById("fileDownloadsContainer");this.isFilesVisible=!this.isFilesVisible,this.isFilesVisible?t.classList.add("show"):t.classList.remove("show")}async downloadAllAsZip(){if(!this._projectResultCache||Object.keys(this._projectResultCache).length===0){alert("No project files found. Please generate a project first.");return}const t=new vA;for(const[s,o]of Object.entries(this._projectResultCache))t.file(s,o);const n=await t.generateAsync({type:"blob"}),a=URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download="project_files.zip",i.click(),URL.revokeObjectURL(a)}startLogCard(t,n){const a=this.shadow.getElementById("logCarousel"),i=n.replace(/\[.*?\]\s*/g,""),s=this.createWaveText(i),o=document.createElement("div");o.classList.add("log-card","enter");const c=this.createPulseHex(),l=document.createElement("div");l.classList.add("log-text"),l.appendChild(s),o.appendChild(c),o.appendChild(l),a.firstChild?a.insertBefore(o,a.firstChild):a.appendChild(o),requestAnimationFrame(()=>{o.classList.remove("enter")}),this.stepCards.set(t,o),this.updateCardOpacity()}finishLogCard(t,n){const a=this.stepCards.get(t);if(!a)return;const i=n.replace(/\[.*?\]\s*/g,""),s=this.createWaveText(i,!1),o=a.querySelector(".log-text");o&&(o.innerHTML="",o.appendChild(s)),a.querySelectorAll("polygon").forEach(l=>{l.classList.remove("pulse"),l.classList.add("pulse-stop")})}createPulseHex(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.setAttribute("viewBox","0 0 200 200"),t.classList.add("pulse-hex"),[{points:"100,100 152,70   152,130",fill:"#EA3546"},{points:"100,100 152,130  100,160",fill:"#EA3546"},{points:"100,100 100,160  48,130",fill:"#FABF35"},{points:"100,100 48,130   48,70",fill:"#FABF35"},{points:"100,100 48,70    100,40",fill:"#345995"},{points:"100,100 100,40   152,70",fill:"#345995"}].forEach((a,i)=>{const s=document.createElementNS("http://www.w3.org/2000/svg","polygon");s.setAttribute("points",a.points),s.setAttribute("fill",a.fill),s.style.setProperty("--original-fill",a.fill),s.style.setProperty("--color-bg","#FFF"),s.classList.add("pulse"),s.style.animationDelay=`${i*.1}s`,t.appendChild(s)}),t}createWaveText(t,n=!0){const a=document.createElement("span");return t.split("").forEach((i,s)=>{const o=document.createElement("span");if(o.textContent=i,i.trim()===""){a.appendChild(o);return}n?(o.classList.add("wave-char"),o.style.animationDelay=`${s*.01}s`):o.classList.add("wave-char-final"),a.appendChild(o)}),a}updateCardOpacity(){const t=this.shadow.getElementById("logCarousel");Array.from(t.querySelectorAll(".log-card")).forEach((a,i)=>{const s=1-i*.15,o=Math.max(.3,s);a.style.opacity=String(o)})}}function yA(e,r,t=50,n){let a=0;e.textContent="";const i=setInterval(()=>{e.textContent+=r.charAt(a),e.scrollTop=e.scrollHeight,a++,a>=r.length&&clearInterval(i)},t)}customElements.define("cluster-page",wA);const kA=750,EA=0;class TA extends HTMLElement{constructor(){super();At(this,"shadow");this.shadow=this.attachShadow({mode:"open"}),this.shadow.innerHTML=`
      <style>
        .cluster-container {
          display: flex;
          flex-direction: column;
          padding: 16px;
          font-family: sans-serif;
          align-items: center;
          max-height: 90vh;
          overflow-y: auto;
          overflow-x: hidden;
        }

        .logo-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
          gap: 24px;
          width: 100%;
          justify-items: center;
          align-items: center;
          padding: 16px;
          overflow-y: auto;
          overflow-x: hidden;
        }

        .logo-wrapper svg {
          width: 200px;
          height: 200px;
          margin: 20px auto;
        }
        .logo-wrapper:hover {
          transform: scale(1.1) rotate(10deg);
        }

        polygon {
          transform-origin: 100px 100px;
          transition: fill 0.3s ease;
        }

        @keyframes flashOrange {
          0%, 100% { fill: var(--original-fill); transform: scale(1);}
          50%      { fill: var(--color-bg); transform: scale(1); }
        }
        
        @keyframes rotateColors {
          0%   { fill: var(--c0); }
          16%  { fill: var(--c5); }
          33%  { fill: var(--c4); }
          50%  { fill: var(--c3); }
          66%  { fill: var(--c2); }
          83%  { fill: var(--c1); }
          100% { fill: var(--c0); }
        }

        .rotate {
          animation: rotateColors 2.4s linear 3;
        }

        .pulse {
          animation: flashOrange 1.2s ease-in-out 3;
        }
        @keyframes groupPulse {
          0%, 100% {
            transform: translate(0, 0);
          }
          50% {
            transform: var(--move);
          }
        }

        .group-animate {
          animation: groupPulse 1.5s ease-in-out 3;
        }
      </style>

      <div class="cluster-container">
        <h2>Logo Page</h2>
            <div class="logo-grid">
              <div class="logo-wrapper"></div>
              <div class="logo-wrapper"></div>
              <div class="logo-wrapper"></div>
              <div class="logo-wrapper"></div> <!-- New one -->
            </div>
      </div>
    `}connectedCallback(){this.loadSVG().then(()=>{this.shadow.querySelectorAll(".logo-wrapper").forEach(t=>{t.addEventListener("click",()=>{const n=t.querySelectorAll("polygon");n.forEach(a=>{const i=a.classList,s=i.contains("pulse"),o=i.contains("rotate"),c=i.contains("group-animate");a.classList.remove("pulse","rotate","group-animate"),a.getBoundingClientRect().width,s&&a.classList.add("pulse"),o&&a.classList.add("rotate"),c&&[[0,1],[2,3],[4,5]].forEach((f,u)=>{f.forEach((d,h)=>{const x=u*kA+h*EA;setTimeout(()=>{n[d].classList.add("group-animate")},x)})})})})})})}async loadSVG(){try{const n=await(await fetch("./data/hexlogo.html")).text(),s=new DOMParser().parseFromString(n,"text/html").querySelector("svg"),o=this.shadow.querySelectorAll(".logo-wrapper");if(s&&o[0]){const c=s.cloneNode(!0);o[0].appendChild(c),c.querySelectorAll("polygon").forEach((f,u)=>{const d=f.getAttribute("fill")||"#000";f.style.setProperty("--original-fill",d),f.classList.add("pulse"),f.style.animationDelay=`${u*.4}s`})}if(s&&o[1]){const c=s.cloneNode(!0);o[1].appendChild(c);const l=c.querySelectorAll("polygon"),f=["#EA3546","#EA3546","#FABF35","#FABF35","#345995","#345995"];l.forEach((u,d)=>{u.style.setProperty("--c0",f[d%6]),u.style.setProperty("--c1",f[(d+1)%6]),u.style.setProperty("--c2",f[(d+2)%6]),u.style.setProperty("--c3",f[(d+3)%6]),u.style.setProperty("--c4",f[(d+4)%6]),u.style.setProperty("--c5",f[(d+5)%6]),u.classList.add("rotate")})}if(s&&o[2]){const c=s.cloneNode(!0);o[2].appendChild(c),c.querySelectorAll("polygon").forEach((f,u)=>{const d=f.getAttribute("fill")||"#000";f.style.setProperty("--original-fill",d),f.classList.add("pulse");const h=Math.floor(u/2);f.style.animationDelay=`${h*.4}s`})}if(s&&o[3]){const c=s.cloneNode(!0);o[3].appendChild(c);const l=c.querySelectorAll("polygon");l.forEach((u,d)=>{const h=u.getAttribute("fill")||"#000";u.style.setProperty("--original-fill",h);let x="";d===0||d===1?x="translate(15px, 15px)":d===2||d===3?x="translate(-15px, 15px)":(d===4||d===5)&&(x="translate(0px, -15px)"),u.style.setProperty("--move",x)}),[[0,1],[2,3],[4,5]].forEach((u,d)=>{u.forEach(h=>{const x=l[h];setTimeout(()=>{x.classList.add("group-animate")},d*1500)})})}}catch(t){console.error("Failed to load SVG:",t)}}}customElements.define("logo-page",TA);window.addEventListener("DOMContentLoaded",()=>{nb();let e=document.querySelector("main-header");e||(e=document.createElement("main-header"),document.body.prepend(e));let r=document.getElementById("mainContainer");r||(r=document.createElement("div"),r.id="mainContainer",document.body.appendChild(r)),Pd()});async function Pd(){const e=document.querySelector("main-header"),r=document.getElementById("mainContainer"),t=document.getElementById("login"),n=document.querySelector("main-header").shadowRoot.querySelector("#logoutButton");n.onclick=async()=>{console.log("Logout button clicked"),await Ro.signOut(),r.innerHTML="",e.style.display="none",n.style.display="none",e.classList.remove("visible"),r.classList.remove("visible"),r.classList.add("hidden"),t.resetSendLinkButton(),t.show()},await Ro.isAuthenticated()?(console.log("User is authenticated - showing header + main container"),e.style.display="block",n.style.display="block",r.classList.remove("hidden"),t.style.display="none",r.innerHTML="",r.appendChild(document.createElement("tree-bom-page")),bA(),setTimeout(()=>{e.classList.add("visible"),r.classList.add("visible")},50)):(console.log("User is NOT authenticated - hiding header + showing login"),e.style.display="none",n.style.display="none",r.innerHTML="",t.show())}function no(e){const r=document.getElementById("mainContainer");r.innerHTML="",e.classList.add("page-content","slide-up-enter"),r.appendChild(e),requestAnimationFrame(()=>{e.classList.add("slide-up-enter-active")}),setTimeout(()=>{e.classList.remove("slide-up-enter","slide-up-enter-active")},300)}function bA(){document.addEventListener("navigate",e=>{const r=e.detail;r==="treebom"?no(document.createElement("tree-bom-page")):r==="cluster"?no(document.createElement("cluster-page")):r==="logo"&&no(document.createElement("logo-page"))})}let ao=!1;document.addEventListener("toggleDarkMode",()=>{ao=!ao,document.body.classList.toggle("dark-mode",ao)});document.addEventListener("login-success",()=>{console.log("login-success event received - re-checking auth via init()"),Pd()});
