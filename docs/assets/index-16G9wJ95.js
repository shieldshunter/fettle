var Wd=Object.defineProperty;var Vd=(e,r,t)=>r in e?Wd(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var At=(e,r,t)=>Vd(e,typeof r!="symbol"?r+"":r,t);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();const Gd=Math.sqrt(50),Xd=Math.sqrt(10),jd=Math.sqrt(2);function Ni(e,r,t){const n=(r-e)/Math.max(0,t),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=Gd?10:i>=Xd?5:i>=jd?2:1;let o,c,f;return a<0?(f=Math.pow(10,-a)/s,o=Math.round(e*f),c=Math.round(r*f),o/f<e&&++o,c/f>r&&--c,f=-f):(f=Math.pow(10,a)*s,o=Math.round(e/f),c=Math.round(r/f),o*f<e&&++o,c*f>r&&--c),c<o&&.5<=t&&t<2?Ni(e,r,t*2):[o,c,f]}function Yd(e,r,t){if(r=+r,e=+e,t=+t,!(t>0))return[];if(e===r)return[e];const n=r<e,[a,i,s]=n?Ni(r,e,t):Ni(e,r,t);if(!(i>=a))return[];const o=i-a+1,c=new Array(o);if(n)if(s<0)for(let f=0;f<o;++f)c[f]=(i-f)/-s;else for(let f=0;f<o;++f)c[f]=(i-f)*s;else if(s<0)for(let f=0;f<o;++f)c[f]=(a+f)/-s;else for(let f=0;f<o;++f)c[f]=(a+f)*s;return c}function ao(e,r,t){return r=+r,e=+e,t=+t,Ni(e,r,t)[2]}function Kd(e,r,t){r=+r,e=+e,t=+t;const n=r<e,a=n?ao(r,e,t):ao(e,r,t);return(n?-1:1)*(a<0?1/-a:a)}function qd(e,r){let t;if(r===void 0)for(const n of e)n!=null&&(t<n||t===void 0&&n>=n)&&(t=n);else{let n=-1;for(let a of e)(a=r(a,++n,e))!=null&&(t<a||t===void 0&&a>=a)&&(t=a)}return t}var Zd={value:()=>{}};function Wo(){for(var e=0,r=arguments.length,t={},n;e<r;++e){if(!(n=arguments[e]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new Ti(t)}function Ti(e){this._=e}function Jd(e,r){return e.trim().split(/^|\s+/).map(function(t){var n="",a=t.indexOf(".");if(a>=0&&(n=t.slice(a+1),t=t.slice(0,a)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}Ti.prototype=Wo.prototype={constructor:Ti,on:function(e,r){var t=this._,n=Jd(e+"",t),a,i=-1,s=n.length;if(arguments.length<2){for(;++i<s;)if((a=(e=n[i]).type)&&(a=Qd(t[a],e.name)))return a;return}if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++i<s;)if(a=(e=n[i]).type)t[a]=r0(t[a],e.name,r);else if(r==null)for(a in t)t[a]=r0(t[a],e.name,null);return this},copy:function(){var e={},r=this._;for(var t in r)e[t]=r[t].slice();return new Ti(e)},call:function(e,r){if((a=arguments.length-2)>0)for(var t=new Array(a),n=0,a,i;n<a;++n)t[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],n=0,a=i.length;n<a;++n)i[n].value.apply(r,t)},apply:function(e,r,t){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],a=0,i=n.length;a<i;++a)n[a].value.apply(r,t)}};function Qd(e,r){for(var t=0,n=e.length,a;t<n;++t)if((a=e[t]).name===r)return a.value}function r0(e,r,t){for(var n=0,a=e.length;n<a;++n)if(e[n].name===r){e[n]=Zd,e=e.slice(0,n).concat(e.slice(n+1));break}return t!=null&&e.push({name:r,value:t}),e}var io="http://www.w3.org/1999/xhtml";const n0={svg:"http://www.w3.org/2000/svg",xhtml:io,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function os(e){var r=e+="",t=r.indexOf(":");return t>=0&&(r=e.slice(0,t))!=="xmlns"&&(e=e.slice(t+1)),n0.hasOwnProperty(r)?{space:n0[r],local:e}:e}function e1(e){return function(){var r=this.ownerDocument,t=this.namespaceURI;return t===io&&r.documentElement.namespaceURI===io?r.createElement(e):r.createElementNS(t,e)}}function t1(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Vo(e){var r=os(e);return(r.local?t1:e1)(r)}function r1(){}function Go(e){return e==null?r1:function(){return this.querySelector(e)}}function n1(e){typeof e!="function"&&(e=Go(e));for(var r=this._groups,t=r.length,n=new Array(t),a=0;a<t;++a)for(var i=r[a],s=i.length,o=n[a]=new Array(s),c,f,l=0;l<s;++l)(c=i[l])&&(f=e.call(c,c.__data__,l,i))&&("__data__"in c&&(f.__data__=c.__data__),o[l]=f);return new $t(n,this._parents)}function a1(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function i1(){return[]}function nl(e){return e==null?i1:function(){return this.querySelectorAll(e)}}function s1(e){return function(){return a1(e.apply(this,arguments))}}function o1(e){typeof e=="function"?e=s1(e):e=nl(e);for(var r=this._groups,t=r.length,n=[],a=[],i=0;i<t;++i)for(var s=r[i],o=s.length,c,f=0;f<o;++f)(c=s[f])&&(n.push(e.call(c,c.__data__,f,s)),a.push(c));return new $t(n,a)}function al(e){return function(){return this.matches(e)}}function il(e){return function(r){return r.matches(e)}}var c1=Array.prototype.find;function f1(e){return function(){return c1.call(this.children,e)}}function l1(){return this.firstElementChild}function u1(e){return this.select(e==null?l1:f1(typeof e=="function"?e:il(e)))}var h1=Array.prototype.filter;function d1(){return Array.from(this.children)}function p1(e){return function(){return h1.call(this.children,e)}}function x1(e){return this.selectAll(e==null?d1:p1(typeof e=="function"?e:il(e)))}function m1(e){typeof e!="function"&&(e=al(e));for(var r=this._groups,t=r.length,n=new Array(t),a=0;a<t;++a)for(var i=r[a],s=i.length,o=n[a]=[],c,f=0;f<s;++f)(c=i[f])&&e.call(c,c.__data__,f,i)&&o.push(c);return new $t(n,this._parents)}function sl(e){return new Array(e.length)}function g1(){return new $t(this._enter||this._groups.map(sl),this._parents)}function Mi(e,r){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=r}Mi.prototype={constructor:Mi,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,r){return this._parent.insertBefore(e,r)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function _1(e){return function(){return e}}function v1(e,r,t,n,a,i){for(var s=0,o,c=r.length,f=i.length;s<f;++s)(o=r[s])?(o.__data__=i[s],n[s]=o):t[s]=new Mi(e,i[s]);for(;s<c;++s)(o=r[s])&&(a[s]=o)}function w1(e,r,t,n,a,i,s){var o,c,f=new Map,l=r.length,u=i.length,d=new Array(l),h;for(o=0;o<l;++o)(c=r[o])&&(d[o]=h=s.call(c,c.__data__,o,r)+"",f.has(h)?a[o]=c:f.set(h,c));for(o=0;o<u;++o)h=s.call(e,i[o],o,i)+"",(c=f.get(h))?(n[o]=c,c.__data__=i[o],f.delete(h)):t[o]=new Mi(e,i[o]);for(o=0;o<l;++o)(c=r[o])&&f.get(d[o])===c&&(a[o]=c)}function y1(e){return e.__data__}function k1(e,r){if(!arguments.length)return Array.from(this,y1);var t=r?w1:v1,n=this._parents,a=this._groups;typeof e!="function"&&(e=_1(e));for(var i=a.length,s=new Array(i),o=new Array(i),c=new Array(i),f=0;f<i;++f){var l=n[f],u=a[f],d=u.length,h=E1(e.call(l,l&&l.__data__,f,n)),x=h.length,p=o[f]=new Array(x),m=s[f]=new Array(x),g=c[f]=new Array(d);t(l,u,p,m,g,h,r);for(var w=0,v=0,k,A;w<x;++w)if(k=p[w]){for(w>=v&&(v=w+1);!(A=m[v])&&++v<x;);k._next=A||null}}return s=new $t(s,n),s._enter=o,s._exit=c,s}function E1(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function T1(){return new $t(this._exit||this._groups.map(sl),this._parents)}function b1(e,r,t){var n=this.enter(),a=this,i=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),r!=null&&(a=r(a),a&&(a=a.selection())),t==null?i.remove():t(i),n&&a?n.merge(a).order():a}function A1(e){for(var r=e.selection?e.selection():e,t=this._groups,n=r._groups,a=t.length,i=n.length,s=Math.min(a,i),o=new Array(a),c=0;c<s;++c)for(var f=t[c],l=n[c],u=f.length,d=o[c]=new Array(u),h,x=0;x<u;++x)(h=f[x]||l[x])&&(d[x]=h);for(;c<a;++c)o[c]=t[c];return new $t(o,this._parents)}function S1(){for(var e=this._groups,r=-1,t=e.length;++r<t;)for(var n=e[r],a=n.length-1,i=n[a],s;--a>=0;)(s=n[a])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function C1(e){e||(e=F1);function r(u,d){return u&&d?e(u.__data__,d.__data__):!u-!d}for(var t=this._groups,n=t.length,a=new Array(n),i=0;i<n;++i){for(var s=t[i],o=s.length,c=a[i]=new Array(o),f,l=0;l<o;++l)(f=s[l])&&(c[l]=f);c.sort(r)}return new $t(a,this._parents).order()}function F1(e,r){return e<r?-1:e>r?1:e>=r?0:NaN}function R1(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function I1(){return Array.from(this)}function O1(){for(var e=this._groups,r=0,t=e.length;r<t;++r)for(var n=e[r],a=0,i=n.length;a<i;++a){var s=n[a];if(s)return s}return null}function D1(){let e=0;for(const r of this)++e;return e}function P1(){return!this.node()}function N1(e){for(var r=this._groups,t=0,n=r.length;t<n;++t)for(var a=r[t],i=0,s=a.length,o;i<s;++i)(o=a[i])&&e.call(o,o.__data__,i,a);return this}function M1(e){return function(){this.removeAttribute(e)}}function L1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function B1(e,r){return function(){this.setAttribute(e,r)}}function U1(e,r){return function(){this.setAttributeNS(e.space,e.local,r)}}function z1(e,r){return function(){var t=r.apply(this,arguments);t==null?this.removeAttribute(e):this.setAttribute(e,t)}}function $1(e,r){return function(){var t=r.apply(this,arguments);t==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}function H1(e,r){var t=os(e);if(arguments.length<2){var n=this.node();return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}return this.each((r==null?t.local?L1:M1:typeof r=="function"?t.local?$1:z1:t.local?U1:B1)(t,r))}function ol(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function W1(e){return function(){this.style.removeProperty(e)}}function V1(e,r,t){return function(){this.style.setProperty(e,r,t)}}function G1(e,r,t){return function(){var n=r.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,t)}}function X1(e,r,t){return arguments.length>1?this.each((r==null?W1:typeof r=="function"?G1:V1)(e,r,t??"")):Nn(this.node(),e)}function Nn(e,r){return e.style.getPropertyValue(r)||ol(e).getComputedStyle(e,null).getPropertyValue(r)}function j1(e){return function(){delete this[e]}}function Y1(e,r){return function(){this[e]=r}}function K1(e,r){return function(){var t=r.apply(this,arguments);t==null?delete this[e]:this[e]=t}}function q1(e,r){return arguments.length>1?this.each((r==null?j1:typeof r=="function"?K1:Y1)(e,r)):this.node()[e]}function cl(e){return e.trim().split(/^|\s+/)}function Xo(e){return e.classList||new fl(e)}function fl(e){this._node=e,this._names=cl(e.getAttribute("class")||"")}fl.prototype={add:function(e){var r=this._names.indexOf(e);r<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var r=this._names.indexOf(e);r>=0&&(this._names.splice(r,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ll(e,r){for(var t=Xo(e),n=-1,a=r.length;++n<a;)t.add(r[n])}function ul(e,r){for(var t=Xo(e),n=-1,a=r.length;++n<a;)t.remove(r[n])}function Z1(e){return function(){ll(this,e)}}function J1(e){return function(){ul(this,e)}}function Q1(e,r){return function(){(r.apply(this,arguments)?ll:ul)(this,e)}}function ep(e,r){var t=cl(e+"");if(arguments.length<2){for(var n=Xo(this.node()),a=-1,i=t.length;++a<i;)if(!n.contains(t[a]))return!1;return!0}return this.each((typeof r=="function"?Q1:r?Z1:J1)(t,r))}function tp(){this.textContent=""}function rp(e){return function(){this.textContent=e}}function np(e){return function(){var r=e.apply(this,arguments);this.textContent=r??""}}function ap(e){return arguments.length?this.each(e==null?tp:(typeof e=="function"?np:rp)(e)):this.node().textContent}function ip(){this.innerHTML=""}function sp(e){return function(){this.innerHTML=e}}function op(e){return function(){var r=e.apply(this,arguments);this.innerHTML=r??""}}function cp(e){return arguments.length?this.each(e==null?ip:(typeof e=="function"?op:sp)(e)):this.node().innerHTML}function fp(){this.nextSibling&&this.parentNode.appendChild(this)}function lp(){return this.each(fp)}function up(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function hp(){return this.each(up)}function dp(e){var r=typeof e=="function"?e:Vo(e);return this.select(function(){return this.appendChild(r.apply(this,arguments))})}function pp(){return null}function xp(e,r){var t=typeof e=="function"?e:Vo(e),n=r==null?pp:typeof r=="function"?r:Go(r);return this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})}function mp(){var e=this.parentNode;e&&e.removeChild(this)}function gp(){return this.each(mp)}function _p(){var e=this.cloneNode(!1),r=this.parentNode;return r?r.insertBefore(e,this.nextSibling):e}function vp(){var e=this.cloneNode(!0),r=this.parentNode;return r?r.insertBefore(e,this.nextSibling):e}function wp(e){return this.select(e?vp:_p)}function yp(e){return arguments.length?this.property("__data__",e):this.node().__data__}function kp(e){return function(r){e.call(this,r,this.__data__)}}function Ep(e){return e.trim().split(/^|\s+/).map(function(r){var t="",n=r.indexOf(".");return n>=0&&(t=r.slice(n+1),r=r.slice(0,n)),{type:r,name:t}})}function Tp(e){return function(){var r=this.__on;if(r){for(var t=0,n=-1,a=r.length,i;t<a;++t)i=r[t],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):r[++n]=i;++n?r.length=n:delete this.__on}}}function bp(e,r,t){return function(){var n=this.__on,a,i=kp(r);if(n){for(var s=0,o=n.length;s<o;++s)if((a=n[s]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=i,a.options=t),a.value=r;return}}this.addEventListener(e.type,i,t),a={type:e.type,name:e.name,value:r,listener:i,options:t},n?n.push(a):this.__on=[a]}}function Ap(e,r,t){var n=Ep(e+""),a,i=n.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var c=0,f=o.length,l;c<f;++c)for(a=0,l=o[c];a<i;++a)if((s=n[a]).type===l.type&&s.name===l.name)return l.value}return}for(o=r?bp:Tp,a=0;a<i;++a)this.each(o(n[a],r,t));return this}function hl(e,r,t){var n=ol(e),a=n.CustomEvent;typeof a=="function"?a=new a(r,t):(a=n.document.createEvent("Event"),t?(a.initEvent(r,t.bubbles,t.cancelable),a.detail=t.detail):a.initEvent(r,!1,!1)),e.dispatchEvent(a)}function Sp(e,r){return function(){return hl(this,e,r)}}function Cp(e,r){return function(){return hl(this,e,r.apply(this,arguments))}}function Fp(e,r){return this.each((typeof r=="function"?Cp:Sp)(e,r))}function*Rp(){for(var e=this._groups,r=0,t=e.length;r<t;++r)for(var n=e[r],a=0,i=n.length,s;a<i;++a)(s=n[a])&&(yield s)}var dl=[null];function $t(e,r){this._groups=e,this._parents=r}function Na(){return new $t([[document.documentElement]],dl)}function Ip(){return this}$t.prototype=Na.prototype={constructor:$t,select:n1,selectAll:o1,selectChild:u1,selectChildren:x1,filter:m1,data:k1,enter:g1,exit:T1,join:b1,merge:A1,selection:Ip,order:S1,sort:C1,call:R1,nodes:I1,node:O1,size:D1,empty:P1,each:N1,attr:H1,style:X1,property:q1,classed:ep,text:ap,html:cp,raise:lp,lower:hp,append:dp,insert:xp,remove:gp,clone:wp,datum:yp,on:Ap,dispatch:Fp,[Symbol.iterator]:Rp};function jt(e){return typeof e=="string"?new $t([[document.querySelector(e)]],[document.documentElement]):new $t([[e]],dl)}function Op(e){return jt(Vo(e).call(document.documentElement))}function Dp(e){let r;for(;r=e.sourceEvent;)e=r;return e}function jr(e,r){if(e=Dp(e),r===void 0&&(r=e.currentTarget),r){var t=r.ownerSVGElement||r;if(t.createSVGPoint){var n=t.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(r.getScreenCTM().inverse()),[n.x,n.y]}if(r.getBoundingClientRect){var a=r.getBoundingClientRect();return[e.clientX-a.left-r.clientLeft,e.clientY-a.top-r.clientTop]}}return[e.pageX,e.pageY]}const so={capture:!0,passive:!1};function oo(e){e.preventDefault(),e.stopImmediatePropagation()}function Pp(e){var r=e.document.documentElement,t=jt(e).on("dragstart.drag",oo,so);"onselectstart"in r?t.on("selectstart.drag",oo,so):(r.__noselect=r.style.MozUserSelect,r.style.MozUserSelect="none")}function Np(e,r){var t=e.document.documentElement,n=jt(e).on("dragstart.drag",null);r&&(n.on("click.drag",oo,so),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in t?n.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}function jo(e,r,t){e.prototype=r.prototype=t,t.constructor=e}function pl(e,r){var t=Object.create(e.prototype);for(var n in r)t[n]=r[n];return t}function Ma(){}var ka=.7,Li=1/ka,Sn="\\s*([+-]?\\d+)\\s*",Ea="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",mr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Mp=/^#([0-9a-f]{3,8})$/,Lp=new RegExp(`^rgb\\(${Sn},${Sn},${Sn}\\)$`),Bp=new RegExp(`^rgb\\(${mr},${mr},${mr}\\)$`),Up=new RegExp(`^rgba\\(${Sn},${Sn},${Sn},${Ea}\\)$`),zp=new RegExp(`^rgba\\(${mr},${mr},${mr},${Ea}\\)$`),$p=new RegExp(`^hsl\\(${Ea},${mr},${mr}\\)$`),Hp=new RegExp(`^hsla\\(${Ea},${mr},${mr},${Ea}\\)$`),a0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};jo(Ma,an,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:i0,formatHex:i0,formatHex8:Wp,formatHsl:Vp,formatRgb:s0,toString:s0});function i0(){return this.rgb().formatHex()}function Wp(){return this.rgb().formatHex8()}function Vp(){return xl(this).formatHsl()}function s0(){return this.rgb().formatRgb()}function an(e){var r,t;return e=(e+"").trim().toLowerCase(),(r=Mp.exec(e))?(t=r[1].length,r=parseInt(r[1],16),t===6?o0(r):t===3?new Pt(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):t===8?Qa(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):t===4?Qa(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=Lp.exec(e))?new Pt(r[1],r[2],r[3],1):(r=Bp.exec(e))?new Pt(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=Up.exec(e))?Qa(r[1],r[2],r[3],r[4]):(r=zp.exec(e))?Qa(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=$p.exec(e))?l0(r[1],r[2]/100,r[3]/100,1):(r=Hp.exec(e))?l0(r[1],r[2]/100,r[3]/100,r[4]):a0.hasOwnProperty(e)?o0(a0[e]):e==="transparent"?new Pt(NaN,NaN,NaN,0):null}function o0(e){return new Pt(e>>16&255,e>>8&255,e&255,1)}function Qa(e,r,t,n){return n<=0&&(e=r=t=NaN),new Pt(e,r,t,n)}function Gp(e){return e instanceof Ma||(e=an(e)),e?(e=e.rgb(),new Pt(e.r,e.g,e.b,e.opacity)):new Pt}function Bi(e,r,t,n){return arguments.length===1?Gp(e):new Pt(e,r,t,n??1)}function Pt(e,r,t,n){this.r=+e,this.g=+r,this.b=+t,this.opacity=+n}jo(Pt,Bi,pl(Ma,{brighter(e){return e=e==null?Li:Math.pow(Li,e),new Pt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ka:Math.pow(ka,e),new Pt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Pt(tn(this.r),tn(this.g),tn(this.b),Ui(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:c0,formatHex:c0,formatHex8:Xp,formatRgb:f0,toString:f0}));function c0(){return`#${Jr(this.r)}${Jr(this.g)}${Jr(this.b)}`}function Xp(){return`#${Jr(this.r)}${Jr(this.g)}${Jr(this.b)}${Jr((isNaN(this.opacity)?1:this.opacity)*255)}`}function f0(){const e=Ui(this.opacity);return`${e===1?"rgb(":"rgba("}${tn(this.r)}, ${tn(this.g)}, ${tn(this.b)}${e===1?")":`, ${e})`}`}function Ui(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function tn(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Jr(e){return e=tn(e),(e<16?"0":"")+e.toString(16)}function l0(e,r,t,n){return n<=0?e=r=t=NaN:t<=0||t>=1?e=r=NaN:r<=0&&(e=NaN),new rr(e,r,t,n)}function xl(e){if(e instanceof rr)return new rr(e.h,e.s,e.l,e.opacity);if(e instanceof Ma||(e=an(e)),!e)return new rr;if(e instanceof rr)return e;e=e.rgb();var r=e.r/255,t=e.g/255,n=e.b/255,a=Math.min(r,t,n),i=Math.max(r,t,n),s=NaN,o=i-a,c=(i+a)/2;return o?(r===i?s=(t-n)/o+(t<n)*6:t===i?s=(n-r)/o+2:s=(r-t)/o+4,o/=c<.5?i+a:2-i-a,s*=60):o=c>0&&c<1?0:s,new rr(s,o,c,e.opacity)}function jp(e,r,t,n){return arguments.length===1?xl(e):new rr(e,r,t,n??1)}function rr(e,r,t,n){this.h=+e,this.s=+r,this.l=+t,this.opacity=+n}jo(rr,jp,pl(Ma,{brighter(e){return e=e==null?Li:Math.pow(Li,e),new rr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ka:Math.pow(ka,e),new rr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*r,a=2*t-n;return new Pt(As(e>=240?e-240:e+120,a,n),As(e,a,n),As(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new rr(u0(this.h),ei(this.s),ei(this.l),Ui(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ui(this.opacity);return`${e===1?"hsl(":"hsla("}${u0(this.h)}, ${ei(this.s)*100}%, ${ei(this.l)*100}%${e===1?")":`, ${e})`}`}}));function u0(e){return e=(e||0)%360,e<0?e+360:e}function ei(e){return Math.max(0,Math.min(1,e||0))}function As(e,r,t){return(e<60?r+(t-r)*e/60:e<180?t:e<240?r+(t-r)*(240-e)/60:r)*255}function Yp(e,r,t,n,a){var i=e*e,s=i*e;return((1-3*e+3*i-s)*r+(4-6*i+3*s)*t+(1+3*e+3*i-3*s)*n+s*a)/6}function Kp(e){var r=e.length-1;return function(t){var n=t<=0?t=0:t>=1?(t=1,r-1):Math.floor(t*r),a=e[n],i=e[n+1],s=n>0?e[n-1]:2*a-i,o=n<r-1?e[n+2]:2*i-a;return Yp((t-n/r)*r,s,a,i,o)}}const Yo=e=>()=>e;function qp(e,r){return function(t){return e+t*r}}function Zp(e,r,t){return e=Math.pow(e,t),r=Math.pow(r,t)-e,t=1/t,function(n){return Math.pow(e+n*r,t)}}function Jp(e){return(e=+e)==1?ml:function(r,t){return t-r?Zp(r,t,e):Yo(isNaN(r)?t:r)}}function ml(e,r){var t=r-e;return t?qp(e,t):Yo(isNaN(e)?r:e)}const zi=function e(r){var t=Jp(r);function n(a,i){var s=t((a=Bi(a)).r,(i=Bi(i)).r),o=t(a.g,i.g),c=t(a.b,i.b),f=ml(a.opacity,i.opacity);return function(l){return a.r=s(l),a.g=o(l),a.b=c(l),a.opacity=f(l),a+""}}return n.gamma=e,n}(1);function Qp(e){return function(r){var t=r.length,n=new Array(t),a=new Array(t),i=new Array(t),s,o;for(s=0;s<t;++s)o=Bi(r[s]),n[s]=o.r||0,a[s]=o.g||0,i[s]=o.b||0;return n=e(n),a=e(a),i=e(i),o.opacity=1,function(c){return o.r=n(c),o.g=a(c),o.b=i(c),o+""}}}var ex=Qp(Kp);function tx(e,r){r||(r=[]);var t=e?Math.min(r.length,e.length):0,n=r.slice(),a;return function(i){for(a=0;a<t;++a)n[a]=e[a]*(1-i)+r[a]*i;return n}}function rx(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function nx(e,r){var t=r?r.length:0,n=e?Math.min(t,e.length):0,a=new Array(n),i=new Array(t),s;for(s=0;s<n;++s)a[s]=Ko(e[s],r[s]);for(;s<t;++s)i[s]=r[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function ax(e,r){var t=new Date;return e=+e,r=+r,function(n){return t.setTime(e*(1-n)+r*n),t}}function pr(e,r){return e=+e,r=+r,function(t){return e*(1-t)+r*t}}function ix(e,r){var t={},n={},a;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(a in r)a in e?t[a]=Ko(e[a],r[a]):n[a]=r[a];return function(i){for(a in t)n[a]=t[a](i);return n}}var co=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ss=new RegExp(co.source,"g");function sx(e){return function(){return e}}function ox(e){return function(r){return e(r)+""}}function gl(e,r){var t=co.lastIndex=Ss.lastIndex=0,n,a,i,s=-1,o=[],c=[];for(e=e+"",r=r+"";(n=co.exec(e))&&(a=Ss.exec(r));)(i=a.index)>t&&(i=r.slice(t,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,c.push({i:s,x:pr(n,a)})),t=Ss.lastIndex;return t<r.length&&(i=r.slice(t),o[s]?o[s]+=i:o[++s]=i),o.length<2?c[0]?ox(c[0].x):sx(r):(r=c.length,function(f){for(var l=0,u;l<r;++l)o[(u=c[l]).i]=u.x(f);return o.join("")})}function Ko(e,r){var t=typeof r,n;return r==null||t==="boolean"?Yo(r):(t==="number"?pr:t==="string"?(n=an(r))?(r=n,zi):gl:r instanceof an?zi:r instanceof Date?ax:rx(r)?tx:Array.isArray(r)?nx:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?ix:pr)(e,r)}function cx(e,r){return e=+e,r=+r,function(t){return Math.round(e*(1-t)+r*t)}}var h0=180/Math.PI,fo={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function _l(e,r,t,n,a,i){var s,o,c;return(s=Math.sqrt(e*e+r*r))&&(e/=s,r/=s),(c=e*t+r*n)&&(t-=e*c,n-=r*c),(o=Math.sqrt(t*t+n*n))&&(t/=o,n/=o,c/=o),e*n<r*t&&(e=-e,r=-r,c=-c,s=-s),{translateX:a,translateY:i,rotate:Math.atan2(r,e)*h0,skewX:Math.atan(c)*h0,scaleX:s,scaleY:o}}var ti;function fx(e){const r=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return r.isIdentity?fo:_l(r.a,r.b,r.c,r.d,r.e,r.f)}function lx(e){return e==null||(ti||(ti=document.createElementNS("http://www.w3.org/2000/svg","g")),ti.setAttribute("transform",e),!(e=ti.transform.baseVal.consolidate()))?fo:(e=e.matrix,_l(e.a,e.b,e.c,e.d,e.e,e.f))}function vl(e,r,t,n){function a(f){return f.length?f.pop()+" ":""}function i(f,l,u,d,h,x){if(f!==u||l!==d){var p=h.push("translate(",null,r,null,t);x.push({i:p-4,x:pr(f,u)},{i:p-2,x:pr(l,d)})}else(u||d)&&h.push("translate("+u+r+d+t)}function s(f,l,u,d){f!==l?(f-l>180?l+=360:l-f>180&&(f+=360),d.push({i:u.push(a(u)+"rotate(",null,n)-2,x:pr(f,l)})):l&&u.push(a(u)+"rotate("+l+n)}function o(f,l,u,d){f!==l?d.push({i:u.push(a(u)+"skewX(",null,n)-2,x:pr(f,l)}):l&&u.push(a(u)+"skewX("+l+n)}function c(f,l,u,d,h,x){if(f!==u||l!==d){var p=h.push(a(h)+"scale(",null,",",null,")");x.push({i:p-4,x:pr(f,u)},{i:p-2,x:pr(l,d)})}else(u!==1||d!==1)&&h.push(a(h)+"scale("+u+","+d+")")}return function(f,l){var u=[],d=[];return f=e(f),l=e(l),i(f.translateX,f.translateY,l.translateX,l.translateY,u,d),s(f.rotate,l.rotate,u,d),o(f.skewX,l.skewX,u,d),c(f.scaleX,f.scaleY,l.scaleX,l.scaleY,u,d),f=l=null,function(h){for(var x=-1,p=d.length,m;++x<p;)u[(m=d[x]).i]=m.x(h);return u.join("")}}}var ux=vl(fx,"px, ","px)","deg)"),hx=vl(lx,", ",")",")"),dx=1e-12;function d0(e){return((e=Math.exp(e))+1/e)/2}function px(e){return((e=Math.exp(e))-1/e)/2}function xx(e){return((e=Math.exp(2*e))-1)/(e+1)}const mx=function e(r,t,n){function a(i,s){var o=i[0],c=i[1],f=i[2],l=s[0],u=s[1],d=s[2],h=l-o,x=u-c,p=h*h+x*x,m,g;if(p<dx)g=Math.log(d/f)/r,m=function(E){return[o+E*h,c+E*x,f*Math.exp(r*E*g)]};else{var w=Math.sqrt(p),v=(d*d-f*f+n*p)/(2*f*t*w),k=(d*d-f*f-n*p)/(2*d*t*w),A=Math.log(Math.sqrt(v*v+1)-v),F=Math.log(Math.sqrt(k*k+1)-k);g=(F-A)/r,m=function(E){var z=E*g,C=d0(A),G=f/(t*w)*(C*xx(r*z+A)-px(A));return[o+G*h,c+G*x,f*C/d0(r*z+A)]}}return m.duration=g*1e3*r/Math.SQRT2,m}return a.rho=function(i){var s=Math.max(.001,+i),o=s*s,c=o*o;return e(s,o,c)},a}(Math.SQRT2,2,4);var Mn=0,Qn=0,Zn=0,wl=1e3,$i,ea,Hi=0,sn=0,cs=0,Ta=typeof performance=="object"&&performance.now?performance:Date,yl=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function qo(){return sn||(yl(gx),sn=Ta.now()+cs)}function gx(){sn=0}function Wi(){this._call=this._time=this._next=null}Wi.prototype=kl.prototype={constructor:Wi,restart:function(e,r,t){if(typeof e!="function")throw new TypeError("callback is not a function");t=(t==null?qo():+t)+(r==null?0:+r),!this._next&&ea!==this&&(ea?ea._next=this:$i=this,ea=this),this._call=e,this._time=t,lo()},stop:function(){this._call&&(this._call=null,this._time=1/0,lo())}};function kl(e,r,t){var n=new Wi;return n.restart(e,r,t),n}function _x(){qo(),++Mn;for(var e=$i,r;e;)(r=sn-e._time)>=0&&e._call.call(void 0,r),e=e._next;--Mn}function p0(){sn=(Hi=Ta.now())+cs,Mn=Qn=0;try{_x()}finally{Mn=0,wx(),sn=0}}function vx(){var e=Ta.now(),r=e-Hi;r>wl&&(cs-=r,Hi=e)}function wx(){for(var e,r=$i,t,n=1/0;r;)r._call?(n>r._time&&(n=r._time),e=r,r=r._next):(t=r._next,r._next=null,r=e?e._next=t:$i=t);ea=e,lo(n)}function lo(e){if(!Mn){Qn&&(Qn=clearTimeout(Qn));var r=e-sn;r>24?(e<1/0&&(Qn=setTimeout(p0,e-Ta.now()-cs)),Zn&&(Zn=clearInterval(Zn))):(Zn||(Hi=Ta.now(),Zn=setInterval(vx,wl)),Mn=1,yl(p0))}}function x0(e,r,t){var n=new Wi;return r=r==null?0:+r,n.restart(a=>{n.stop(),e(a+r)},r,t),n}var yx=Wo("start","end","cancel","interrupt"),kx=[],El=0,m0=1,uo=2,bi=3,g0=4,ho=5,Ai=6;function fs(e,r,t,n,a,i){var s=e.__transition;if(!s)e.__transition={};else if(t in s)return;Ex(e,t,{name:r,index:n,group:a,on:yx,tween:kx,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:El})}function Zo(e,r){var t=cr(e,r);if(t.state>El)throw new Error("too late; already scheduled");return t}function _r(e,r){var t=cr(e,r);if(t.state>bi)throw new Error("too late; already running");return t}function cr(e,r){var t=e.__transition;if(!t||!(t=t[r]))throw new Error("transition not found");return t}function Ex(e,r,t){var n=e.__transition,a;n[r]=t,t.timer=kl(i,0,t.time);function i(f){t.state=m0,t.timer.restart(s,t.delay,t.time),t.delay<=f&&s(f-t.delay)}function s(f){var l,u,d,h;if(t.state!==m0)return c();for(l in n)if(h=n[l],h.name===t.name){if(h.state===bi)return x0(s);h.state===g0?(h.state=Ai,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete n[l]):+l<r&&(h.state=Ai,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete n[l])}if(x0(function(){t.state===bi&&(t.state=g0,t.timer.restart(o,t.delay,t.time),o(f))}),t.state=uo,t.on.call("start",e,e.__data__,t.index,t.group),t.state===uo){for(t.state=bi,a=new Array(d=t.tween.length),l=0,u=-1;l<d;++l)(h=t.tween[l].value.call(e,e.__data__,t.index,t.group))&&(a[++u]=h);a.length=u+1}}function o(f){for(var l=f<t.duration?t.ease.call(null,f/t.duration):(t.timer.restart(c),t.state=ho,1),u=-1,d=a.length;++u<d;)a[u].call(e,l);t.state===ho&&(t.on.call("end",e,e.__data__,t.index,t.group),c())}function c(){t.state=Ai,t.timer.stop(),delete n[r];for(var f in n)return;delete e.__transition}}function Si(e,r){var t=e.__transition,n,a,i=!0,s;if(t){r=r==null?null:r+"";for(s in t){if((n=t[s]).name!==r){i=!1;continue}a=n.state>uo&&n.state<ho,n.state=Ai,n.timer.stop(),n.on.call(a?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete t[s]}i&&delete e.__transition}}function Tx(e){return this.each(function(){Si(this,e)})}function bx(e,r){var t,n;return function(){var a=_r(this,e),i=a.tween;if(i!==t){n=t=i;for(var s=0,o=n.length;s<o;++s)if(n[s].name===r){n=n.slice(),n.splice(s,1);break}}a.tween=n}}function Ax(e,r,t){var n,a;if(typeof t!="function")throw new Error;return function(){var i=_r(this,e),s=i.tween;if(s!==n){a=(n=s).slice();for(var o={name:r,value:t},c=0,f=a.length;c<f;++c)if(a[c].name===r){a[c]=o;break}c===f&&a.push(o)}i.tween=a}}function Sx(e,r){var t=this._id;if(e+="",arguments.length<2){for(var n=cr(this.node(),t).tween,a=0,i=n.length,s;a<i;++a)if((s=n[a]).name===e)return s.value;return null}return this.each((r==null?bx:Ax)(t,e,r))}function Jo(e,r,t){var n=e._id;return e.each(function(){var a=_r(this,n);(a.value||(a.value={}))[r]=t.apply(this,arguments)}),function(a){return cr(a,n).value[r]}}function Tl(e,r){var t;return(typeof r=="number"?pr:r instanceof an?zi:(t=an(r))?(r=t,zi):gl)(e,r)}function Cx(e){return function(){this.removeAttribute(e)}}function Fx(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Rx(e,r,t){var n,a=t+"",i;return function(){var s=this.getAttribute(e);return s===a?null:s===n?i:i=r(n=s,t)}}function Ix(e,r,t){var n,a=t+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===a?null:s===n?i:i=r(n=s,t)}}function Ox(e,r,t){var n,a,i;return function(){var s,o=t(this),c;return o==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=o+"",s===c?null:s===n&&c===a?i:(a=c,i=r(n=s,o)))}}function Dx(e,r,t){var n,a,i;return function(){var s,o=t(this),c;return o==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=o+"",s===c?null:s===n&&c===a?i:(a=c,i=r(n=s,o)))}}function Px(e,r){var t=os(e),n=t==="transform"?hx:Tl;return this.attrTween(e,typeof r=="function"?(t.local?Dx:Ox)(t,n,Jo(this,"attr."+e,r)):r==null?(t.local?Fx:Cx)(t):(t.local?Ix:Rx)(t,n,r))}function Nx(e,r){return function(t){this.setAttribute(e,r.call(this,t))}}function Mx(e,r){return function(t){this.setAttributeNS(e.space,e.local,r.call(this,t))}}function Lx(e,r){var t,n;function a(){var i=r.apply(this,arguments);return i!==n&&(t=(n=i)&&Mx(e,i)),t}return a._value=r,a}function Bx(e,r){var t,n;function a(){var i=r.apply(this,arguments);return i!==n&&(t=(n=i)&&Nx(e,i)),t}return a._value=r,a}function Ux(e,r){var t="attr."+e;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(r==null)return this.tween(t,null);if(typeof r!="function")throw new Error;var n=os(e);return this.tween(t,(n.local?Lx:Bx)(n,r))}function zx(e,r){return function(){Zo(this,e).delay=+r.apply(this,arguments)}}function $x(e,r){return r=+r,function(){Zo(this,e).delay=r}}function Hx(e){var r=this._id;return arguments.length?this.each((typeof e=="function"?zx:$x)(r,e)):cr(this.node(),r).delay}function Wx(e,r){return function(){_r(this,e).duration=+r.apply(this,arguments)}}function Vx(e,r){return r=+r,function(){_r(this,e).duration=r}}function Gx(e){var r=this._id;return arguments.length?this.each((typeof e=="function"?Wx:Vx)(r,e)):cr(this.node(),r).duration}function Xx(e,r){if(typeof r!="function")throw new Error;return function(){_r(this,e).ease=r}}function jx(e){var r=this._id;return arguments.length?this.each(Xx(r,e)):cr(this.node(),r).ease}function Yx(e,r){return function(){var t=r.apply(this,arguments);if(typeof t!="function")throw new Error;_r(this,e).ease=t}}function Kx(e){if(typeof e!="function")throw new Error;return this.each(Yx(this._id,e))}function qx(e){typeof e!="function"&&(e=al(e));for(var r=this._groups,t=r.length,n=new Array(t),a=0;a<t;++a)for(var i=r[a],s=i.length,o=n[a]=[],c,f=0;f<s;++f)(c=i[f])&&e.call(c,c.__data__,f,i)&&o.push(c);return new Rr(n,this._parents,this._name,this._id)}function Zx(e){if(e._id!==this._id)throw new Error;for(var r=this._groups,t=e._groups,n=r.length,a=t.length,i=Math.min(n,a),s=new Array(n),o=0;o<i;++o)for(var c=r[o],f=t[o],l=c.length,u=s[o]=new Array(l),d,h=0;h<l;++h)(d=c[h]||f[h])&&(u[h]=d);for(;o<n;++o)s[o]=r[o];return new Rr(s,this._parents,this._name,this._id)}function Jx(e){return(e+"").trim().split(/^|\s+/).every(function(r){var t=r.indexOf(".");return t>=0&&(r=r.slice(0,t)),!r||r==="start"})}function Qx(e,r,t){var n,a,i=Jx(r)?Zo:_r;return function(){var s=i(this,e),o=s.on;o!==n&&(a=(n=o).copy()).on(r,t),s.on=a}}function em(e,r){var t=this._id;return arguments.length<2?cr(this.node(),t).on.on(e):this.each(Qx(t,e,r))}function tm(e){return function(){var r=this.parentNode;for(var t in this.__transition)if(+t!==e)return;r&&r.removeChild(this)}}function rm(){return this.on("end.remove",tm(this._id))}function nm(e){var r=this._name,t=this._id;typeof e!="function"&&(e=Go(e));for(var n=this._groups,a=n.length,i=new Array(a),s=0;s<a;++s)for(var o=n[s],c=o.length,f=i[s]=new Array(c),l,u,d=0;d<c;++d)(l=o[d])&&(u=e.call(l,l.__data__,d,o))&&("__data__"in l&&(u.__data__=l.__data__),f[d]=u,fs(f[d],r,t,d,f,cr(l,t)));return new Rr(i,this._parents,r,t)}function am(e){var r=this._name,t=this._id;typeof e!="function"&&(e=nl(e));for(var n=this._groups,a=n.length,i=[],s=[],o=0;o<a;++o)for(var c=n[o],f=c.length,l,u=0;u<f;++u)if(l=c[u]){for(var d=e.call(l,l.__data__,u,c),h,x=cr(l,t),p=0,m=d.length;p<m;++p)(h=d[p])&&fs(h,r,t,p,d,x);i.push(d),s.push(l)}return new Rr(i,s,r,t)}var im=Na.prototype.constructor;function sm(){return new im(this._groups,this._parents)}function om(e,r){var t,n,a;return function(){var i=Nn(this,e),s=(this.style.removeProperty(e),Nn(this,e));return i===s?null:i===t&&s===n?a:a=r(t=i,n=s)}}function bl(e){return function(){this.style.removeProperty(e)}}function cm(e,r,t){var n,a=t+"",i;return function(){var s=Nn(this,e);return s===a?null:s===n?i:i=r(n=s,t)}}function fm(e,r,t){var n,a,i;return function(){var s=Nn(this,e),o=t(this),c=o+"";return o==null&&(c=o=(this.style.removeProperty(e),Nn(this,e))),s===c?null:s===n&&c===a?i:(a=c,i=r(n=s,o))}}function lm(e,r){var t,n,a,i="style."+r,s="end."+i,o;return function(){var c=_r(this,e),f=c.on,l=c.value[i]==null?o||(o=bl(r)):void 0;(f!==t||a!==l)&&(n=(t=f).copy()).on(s,a=l),c.on=n}}function um(e,r,t){var n=(e+="")=="transform"?ux:Tl;return r==null?this.styleTween(e,om(e,n)).on("end.style."+e,bl(e)):typeof r=="function"?this.styleTween(e,fm(e,n,Jo(this,"style."+e,r))).each(lm(this._id,e)):this.styleTween(e,cm(e,n,r),t).on("end.style."+e,null)}function hm(e,r,t){return function(n){this.style.setProperty(e,r.call(this,n),t)}}function dm(e,r,t){var n,a;function i(){var s=r.apply(this,arguments);return s!==a&&(n=(a=s)&&hm(e,s,t)),n}return i._value=r,i}function pm(e,r,t){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(r==null)return this.tween(n,null);if(typeof r!="function")throw new Error;return this.tween(n,dm(e,r,t??""))}function xm(e){return function(){this.textContent=e}}function mm(e){return function(){var r=e(this);this.textContent=r??""}}function gm(e){return this.tween("text",typeof e=="function"?mm(Jo(this,"text",e)):xm(e==null?"":e+""))}function _m(e){return function(r){this.textContent=e.call(this,r)}}function vm(e){var r,t;function n(){var a=e.apply(this,arguments);return a!==t&&(r=(t=a)&&_m(a)),r}return n._value=e,n}function wm(e){var r="text";if(arguments.length<1)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,vm(e))}function ym(){for(var e=this._name,r=this._id,t=Al(),n=this._groups,a=n.length,i=0;i<a;++i)for(var s=n[i],o=s.length,c,f=0;f<o;++f)if(c=s[f]){var l=cr(c,r);fs(c,e,t,f,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new Rr(n,this._parents,e,t)}function km(){var e,r,t=this,n=t._id,a=t.size();return new Promise(function(i,s){var o={value:s},c={value:function(){--a===0&&i()}};t.each(function(){var f=_r(this,n),l=f.on;l!==e&&(r=(e=l).copy(),r._.cancel.push(o),r._.interrupt.push(o),r._.end.push(c)),f.on=r}),a===0&&i()})}var Em=0;function Rr(e,r,t,n){this._groups=e,this._parents=r,this._name=t,this._id=n}function Al(){return++Em}var Er=Na.prototype;Rr.prototype={constructor:Rr,select:nm,selectAll:am,selectChild:Er.selectChild,selectChildren:Er.selectChildren,filter:qx,merge:Zx,selection:sm,transition:ym,call:Er.call,nodes:Er.nodes,node:Er.node,size:Er.size,empty:Er.empty,each:Er.each,on:em,attr:Px,attrTween:Ux,style:um,styleTween:pm,text:gm,textTween:wm,remove:rm,tween:Sx,delay:Hx,duration:Gx,ease:jx,easeVarying:Kx,end:km,[Symbol.iterator]:Er[Symbol.iterator]};function Tm(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var bm={time:null,delay:0,duration:250,ease:Tm};function Am(e,r){for(var t;!(t=e.__transition)||!(t=t[r]);)if(!(e=e.parentNode))throw new Error(`transition ${r} not found`);return t}function Sm(e){var r,t;e instanceof Rr?(r=e._id,e=e._name):(r=Al(),(t=bm).time=qo(),e=e==null?null:e+"");for(var n=this._groups,a=n.length,i=0;i<a;++i)for(var s=n[i],o=s.length,c,f=0;f<o;++f)(c=s[f])&&fs(c,e,r,f,s,t||Am(c,r));return new Rr(n,this._parents,e,r)}Na.prototype.interrupt=Tx;Na.prototype.transition=Sm;const po=Math.PI,xo=2*po,Kr=1e-6,Cm=xo-Kr;function Sl(e){this._+=e[0];for(let r=1,t=e.length;r<t;++r)this._+=arguments[r]+e[r]}function Fm(e){let r=Math.floor(e);if(!(r>=0))throw new Error(`invalid digits: ${e}`);if(r>15)return Sl;const t=10**r;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*t)/t+n[a]}}class Rm{constructor(r){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=r==null?Sl:Fm(r)}moveTo(r,t){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(r,t){this._append`L${this._x1=+r},${this._y1=+t}`}quadraticCurveTo(r,t,n,a){this._append`Q${+r},${+t},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(r,t,n,a,i,s){this._append`C${+r},${+t},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(r,t,n,a,i){if(r=+r,t=+t,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,c=n-r,f=a-t,l=s-r,u=o-t,d=l*l+u*u;if(this._x1===null)this._append`M${this._x1=r},${this._y1=t}`;else if(d>Kr)if(!(Math.abs(u*c-f*l)>Kr)||!i)this._append`L${this._x1=r},${this._y1=t}`;else{let h=n-s,x=a-o,p=c*c+f*f,m=h*h+x*x,g=Math.sqrt(p),w=Math.sqrt(d),v=i*Math.tan((po-Math.acos((p+d-m)/(2*g*w)))/2),k=v/w,A=v/g;Math.abs(k-1)>Kr&&this._append`L${r+k*l},${t+k*u}`,this._append`A${i},${i},0,0,${+(u*h>l*x)},${this._x1=r+A*c},${this._y1=t+A*f}`}}arc(r,t,n,a,i,s){if(r=+r,t=+t,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),c=n*Math.sin(a),f=r+o,l=t+c,u=1^s,d=s?a-i:i-a;this._x1===null?this._append`M${f},${l}`:(Math.abs(this._x1-f)>Kr||Math.abs(this._y1-l)>Kr)&&this._append`L${f},${l}`,n&&(d<0&&(d=d%xo+xo),d>Cm?this._append`A${n},${n},0,1,${u},${r-o},${t-c}A${n},${n},0,1,${u},${this._x1=f},${this._y1=l}`:d>Kr&&this._append`A${n},${n},0,${+(d>=po)},${u},${this._x1=r+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(r,t,n,a){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+t}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function Im(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Vi(e,r){if((t=(e=r?e.toExponential(r-1):e.toExponential()).indexOf("e"))<0)return null;var t,n=e.slice(0,t);return[n.length>1?n[0]+n.slice(2):n,+e.slice(t+1)]}function Ln(e){return e=Vi(Math.abs(e)),e?e[1]:NaN}function Om(e,r){return function(t,n){for(var a=t.length,i=[],s=0,o=e[0],c=0;a>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),i.push(t.substring(a-=o,a+o)),!((c+=o+1)>n));)o=e[s=(s+1)%e.length];return i.reverse().join(r)}}function Dm(e){return function(r){return r.replace(/[0-9]/g,function(t){return e[+t]})}}var Pm=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Gi(e){if(!(r=Pm.exec(e)))throw new Error("invalid format: "+e);var r;return new Qo({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}Gi.prototype=Qo.prototype;function Qo(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Qo.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Nm(e){e:for(var r=e.length,t=1,n=-1,a;t<r;++t)switch(e[t]){case".":n=a=t;break;case"0":n===0&&(n=t),a=t;break;default:if(!+e[t])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var Cl;function Mm(e,r){var t=Vi(e,r);if(!t)return e+"";var n=t[0],a=t[1],i=a-(Cl=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Vi(e,Math.max(0,r+i-1))[0]}function _0(e,r){var t=Vi(e,r);if(!t)return e+"";var n=t[0],a=t[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const v0={"%":(e,r)=>(e*100).toFixed(r),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Im,e:(e,r)=>e.toExponential(r),f:(e,r)=>e.toFixed(r),g:(e,r)=>e.toPrecision(r),o:e=>Math.round(e).toString(8),p:(e,r)=>_0(e*100,r),r:_0,s:Mm,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function w0(e){return e}var y0=Array.prototype.map,k0=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Lm(e){var r=e.grouping===void 0||e.thousands===void 0?w0:Om(y0.call(e.grouping,Number),e.thousands+""),t=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?w0:Dm(y0.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"−":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function f(u){u=Gi(u);var d=u.fill,h=u.align,x=u.sign,p=u.symbol,m=u.zero,g=u.width,w=u.comma,v=u.precision,k=u.trim,A=u.type;A==="n"?(w=!0,A="g"):v0[A]||(v===void 0&&(v=12),k=!0,A="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var F=p==="$"?t:p==="#"&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",E=p==="$"?n:/[%p]/.test(A)?s:"",z=v0[A],C=/[defgprs%]/.test(A);v=v===void 0?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function G(H){var b=F,X=E,_,W,q;if(A==="c")X=z(H)+X,H="";else{H=+H;var j=H<0||1/H<0;if(H=isNaN(H)?c:z(Math.abs(H),v),k&&(H=Nm(H)),j&&+H==0&&x!=="+"&&(j=!1),b=(j?x==="("?x:o:x==="-"||x==="("?"":x)+b,X=(A==="s"?k0[8+Cl/3]:"")+X+(j&&x==="("?")":""),C){for(_=-1,W=H.length;++_<W;)if(q=H.charCodeAt(_),48>q||q>57){X=(q===46?a+H.slice(_+1):H.slice(_))+X,H=H.slice(0,_);break}}}w&&!m&&(H=r(H,1/0));var ue=b.length+H.length+X.length,P=ue<g?new Array(g-ue+1).join(d):"";switch(w&&m&&(H=r(P+H,P.length?g-X.length:1/0),P=""),h){case"<":H=b+H+X+P;break;case"=":H=b+P+H+X;break;case"^":H=P.slice(0,ue=P.length>>1)+b+H+X+P.slice(ue);break;default:H=P+b+H+X;break}return i(H)}return G.toString=function(){return u+""},G}function l(u,d){var h=f((u=Gi(u),u.type="f",u)),x=Math.max(-8,Math.min(8,Math.floor(Ln(d)/3)))*3,p=Math.pow(10,-x),m=k0[8+x/3];return function(g){return h(p*g)+m}}return{format:f,formatPrefix:l}}var ri,Fl,Rl;Bm({thousands:",",grouping:[3],currency:["$",""]});function Bm(e){return ri=Lm(e),Fl=ri.format,Rl=ri.formatPrefix,ri}function Um(e){return Math.max(0,-Ln(Math.abs(e)))}function zm(e,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ln(r)/3)))*3-Ln(Math.abs(e)))}function $m(e,r){return e=Math.abs(e),r=Math.abs(r)-e,Math.max(0,Ln(r)-Ln(e))+1}function Hm(e){var r=0,t=e.children,n=t&&t.length;if(!n)r=1;else for(;--n>=0;)r+=t[n].value;e.value=r}function Wm(){return this.eachAfter(Hm)}function Vm(e,r){let t=-1;for(const n of this)e.call(r,n,++t,this);return this}function Gm(e,r){for(var t=this,n=[t],a,i,s=-1;t=n.pop();)if(e.call(r,t,++s,this),a=t.children)for(i=a.length-1;i>=0;--i)n.push(a[i]);return this}function Xm(e,r){for(var t=this,n=[t],a=[],i,s,o,c=-1;t=n.pop();)if(a.push(t),i=t.children)for(s=0,o=i.length;s<o;++s)n.push(i[s]);for(;t=a.pop();)e.call(r,t,++c,this);return this}function jm(e,r){let t=-1;for(const n of this)if(e.call(r,n,++t,this))return n}function Ym(e){return this.eachAfter(function(r){for(var t=+e(r.data)||0,n=r.children,a=n&&n.length;--a>=0;)t+=n[a].value;r.value=t})}function Km(e){return this.eachBefore(function(r){r.children&&r.children.sort(e)})}function qm(e){for(var r=this,t=Zm(r,e),n=[r];r!==t;)r=r.parent,n.push(r);for(var a=n.length;e!==t;)n.splice(a,0,e),e=e.parent;return n}function Zm(e,r){if(e===r)return e;var t=e.ancestors(),n=r.ancestors(),a=null;for(e=t.pop(),r=n.pop();e===r;)a=e,e=t.pop(),r=n.pop();return a}function Jm(){for(var e=this,r=[e];e=e.parent;)r.push(e);return r}function Qm(){return Array.from(this)}function eg(){var e=[];return this.eachBefore(function(r){r.children||e.push(r)}),e}function tg(){var e=this,r=[];return e.each(function(t){t!==e&&r.push({source:t.parent,target:t})}),r}function*rg(){var e=this,r,t=[e],n,a,i;do for(r=t.reverse(),t=[];e=r.pop();)if(yield e,n=e.children)for(a=0,i=n.length;a<i;++a)t.push(n[a]);while(t.length)}function Il(e,r){e instanceof Map?(e=[void 0,e],r===void 0&&(r=ig)):r===void 0&&(r=ag);for(var t=new Bn(e),n,a=[t],i,s,o,c;n=a.pop();)if((s=r(n.data))&&(c=(s=Array.from(s)).length))for(n.children=s,o=c-1;o>=0;--o)a.push(i=s[o]=new Bn(s[o])),i.parent=n,i.depth=n.depth+1;return t.eachBefore(Ol)}function ng(){return Il(this).eachBefore(sg)}function ag(e){return e.children}function ig(e){return Array.isArray(e)?e[1]:null}function sg(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Ol(e){var r=0;do e.height=r;while((e=e.parent)&&e.height<++r)}function Bn(e){this.data=e,this.depth=this.height=0,this.parent=null}Bn.prototype=Il.prototype={constructor:Bn,count:Wm,each:Vm,eachAfter:Xm,eachBefore:Gm,find:jm,sum:Ym,sort:Km,path:qm,ancestors:Jm,descendants:Qm,leaves:eg,links:tg,copy:ng,[Symbol.iterator]:rg};function Cs(e){return e==null?null:og(e)}function og(e){if(typeof e!="function")throw new Error;return e}var cg={depth:-1},E0={},Fs={};function fg(e){return e.id}function lg(e){return e.parentId}function ug(){var e=fg,r=lg,t;function n(a){var i=Array.from(a),s=e,o=r,c,f,l,u,d,h,x,p,m=new Map;if(t!=null){const g=i.map((k,A)=>hg(t(k,A,a))),w=g.map(T0),v=new Set(g).add("");for(const k of w)v.has(k)||(v.add(k),g.push(k),w.push(T0(k)),i.push(Fs));s=(k,A)=>g[A],o=(k,A)=>w[A]}for(l=0,c=i.length;l<c;++l)f=i[l],h=i[l]=new Bn(f),(x=s(f,l,a))!=null&&(x+="")&&(p=h.id=x,m.set(p,m.has(p)?E0:h)),(x=o(f,l,a))!=null&&(x+="")&&(h.parent=x);for(l=0;l<c;++l)if(h=i[l],x=h.parent){if(d=m.get(x),!d)throw new Error("missing: "+x);if(d===E0)throw new Error("ambiguous: "+x);d.children?d.children.push(h):d.children=[h],h.parent=d}else{if(u)throw new Error("multiple roots");u=h}if(!u)throw new Error("no root");if(t!=null){for(;u.data===Fs&&u.children.length===1;)u=u.children[0],--c;for(let g=i.length-1;g>=0&&(h=i[g],h.data===Fs);--g)h.data=null}if(u.parent=cg,u.eachBefore(function(g){g.depth=g.parent.depth+1,--c}).eachBefore(Ol),u.parent=null,c>0)throw new Error("cycle");return u}return n.id=function(a){return arguments.length?(e=Cs(a),n):e},n.parentId=function(a){return arguments.length?(r=Cs(a),n):r},n.path=function(a){return arguments.length?(t=Cs(a),n):t},n}function hg(e){e=`${e}`;let r=e.length;return mo(e,r-1)&&!mo(e,r-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function T0(e){let r=e.length;if(r<2)return"";for(;--r>1&&!mo(e,r););return e.slice(0,r)}function mo(e,r){if(e[r]==="/"){let t=0;for(;r>0&&e[--r]==="\\";)++t;if((t&1)===0)return!0}return!1}function dg(e,r){return e.parent===r.parent?1:2}function Rs(e){var r=e.children;return r?r[0]:e.t}function Is(e){var r=e.children;return r?r[r.length-1]:e.t}function pg(e,r,t){var n=t/(r.i-e.i);r.c-=n,r.s+=t,e.c+=n,r.z+=t,r.m+=t}function xg(e){for(var r=0,t=0,n=e.children,a=n.length,i;--a>=0;)i=n[a],i.z+=r,i.m+=r,r+=i.s+(t+=i.c)}function mg(e,r,t){return e.a.parent===r.parent?e.a:t}function Ci(e,r){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=r}Ci.prototype=Object.create(Bn.prototype);function gg(e){for(var r=new Ci(e,0),t,n=[r],a,i,s,o;t=n.pop();)if(i=t._.children)for(t.children=new Array(o=i.length),s=o-1;s>=0;--s)n.push(a=t.children[s]=new Ci(i[s],s)),a.parent=t;return(r.parent=new Ci(null,0)).children=[r],r}function _g(){var e=dg,r=1,t=1,n=null;function a(f){var l=gg(f);if(l.eachAfter(i),l.parent.m=-l.z,l.eachBefore(s),n)f.eachBefore(c);else{var u=f,d=f,h=f;f.eachBefore(function(w){w.x<u.x&&(u=w),w.x>d.x&&(d=w),w.depth>h.depth&&(h=w)});var x=u===d?1:e(u,d)/2,p=x-u.x,m=r/(d.x+x+p),g=t/(h.depth||1);f.eachBefore(function(w){w.x=(w.x+p)*m,w.y=w.depth*g})}return f}function i(f){var l=f.children,u=f.parent.children,d=f.i?u[f.i-1]:null;if(l){xg(f);var h=(l[0].z+l[l.length-1].z)/2;d?(f.z=d.z+e(f._,d._),f.m=f.z-h):f.z=h}else d&&(f.z=d.z+e(f._,d._));f.parent.A=o(f,d,f.parent.A||u[0])}function s(f){f._.x=f.z+f.parent.m,f.m+=f.parent.m}function o(f,l,u){if(l){for(var d=f,h=f,x=l,p=d.parent.children[0],m=d.m,g=h.m,w=x.m,v=p.m,k;x=Is(x),d=Rs(d),x&&d;)p=Rs(p),h=Is(h),h.a=f,k=x.z+w-d.z-m+e(x._,d._),k>0&&(pg(mg(x,f,u),f,k),m+=k,g+=k),w+=x.m,m+=d.m,v+=p.m,g+=h.m;x&&!Is(h)&&(h.t=x,h.m+=w-g),d&&!Rs(p)&&(p.t=d,p.m+=m-v,u=f)}return u}function c(f){f.x*=r,f.y=f.depth*t}return a.separation=function(f){return arguments.length?(e=f,a):e},a.size=function(f){return arguments.length?(n=!1,r=+f[0],t=+f[1],a):n?null:[r,t]},a.nodeSize=function(f){return arguments.length?(n=!0,r=+f[0],t=+f[1],a):n?[r,t]:null},a}function vg(e,r){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof r=="function"?this.interpolator(r):this.range(r);break}}return this}function Dl(e){return e}function wg(e,r,t,n){var a=Kd(e,r,t),i;switch(n=Gi(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(r));return n.precision==null&&!isNaN(i=zm(a,s))&&(n.precision=i),Rl(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=$m(a,Math.max(Math.abs(e),Math.abs(r))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=Um(a))&&(n.precision=i-(n.type==="%")*2);break}}return Fl(n)}function yg(e){var r=e.domain;return e.ticks=function(t){var n=r();return Yd(n[0],n[n.length-1],t??10)},e.tickFormat=function(t,n){var a=r();return wg(a[0],a[a.length-1],t??10,n)},e.nice=function(t){t==null&&(t=10);var n=r(),a=0,i=n.length-1,s=n[a],o=n[i],c,f,l=10;for(o<s&&(f=s,s=o,o=f,f=a,a=i,i=f);l-- >0;){if(f=ao(s,o,t),f===c)return n[a]=s,n[i]=o,r(n);if(f>0)s=Math.floor(s/f)*f,o=Math.ceil(o/f)*f;else if(f<0)s=Math.ceil(s*f)/f,o=Math.floor(o*f)/f;else break;c=f}return e},e}function kg(){var e=0,r=1,t,n,a,i,s=Dl,o=!1,c;function f(u){return u==null||isNaN(u=+u)?c:s(a===0?.5:(u=(i(u)-t)*a,o?Math.max(0,Math.min(1,u)):u))}f.domain=function(u){return arguments.length?([e,r]=u,t=i(e=+e),n=i(r=+r),a=t===n?0:1/(n-t),f):[e,r]},f.clamp=function(u){return arguments.length?(o=!!u,f):o},f.interpolator=function(u){return arguments.length?(s=u,f):s};function l(u){return function(d){var h,x;return arguments.length?([h,x]=d,s=u(h,x),f):[s(0),s(1)]}}return f.range=l(Ko),f.rangeRound=l(cx),f.unknown=function(u){return arguments.length?(c=u,f):c},function(u){return i=u,t=u(e),n=u(r),a=t===n?0:1/(n-t),f}}function Eg(e,r){return r.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Pl(){var e=yg(kg()(Dl));return e.copy=function(){return Eg(e,Pl())},vg.apply(e,arguments)}function Tg(e){for(var r=e.length/6|0,t=new Array(r),n=0;n<r;)t[n]="#"+e.slice(n*6,++n*6);return t}const bg=e=>ex(e[e.length-1]);var Ag=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Tg);const Sg=bg(Ag);function b0(e){return function(){return e}}function Cg(e){let r=3;return e.digits=function(t){if(!arguments.length)return r;if(t==null)r=null;else{const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);r=n}return e},()=>new Rm(r)}var Fg=Array.prototype.slice;function Rg(e){return e[0]}function Ig(e){return e[1]}class Og{constructor(r,t){this._context=r,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(r,t){switch(r=+r,t=+t,this._point){case 0:{this._point=1,this._line?this._context.lineTo(r,t):this._context.moveTo(r,t);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+r)/2,this._y0,this._x0,t,r,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,r,this._y0,r,t);break}}this._x0=r,this._y0=t}}function Dg(e){return new Og(e,!1)}function Pg(e){return e.source}function Ng(e){return e.target}function Mg(e){let r=Pg,t=Ng,n=Rg,a=Ig,i=null,s=null,o=Cg(c);function c(){let f;const l=Fg.call(arguments),u=r.apply(this,l),d=t.apply(this,l);if(i==null&&(s=e(f=o())),s.lineStart(),l[0]=u,s.point(+n.apply(this,l),+a.apply(this,l)),l[0]=d,s.point(+n.apply(this,l),+a.apply(this,l)),s.lineEnd(),f)return s=null,f+""||null}return c.source=function(f){return arguments.length?(r=f,c):r},c.target=function(f){return arguments.length?(t=f,c):t},c.x=function(f){return arguments.length?(n=typeof f=="function"?f:b0(+f),c):n},c.y=function(f){return arguments.length?(a=typeof f=="function"?f:b0(+f),c):a},c.context=function(f){return arguments.length?(f==null?i=s=null:s=e(i=f),c):i},c}function Lg(){return Mg(Dg)}const ni=e=>()=>e;function Bg(e,{sourceEvent:r,target:t,transform:n,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:r,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:a}})}function Ar(e,r,t){this.k=e,this.x=r,this.y=t}Ar.prototype={constructor:Ar,scale:function(e){return e===1?this:new Ar(this.k*e,this.x,this.y)},translate:function(e,r){return e===0&r===0?this:new Ar(this.k,this.x+this.k*e,this.y+this.k*r)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Nl=new Ar(1,0,0);Ar.prototype;function Os(e){e.stopImmediatePropagation()}function Jn(e){e.preventDefault(),e.stopImmediatePropagation()}function Ug(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function zg(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function A0(){return this.__zoom||Nl}function $g(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Hg(){return navigator.maxTouchPoints||"ontouchstart"in this}function Wg(e,r,t){var n=e.invertX(r[0][0])-t[0][0],a=e.invertX(r[1][0])-t[1][0],i=e.invertY(r[0][1])-t[0][1],s=e.invertY(r[1][1])-t[1][1];return e.translate(a>n?(n+a)/2:Math.min(0,n)||Math.max(0,a),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function Vg(){var e=Ug,r=zg,t=Wg,n=$g,a=Hg,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],o=250,c=mx,f=Wo("start","zoom","end"),l,u,d,h=500,x=150,p=0,m=10;function g(_){_.property("__zoom",A0).on("wheel.zoom",z,{passive:!1}).on("mousedown.zoom",C).on("dblclick.zoom",G).filter(a).on("touchstart.zoom",H).on("touchmove.zoom",b).on("touchend.zoom touchcancel.zoom",X).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(_,W,q,j){var ue=_.selection?_.selection():_;ue.property("__zoom",A0),_!==ue?A(_,W,q,j):ue.interrupt().each(function(){F(this,arguments).event(j).start().zoom(null,typeof W=="function"?W.apply(this,arguments):W).end()})},g.scaleBy=function(_,W,q,j){g.scaleTo(_,function(){var ue=this.__zoom.k,P=typeof W=="function"?W.apply(this,arguments):W;return ue*P},q,j)},g.scaleTo=function(_,W,q,j){g.transform(_,function(){var ue=r.apply(this,arguments),P=this.__zoom,se=q==null?k(ue):typeof q=="function"?q.apply(this,arguments):q,Y=P.invert(se),T=typeof W=="function"?W.apply(this,arguments):W;return t(v(w(P,T),se,Y),ue,s)},q,j)},g.translateBy=function(_,W,q,j){g.transform(_,function(){return t(this.__zoom.translate(typeof W=="function"?W.apply(this,arguments):W,typeof q=="function"?q.apply(this,arguments):q),r.apply(this,arguments),s)},null,j)},g.translateTo=function(_,W,q,j,ue){g.transform(_,function(){var P=r.apply(this,arguments),se=this.__zoom,Y=j==null?k(P):typeof j=="function"?j.apply(this,arguments):j;return t(Nl.translate(Y[0],Y[1]).scale(se.k).translate(typeof W=="function"?-W.apply(this,arguments):-W,typeof q=="function"?-q.apply(this,arguments):-q),P,s)},j,ue)};function w(_,W){return W=Math.max(i[0],Math.min(i[1],W)),W===_.k?_:new Ar(W,_.x,_.y)}function v(_,W,q){var j=W[0]-q[0]*_.k,ue=W[1]-q[1]*_.k;return j===_.x&&ue===_.y?_:new Ar(_.k,j,ue)}function k(_){return[(+_[0][0]+ +_[1][0])/2,(+_[0][1]+ +_[1][1])/2]}function A(_,W,q,j){_.on("start.zoom",function(){F(this,arguments).event(j).start()}).on("interrupt.zoom end.zoom",function(){F(this,arguments).event(j).end()}).tween("zoom",function(){var ue=this,P=arguments,se=F(ue,P).event(j),Y=r.apply(ue,P),T=q==null?k(Y):typeof q=="function"?q.apply(ue,P):q,K=Math.max(Y[1][0]-Y[0][0],Y[1][1]-Y[0][1]),B=ue.__zoom,N=typeof W=="function"?W.apply(ue,P):W,ie=c(B.invert(T).concat(K/B.k),N.invert(T).concat(K/N.k));return function(pe){if(pe===1)pe=N;else{var le=ie(pe),fe=K/le[2];pe=new Ar(fe,T[0]-le[0]*fe,T[1]-le[1]*fe)}se.zoom(null,pe)}})}function F(_,W,q){return!q&&_.__zooming||new E(_,W)}function E(_,W){this.that=_,this.args=W,this.active=0,this.sourceEvent=null,this.extent=r.apply(_,W),this.taps=0}E.prototype={event:function(_){return _&&(this.sourceEvent=_),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(_,W){return this.mouse&&_!=="mouse"&&(this.mouse[1]=W.invert(this.mouse[0])),this.touch0&&_!=="touch"&&(this.touch0[1]=W.invert(this.touch0[0])),this.touch1&&_!=="touch"&&(this.touch1[1]=W.invert(this.touch1[0])),this.that.__zoom=W,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(_){var W=jt(this.that).datum();f.call(_,this.that,new Bg(_,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:f}),W)}};function z(_,...W){if(!e.apply(this,arguments))return;var q=F(this,W).event(_),j=this.__zoom,ue=Math.max(i[0],Math.min(i[1],j.k*Math.pow(2,n.apply(this,arguments)))),P=jr(_);if(q.wheel)(q.mouse[0][0]!==P[0]||q.mouse[0][1]!==P[1])&&(q.mouse[1]=j.invert(q.mouse[0]=P)),clearTimeout(q.wheel);else{if(j.k===ue)return;q.mouse=[P,j.invert(P)],Si(this),q.start()}Jn(_),q.wheel=setTimeout(se,x),q.zoom("mouse",t(v(w(j,ue),q.mouse[0],q.mouse[1]),q.extent,s));function se(){q.wheel=null,q.end()}}function C(_,...W){if(d||!e.apply(this,arguments))return;var q=_.currentTarget,j=F(this,W,!0).event(_),ue=jt(_.view).on("mousemove.zoom",T,!0).on("mouseup.zoom",K,!0),P=jr(_,q),se=_.clientX,Y=_.clientY;Pp(_.view),Os(_),j.mouse=[P,this.__zoom.invert(P)],Si(this),j.start();function T(B){if(Jn(B),!j.moved){var N=B.clientX-se,ie=B.clientY-Y;j.moved=N*N+ie*ie>p}j.event(B).zoom("mouse",t(v(j.that.__zoom,j.mouse[0]=jr(B,q),j.mouse[1]),j.extent,s))}function K(B){ue.on("mousemove.zoom mouseup.zoom",null),Np(B.view,j.moved),Jn(B),j.event(B).end()}}function G(_,...W){if(e.apply(this,arguments)){var q=this.__zoom,j=jr(_.changedTouches?_.changedTouches[0]:_,this),ue=q.invert(j),P=q.k*(_.shiftKey?.5:2),se=t(v(w(q,P),j,ue),r.apply(this,W),s);Jn(_),o>0?jt(this).transition().duration(o).call(A,se,j,_):jt(this).call(g.transform,se,j,_)}}function H(_,...W){if(e.apply(this,arguments)){var q=_.touches,j=q.length,ue=F(this,W,_.changedTouches.length===j).event(_),P,se,Y,T;for(Os(_),se=0;se<j;++se)Y=q[se],T=jr(Y,this),T=[T,this.__zoom.invert(T),Y.identifier],ue.touch0?!ue.touch1&&ue.touch0[2]!==T[2]&&(ue.touch1=T,ue.taps=0):(ue.touch0=T,P=!0,ue.taps=1+!!l);l&&(l=clearTimeout(l)),P&&(ue.taps<2&&(u=T[0],l=setTimeout(function(){l=null},h)),Si(this),ue.start())}}function b(_,...W){if(this.__zooming){var q=F(this,W).event(_),j=_.changedTouches,ue=j.length,P,se,Y,T;for(Jn(_),P=0;P<ue;++P)se=j[P],Y=jr(se,this),q.touch0&&q.touch0[2]===se.identifier?q.touch0[0]=Y:q.touch1&&q.touch1[2]===se.identifier&&(q.touch1[0]=Y);if(se=q.that.__zoom,q.touch1){var K=q.touch0[0],B=q.touch0[1],N=q.touch1[0],ie=q.touch1[1],pe=(pe=N[0]-K[0])*pe+(pe=N[1]-K[1])*pe,le=(le=ie[0]-B[0])*le+(le=ie[1]-B[1])*le;se=w(se,Math.sqrt(pe/le)),Y=[(K[0]+N[0])/2,(K[1]+N[1])/2],T=[(B[0]+ie[0])/2,(B[1]+ie[1])/2]}else if(q.touch0)Y=q.touch0[0],T=q.touch0[1];else return;q.zoom("touch",t(v(se,Y,T),q.extent,s))}}function X(_,...W){if(this.__zooming){var q=F(this,W).event(_),j=_.changedTouches,ue=j.length,P,se;for(Os(_),d&&clearTimeout(d),d=setTimeout(function(){d=null},h),P=0;P<ue;++P)se=j[P],q.touch0&&q.touch0[2]===se.identifier?delete q.touch0:q.touch1&&q.touch1[2]===se.identifier&&delete q.touch1;if(q.touch1&&!q.touch0&&(q.touch0=q.touch1,delete q.touch1),q.touch0)q.touch0[1]=this.__zoom.invert(q.touch0[0]);else if(q.end(),q.taps===2&&(se=jr(se,this),Math.hypot(u[0]-se[0],u[1]-se[1])<m)){var Y=jt(this).on("dblclick.zoom");Y&&Y.apply(this,arguments)}}}return g.wheelDelta=function(_){return arguments.length?(n=typeof _=="function"?_:ni(+_),g):n},g.filter=function(_){return arguments.length?(e=typeof _=="function"?_:ni(!!_),g):e},g.touchable=function(_){return arguments.length?(a=typeof _=="function"?_:ni(!!_),g):a},g.extent=function(_){return arguments.length?(r=typeof _=="function"?_:ni([[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]]),g):r},g.scaleExtent=function(_){return arguments.length?(i[0]=+_[0],i[1]=+_[1],g):[i[0],i[1]]},g.translateExtent=function(_){return arguments.length?(s[0][0]=+_[0][0],s[1][0]=+_[1][0],s[0][1]=+_[0][1],s[1][1]=+_[1][1],g):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},g.constrain=function(_){return arguments.length?(t=_,g):t},g.duration=function(_){return arguments.length?(o=+_,g):o},g.interpolate=function(_){return arguments.length?(c=_,g):c},g.on=function(){var _=f.on.apply(f,arguments);return _===f?g:_},g.clickDistance=function(_){return arguments.length?(p=(_=+_)*_,g):Math.sqrt(p)},g.tapDistance=function(_){return arguments.length?(m=+_,g):m},g}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ml=1252,Gg=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ec={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},tc=function(e){Gg.indexOf(e)!=-1&&(Ml=ec[0]=e)};function Xg(){tc(1252)}var ar=function(e){tc(e)};function Ll(){ar(1200),Xg()}function S0(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function jg(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function Bl(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var ta=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?jg(e.slice(2)):r==254&&t==255?Bl(e.slice(2)):r==65279?e.slice(1):e},ai=function(r){return String.fromCharCode(r)},C0=function(r){return String.fromCharCode(r)},go,Br="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function F0(e){for(var r="",t=0,n=0,a=0,i=0,s=0,o=0,c=0,f=0;f<e.length;)t=e.charCodeAt(f++),i=t>>2,n=e.charCodeAt(f++),s=(t&3)<<4|n>>4,a=e.charCodeAt(f++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),r+=Br.charAt(i)+Br.charAt(s)+Br.charAt(o)+Br.charAt(c);return r}function Ht(e){var r="",t=0,n=0,a=0,i=0,s=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)i=Br.indexOf(e.charAt(f++)),s=Br.indexOf(e.charAt(f++)),t=i<<2|s>>4,r+=String.fromCharCode(t),o=Br.indexOf(e.charAt(f++)),n=(s&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(n)),c=Br.indexOf(e.charAt(f++)),a=(o&3)<<6|c,c!==64&&(r+=String.fromCharCode(a));return r}var Ne=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ln=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function $r(e){return Ne?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function R0(e){return Ne?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var nr=function(r){return Ne?ln(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function un(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function rc(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return rc(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var Lr=Ne?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:ln(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)if(a=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Yg(e){for(var r=[],t=0,n=e.length+250,a=$r(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[t++]=s;else if(s<2048)a[t++]=192|s>>6&31,a[t++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[t++]=240|s>>8&7,a[t++]=128|s>>2&63,a[t++]=128|o>>6&15|(s&3)<<4,a[t++]=128|o&63}else a[t++]=224|s>>12&15,a[t++]=128|s>>6&63,a[t++]=128|s&63;t>n&&(r.push(a.slice(0,t)),t=0,a=$r(65535),n=65530)}return r.push(a.slice(0,t)),Lr(r)}var Rt=/\u0000/g,ra=/[\u0001-\u0006]/g;function Cn(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function ir(e,r){var t=""+e;return t.length>=r?t:qe("0",r-t.length)+t}function nc(e,r){var t=""+e;return t.length>=r?t:qe(" ",r-t.length)+t}function Xi(e,r){var t=""+e;return t.length>=r?t:t+qe(" ",r-t.length)}function Kg(e,r){var t=""+Math.round(e);return t.length>=r?t:qe("0",r-t.length)+t}function qg(e,r){var t=""+e;return t.length>=r?t:qe("0",r-t.length)+t}var I0=Math.pow(2,32);function gn(e,r){if(e>I0||e<-I0)return Kg(e,r);var t=Math.round(e);return qg(t,r)}function ji(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var O0=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ds=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Zg(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Oe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},D0={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Jg={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Yi(e,r,t){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,c=1,f=0,l=0,u=Math.floor(a);f<r&&(u=Math.floor(a),o=u*s+i,l=u*f+c,!(a-u<5e-8));)a=1/(a-u),i=s,s=o,c=f,f=l;if(l>r&&(f>r?(l=c,o=i):(l=f,o=s)),!t)return[0,n*o,l];var d=Math.floor(n*o/l);return[d,n*o-d*l,l]}function Qr(e,r,t){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=t?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=t?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),t&&(i=a_(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var Ul=new Date(1899,11,31,0,0,0),Qg=Ul.getTime(),e_=new Date(1900,2,1,0,0,0);function zl(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=e_&&(t+=24*60*60*1e3),(t-(Qg+(e.getTimezoneOffset()-Ul.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ac(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function t_(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function r_(e){var r=e<0?12:11,t=ac(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function n_(e){var r=ac(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function ba(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=r_(e):r===10?t=e.toFixed(10).substr(0,12):t=n_(e),ac(t_(t.toUpperCase()))}function on(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ba(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Kt(14,zl(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function a_(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function i_(e,r,t,n){var a="",i=0,s=0,o=t.y,c,f=0;switch(e){case 98:o=t.y+543;case 121:switch(r.length){case 1:case 2:c=o%100,f=2;break;default:c=o%1e4,f=4;break}break;case 109:switch(r.length){case 1:case 2:c=t.m,f=r.length;break;case 3:return Ds[t.m-1][1];case 5:return Ds[t.m-1][0];default:return Ds[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=t.d,f=r.length;break;case 3:return O0[t.q][0];default:return O0[t.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(t.H+11)%12,f=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=t.H,f=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=t.M,f=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?ir(t.S,r.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(t.S+t.u)),i>=60*s&&(i=0),r==="s"?i===0?"0":""+i/s:(a=ir(i,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}f=r.length===3?1:2;break;case 101:c=o,f=1;break}var l=f>0?ir(c,f):"";return l}function Ur(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var $l=/%/g;function s_(e,r,t){var n=r.replace($l,""),a=r.length-n.length;return Cr(e,n,t*Math.pow(10,2*a))+qe("%",a)}function o_(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Cr(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function Hl(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Hl(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),t=(r/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),t.indexOf("e")===-1){var s=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,f,l){return c+f+l.substr(0,(a+i)%a)+"."+l.substr(i)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Wl=/# (\?+)( ?)\/( ?)(\d+)/;function c_(e,r,t){var n=parseInt(e[4],10),a=Math.round(r*n),i=Math.floor(a/n),s=a-i*n,o=n;return t+(i===0?"":""+i)+" "+(s===0?qe(" ",e[1].length+1+e[4].length):nc(s,e[1].length)+e[2]+"/"+e[3]+ir(o,e[4].length))}function f_(e,r,t){return t+(r===0?"":""+r)+qe(" ",e[1].length+2+e[4].length)}var Vl=/^#*0*\.([0#]+)/,Gl=/\).*[0#]/,Xl=/\(###\) ###\\?-####/;function St(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function P0(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function N0(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function l_(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function u_(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Gt(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Gl)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Gt("n",n,t):"("+Gt("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return o_(e,r,t);if(r.indexOf("%")!==-1)return s_(e,r,t);if(r.indexOf("E")!==-1)return Hl(r,t);if(r.charCodeAt(0)===36)return"$"+Gt(e,r.substr(r.charAt(1)==" "?2:1),t);var a,i,s,o,c=Math.abs(t),f=t<0?"-":"";if(r.match(/^00+$/))return f+gn(c,r.length);if(r.match(/^[#?]+$/))return a=gn(t,0),a==="0"&&(a=""),a.length>r.length?a:St(r.substr(0,r.length-a.length))+a;if(i=r.match(Wl))return c_(i,c,f);if(r.match(/^#+0+$/))return f+gn(c,r.length-r.indexOf("0"));if(i=r.match(Vl))return a=P0(t,i[1].length).replace(/^([^\.]+)$/,"$1."+St(i[1])).replace(/\.$/,"."+St(i[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+qe("0",St(i[1]).length-p.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return f+P0(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return f+Ur(gn(c,0));if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Gt(e,r,-t):Ur(""+(Math.floor(t)+l_(t,i[1].length)))+"."+ir(N0(t,i[1].length),i[1].length);if(i=r.match(/^#,#*,#0/))return Gt(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Cn(Gt(e,r.replace(/[\\-]/g,""),t)),s=0,Cn(Cn(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(r.match(Xl))return a=Gt(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var l="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Yi(c,Math.pow(10,s)-1,!1),a=""+f,l=Cr("n",i[1],o[1]),l.charAt(l.length-1)==" "&&(l=l.substr(0,l.length-1)+"0"),a+=l+i[2]+"/"+i[3],l=Xi(o[2],s),l.length<i[4].length&&(l=St(i[4].substr(i[4].length-l.length))+l),a+=l,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Yi(c,Math.pow(10,s)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?nc(o[1],s)+i[2]+"/"+i[3]+Xi(o[2],s):qe(" ",2*s+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=gn(t,0),r.length<=a.length?a:St(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var u=r.indexOf(".")-s,d=r.length-a.length-u;return St(r.substr(0,u)+a+r.substr(r.length-d))}if(i=r.match(/^00,000\.([#0]*0)$/))return s=N0(t,i[1].length),t<0?"-"+Gt(e,r,-t):Ur(u_(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ir(0,3-x.length):"")+x})+"."+ir(s,i[1].length);switch(r){case"###,##0.00":return Gt(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var h=Ur(gn(c,0));return h!=="0"?f+h:"";case"###,###.00":return Gt(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Gt(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function h_(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Cr(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function d_(e,r,t){var n=r.replace($l,""),a=r.length-n.length;return Cr(e,n,t*Math.pow(10,2*a))+qe("%",a)}function jl(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+jl(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),t=(r/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!t.match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,f,l){return c+f+l.substr(0,(a+i)%a)+"."+l.substr(i)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ur(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Gl)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ur("n",n,t):"("+ur("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return h_(e,r,t);if(r.indexOf("%")!==-1)return d_(e,r,t);if(r.indexOf("E")!==-1)return jl(r,t);if(r.charCodeAt(0)===36)return"$"+ur(e,r.substr(r.charAt(1)==" "?2:1),t);var a,i,s,o,c=Math.abs(t),f=t<0?"-":"";if(r.match(/^00+$/))return f+ir(c,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:St(r.substr(0,r.length-a.length))+a;if(i=r.match(Wl))return f_(i,c,f);if(r.match(/^#+0+$/))return f+ir(c,r.length-r.indexOf("0"));if(i=r.match(Vl))return a=(""+t).replace(/^([^\.]+)$/,"$1."+St(i[1])).replace(/\.$/,"."+St(i[1])),a=a.replace(/\.(\d*)$/,function(x,p){return"."+p+qe("0",St(i[1]).length-p.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return f+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return f+Ur(""+c);if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ur(e,r,-t):Ur(""+t)+"."+qe("0",i[1].length);if(i=r.match(/^#,#*,#0/))return ur(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Cn(ur(e,r.replace(/[\\-]/g,""),t)),s=0,Cn(Cn(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(r.match(Xl))return a=ur(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var l="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Yi(c,Math.pow(10,s)-1,!1),a=""+f,l=Cr("n",i[1],o[1]),l.charAt(l.length-1)==" "&&(l=l.substr(0,l.length-1)+"0"),a+=l+i[2]+"/"+i[3],l=Xi(o[2],s),l.length<i[4].length&&(l=St(i[4].substr(i[4].length-l.length))+l),a+=l,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Yi(c,Math.pow(10,s)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?nc(o[1],s)+i[2]+"/"+i[3]+Xi(o[2],s):qe(" ",2*s+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:St(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var u=r.indexOf(".")-s,d=r.length-a.length-u;return St(r.substr(0,u)+a+r.substr(r.length-d))}if(i=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ur(e,r,-t):Ur(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ir(0,3-x.length):"")+x})+"."+ir(0,i[1].length);switch(r){case"###,###":case"##,###":case"#,###":var h=Ur(""+c);return h!=="0"?f+h:"";default:if(r.match(/\.[0#?]*$/))return ur(e,r.slice(0,r.lastIndexOf(".")),t)+St(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Cr(e,r,t){return(t|0)===t?ur(e,r,t):Gt(e,r,t)}function p_(e){for(var r=[],t=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(a,n-a),a=n+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Yl=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Hn(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":ji(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(Yl))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function x_(e,r,t,n){for(var a=[],i="",s=0,o="",c="t",f,l,u,d="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!ji(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(u=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(u);a[a.length]={t:"t",v:i},++s;break;case"\\":var h=e.charAt(++s),x=h==="("||h===")"?h:"t";a[a.length]={t:x,v:h},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:r},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(f==null&&(f=Qr(r,t,e.charAt(s+1)==="2"),f==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||f==null&&(f=Qr(r,t),f==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),a[a.length]={t:o,v:i},c=o;break;case"A":case"a":case"上":var p={t:o,v:o};if(f==null&&(f=Qr(r,t)),e.substr(s,3).toUpperCase()==="A/P"?(f!=null&&(p.v=f.H>=12?"P":"A"),p.t="T",d="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(f!=null&&(p.v=f.H>=12?"PM":"AM"),p.t="T",s+=5,d="h"):e.substr(s,5).toUpperCase()==="上午/下午"?(f!=null&&(p.v=f.H>=12?"下午":"上午"),p.t="T",s+=5,d="h"):(p.t="t",++s),f==null&&p.t==="T")return"";a[a.length]=p,c=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Yl)){if(f==null&&(f=Qr(r,t),f==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Hn(e)||(a[a.length]={t:"t",v:i}));break;case".":if(f!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},c=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var m=0,g=0,w;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=d,c="h",m<1&&(m=1);break;case"s":(w=a[s].v.match(/\.0+$/))&&(g=Math.max(g,w[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":c=a[s].t;break;case"m":c==="s"&&(a[s].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&a[s].v.match(/[Hh]/)&&(m=1),m<2&&a[s].v.match(/[Mm]/)&&(m=2),m<3&&a[s].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var v="",k;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=i_(a[s].t.charCodeAt(0),a[s].v,f,g),a[s].t="t";break;case"n":case"?":for(k=s+1;a[k]!=null&&((o=a[k].t)==="?"||o==="D"||(o===" "||o==="t")&&a[k+1]!=null&&(a[k+1].t==="?"||a[k+1].t==="t"&&a[k+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[k].v==="/"||a[k].v===" "&&a[k+1]!=null&&a[k+1].t=="?"));)a[s].v+=a[k].v,a[k]={v:"",t:";"},++k;v+=a[s].v,s=k-1;break;case"G":a[s].t="t",a[s].v=on(r,t);break}var A="",F,E;if(v.length>0){v.charCodeAt(0)==40?(F=r<0&&v.charCodeAt(0)===45?-r:r,E=Cr("n",v,F)):(F=r<0&&n>1?-r:r,E=Cr("n",v,F),F<0&&a[0]&&a[0].t=="t"&&(E=E.substr(1),a[0].v="-"+a[0].v)),k=E.length-1;var z=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){z=s;break}var C=a.length;if(z===a.length&&E.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(k>=a[s].v.length-1?(k-=a[s].v.length,a[s].v=E.substr(k+1,a[s].v.length)):k<0?a[s].v="":(a[s].v=E.substr(0,k+1),k=-1),a[s].t="t",C=s);k>=0&&C<a.length&&(a[C].v=E.substr(0,k+1)+a[C].v)}else if(z!==a.length&&E.indexOf("E")===-1){for(k=E.indexOf(".")-1,s=z;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(l=a[s].v.indexOf(".")>-1&&s===z?a[s].v.indexOf(".")-1:a[s].v.length-1,A=a[s].v.substr(l+1);l>=0;--l)k>=0&&(a[s].v.charAt(l)==="0"||a[s].v.charAt(l)==="#")&&(A=E.charAt(k--)+A);a[s].v=A,a[s].t="t",C=s}for(k>=0&&C<a.length&&(a[C].v=E.substr(0,k+1)+a[C].v),k=E.indexOf(".")+1,s=z;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==z)){for(l=a[s].v.indexOf(".")>-1&&s===z?a[s].v.indexOf(".")+1:0,A=a[s].v.substr(0,l);l<a[s].v.length;++l)k<E.length&&(A+=E.charAt(k++));a[s].v=A,a[s].t="t",C=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(F=n>1&&r<0&&s>0&&a[s-1].v==="-"?-r:r,a[s].v=Cr(a[s].t,a[s].v,F),a[s].t="t");var G="";for(s=0;s!==a.length;++s)a[s]!=null&&(G+=a[s].v);return G}var M0=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function L0(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function m_(e,r){var t=p_(e),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var i=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,i];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var s=t[0].match(M0),o=t[1].match(M0);return L0(r,s)?[n,t[0]]:L0(r,o)?[n,t[1]]:[n,t[s!=null&&o!=null?2:1]]}return[n,i]}function Kt(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:Oe)[e],n==null&&(n=t.table&&t.table[D0[e]]||Oe[D0[e]]),n==null&&(n=Jg[e]||"General");break}if(ji(n,0))return on(r,t);r instanceof Date&&(r=zl(r,t.date1904));var a=m_(n,r);if(ji(a[1]))return on(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return x_(a[1],r,t,a[0])}function rn(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(Oe[t]==null){r<0&&(r=t);continue}if(Oe[t]==e){r=t;break}}r<0&&(r=391)}return Oe[r]=e,r}function Kl(){Oe=Zg()}var g_={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ql=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function __(e){var r=typeof e=="number"?Oe[e]:e;return r=r.replace(ql,"(\\d+)"),new RegExp("^"+r+"$")}function v_(e,r,t){var n=-1,a=-1,i=-1,s=-1,o=-1,c=-1;(r.match(ql)||[]).forEach(function(u,d){var h=parseInt(t[d+1],10);switch(u.toLowerCase().charAt(0)){case"y":n=h;break;case"d":i=h;break;case"h":s=h;break;case"s":c=h;break;case"m":s>=0?o=h:a=h;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var l=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?f:n==-1&&a==-1&&i==-1?l:f+"T"+l}var w_=function(){var e={};e.version="1.2.0";function r(){for(var E=0,z=new Array(256),C=0;C!=256;++C)E=C,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,z[C]=E;return typeof Int32Array<"u"?new Int32Array(z):z}var t=r();function n(E){var z=0,C=0,G=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(G=0;G!=256;++G)H[G]=E[G];for(G=0;G!=256;++G)for(C=E[G],z=256+G;z<4096;z+=256)C=H[z]=C>>>8^E[C&255];var b=[];for(G=1;G!=16;++G)b[G-1]=typeof Int32Array<"u"?H.subarray(G*256,G*256+256):H.slice(G*256,G*256+256);return b}var a=n(t),i=a[0],s=a[1],o=a[2],c=a[3],f=a[4],l=a[5],u=a[6],d=a[7],h=a[8],x=a[9],p=a[10],m=a[11],g=a[12],w=a[13],v=a[14];function k(E,z){for(var C=z^-1,G=0,H=E.length;G<H;)C=C>>>8^t[(C^E.charCodeAt(G++))&255];return~C}function A(E,z){for(var C=z^-1,G=E.length-15,H=0;H<G;)C=v[E[H++]^C&255]^w[E[H++]^C>>8&255]^g[E[H++]^C>>16&255]^m[E[H++]^C>>>24]^p[E[H++]]^x[E[H++]]^h[E[H++]]^d[E[H++]]^u[E[H++]]^l[E[H++]]^f[E[H++]]^c[E[H++]]^o[E[H++]]^s[E[H++]]^i[E[H++]]^t[E[H++]];for(G+=15;H<G;)C=C>>>8^t[(C^E[H++])&255];return~C}function F(E,z){for(var C=z^-1,G=0,H=E.length,b=0,X=0;G<H;)b=E.charCodeAt(G++),b<128?C=C>>>8^t[(C^b)&255]:b<2048?(C=C>>>8^t[(C^(192|b>>6&31))&255],C=C>>>8^t[(C^(128|b&63))&255]):b>=55296&&b<57344?(b=(b&1023)+64,X=E.charCodeAt(G++)&1023,C=C>>>8^t[(C^(240|b>>8&7))&255],C=C>>>8^t[(C^(128|b>>2&63))&255],C=C>>>8^t[(C^(128|X>>6&15|(b&3)<<4))&255],C=C>>>8^t[(C^(128|X&63))&255]):(C=C>>>8^t[(C^(224|b>>12&15))&255],C=C>>>8^t[(C^(128|b>>6&63))&255],C=C>>>8^t[(C^(128|b&63))&255]);return~C}return e.table=t,e.bstr=k,e.buf=A,e.str=F,e}(),Le=function(){var r={};r.version="1.2.1";function t(S,M){for(var I=S.split("/"),D=M.split("/"),L=0,U=0,te=Math.min(I.length,D.length);L<te;++L){if(U=I[L].length-D[L].length)return U;if(I[L]!=D[L])return I[L]<D[L]?-1:1}return I.length-D.length}function n(S){if(S.charAt(S.length-1)=="/")return S.slice(0,-1).indexOf("/")===-1?S:n(S.slice(0,-1));var M=S.lastIndexOf("/");return M===-1?S:S.slice(0,M+1)}function a(S){if(S.charAt(S.length-1)=="/")return a(S.slice(0,-1));var M=S.lastIndexOf("/");return M===-1?S:S.slice(M+1)}function i(S,M){typeof M=="string"&&(M=new Date(M));var I=M.getHours();I=I<<6|M.getMinutes(),I=I<<5|M.getSeconds()>>>1,S.write_shift(2,I);var D=M.getFullYear()-1980;D=D<<4|M.getMonth()+1,D=D<<5|M.getDate(),S.write_shift(2,D)}function s(S){var M=S.read_shift(2)&65535,I=S.read_shift(2)&65535,D=new Date,L=I&31;I>>>=5;var U=I&15;I>>>=4,D.setMilliseconds(0),D.setFullYear(I+1980),D.setMonth(U-1),D.setDate(L);var te=M&31;M>>>=5;var oe=M&63;return M>>>=6,D.setHours(M),D.setMinutes(oe),D.setSeconds(te<<1),D}function o(S){dt(S,0);for(var M={},I=0;S.l<=S.length-4;){var D=S.read_shift(2),L=S.read_shift(2),U=S.l+L,te={};switch(D){case 21589:I=S.read_shift(1),I&1&&(te.mtime=S.read_shift(4)),L>5&&(I&2&&(te.atime=S.read_shift(4)),I&4&&(te.ctime=S.read_shift(4))),te.mtime&&(te.mt=new Date(te.mtime*1e3));break}S.l=U,M[D]=te}return M}var c;function f(){return c||(c={})}function l(S,M){if(S[0]==80&&S[1]==75)return Za(S,M);if((S[0]|32)==109&&(S[1]|32)==105)return Ld(S,M);if(S.length<512)throw new Error("CFB file size "+S.length+" < 512");var I=3,D=512,L=0,U=0,te=0,oe=0,ee=0,re=[],ne=S.slice(0,512);dt(ne,0);var ge=u(ne);switch(I=ge[0],I){case 3:D=512;break;case 4:D=4096;break;case 0:if(ge[1]==0)return Za(S,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}D!==512&&(ne=S.slice(0,D),dt(ne,28));var we=S.slice(0,D);d(ne,I);var ke=ne.read_shift(4,"i");if(I===3&&ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ke);ne.l+=4,te=ne.read_shift(4,"i"),ne.l+=4,ne.chk("00100000","Mini Stream Cutoff Size: "),oe=ne.read_shift(4,"i"),L=ne.read_shift(4,"i"),ee=ne.read_shift(4,"i"),U=ne.read_shift(4,"i");for(var _e=-1,ye=0;ye<109&&(_e=ne.read_shift(4,"i"),!(_e<0));++ye)re[ye]=_e;var Ie=h(S,D);m(ee,U,Ie,D,re);var je=w(Ie,te,re,D);je[te].name="!Directory",L>0&&oe!==X&&(je[oe].name="!MiniFAT"),je[re[0]].name="!FAT",je.fat_addrs=re,je.ssz=D;var Ye={},gt=[],Yn=[],Kn=[];v(te,je,Ie,gt,L,Ye,Yn,oe),x(Yn,Kn,gt),gt.shift();var qn={FileIndex:Yn,FullPaths:Kn};return M&&M.raw&&(qn.raw={header:we,sectors:Ie}),qn}function u(S){if(S[S.l]==80&&S[S.l+1]==75)return[0,0];S.chk(_,"Header Signature: "),S.l+=16;var M=S.read_shift(2,"u");return[S.read_shift(2,"u"),M]}function d(S,M){var I=9;switch(S.l+=2,I=S.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}S.chk("0600","Mini Sector Shift: "),S.chk("000000000000","Reserved: ")}function h(S,M){for(var I=Math.ceil(S.length/M)-1,D=[],L=1;L<I;++L)D[L-1]=S.slice(L*M,(L+1)*M);return D[I-1]=S.slice(I*M),D}function x(S,M,I){for(var D=0,L=0,U=0,te=0,oe=0,ee=I.length,re=[],ne=[];D<ee;++D)re[D]=ne[D]=D,M[D]=I[D];for(;oe<ne.length;++oe)D=ne[oe],L=S[D].L,U=S[D].R,te=S[D].C,re[D]===D&&(L!==-1&&re[L]!==L&&(re[D]=re[L]),U!==-1&&re[U]!==U&&(re[D]=re[U])),te!==-1&&(re[te]=D),L!==-1&&D!=re[D]&&(re[L]=re[D],ne.lastIndexOf(L)<oe&&ne.push(L)),U!==-1&&D!=re[D]&&(re[U]=re[D],ne.lastIndexOf(U)<oe&&ne.push(U));for(D=1;D<ee;++D)re[D]===D&&(U!==-1&&re[U]!==U?re[D]=re[U]:L!==-1&&re[L]!==L&&(re[D]=re[L]));for(D=1;D<ee;++D)if(S[D].type!==0){if(oe=D,oe!=re[oe])do oe=re[oe],M[D]=M[oe]+"/"+M[D];while(oe!==0&&re[oe]!==-1&&oe!=re[oe]);re[D]=-1}for(M[0]+="/",D=1;D<ee;++D)S[D].type!==2&&(M[D]+="/")}function p(S,M,I){for(var D=S.start,L=S.size,U=[],te=D;I&&L>0&&te>=0;)U.push(M.slice(te*b,te*b+b)),L-=b,te=qr(I,te*4);return U.length===0?at(0):Lr(U).slice(0,S.size)}function m(S,M,I,D,L){var U=X;if(S===X){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(S!==-1){var te=I[S],oe=(D>>>2)-1;if(!te)return;for(var ee=0;ee<oe&&(U=qr(te,ee*4))!==X;++ee)L.push(U);m(qr(te,D-4),M-1,I,D,L)}}function g(S,M,I,D,L){var U=[],te=[];L||(L=[]);var oe=D-1,ee=0,re=0;for(ee=M;ee>=0;){L[ee]=!0,U[U.length]=ee,te.push(S[ee]);var ne=I[Math.floor(ee*4/D)];if(re=ee*4&oe,D<4+re)throw new Error("FAT boundary crossed: "+ee+" 4 "+D);if(!S[ne])break;ee=qr(S[ne],re)}return{nodes:U,data:j0([te])}}function w(S,M,I,D){var L=S.length,U=[],te=[],oe=[],ee=[],re=D-1,ne=0,ge=0,we=0,ke=0;for(ne=0;ne<L;++ne)if(oe=[],we=ne+M,we>=L&&(we-=L),!te[we]){ee=[];var _e=[];for(ge=we;ge>=0;){_e[ge]=!0,te[ge]=!0,oe[oe.length]=ge,ee.push(S[ge]);var ye=I[Math.floor(ge*4/D)];if(ke=ge*4&re,D<4+ke)throw new Error("FAT boundary crossed: "+ge+" 4 "+D);if(!S[ye]||(ge=qr(S[ye],ke),_e[ge]))break}U[we]={nodes:oe,data:j0([ee])}}return U}function v(S,M,I,D,L,U,te,oe){for(var ee=0,re=D.length?2:0,ne=M[S].data,ge=0,we=0,ke;ge<ne.length;ge+=128){var _e=ne.slice(ge,ge+128);dt(_e,64),we=_e.read_shift(2),ke=fc(_e,0,we-re),D.push(ke);var ye={name:ke,type:_e.read_shift(1),color:_e.read_shift(1),L:_e.read_shift(4,"i"),R:_e.read_shift(4,"i"),C:_e.read_shift(4,"i"),clsid:_e.read_shift(16),state:_e.read_shift(4,"i"),start:0,size:0},Ie=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);Ie!==0&&(ye.ct=k(_e,_e.l-8));var je=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);je!==0&&(ye.mt=k(_e,_e.l-8)),ye.start=_e.read_shift(4,"i"),ye.size=_e.read_shift(4,"i"),ye.size<0&&ye.start<0&&(ye.size=ye.type=0,ye.start=X,ye.name=""),ye.type===5?(ee=ye.start,L>0&&ee!==X&&(M[ee].name="!StreamData")):ye.size>=4096?(ye.storage="fat",M[ye.start]===void 0&&(M[ye.start]=g(I,ye.start,M.fat_addrs,M.ssz)),M[ye.start].name=ye.name,ye.content=M[ye.start].data.slice(0,ye.size)):(ye.storage="minifat",ye.size<0?ye.size=0:ee!==X&&ye.start!==X&&M[ee]&&(ye.content=p(ye,M[ee].data,(M[oe]||{}).data))),ye.content&&dt(ye.content,0),U[ke]=ye,te.push(ye)}}function k(S,M){return new Date((Ut(S,M+4)/1e7*Math.pow(2,32)+Ut(S,M)/1e7-11644473600)*1e3)}function A(S,M){return f(),l(c.readFileSync(S),M)}function F(S,M){var I=M&&M.type;switch(I||Ne&&Buffer.isBuffer(S)&&(I="buffer"),I||"base64"){case"file":return A(S,M);case"base64":return l(nr(Ht(S)),M);case"binary":return l(nr(S),M)}return l(S,M)}function E(S,M){var I=M||{},D=I.root||"Root Entry";if(S.FullPaths||(S.FullPaths=[]),S.FileIndex||(S.FileIndex=[]),S.FullPaths.length!==S.FileIndex.length)throw new Error("inconsistent CFB structure");S.FullPaths.length===0&&(S.FullPaths[0]=D+"/",S.FileIndex[0]={name:D,type:5}),I.CLSID&&(S.FileIndex[0].clsid=I.CLSID),z(S)}function z(S){var M="Sh33tJ5";if(!Le.find(S,"/"+M)){var I=at(4);I[0]=55,I[1]=I[3]=50,I[2]=54,S.FileIndex.push({name:M,type:2,content:I,size:4,L:69,R:69,C:69}),S.FullPaths.push(S.FullPaths[0]+M),C(S)}}function C(S,M){E(S);for(var I=!1,D=!1,L=S.FullPaths.length-1;L>=0;--L){var U=S.FileIndex[L];switch(U.type){case 0:D?I=!0:(S.FileIndex.pop(),S.FullPaths.pop());break;case 1:case 2:case 5:D=!0,isNaN(U.R*U.L*U.C)&&(I=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!M)){var te=new Date(1987,1,19),oe=0,ee=Object.create?Object.create(null):{},re=[];for(L=0;L<S.FullPaths.length;++L)ee[S.FullPaths[L]]=!0,S.FileIndex[L].type!==0&&re.push([S.FullPaths[L],S.FileIndex[L]]);for(L=0;L<re.length;++L){var ne=n(re[L][0]);D=ee[ne],D||(re.push([ne,{name:a(ne).replace("/",""),type:1,clsid:q,ct:te,mt:te,content:null}]),ee[ne]=!0)}for(re.sort(function(ke,_e){return t(ke[0],_e[0])}),S.FullPaths=[],S.FileIndex=[],L=0;L<re.length;++L)S.FullPaths[L]=re[L][0],S.FileIndex[L]=re[L][1];for(L=0;L<re.length;++L){var ge=S.FileIndex[L],we=S.FullPaths[L];if(ge.name=a(we).replace("/",""),ge.L=ge.R=ge.C=-(ge.color=1),ge.size=ge.content?ge.content.length:0,ge.start=0,ge.clsid=ge.clsid||q,L===0)ge.C=re.length>1?1:-1,ge.size=0,ge.type=5;else if(we.slice(-1)=="/"){for(oe=L+1;oe<re.length&&n(S.FullPaths[oe])!=we;++oe);for(ge.C=oe>=re.length?-1:oe,oe=L+1;oe<re.length&&n(S.FullPaths[oe])!=n(we);++oe);ge.R=oe>=re.length?-1:oe,ge.type=1}else n(S.FullPaths[L+1]||"")==n(we)&&(ge.R=L+1),ge.type=2}}}function G(S,M){var I=M||{};if(I.fileType=="mad")return Bd(S,I);switch(C(S),I.fileType){case"zip":return Gr(S,I)}var D=function(ke){for(var _e=0,ye=0,Ie=0;Ie<ke.FileIndex.length;++Ie){var je=ke.FileIndex[Ie];if(je.content){var Ye=je.content.length;Ye>0&&(Ye<4096?_e+=Ye+63>>6:ye+=Ye+511>>9)}}for(var gt=ke.FullPaths.length+3>>2,Yn=_e+7>>3,Kn=_e+127>>7,qn=Yn+ye+gt+Kn,Xr=qn+127>>7,bs=Xr<=109?0:Math.ceil((Xr-109)/127);qn+Xr+bs+127>>7>Xr;)bs=++Xr<=109?0:Math.ceil((Xr-109)/127);var kr=[1,bs,Xr,Kn,gt,ye,_e,0];return ke.FileIndex[0].size=_e<<6,kr[7]=(ke.FileIndex[0].start=kr[0]+kr[1]+kr[2]+kr[3]+kr[4]+kr[5])+(kr[6]+7>>3),kr}(S),L=at(D[7]<<9),U=0,te=0;{for(U=0;U<8;++U)L.write_shift(1,W[U]);for(U=0;U<8;++U)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),U=0;U<3;++U)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,D[2]),L.write_shift(4,D[0]+D[1]+D[2]+D[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,D[3]?D[0]+D[1]+D[2]-1:X),L.write_shift(4,D[3]),L.write_shift(-4,D[1]?D[0]-1:X),L.write_shift(4,D[1]),U=0;U<109;++U)L.write_shift(-4,U<D[2]?D[1]+U:-1)}if(D[1])for(te=0;te<D[1];++te){for(;U<236+te*127;++U)L.write_shift(-4,U<D[2]?D[1]+U:-1);L.write_shift(-4,te===D[1]-1?X:te+1)}var oe=function(ke){for(te+=ke;U<te-1;++U)L.write_shift(-4,U+1);ke&&(++U,L.write_shift(-4,X))};for(te=U=0,te+=D[1];U<te;++U)L.write_shift(-4,j.DIFSECT);for(te+=D[2];U<te;++U)L.write_shift(-4,j.FATSECT);oe(D[3]),oe(D[4]);for(var ee=0,re=0,ne=S.FileIndex[0];ee<S.FileIndex.length;++ee)ne=S.FileIndex[ee],ne.content&&(re=ne.content.length,!(re<4096)&&(ne.start=te,oe(re+511>>9)));for(oe(D[6]+7>>3);L.l&511;)L.write_shift(-4,j.ENDOFCHAIN);for(te=U=0,ee=0;ee<S.FileIndex.length;++ee)ne=S.FileIndex[ee],ne.content&&(re=ne.content.length,!(!re||re>=4096)&&(ne.start=te,oe(re+63>>6)));for(;L.l&511;)L.write_shift(-4,j.ENDOFCHAIN);for(U=0;U<D[4]<<2;++U){var ge=S.FullPaths[U];if(!ge||ge.length===0){for(ee=0;ee<17;++ee)L.write_shift(4,0);for(ee=0;ee<3;++ee)L.write_shift(4,-1);for(ee=0;ee<12;++ee)L.write_shift(4,0);continue}ne=S.FileIndex[U],U===0&&(ne.start=ne.size?ne.start-1:X);var we=U===0&&I.root||ne.name;if(re=2*(we.length+1),L.write_shift(64,we,"utf16le"),L.write_shift(2,re),L.write_shift(1,ne.type),L.write_shift(1,ne.color),L.write_shift(-4,ne.L),L.write_shift(-4,ne.R),L.write_shift(-4,ne.C),ne.clsid)L.write_shift(16,ne.clsid,"hex");else for(ee=0;ee<4;++ee)L.write_shift(4,0);L.write_shift(4,ne.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,ne.start),L.write_shift(4,ne.size),L.write_shift(4,0)}for(U=1;U<S.FileIndex.length;++U)if(ne=S.FileIndex[U],ne.size>=4096)if(L.l=ne.start+1<<9,Ne&&Buffer.isBuffer(ne.content))ne.content.copy(L,L.l,0,ne.size),L.l+=ne.size+511&-512;else{for(ee=0;ee<ne.size;++ee)L.write_shift(1,ne.content[ee]);for(;ee&511;++ee)L.write_shift(1,0)}for(U=1;U<S.FileIndex.length;++U)if(ne=S.FileIndex[U],ne.size>0&&ne.size<4096)if(Ne&&Buffer.isBuffer(ne.content))ne.content.copy(L,L.l,0,ne.size),L.l+=ne.size+63&-64;else{for(ee=0;ee<ne.size;++ee)L.write_shift(1,ne.content[ee]);for(;ee&63;++ee)L.write_shift(1,0)}if(Ne)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function H(S,M){var I=S.FullPaths.map(function(ee){return ee.toUpperCase()}),D=I.map(function(ee){var re=ee.split("/");return re[re.length-(ee.slice(-1)=="/"?2:1)]}),L=!1;M.charCodeAt(0)===47?(L=!0,M=I[0].slice(0,-1)+M):L=M.indexOf("/")!==-1;var U=M.toUpperCase(),te=L===!0?I.indexOf(U):D.indexOf(U);if(te!==-1)return S.FileIndex[te];var oe=!U.match(ra);for(U=U.replace(Rt,""),oe&&(U=U.replace(ra,"!")),te=0;te<I.length;++te)if((oe?I[te].replace(ra,"!"):I[te]).replace(Rt,"")==U||(oe?D[te].replace(ra,"!"):D[te]).replace(Rt,"")==U)return S.FileIndex[te];return null}var b=64,X=-2,_="d0cf11e0a1b11ae1",W=[208,207,17,224,161,177,26,225],q="00000000000000000000000000000000",j={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:X,FREESECT:-1,HEADER_SIGNATURE:_,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ue(S,M,I){f();var D=G(S,I);c.writeFileSync(M,D)}function P(S){for(var M=new Array(S.length),I=0;I<S.length;++I)M[I]=String.fromCharCode(S[I]);return M.join("")}function se(S,M){var I=G(S,M);switch(M&&M.type||"buffer"){case"file":return f(),c.writeFileSync(M.filename,I),I;case"binary":return typeof I=="string"?I:P(I);case"base64":return F0(typeof I=="string"?I:P(I));case"buffer":if(Ne)return Buffer.isBuffer(I)?I:ln(I);case"array":return typeof I=="string"?nr(I):I}return I}var Y;function T(S){try{var M=S.InflateRaw,I=new M;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)Y=S;else throw new Error("zlib does not expose bytesRead")}catch(D){console.error("cannot use native zlib: "+(D.message||D))}}function K(S,M){if(!Y)return Ka(S,M);var I=Y.InflateRaw,D=new I,L=D._processChunk(S.slice(S.l),D._finishFlushFlag);return S.l+=D.bytesRead,L}function B(S){return Y?Y.deflateRawSync(S):Fe(S)}var N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(S){var M=(S<<1|S<<11)&139536|(S<<5|S<<15)&558144;return(M>>16|M>>8|M)&255}for(var fe=typeof Uint8Array<"u",he=fe?new Uint8Array(256):[],be=0;be<256;++be)he[be]=le(be);function V(S,M){var I=he[S&255];return M<=8?I>>>8-M:(I=I<<8|he[S>>8&255],M<=16?I>>>16-M:(I=I<<8|he[S>>16&255],I>>>24-M))}function Ue(S,M){var I=M&7,D=M>>>3;return(S[D]|(I<=6?0:S[D+1]<<8))>>>I&3}function y(S,M){var I=M&7,D=M>>>3;return(S[D]|(I<=5?0:S[D+1]<<8))>>>I&7}function ae(S,M){var I=M&7,D=M>>>3;return(S[D]|(I<=4?0:S[D+1]<<8))>>>I&15}function J(S,M){var I=M&7,D=M>>>3;return(S[D]|(I<=3?0:S[D+1]<<8))>>>I&31}function R(S,M){var I=M&7,D=M>>>3;return(S[D]|(I<=1?0:S[D+1]<<8))>>>I&127}function O(S,M,I){var D=M&7,L=M>>>3,U=(1<<I)-1,te=S[L]>>>D;return I<8-D||(te|=S[L+1]<<8-D,I<16-D)||(te|=S[L+2]<<16-D,I<24-D)||(te|=S[L+3]<<24-D),te&U}function Z(S,M,I){var D=M&7,L=M>>>3;return D<=5?S[L]|=(I&7)<<D:(S[L]|=I<<D&255,S[L+1]=(I&7)>>8-D),M+3}function ce(S,M,I){var D=M&7,L=M>>>3;return I=(I&1)<<D,S[L]|=I,M+1}function de(S,M,I){var D=M&7,L=M>>>3;return I<<=D,S[L]|=I&255,I>>>=8,S[L+1]=I,M+8}function Q(S,M,I){var D=M&7,L=M>>>3;return I<<=D,S[L]|=I&255,I>>>=8,S[L+1]=I&255,S[L+2]=I>>>8,M+16}function xe(S,M){var I=S.length,D=2*I>M?2*I:M+5,L=0;if(I>=M)return S;if(Ne){var U=R0(D);if(S.copy)S.copy(U);else for(;L<S.length;++L)U[L]=S[L];return U}else if(fe){var te=new Uint8Array(D);if(te.set)te.set(S);else for(;L<I;++L)te[L]=S[L];return te}return S.length=D,S}function ve(S){for(var M=new Array(S),I=0;I<S;++I)M[I]=0;return M}function me(S,M,I){var D=1,L=0,U=0,te=0,oe=0,ee=S.length,re=fe?new Uint16Array(32):ve(32);for(U=0;U<32;++U)re[U]=0;for(U=ee;U<I;++U)S[U]=0;ee=S.length;var ne=fe?new Uint16Array(ee):ve(ee);for(U=0;U<ee;++U)re[L=S[U]]++,D<L&&(D=L),ne[U]=0;for(re[0]=0,U=1;U<=D;++U)re[U+16]=oe=oe+re[U-1]<<1;for(U=0;U<ee;++U)oe=S[U],oe!=0&&(ne[U]=re[oe+16]++);var ge=0;for(U=0;U<ee;++U)if(ge=S[U],ge!=0)for(oe=V(ne[U],D)>>D-ge,te=(1<<D+4-ge)-1;te>=0;--te)M[oe|te<<ge]=ge&15|U<<4;return D}var Ee=fe?new Uint16Array(512):ve(512),$e=fe?new Uint16Array(32):ve(32);if(!fe){for(var Ae=0;Ae<512;++Ae)Ee[Ae]=0;for(Ae=0;Ae<32;++Ae)$e[Ae]=0}(function(){for(var S=[],M=0;M<32;M++)S.push(5);me(S,$e,32);var I=[];for(M=0;M<=143;M++)I.push(8);for(;M<=255;M++)I.push(9);for(;M<=279;M++)I.push(7);for(;M<=287;M++)I.push(8);me(I,Ee,288)})();var Xe=function(){for(var M=fe?new Uint8Array(32768):[],I=0,D=0;I<pe.length-1;++I)for(;D<pe[I+1];++D)M[D]=I;for(;D<32768;++D)M[D]=29;var L=fe?new Uint8Array(259):[];for(I=0,D=0;I<ie.length-1;++I)for(;D<ie[I+1];++D)L[D]=I;function U(oe,ee){for(var re=0;re<oe.length;){var ne=Math.min(65535,oe.length-re),ge=re+ne==oe.length;for(ee.write_shift(1,+ge),ee.write_shift(2,ne),ee.write_shift(2,~ne&65535);ne-- >0;)ee[ee.l++]=oe[re++]}return ee.l}function te(oe,ee){for(var re=0,ne=0,ge=fe?new Uint16Array(32768):[];ne<oe.length;){var we=Math.min(65535,oe.length-ne);if(we<10){for(re=Z(ee,re,+(ne+we==oe.length)),re&7&&(re+=8-(re&7)),ee.l=re/8|0,ee.write_shift(2,we),ee.write_shift(2,~we&65535);we-- >0;)ee[ee.l++]=oe[ne++];re=ee.l*8;continue}re=Z(ee,re,+(ne+we==oe.length)+2);for(var ke=0;we-- >0;){var _e=oe[ne];ke=(ke<<5^_e)&32767;var ye=-1,Ie=0;if((ye=ge[ke])&&(ye|=ne&-32768,ye>ne&&(ye-=32768),ye<ne))for(;oe[ye+Ie]==oe[ne+Ie]&&Ie<250;)++Ie;if(Ie>2){_e=L[Ie],_e<=22?re=de(ee,re,he[_e+1]>>1)-1:(de(ee,re,3),re+=5,de(ee,re,he[_e-23]>>5),re+=3);var je=_e<8?0:_e-4>>2;je>0&&(Q(ee,re,Ie-ie[_e]),re+=je),_e=M[ne-ye],re=de(ee,re,he[_e]>>3),re-=3;var Ye=_e<4?0:_e-2>>1;Ye>0&&(Q(ee,re,ne-ye-pe[_e]),re+=Ye);for(var gt=0;gt<Ie;++gt)ge[ke]=ne&32767,ke=(ke<<5^oe[ne])&32767,++ne;we-=Ie-1}else _e<=143?_e=_e+48:re=ce(ee,re,1),re=de(ee,re,he[_e]),ge[ke]=ne&32767,++ne}re=de(ee,re,0)-1}return ee.l=(re+7)/8|0,ee.l}return function(ee,re){return ee.length<8?U(ee,re):te(ee,re)}}();function Fe(S){var M=at(50+Math.floor(S.length*1.1)),I=Xe(S,M);return M.slice(0,I)}var He=fe?new Uint16Array(32768):ve(32768),ot=fe?new Uint16Array(32768):ve(32768),De=fe?new Uint16Array(128):ve(128),Wt=1,mn=1;function Zt(S,M){var I=J(S,M)+257;M+=5;var D=J(S,M)+1;M+=5;var L=ae(S,M)+4;M+=4;for(var U=0,te=fe?new Uint8Array(19):ve(19),oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,re=fe?new Uint8Array(8):ve(8),ne=fe?new Uint8Array(8):ve(8),ge=te.length,we=0;we<L;++we)te[N[we]]=U=y(S,M),ee<U&&(ee=U),re[U]++,M+=3;var ke=0;for(re[0]=0,we=1;we<=ee;++we)ne[we]=ke=ke+re[we-1]<<1;for(we=0;we<ge;++we)(ke=te[we])!=0&&(oe[we]=ne[ke]++);var _e=0;for(we=0;we<ge;++we)if(_e=te[we],_e!=0){ke=he[oe[we]]>>8-_e;for(var ye=(1<<7-_e)-1;ye>=0;--ye)De[ke|ye<<_e]=_e&7|we<<3}var Ie=[];for(ee=1;Ie.length<I+D;)switch(ke=De[R(S,M)],M+=ke&7,ke>>>=3){case 16:for(U=3+Ue(S,M),M+=2,ke=Ie[Ie.length-1];U-- >0;)Ie.push(ke);break;case 17:for(U=3+y(S,M),M+=3;U-- >0;)Ie.push(0);break;case 18:for(U=11+R(S,M),M+=7;U-- >0;)Ie.push(0);break;default:Ie.push(ke),ee<ke&&(ee=ke);break}var je=Ie.slice(0,I),Ye=Ie.slice(I);for(we=I;we<286;++we)je[we]=0;for(we=D;we<30;++we)Ye[we]=0;return Wt=me(je,He,286),mn=me(Ye,ot,30),M}function Ya(S,M){if(S[0]==3&&!(S[1]&3))return[$r(M),2];for(var I=0,D=0,L=R0(M||1<<18),U=0,te=L.length>>>0,oe=0,ee=0;(D&1)==0;){if(D=y(S,I),I+=3,D>>>1)D>>1==1?(oe=9,ee=5):(I=Zt(S,I),oe=Wt,ee=mn);else{I&7&&(I+=8-(I&7));var re=S[I>>>3]|S[(I>>>3)+1]<<8;if(I+=32,re>0)for(!M&&te<U+re&&(L=xe(L,U+re),te=L.length);re-- >0;)L[U++]=S[I>>>3],I+=8;continue}for(;;){!M&&te<U+32767&&(L=xe(L,U+32767),te=L.length);var ne=O(S,I,oe),ge=D>>>1==1?Ee[ne]:He[ne];if(I+=ge&15,ge>>>=4,(ge>>>8&255)===0)L[U++]=ge;else{if(ge==256)break;ge-=257;var we=ge<8?0:ge-4>>2;we>5&&(we=0);var ke=U+ie[ge];we>0&&(ke+=O(S,I,we),I+=we),ne=O(S,I,ee),ge=D>>>1==1?$e[ne]:ot[ne],I+=ge&15,ge>>>=4;var _e=ge<4?0:ge-2>>1,ye=pe[ge];for(_e>0&&(ye+=O(S,I,_e),I+=_e),!M&&te<ke&&(L=xe(L,ke+100),te=L.length);U<ke;)L[U]=L[U-ye],++U}}}return M?[L,I+7>>>3]:[L.slice(0,U),I+7>>>3]}function Ka(S,M){var I=S.slice(S.l||0),D=Ya(I,M);return S.l+=D[1],D[0]}function qa(S,M){if(S)typeof console<"u"&&console.error(M);else throw new Error(M)}function Za(S,M){var I=S;dt(I,0);var D=[],L=[],U={FileIndex:D,FullPaths:L};E(U,{root:M.root});for(var te=I.length-4;(I[te]!=80||I[te+1]!=75||I[te+2]!=5||I[te+3]!=6)&&te>=0;)--te;I.l=te+4,I.l+=4;var oe=I.read_shift(2);I.l+=6;var ee=I.read_shift(4);for(I.l=ee,te=0;te<oe;++te){I.l+=20;var re=I.read_shift(4),ne=I.read_shift(4),ge=I.read_shift(2),we=I.read_shift(2),ke=I.read_shift(2);I.l+=8;var _e=I.read_shift(4),ye=o(I.slice(I.l+ge,I.l+ge+we));I.l+=ge+we+ke;var Ie=I.l;I.l=_e+4,Ja(I,re,ne,U,ye),I.l=Ie}return U}function Ja(S,M,I,D,L){S.l+=2;var U=S.read_shift(2),te=S.read_shift(2),oe=s(S);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var ee=S.read_shift(4),re=S.read_shift(4),ne=S.read_shift(4),ge=S.read_shift(2),we=S.read_shift(2),ke="",_e=0;_e<ge;++_e)ke+=String.fromCharCode(S[S.l++]);if(we){var ye=o(S.slice(S.l,S.l+we));(ye[21589]||{}).mt&&(oe=ye[21589].mt),((L||{})[21589]||{}).mt&&(oe=L[21589].mt)}S.l+=we;var Ie=S.slice(S.l,S.l+re);switch(te){case 8:Ie=K(S,ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+te)}var je=!1;U&8&&(ee=S.read_shift(4),ee==134695760&&(ee=S.read_shift(4),je=!0),re=S.read_shift(4),ne=S.read_shift(4)),re!=M&&qa(je,"Bad compressed size: "+M+" != "+re),ne!=I&&qa(je,"Bad uncompressed size: "+I+" != "+ne),Ts(D,ke,Ie,{unsafe:!0,mt:oe})}function Gr(S,M){var I=M||{},D=[],L=[],U=at(1),te=I.compression?8:0,oe=0,ee=0,re=0,ne=0,ge=0,we=S.FullPaths[0],ke=we,_e=S.FileIndex[0],ye=[],Ie=0;for(ee=1;ee<S.FullPaths.length;++ee)if(ke=S.FullPaths[ee].slice(we.length),_e=S.FileIndex[ee],!(!_e.size||!_e.content||ke=="Sh33tJ5")){var je=ne,Ye=at(ke.length);for(re=0;re<ke.length;++re)Ye.write_shift(1,ke.charCodeAt(re)&127);Ye=Ye.slice(0,Ye.l),ye[ge]=w_.buf(_e.content,0);var gt=_e.content;te==8&&(gt=B(gt)),U=at(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,oe),U.write_shift(2,te),_e.mt?i(U,_e.mt):U.write_shift(4,0),U.write_shift(-4,ye[ge]),U.write_shift(4,gt.length),U.write_shift(4,_e.content.length),U.write_shift(2,Ye.length),U.write_shift(2,0),ne+=U.length,D.push(U),ne+=Ye.length,D.push(Ye),ne+=gt.length,D.push(gt),U=at(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,oe),U.write_shift(2,te),U.write_shift(4,0),U.write_shift(-4,ye[ge]),U.write_shift(4,gt.length),U.write_shift(4,_e.content.length),U.write_shift(2,Ye.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,je),Ie+=U.l,L.push(U),Ie+=Ye.length,L.push(Ye),++ge}return U=at(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,ge),U.write_shift(2,ge),U.write_shift(4,Ie),U.write_shift(4,ne),U.write_shift(2,0),Lr([Lr(D),Lr(L),U])}var yr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Od(S,M){if(S.ctype)return S.ctype;var I=S.name||"",D=I.match(/\.([^\.]+)$/);return D&&yr[D[1]]||M&&(D=(I=M).match(/[\.\\]([^\.\\])+$/),D&&yr[D[1]])?yr[D[1]]:"application/octet-stream"}function Dd(S){for(var M=F0(S),I=[],D=0;D<M.length;D+=76)I.push(M.slice(D,D+76));return I.join(`\r
`)+`\r
`}function Pd(S){var M=S.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var ne=re.charCodeAt(0).toString(16).toUpperCase();return"="+(ne.length==1?"0"+ne:ne)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],D=M.split(`\r
`),L=0;L<D.length;++L){var U=D[L];if(U.length==0){I.push("");continue}for(var te=0;te<U.length;){var oe=76,ee=U.slice(te,te+oe);ee.charAt(oe-1)=="="?oe--:ee.charAt(oe-2)=="="?oe-=2:ee.charAt(oe-3)=="="&&(oe-=3),ee=U.slice(te,te+oe),te+=oe,te<U.length&&(ee+="="),I.push(ee)}}return I.join(`\r
`)}function Nd(S){for(var M=[],I=0;I<S.length;++I){for(var D=S[I];I<=S.length&&D.charAt(D.length-1)=="=";)D=D.slice(0,D.length-1)+S[++I];M.push(D)}for(var L=0;L<M.length;++L)M[L]=M[L].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return nr(M.join(`\r
`))}function Md(S,M,I){for(var D="",L="",U="",te,oe=0;oe<10;++oe){var ee=M[oe];if(!ee||ee.match(/^\s*$/))break;var re=ee.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":D=re[2].trim();break;case"content-type":U=re[2].trim();break;case"content-transfer-encoding":L=re[2].trim();break}}switch(++oe,L.toLowerCase()){case"base64":te=nr(Ht(M.slice(oe).join("")));break;case"quoted-printable":te=Nd(M.slice(oe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var ne=Ts(S,D.slice(I.length),te,{unsafe:!0});U&&(ne.ctype=U)}function Ld(S,M){if(P(S.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=M&&M.root||"",D=(Ne&&Buffer.isBuffer(S)?S.toString("binary"):P(S)).split(`\r
`),L=0,U="";for(L=0;L<D.length;++L)if(U=D[L],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),I||(I=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),U.slice(0,I.length)!=I););var te=(D[1]||"").match(/boundary="(.*?)"/);if(!te)throw new Error("MAD cannot find boundary");var oe="--"+(te[1]||""),ee=[],re=[],ne={FileIndex:ee,FullPaths:re};E(ne);var ge,we=0;for(L=0;L<D.length;++L){var ke=D[L];ke!==oe&&ke!==oe+"--"||(we++&&Md(ne,D.slice(ge,L),I),ge=L)}return ne}function Bd(S,M){var I=M||{},D=I.boundary||"SheetJS";D="------="+D;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+D.slice(2)+'"',"","",""],U=S.FullPaths[0],te=U,oe=S.FileIndex[0],ee=1;ee<S.FullPaths.length;++ee)if(te=S.FullPaths[ee].slice(U.length),oe=S.FileIndex[ee],!(!oe.size||!oe.content||te=="Sh33tJ5")){te=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var re=oe.content,ne=Ne&&Buffer.isBuffer(re)?re.toString("binary"):P(re),ge=0,we=Math.min(1024,ne.length),ke=0,_e=0;_e<=we;++_e)(ke=ne.charCodeAt(_e))>=32&&ke<128&&++ge;var ye=ge>=we*4/5;L.push(D),L.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+te),L.push("Content-Transfer-Encoding: "+(ye?"quoted-printable":"base64")),L.push("Content-Type: "+Od(oe,te)),L.push(""),L.push(ye?Pd(ne):Dd(ne))}return L.push(D+`--\r
`),L.join(`\r
`)}function Ud(S){var M={};return E(M,S),M}function Ts(S,M,I,D){var L=D&&D.unsafe;L||E(S);var U=!L&&Le.find(S,M);if(!U){var te=S.FullPaths[0];M.slice(0,te.length)==te?te=M:(te.slice(-1)!="/"&&(te+="/"),te=(te+M).replace("//","/")),U={name:a(M),type:2},S.FileIndex.push(U),S.FullPaths.push(te),L||Le.utils.cfb_gc(S)}return U.content=I,U.size=I?I.length:0,D&&(D.CLSID&&(U.clsid=D.CLSID),D.mt&&(U.mt=D.mt),D.ct&&(U.ct=D.ct)),U}function zd(S,M){E(S);var I=Le.find(S,M);if(I){for(var D=0;D<S.FileIndex.length;++D)if(S.FileIndex[D]==I)return S.FileIndex.splice(D,1),S.FullPaths.splice(D,1),!0}return!1}function $d(S,M,I){E(S);var D=Le.find(S,M);if(D){for(var L=0;L<S.FileIndex.length;++L)if(S.FileIndex[L]==D)return S.FileIndex[L].name=a(I),S.FullPaths[L]=I,!0}return!1}function Hd(S){C(S,!0)}return r.find=H,r.read=F,r.parse=l,r.write=se,r.writeFile=ue,r.utils={cfb_new:Ud,cfb_add:Ts,cfb_del:zd,cfb_mov:$d,cfb_gc:Hd,ReadShift:ua,CheckField:_u,prep_blob:dt,bconcat:Lr,use_zlib:T,_deflateRaw:Fe,_inflateRaw:Ka,consts:j},r}();function y_(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function gr(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function ic(e){for(var r=[],t=gr(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}var Ki=new Date(1899,11,30,0,0,0);function It(e,r){var t=e.getTime(),n=Ki.getTime()+(e.getTimezoneOffset()-Ki.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var Zl=new Date,k_=Ki.getTime()+(Zl.getTimezoneOffset()-Ki.getTimezoneOffset())*6e4,B0=Zl.getTimezoneOffset();function ls(e){var r=new Date;return r.setTime(e*24*60*60*1e3+k_),r.getTimezoneOffset()!==B0&&r.setTime(r.getTime()+(r.getTimezoneOffset()-B0)*6e4),r}function E_(e){var r=0,t=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(t=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(a[i],10)}return r}var U0=new Date("2017-02-19T19:06:09.000Z"),Jl=isNaN(U0.getFullYear())?new Date("2/19/17"):U0,T_=Jl.getFullYear()==2017;function lt(e,r){var t=new Date(e);if(T_)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Jl.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function cn(e,r){if(Ne&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return aa(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return aa(Bl(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return aa(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return aa(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return t[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function pt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=pt(e[t]));return r}function qe(e,r){for(var t="";t.length<r;)t+=e;return t}function or(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return t=-t,i}),!isNaN(r=Number(n)))?r/t:r}var b_=["january","february","march","april","may","june","july","august","september","october","november","december"];function Un(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),a=r.getMonth(),i=r.getDate();if(isNaN(i))return t;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&b_.indexOf(s)==-1)return t}else if(s.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||i>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var A_=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,a){if(e||typeof n=="string")return t.split(n);for(var i=t.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}}();function Ql(e){return e?e.content&&e.type?cn(e.content,!0):e.data?ta(e.data):e.asNodeBuffer&&Ne?ta(e.asNodeBuffer().toString("binary")):e.asBinary?ta(e.asBinary()):e._data&&e._data.getContent?ta(cn(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function eu(e){if(!e)return null;if(e.data)return S0(e.data);if(e.asNodeBuffer&&Ne)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?S0(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function S_(e){return e&&e.name.slice(-4)===".bin"?eu(e):Ql(e)}function Xt(e,r){for(var t=e.FullPaths||gr(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<t.length;++i){var s=t[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[t[i]]:e.FileIndex[i]}return null}function sc(e,r){var t=Xt(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function et(e,r,t){if(!t)return S_(sc(e,r));if(!r)return null;try{return et(e,r)}catch{return null}}function zt(e,r,t){if(!t)return Ql(sc(e,r));if(!r)return null;try{return zt(e,r)}catch{return null}}function C_(e,r,t){return eu(sc(e,r))}function z0(e){for(var r=e.FullPaths||gr(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function F_(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return Ne?n=ln(t):n=Yg(t),Le.utils.cfb_add(e,r,n)}Le.utils.cfb_add(e,r,t)}else e.file(r,t)}function tu(e,r){switch(r.type){case"base64":return Le.read(e,{type:"base64"});case"binary":return Le.read(e,{type:"binary"});case"buffer":case"array":return Le.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function na(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var ru=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,R_=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,$0=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,I_=/<[^>]*>/g,bt=ru.match($0)?$0:I_,O_=/<\w*:/,D_=/<(\/?)\w+:/;function Ce(e,r,t){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(r||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(R_),o=0,c="",f=0,l="",u="",d=1;if(s)for(f=0;f!=s.length;++f){for(u=s[f],i=0;i!=u.length&&u.charCodeAt(i)!==61;++i);for(l=u.slice(0,i).trim();u.charCodeAt(i+1)==32;)++i;for(d=(a=u.charCodeAt(i+1))==34||a==39?1:0,c=u.slice(i+1+d,u.length-d),o=0;o!=l.length&&l.charCodeAt(o)!==58;++o);if(o===l.length)l.indexOf("_")>0&&(l=l.slice(0,l.indexOf("_"))),n[l]=c,n[l.toLowerCase()]=c;else{var h=(o===5&&l.slice(0,5)==="xmlns"?"xmlns":"")+l.slice(o+1);if(n[h]&&l.slice(o-3,o)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function vr(e){return e.replace(D_,"<$1")}var nu={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},P_=ic(nu),ze=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,c){return nu[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(r,function(o,c){return String.fromCharCode(parseInt(c,16))});var s=a.indexOf("]]>");return t(a.slice(0,i))+a.slice(i+9,s)+t(a.slice(s+3))}}(),N_=/[&<>'"]/g,M_=/[\u0000-\u001f]/g;function oc(e){var r=e+"";return r.replace(N_,function(t){return P_[t]}).replace(/\n/g,"<br/>").replace(M_,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var H0=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function Ge(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ps(e){for(var r="",t=0,n=0,a=0,i=0,s=0,o=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(a=e.charCodeAt(t++),n>191&&n<224){s=(n&31)<<6,s|=a&63,r+=String.fromCharCode(s);continue}if(i=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(t++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function W0(e){var r=$r(2*e.length),t,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?t=o:o<224?(t=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(t=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,t=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,s=55296+(t>>>10&1023),t=56320+(t&1023)),s!==0&&(r[i++]=s&255,r[i++]=s>>>8,s=0),r[i++]=t%256,r[i++]=t>>>8;return r.slice(0,i).toString("ucs2")}function V0(e){return ln(e,"binary").toString("utf8")}var ii="foo bar bazâð£",Ve=Ne&&(V0(ii)==Ps(ii)&&V0||W0(ii)==Ps(ii)&&W0)||Ps,aa=Ne?function(e){return ln(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,a=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Aa=function(){var e={};return function(t,n){var a=t+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),au=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),L_=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),B_=/<\/?(?:vt:)?variant>/g,U_=/<(?:vt:)([^>]*)>([\s\S]*)</;function G0(e,r){var t=Ce(e),n=e.match(L_(t.baseType))||[],a=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return a}return n.forEach(function(i){var s=i.replace(B_,"").match(U_);s&&a.push({v:Ve(s[2]),t:s[1]})}),a}var z_=/(^\s|\s$|\n)/;function $_(e){return gr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function H_(e,r,t){return"<"+e+(t!=null?$_(t):"")+(r!=null?(r.match(z_)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function cc(e){if(Ne&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ve(un(rc(e)));throw new Error("Bad input format: expected Buffer or string")}var Sa=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,W_={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},V_=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function G_(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,i=5;i>=0;--i)a=a*256+e[r+i];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function X_(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,i=0,s=n?-r:r;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(r)?26985:0);for(var o=0;o<=5;++o,i/=256)e[t+o]=i&255;e[t+6]=(a&15)<<4|i&15,e[t+7]=a>>4|n}var X0=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=t)r.push.apply(r,e[0][n].slice(a,a+t));return r},j0=Ne?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:ln(r)})):X0(e)}:X0,Y0=function(e,r,t){for(var n=[],a=r;a<t;a+=2)n.push(String.fromCharCode(Sr(e,a)));return n.join("").replace(Rt,"")},fc=Ne?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Rt,""):Y0(e,r,t)}:Y0,K0=function(e,r,t){for(var n=[],a=r;a<r+t;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},iu=Ne?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):K0(e,r,t)}:K0,q0=function(e,r,t){for(var n=[],a=r;a<t;a++)n.push(String.fromCharCode(kn(e,a)));return n.join("")},La=Ne?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):q0(r,t,n)}:q0,su=function(e,r){var t=Ut(e,r);return t>0?La(e,r+4,r+4+t-1):""},ou=su,cu=function(e,r){var t=Ut(e,r);return t>0?La(e,r+4,r+4+t-1):""},fu=cu,lu=function(e,r){var t=2*Ut(e,r);return t>0?La(e,r+4,r+4+t-1):""},uu=lu,hu=function(r,t){var n=Ut(r,t);return n>0?fc(r,t+4,t+4+n):""},du=hu,pu=function(e,r){var t=Ut(e,r);return t>0?La(e,r+4,r+4+t):""},xu=pu,mu=function(e,r){return G_(e,r)},qi=mu,gu=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Ne&&(ou=function(r,t){if(!Buffer.isBuffer(r))return su(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},fu=function(r,t){if(!Buffer.isBuffer(r))return cu(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},uu=function(r,t){if(!Buffer.isBuffer(r))return lu(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},du=function(r,t){if(!Buffer.isBuffer(r))return hu(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},xu=function(r,t){if(!Buffer.isBuffer(r))return pu(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},qi=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):mu(r,t)},gu=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var kn=function(e,r){return e[r]},Sr=function(e,r){return e[r+1]*256+e[r]},j_=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Ut=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},qr=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},Y_=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function ua(e,r){var t="",n,a,i=[],s,o,c,f;switch(r){case"dbcs":if(f=this.l,Ne&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)t+=String.fromCharCode(Sr(this,f)),f+=2;e*=2;break;case"utf8":t=La(this,this.l,this.l+e);break;case"utf16le":e*=2,t=fc(this,this.l,this.l+e);break;case"wstr":return ua.call(this,e,"dbcs");case"lpstr-ansi":t=ou(this,this.l),e=4+Ut(this,this.l);break;case"lpstr-cp":t=fu(this,this.l),e=4+Ut(this,this.l);break;case"lpwstr":t=uu(this,this.l),e=4+2*Ut(this,this.l);break;case"lpp4":e=4+Ut(this,this.l),t=du(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ut(this,this.l),t=xu(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(s=kn(this,this.l+e++))!==0;)i.push(ai(s));t=i.join("");break;case"_wstr":for(e=0,t="";(s=Sr(this,this.l+e))!==0;)i.push(ai(s)),e+=2;e+=2,t=i.join("");break;case"dbcs-cont":for(t="",f=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return s=kn(this,f),this.l=f+1,o=ua.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ai(Sr(this,f))),f+=2}t=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",f=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return s=kn(this,f),this.l=f+1,o=ua.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ai(kn(this,f))),f+=1}t=i.join("");break;default:switch(e){case 1:return n=kn(this,this.l),this.l++,n;case 2:return n=(r==="i"?j_:Sr)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(e>0?qr:Y_)(this,this.l),this.l+=4,n):(a=Ut(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=qi(this,this.l):a=qi([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=iu(this,this.l,e);break}}return this.l+=e,t}var K_=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},q_=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},Z_=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function J_(e,r,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)Z_(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var s=r.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,K_(this,r,this.l);break;case 8:if(n=8,t==="f"){X_(this,r,this.l);break}case 16:break;case-4:n=4,q_(this,r,this.l);break}return this.l+=n,this}function _u(e,r){var t=iu(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function dt(e,r){e.l=r,e.read_shift=ua,e.chk=_u,e.write_shift=J_}function Tt(e,r){e.l+=r}function at(e){var r=$r(e);return dt(r,0),r}function Or(e,r,t){if(e){var n,a,i;dt(e,e.l||0);for(var s=e.length,o=0,c=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var f=rs[o]||rs[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;c=e.l+i;var l=f.f&&f.f(e,i,t);if(e.l=c,r(l,f,o))return}}}function _o(){var e=[],r=Ne?256:2048,t=function(f){var l=at(f);return dt(l,0),l},n=t(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(f){return n&&f<n.length-n.l?n:(a(),n=t(Math.max(f+1,r)))},s=function(){return a(),Lr(e)},o=function(f){a(),n=f,n.l==null&&(n.l=n.length),i(r)};return{next:i,push:o,end:s,_bufs:e}}function ha(e,r,t){var n=pt(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Z0(e,r,t){var n=pt(e);return n.s=ha(n.s,r.s,t),n.e=ha(n.e,r.s,t),n}function da(e,r){if(e.cRel&&e.c<0)for(e=pt(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=pt(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Re(e);return!e.cRel&&e.cRel!=null&&(t=tv(t)),!e.rRel&&e.rRel!=null&&(t=Q_(t)),t}function Ns(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+it(e.s.c)+":"+(e.e.cRel?"":"$")+it(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+xt(e.s.r)+":"+(e.e.rRel?"":"$")+xt(e.e.r):da(e.s,r.biff)+":"+da(e.e,r.biff)}function lc(e){return parseInt(ev(e),10)-1}function xt(e){return""+(e+1)}function Q_(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function ev(e){return e.replace(/\$(\d+)$/,"$1")}function uc(e){for(var r=rv(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function it(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function tv(e){return e.replace(/^([A-Z])/,"$$$1")}function rv(e){return e.replace(/^\$([A-Z])/,"$1")}function nv(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ft(e){for(var r=0,t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function Re(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Wn(e){var r=e.indexOf(":");return r==-1?{s:Ft(e),e:Ft(e)}:{s:Ft(e.slice(0,r)),e:Ft(e.slice(r+1))}}function Be(e,r){return typeof r>"u"||typeof r=="number"?Be(e.s,e.e):(typeof e!="string"&&(e=Re(e)),typeof r!="string"&&(r=Re(r)),e==r?e:e+":"+r)}function Ze(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,i=e.length;for(t=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.s.c=--t,t=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(r.s.r=--t,n===i||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.e.c=--t,t=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return r.e.r=--t,r}function J0(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=Kt(e.z,t?It(r):r)}catch{}try{return e.w=Kt((e.XF||{}).numFmtId||(t?14:0),t?It(r):r)}catch{return""+r}}function Ir(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?pn[e.v]||e.v:r==null?J0(e,e.v):J0(e,r))}function Wr(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function vu(e,r,t){var n=t||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Ft(n.origin):n.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var l=Ze(i["!ref"]);f.s.c=l.s.c,f.s.r=l.s.r,f.e.c=Math.max(f.e.c,l.e.c),f.e.r=Math.max(f.e.r,l.e.r),s==-1&&(f.e.r=s=l.e.r+1)}for(var u=0;u!=r.length;++u)if(r[u]){if(!Array.isArray(r[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=r[u].length;++d)if(!(typeof r[u][d]>"u")){var h={v:r[u][d]},x=s+u,p=o+d;if(f.s.r>x&&(f.s.r=x),f.s.c>p&&(f.s.c=p),f.e.r<x&&(f.e.r=x),f.e.c<p&&(f.e.c=p),r[u][d]&&typeof r[u][d]=="object"&&!Array.isArray(r[u][d])&&!(r[u][d]instanceof Date))h=r[u][d];else if(Array.isArray(h.v)&&(h.f=r[u][d][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Oe[14],n.cellDates?(h.t="d",h.w=Kt(h.z,It(h.v))):(h.t="n",h.v=It(h.v),h.w=Kt(h.z,h.v))):h.t="s";if(a)i[x]||(i[x]=[]),i[x][p]&&i[x][p].z&&(h.z=i[x][p].z),i[x][p]=h;else{var m=Re({c:p,r:x});i[m]&&i[m].z&&(h.z=i[m].z),i[m]=h}}}return f.s.c<1e7&&(i["!ref"]=Be(f)),i}function Vn(e,r){return vu(null,e,r)}function av(e){return e.read_shift(4,"i")}function Et(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function iv(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function hc(e,r){var t=e.l,n=e.read_shift(1),a=Et(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(iv(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=t+r,s}var sv=hc;function qt(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function hn(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var ov=Et;function dc(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var cv=Et,vo=dc;function pc(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var a=n===0?qi([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):qr(r,0)>>2;return t?a/100:a}function wu(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var dn=wu;function yt(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function fv(e){var r={},t=e.read_shift(1),n=t>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var f=nn[a];f&&(r.rgb=Fa(f));break;case 2:r.rgb=Fa([s,o,c]);break;case 3:r.theme=a;break}return i!=0&&(r.tint=i>0?i/32767:i/32768),r}function lv(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function yu(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function uv(e){return yu(e,1)}function hv(e){return yu(e,2)}var xc=2,Dt=3,si=11,Q0=12,Zi=19,oi=64,dv=65,pv=71,xv=4108,mv=4126,ft=80,ku=81,gv=[ft,ku],_v={1:{n:"CodePage",t:xc},2:{n:"Category",t:ft},3:{n:"PresentationFormat",t:ft},4:{n:"ByteCount",t:Dt},5:{n:"LineCount",t:Dt},6:{n:"ParagraphCount",t:Dt},7:{n:"SlideCount",t:Dt},8:{n:"NoteCount",t:Dt},9:{n:"HiddenCount",t:Dt},10:{n:"MultimediaClipCount",t:Dt},11:{n:"ScaleCrop",t:si},12:{n:"HeadingPairs",t:xv},13:{n:"TitlesOfParts",t:mv},14:{n:"Manager",t:ft},15:{n:"Company",t:ft},16:{n:"LinksUpToDate",t:si},17:{n:"CharacterCount",t:Dt},19:{n:"SharedDoc",t:si},22:{n:"HyperlinksChanged",t:si},23:{n:"AppVersion",t:Dt,p:"version"},24:{n:"DigSig",t:dv},26:{n:"ContentType",t:ft},27:{n:"ContentStatus",t:ft},28:{n:"Language",t:ft},29:{n:"Version",t:ft},255:{},2147483648:{n:"Locale",t:Zi},2147483651:{n:"Behavior",t:Zi},1919054434:{}},vv={1:{n:"CodePage",t:xc},2:{n:"Title",t:ft},3:{n:"Subject",t:ft},4:{n:"Author",t:ft},5:{n:"Keywords",t:ft},6:{n:"Comments",t:ft},7:{n:"Template",t:ft},8:{n:"LastAuthor",t:ft},9:{n:"RevNumber",t:ft},10:{n:"EditTime",t:oi},11:{n:"LastPrinted",t:oi},12:{n:"CreatedDate",t:oi},13:{n:"ModifiedDate",t:oi},14:{n:"PageCount",t:Dt},15:{n:"WordCount",t:Dt},16:{n:"CharCount",t:Dt},17:{n:"Thumbnail",t:pv},18:{n:"Application",t:ft},19:{n:"DocSecurity",t:Dt},255:{},2147483648:{n:"Locale",t:Zi},2147483651:{n:"Behavior",t:Zi},1919054434:{}},ef={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},wv=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function yv(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var kv=yv([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),nn=pt(kv),pn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Eu={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},tf={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function Ev(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Tv(e){var r=Ev();if(!e||!e.match)return r;var t={};if((e.match(bt)||[]).forEach(function(n){var a=Ce(n);switch(a[0].replace(O_,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":r[tf[a.ContentType]]!==void 0&&r[tf[a.ContentType]].push(a.PartName);break}}),r.xmlns!==W_.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var bn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function wo(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function pa(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(bt)||[]).forEach(function(a){var i=Ce(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:na(i.Target,r);t[o]=s,n[i.Id]=s}}),t["!id"]=n,t}var bv="application/vnd.oasis.opendocument.spreadsheet";function Av(e,r){for(var t=cc(e),n,a;n=Sa.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ce(n[0],!1),a.path=="/"&&a.type!==bv)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var xa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Sv=function(){for(var e=new Array(xa.length),r=0;r<xa.length;++r){var t=xa[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Tu(e){var r={};e=Ve(e);for(var t=0;t<xa.length;++t){var n=xa[t],a=e.match(Sv[t]);a!=null&&a.length>0&&(r[n[1]]=ze(a[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=lt(r[n[1]]))}return r}var Cv=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function bu(e,r,t,n){var a=[];if(typeof e=="string")a=G0(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(l){return{v:l}}));var s=typeof r=="string"?G0(r,n).map(function(l){return l.v}):r,o=0,c=0;if(s.length>0)for(var f=0;f!==a.length;f+=2){switch(c=+a[f+1].v,a[f].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=c,t.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=s.slice(o,o+c);break}o+=c}}function Fv(e,r,t){var n={};return r||(r={}),e=Ve(e),Cv.forEach(function(a){var i=(e.match(Aa(a[0]))||[])[1];switch(a[2]){case"string":i&&(r[a[1]]=ze(i));break;case"bool":r[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&bu(n.HeadingPairs,n.TitlesOfParts,r,t),r}var Rv=/<[^>]+>[^<]*/g;function Iv(e,r){var t={},n="",a=e.match(Rv);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=Ce(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ze(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),f=c[0].slice(4),l=c[1];switch(f){case"lpstr":case"bstr":case"lpwstr":t[n]=ze(l);break;case"bool":t[n]=Ge(l);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(l,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(l);break;case"filetime":case"date":t[n]=lt(l);break;case"cy":case"error":t[n]=ze(l);break;default:if(f.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",s,f,c)}}else if(s.slice(0,2)!=="</"){if(r.WTF)throw new Error(s)}}}return t}var Ov={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ms;function Dv(e,r,t){Ms||(Ms=ic(Ov)),r=Ms[r]||r,e[r]=t}function mc(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Au(e,r,t){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return a}function Su(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function Cu(e,r,t){return r===31?Su(e):Au(e,r,t)}function yo(e,r,t){return Cu(e,r,t===!1?0:4)}function Pv(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Cu(e,r,0)}function Nv(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var a=e.l;t[n]=e.read_shift(0,"lpwstr").replace(Rt,""),e.l-a&2&&(e.l+=2)}return t}function Mv(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(Rt,"");return t}function Lv(e){var r=e.l,t=Ji(e,ku);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=Ji(e,Dt);return[t,n]}function Bv(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(Lv(e));return t}function rf(e,r){for(var t=e.read_shift(4),n={},a=0;a!=t;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,r===1200?"utf16le":"utf8").replace(Rt,"").replace(ra,"!"),r===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Fu(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function Uv(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Ji(e,r,t){var n=e.read_shift(2),a,i=t||{};if(e.l+=2,r!==Q0&&n!==r&&gv.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===Q0?n:r){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Au(e,n,4).replace(Rt,"");case 31:return Su(e);case 64:return mc(e);case 65:return Fu(e);case 71:return Uv(e);case 80:return yo(e,n,!i.raw).replace(Rt,"");case 81:return Pv(e,n).replace(Rt,"");case 4108:return Bv(e);case 4126:case 4127:return n==4127?Nv(e):Mv(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function nf(e,r){var t=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,c=-1,f={};for(s=0;s!=a;++s){var l=e.read_shift(4),u=e.read_shift(4);i[s]=[l,u+t]}i.sort(function(w,v){return w[1]-v[1]});var d={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var h=!0;if(s>0&&r)switch(r[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break}if((!r||s==0)&&e.l<=i[s][1]&&(h=!1,e.l=i[s][1]),h)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(r){var x=r[i[s][0]];if(d[x.n]=Ji(e,x.t,{raw:!0}),x.p==="version"&&(d[x.n]=String(d[x.n]>>16)+"."+("0000"+String(d[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(d[x.n]){case 0:d[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ar(o=d[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[x.n])}}else if(i[s][0]===1){if(o=d.CodePage=Ji(e,xc),ar(o),c!==-1){var p=e.l;e.l=i[c][1],f=rf(e,o),e.l=p}}else if(i[s][0]===0){if(o===0){c=s,e.l=i[s+1][1];continue}f=rf(e,o)}else{var m=f[i[s][0]],g;switch(e[e.l]){case 65:e.l+=4,g=Fu(e);break;case 30:e.l+=4,g=yo(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,g=yo(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Je(e,4);break;case 64:e.l+=4,g=lt(mc(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[m]=g}}return e.l=t+n,d}function af(e,r,t){var n=e.content;if(!n)return{};dt(n,0);var a,i,s,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),l=n.read_shift(16);if(l!==Le.utils.consts.HEADER_CLSID&&l!==t)throw new Error("Bad PropertySet CLSID "+l);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),c=n.read_shift(4));var u=nf(n,r),d={SystemIdentifier:f};for(var h in u)d[h]=u[h];if(d.FMTID=i,a===1)return d;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var x;try{x=nf(n,null)}catch{}for(h in x)d[h]=x[h];return d.FMTID=[i,s],d}function Dr(e,r){return e.read_shift(r),null}function zv(e,r,t){for(var n=[],a=e.l+r;e.l<a;)n.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Je(e,r){return e.read_shift(r)===1}function tt(e){return e.read_shift(2,"u")}function Ru(e,r){return zv(e,r,tt)}function $v(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function Ba(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function Hv(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,a=t&8,i=1+(t&1),s=0,o,c={};a&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",l=r===0?"":e.read_shift(r,f);return a&&(e.l+=4*s),n&&(e.l+=o),c.t=l,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function fn(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function Ua(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):fn(e,n,t)}function xn(e,r,t){if(t.biff>5)return Ua(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Wv(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function Vv(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var a=e.read_shift((n?r-24:r)>>1,"utf16le").replace(Rt,"");return n&&(e.l+=24),a}function Gv(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(Rt,"");return t+s}function Xv(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return Vv(e);case"0303000000000000c000000000000046":return Gv(e);default:throw new Error("Unsupported Moniker "+t)}}function ci(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Rt,""):"";return t}function jv(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,c,f="",l,u;a&16&&(i=ci(e,t-e.l)),a&128&&(s=ci(e,t-e.l)),(a&257)===257&&(o=ci(e,t-e.l)),(a&257)===1&&(c=Xv(e,t-e.l)),a&8&&(f=ci(e,t-e.l)),a&32&&(l=e.read_shift(16)),a&64&&(u=mc(e)),e.l=t;var d=s||o||c||"";d&&f&&(d+="#"+f),d||(d="#"+f),a&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var h={Target:d};return l&&(h.guid=l),u&&(h.time=u),i&&(h.Tooltip=i),h}function Iu(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[r,t,n,a]}function Ou(e,r){var t=Iu(e);return t[3]=0,t}function wr(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function Yv(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function Kv(e,r,t){return r===0?"":xn(e,r,t)}function qv(e,r,t){var n=t.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function Du(e){var r=e.read_shift(2),t=pc(e);return[r,t]}function Zv(e,r,t){e.l+=4,r-=4;var n=e.l+r,a=Ba(e,r,t),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function us(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r},e:{c:a,r:t}}}function Pu(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r},e:{c:a,r:t}}}var Jv=Pu;function Nu(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function Qv(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function e2(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function _t(e){e.l+=2,e.l+=e.read_shift(2)}var t2={0:_t,4:_t,5:_t,6:_t,7:e2,8:_t,9:_t,10:_t,11:_t,12:_t,13:Qv,14:_t,15:_t,16:_t,17:_t,18:_t,19:_t,20:_t,21:Nu};function r2(e,r){for(var t=e.l+r,n=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{n.push(t2[a](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function fi(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function n2(e,r){return r===0||e.read_shift(2),1200}function a2(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,a=xn(e,0,t);return e.read_shift(r+n-e.l),a}function i2(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function s2(e,r,t){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=Ba(e,0,t);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function o2(e,r){for(var t=e.l+r,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<t;++s)i.push(Hv(e));return i.Count=n,i.Unique=a,i}function c2(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function f2(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function l2(e){var r=Yv(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function u2(e){return e.read_shift(2),e.read_shift(4)}function sf(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function h2(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2);return{Pos:[r,t],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:c,TabRatio:f}}function d2(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function p2(){}function x2(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Ba(e,0,t),n}function m2(e){var r=wr(e);return r.isst=e.read_shift(4),r}function g2(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,a=wr(e);t.biff==2&&e.l++;var i=Ua(e,n-e.l,t);return a.val=i,a}function _2(e,r,t){var n=e.read_shift(2),a=xn(e,0,t);return[n,a]}var v2=xn;function of(e,r,t){var n=e.l+r,a=t.biff==8||!t.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c}}}function w2(e){var r=e.read_shift(2),t=e.read_shift(2),n=Du(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function y2(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<t;)i.push(Du(e));if(e.l!==t)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function k2(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<t;)i.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function E2(e,r,t,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=wv[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function T2(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=E2(e,r,n.fStyle,t),n}function b2(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function cf(e,r,t){var n=wr(e);(t.biff==2||r==9)&&++e.l;var a=$v(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function A2(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=wr(e),a=yt(e);return n.val=a,n}var ff=Kv;function S2(e,r,t){var n=e.l+r,a=e.read_shift(2),i=e.read_shift(2);if(t.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=fn(e,i),o=[];n>e.l;)o.push(Ua(e));return[i,a,s,o]}function lf(e,r,t){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(a=Zv(e,r-2,t)),i.body=a||e.read_shift(r-2),typeof a=="string"&&(i.Name=a),i}var C2=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function uf(e,r,t){var n=e.l+r,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),c=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var f=fn(e,s,t);a&32&&(f=C2[f.charCodeAt(0)]);var l=n-e.l;t&&t.biff==2&&--l;var u=n==e.l||o===0||!(l>0)?[]:fE(e,l,t,o);return{chKey:i,Name:f,itab:c,rgce:u}}function Mu(e,r,t){if(t.biff<8)return F2(e,r,t);for(var n=[],a=e.l+r,i=e.read_shift(t.biff>8?4:2);i--!==0;)n.push(qv(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function F2(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=Ba(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function R2(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),a=e.read_shift(2),i=fn(e,n,t),s=fn(e,a,t);return[i,s]}function I2(e,r,t){var n=Pu(e);e.l++;var a=e.read_shift(1);return r-=8,[lE(e,r,t),a,n]}function hf(e,r,t){var n=Jv(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,oE(e,r,t)]}function O2(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function D2(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=xn(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:a},o,s,i]}}function P2(e,r,t){return D2(e,r,t)}function N2(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(us(e));return t}function M2(e,r,t){if(t&&t.biff<8)return B2(e,r,t);var n=Nu(e),a=r2(e,r-22,n[1]);return{cmo:n,ft:a}}var L2={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:n}}};function B2(e,r,t){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var s=[];return s.push((L2[n]||Tt)(e,r,t)),{cmo:[a,n,i],ft:s}}function U2(e,r,t){var n=e.l,a="";try{e.l+=4;var i=(t.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=Wv(e,6,t);var o=e.read_shift(2);e.read_shift(2),tt(e,2);var c=e.read_shift(2);e.l+=c;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var l=e[e.l],u=fn(e,e.lens[f+1]-e.lens[f]-1);if(a+=u,a.length>=(l?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+r,{t:a}}catch{return e.l=n+r,{t:a}}}function z2(e,r){var t=us(e);e.l+=16;var n=jv(e,r-24);return[t,n]}function $2(e,r){e.read_shift(2);var t=us(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(Rt,""),[t,n]}function H2(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=ef[t]||t,t=e.read_shift(2),r[1]=ef[t]||t,r}function W2(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Ou(e));return t}function V2(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Ou(e));return t}function G2(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function Lu(e,r,t){if(!t.cellStyles)return Tt(e,r);var n=t&&t.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var f={s:a,e:i,w:s,ixfe:o,flags:c};return(t.biff>=5||!t.biff)&&(f.level=c>>8&7),f}function X2(e,r){var t={};return r<32||(e.l+=16,t.header=yt(e),t.footer=yt(e),e.l+=2),t}function j2(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var Y2=wr,K2=Ru,q2=Ua;function Z2(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function J2(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=wr(e);++e.l;var a=xn(e,r-7,t);return n.t="str",n.val=a,n}function Q2(e){var r=wr(e);++e.l;var t=yt(e);return r.t="n",r.val=t,r}function ew(e){var r=wr(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function tw(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function rw(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function nw(e,r,t){var n=e.l+r,a=wr(e),i=e.read_shift(2),s=fn(e,i,t);return e.l=n,a.t="str",a.val=s,a}var aw=[2,3,48,49,131,139,140,245],df=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=ic({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,c){var f=[],l=$r(1);switch(c.type){case"base64":l=nr(Ht(o));break;case"binary":l=nr(o);break;case"buffer":case"array":l=o;break}dt(l,0);var u=l.read_shift(1),d=!!(u&136),h=!1,x=!1;switch(u){case 2:break;case 3:break;case 48:h=!0,d=!0;break;case 49:h=!0,d=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var p=0,m=521;u==2&&(p=l.read_shift(2)),l.l+=3,u!=2&&(p=l.read_shift(4)),p>1048576&&(p=1e6),u!=2&&(m=l.read_shift(2));var g=l.read_shift(2),w=c.codepage||1252;u!=2&&(l.l+=16,l.read_shift(1),l[l.l]!==0&&(w=e[l[l.l]]),l.l+=1,l.l+=2),x&&(l.l+=36);for(var v=[],k={},A=Math.min(l.length,u==2?521:m-10-(h?264:0)),F=x?32:11;l.l<A&&l[l.l]!=13;)switch(k={},k.name=go.utils.decode(w,l.slice(l.l,l.l+F)).replace(/[\u0000\r\n].*$/g,""),l.l+=F,k.type=String.fromCharCode(l.read_shift(1)),u!=2&&!x&&(k.offset=l.read_shift(4)),k.len=l.read_shift(1),u==2&&(k.offset=l.read_shift(2)),k.dec=l.read_shift(1),k.name.length&&v.push(k),u!=2&&(l.l+=x?13:14),k.type){case"B":(!h||k.len!=8)&&c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(l[l.l]!==13&&(l.l=m-1),l.read_shift(1)!==13)throw new Error("DBF Terminator not found "+l.l+" "+l[l.l]);l.l=m;var E=0,z=0;for(f[0]=[],z=0;z!=v.length;++z)f[0][z]=v[z].name;for(;p-- >0;){if(l[l.l]===42){l.l+=g;continue}for(++l.l,f[++E]=[],z=0,z=0;z!=v.length;++z){var C=l.slice(l.l,l.l+v[z].len);l.l+=v[z].len,dt(C,0);var G=go.utils.decode(w,C);switch(v[z].type){case"C":G.trim().length&&(f[E][z]=G.replace(/\s+$/,""));break;case"D":G.length===8?f[E][z]=new Date(+G.slice(0,4),+G.slice(4,6)-1,+G.slice(6,8)):f[E][z]=G;break;case"F":f[E][z]=parseFloat(G.trim());break;case"+":case"I":f[E][z]=x?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(G.trim().toUpperCase()){case"Y":case"T":f[E][z]=!0;break;case"N":case"F":f[E][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+G+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));f[E][z]="##MEMO##"+(x?parseInt(G.trim(),10):C.read_shift(4));break;case"N":G=G.replace(/\u0000/g,"").trim(),G&&G!="."&&(f[E][z]=+G||0);break;case"@":f[E][z]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":f[E][z]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":f[E][z]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[E][z]=-C.read_shift(-8,"f");break;case"B":if(h&&v[z].len==8){f[E][z]=C.read_shift(8,"f");break}case"G":case"P":C.l+=v[z].len;break;case"0":if(v[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[z].type)}}}if(u!=2&&l.l<l.length&&l[l.l++]!=26)throw new Error("DBF EOF Marker missing "+(l.l-1)+" of "+l.length+" "+l[l.l-1].toString(16));return c&&c.sheetRows&&(f=f.slice(0,c.sheetRows)),c.DBF=v,f}function n(o,c){var f=c||{};f.dateNF||(f.dateNF="yyyymmdd");var l=Vn(t(o,f),f);return l["!cols"]=f.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete f.DBF,l}function a(o,c){try{return Wr(n(o,c),c)}catch(f){if(c&&c.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){var f=c||{};if(+f.codepage>=0&&ar(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var l=_o(),u=Co(o,{header:1,raw:!0,cellDates:!0}),d=u[0],h=u.slice(1),x=o["!cols"]||[],p=0,m=0,g=0,w=1;for(p=0;p<d.length;++p){if(((x[p]||{}).DBF||{}).name){d[p]=x[p].DBF.name,++g;continue}if(d[p]!=null){if(++g,typeof d[p]=="number"&&(d[p]=d[p].toString(10)),typeof d[p]!="string")throw new Error("DBF Invalid column name "+d[p]+" |"+typeof d[p]+"|");if(d.indexOf(d[p])!==p){for(m=0;m<1024;++m)if(d.indexOf(d[p]+"_"+m)==-1){d[p]+="_"+m;break}}}}var v=Ze(o["!ref"]),k=[],A=[],F=[];for(p=0;p<=v.e.c-v.s.c;++p){var E="",z="",C=0,G=[];for(m=0;m<h.length;++m)h[m][p]!=null&&G.push(h[m][p]);if(G.length==0||d[p]==null){k[p]="?";continue}for(m=0;m<G.length;++m){switch(typeof G[m]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=G[m]instanceof Date?"D":"C";break;default:z="C"}C=Math.max(C,String(G[m]).length),E=E&&E!=z?"C":z}C>250&&(C=250),z=((x[p]||{}).DBF||{}).type,z=="C"&&x[p].DBF.len>C&&(C=x[p].DBF.len),E=="B"&&z=="N"&&(E="N",F[p]=x[p].DBF.dec,C=x[p].DBF.len),A[p]=E=="C"||z=="N"?C:i[E]||0,w+=A[p],k[p]=E}var H=l.next(32);for(H.write_shift(4,318902576),H.write_shift(4,h.length),H.write_shift(2,296+32*g),H.write_shift(2,w),p=0;p<4;++p)H.write_shift(4,0);for(H.write_shift(4,0|(+r[Ml]||3)<<8),p=0,m=0;p<d.length;++p)if(d[p]!=null){var b=l.next(32),X=(d[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);b.write_shift(1,X,"sbcs"),b.write_shift(1,k[p]=="?"?"C":k[p],"sbcs"),b.write_shift(4,m),b.write_shift(1,A[p]||i[k[p]]||0),b.write_shift(1,F[p]||0),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(1,0),b.write_shift(4,0),b.write_shift(4,0),m+=A[p]||i[k[p]]||0}var _=l.next(264);for(_.write_shift(4,13),p=0;p<65;++p)_.write_shift(4,0);for(p=0;p<h.length;++p){var W=l.next(w);for(W.write_shift(1,0),m=0;m<d.length;++m)if(d[m]!=null)switch(k[m]){case"L":W.write_shift(1,h[p][m]==null?63:h[p][m]?84:70);break;case"B":W.write_shift(8,h[p][m]||0,"f");break;case"N":var q="0";for(typeof h[p][m]=="number"&&(q=h[p][m].toFixed(F[m]||0)),g=0;g<A[m]-q.length;++g)W.write_shift(1,32);W.write_shift(1,q,"sbcs");break;case"D":h[p][m]?(W.write_shift(4,("0000"+h[p][m].getFullYear()).slice(-4),"sbcs"),W.write_shift(2,("00"+(h[p][m].getMonth()+1)).slice(-2),"sbcs"),W.write_shift(2,("00"+h[p][m].getDate()).slice(-2),"sbcs")):W.write_shift(8,"00000000","sbcs");break;case"C":var j=String(h[p][m]!=null?h[p][m]:"").slice(0,A[m]);for(W.write_shift(1,j,"sbcs"),g=0;g<A[m]-j.length;++g)W.write_shift(1,32);break}}return l.next(1).write_shift(1,26),l.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),iw=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+gr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(d,h){var x=e[h];return typeof x=="number"?C0(x):x},n=function(d,h,x){var p=h.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?d:C0(p)};e["|"]=254;function a(d,h){switch(h.type){case"base64":return i(Ht(d),h);case"binary":return i(d,h);case"buffer":return i(Ne&&Buffer.isBuffer(d)?d.toString("binary"):un(d),h);case"array":return i(cn(d),h)}throw new Error("Unrecognized type "+h.type)}function i(d,h){var x=d.split(/[\n\r]+/),p=-1,m=-1,g=0,w=0,v=[],k=[],A=null,F={},E=[],z=[],C=[],G=0,H;for(+h.codepage>=0&&ar(+h.codepage);g!==x.length;++g){G=0;var b=x[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),X=b.replace(/;;/g,"\0").split(";").map(function(N){return N.replace(/\u0000/g,";")}),_=X[0],W;if(b.length>0)switch(_){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":X[1].charAt(0)=="P"&&k.push(b.slice(3).replace(/;;/g,";"));break;case"C":var q=!1,j=!1,ue=!1,P=!1,se=-1,Y=-1;for(w=1;w<X.length;++w)switch(X[w].charAt(0)){case"A":break;case"X":m=parseInt(X[w].slice(1))-1,j=!0;break;case"Y":for(p=parseInt(X[w].slice(1))-1,j||(m=0),H=v.length;H<=p;++H)v[H]=[];break;case"K":W=X[w].slice(1),W.charAt(0)==='"'?W=W.slice(1,W.length-1):W==="TRUE"?W=!0:W==="FALSE"?W=!1:isNaN(or(W))?isNaN(Un(W).getDate())||(W=lt(W)):(W=or(W),A!==null&&Hn(A)&&(W=ls(W))),q=!0;break;case"E":P=!0;var T=Fn(X[w].slice(1),{r:p,c:m});v[p][m]=[v[p][m],T];break;case"S":ue=!0,v[p][m]=[v[p][m],"S5S"];break;case"G":break;case"R":se=parseInt(X[w].slice(1))-1;break;case"C":Y=parseInt(X[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+b)}if(q&&(v[p][m]&&v[p][m].length==2?v[p][m][0]=W:v[p][m]=W,A=null),ue){if(P)throw new Error("SYLK shared formula cannot have own formula");var K=se>-1&&v[se][Y];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");v[p][m][1]=ju(K[1],{r:p-se,c:m-Y})}break;case"F":var B=0;for(w=1;w<X.length;++w)switch(X[w].charAt(0)){case"X":m=parseInt(X[w].slice(1))-1,++B;break;case"Y":for(p=parseInt(X[w].slice(1))-1,H=v.length;H<=p;++H)v[H]=[];break;case"M":G=parseInt(X[w].slice(1))/20;break;case"F":break;case"G":break;case"P":A=k[parseInt(X[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=X[w].slice(1).split(" "),H=parseInt(C[0],10);H<=parseInt(C[1],10);++H)G=parseInt(C[2],10),z[H-1]=G===0?{hidden:!0}:{wch:G},zn(z[H-1]);break;case"C":m=parseInt(X[w].slice(1))-1,z[m]||(z[m]={});break;case"R":p=parseInt(X[w].slice(1))-1,E[p]||(E[p]={}),G>0?(E[p].hpt=G,E[p].hpx=Ra(G)):G===0&&(E[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+b)}B<1&&(A=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+b)}}return E.length>0&&(F["!rows"]=E),z.length>0&&(F["!cols"]=z),h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),[v,F]}function s(d,h){var x=a(d,h),p=x[0],m=x[1],g=Vn(p,h);return gr(m).forEach(function(w){g[w]=m[w]}),g}function o(d,h){return Wr(s(d,h),h)}function c(d,h,x,p){var m="C;Y"+(x+1)+";X"+(p+1)+";K";switch(d.t){case"n":m+=d.v||0,d.f&&!d.F&&(m+=";E"+Gy(d.f,{r:x,c:p}));break;case"b":m+=d.v?"TRUE":"FALSE";break;case"e":m+=d.w||d.v;break;case"d":m+='"'+(d.w||d.v)+'"';break;case"s":m+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function f(d,h){h.forEach(function(x,p){var m="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?m+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=es(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=ts(x.wpx)),typeof x.wch=="number"&&(m+=Math.round(x.wch))),m.charAt(m.length-1)!=" "&&d.push(m)})}function l(d,h){h.forEach(function(x,p){var m="F;";x.hidden?m+="M0;":x.hpt?m+="M"+20*x.hpt+";":x.hpx&&(m+="M"+20*Vu(x.hpx)+";"),m.length>2&&d.push(m+"R"+(p+1))})}function u(d,h){var x=["ID;PWXL;N;E"],p=[],m=Ze(d["!ref"]),g,w=Array.isArray(d),v=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),d["!cols"]&&f(x,d["!cols"]),d["!rows"]&&l(x,d["!rows"]),x.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var k=m.s.r;k<=m.e.r;++k)for(var A=m.s.c;A<=m.e.c;++A){var F=Re({r:k,c:A});g=w?(d[k]||[])[A]:d[F],!(!g||g.v==null&&(!g.f||g.F))&&p.push(c(g,d,k,A))}return x.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:s,from_sheet:u}}(),sw=function(){function e(i,s){switch(s.type){case"base64":return r(Ht(i),s);case"binary":return r(i,s);case"buffer":return r(Ne&&Buffer.isBuffer(i)?i.toString("binary"):un(i),s);case"array":return r(cn(i),s)}throw new Error("Unrecognized type "+s.type)}function r(i,s){for(var o=i.split(`
`),c=-1,f=-1,l=0,u=[];l!==o.length;++l){if(o[l].trim()==="BOT"){u[++c]=[],f=0;continue}if(!(c<0)){var d=o[l].trim().split(","),h=d[0],x=d[1];++l;for(var p=o[l]||"";(p.match(/["]/g)||[]).length&1&&l<o.length-1;)p+=`
`+o[++l];switch(p=p.trim(),+h){case-1:if(p==="BOT"){u[++c]=[],f=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?u[c][f]=!0:p==="FALSE"?u[c][f]=!1:isNaN(or(x))?isNaN(Un(x).getDate())?u[c][f]=x:u[c][f]=lt(x):u[c][f]=or(x),++f;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),u[c][f++]=p!==""?p:null;break}if(p==="EOD")break}}return s&&s.sheetRows&&(u=u.slice(0,s.sheetRows)),u}function t(i,s){return Vn(e(i,s),s)}function n(i,s){return Wr(t(i,s),s)}var a=function(){var i=function(c,f,l,u,d){c.push(f),c.push(l+","+u),c.push('"'+d.replace(/"/g,'""')+'"')},s=function(c,f,l,u){c.push(f+","+l),c.push(f==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(c){var f=[],l=Ze(c["!ref"]),u,d=Array.isArray(c);i(f,"TABLE",0,1,"sheetjs"),i(f,"VECTORS",0,l.e.r-l.s.r+1,""),i(f,"TUPLES",0,l.e.c-l.s.c+1,""),i(f,"DATA",0,0,"");for(var h=l.s.r;h<=l.e.r;++h){s(f,-1,0,"BOT");for(var x=l.s.c;x<=l.e.c;++x){var p=Re({r:h,c:x});if(u=d?(c[h]||[])[x]:c[p],!u){s(f,1,0,"");continue}switch(u.t){case"n":var m=u.w;!m&&u.v!=null&&(m=u.v),m==null?u.f&&!u.F?s(f,1,0,"="+u.f):s(f,1,0,""):s(f,0,m,"V");break;case"b":s(f,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":s(f,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=Kt(u.z||Oe[14],It(lt(u.v)))),s(f,0,u.w,"V");break;default:s(f,1,0,"")}}}s(f,-1,0,"EOD");var g=`\r
`,w=f.join(g);return w}}();return{to_workbook:n,to_sheet:t,from_sheet:a}}(),ow=function(){function e(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(u,d){for(var h=u.split(`
`),x=-1,p=-1,m=0,g=[];m!==h.length;++m){var w=h[m].trim().split(":");if(w[0]==="cell"){var v=Ft(w[1]);if(g.length<=v.r)for(x=g.length;x<=v.r;++x)g[x]||(g[x]=[]);switch(x=v.r,p=v.c,w[2]){case"t":g[x][p]=e(w[3]);break;case"v":g[x][p]=+w[3];break;case"vtf":var k=w[w.length-1];case"vtc":switch(w[3]){case"nl":g[x][p]=!!+w[4];break;default:g[x][p]=+w[4];break}w[2]=="vtf"&&(g[x][p]=[g[x][p],k])}}}return d&&d.sheetRows&&(g=g.slice(0,d.sheetRows)),g}function n(u,d){return Vn(t(u,d),d)}function a(u,d){return Wr(n(u,d),d)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function f(u){if(!u||!u["!ref"])return"";for(var d=[],h=[],x,p="",m=Wn(u["!ref"]),g=Array.isArray(u),w=m.s.r;w<=m.e.r;++w)for(var v=m.s.c;v<=m.e.c;++v)if(p=Re({r:w,c:v}),x=g?(u[w]||[])[v]:u[p],!(!x||x.v==null||x.t==="z")){switch(h=["cell",p,"t"],x.t){case"s":case"str":h.push(r(x.v));break;case"n":x.f?(h[2]="vtf",h[3]="n",h[4]=x.v,h[5]=r(x.f)):(h[2]="v",h[3]=x.v);break;case"b":h[2]="vt"+(x.f?"f":"c"),h[3]="nl",h[4]=x.v?"1":"0",h[5]=r(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var k=It(lt(x.v));h[2]="vtc",h[3]="nd",h[4]=""+k,h[5]=x.w||Kt(x.z||Oe[14],k);break;case"e":continue}d.push(h.join(":"))}return d.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function l(u){return[i,s,o,s,f(u),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:l}}(),Ca=function(){function e(l,u,d,h,x){x.raw?u[d][h]=l:l===""||(l==="TRUE"?u[d][h]=!0:l==="FALSE"?u[d][h]=!1:isNaN(or(l))?isNaN(Un(l).getDate())?u[d][h]=l:u[d][h]=lt(l):u[d][h]=or(l))}function r(l,u){var d=u||{},h=[];if(!l||l.length===0)return h;for(var x=l.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var m=10,g=0,w=0;w<=p;++w)g=x[w].indexOf(" "),g==-1?g=x[w].length:g++,m=Math.max(m,g);for(w=0;w<=p;++w){h[w]=[];var v=0;for(e(x[w].slice(0,m).trim(),h,w,v,d),v=1;v<=(x[w].length-m)/10+1;++v)e(x[w].slice(m+(v-1)*10,m+v*10).trim(),h,w,v,d)}return d.sheetRows&&(h=h.slice(0,d.sheetRows)),h}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(l){for(var u={},d=!1,h=0,x=0;h<l.length;++h)(x=l.charCodeAt(h))==34?d=!d:!d&&x in t&&(u[x]=(u[x]||0)+1);x=[];for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&x.push([u[h],h]);if(!x.length){u=n;for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&x.push([u[h],h])}return x.sort(function(p,m){return p[0]-m[0]||n[p[1]]-n[m[1]]}),t[x.pop()[1]]||44}function i(l,u){var d=u||{},h="",x=d.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};l.slice(0,4)=="sep="?l.charCodeAt(5)==13&&l.charCodeAt(6)==10?(h=l.charAt(4),l=l.slice(7)):l.charCodeAt(5)==13||l.charCodeAt(5)==10?(h=l.charAt(4),l=l.slice(6)):h=a(l.slice(0,1024)):d&&d.FS?h=d.FS:h=a(l.slice(0,1024));var m=0,g=0,w=0,v=0,k=0,A=h.charCodeAt(0),F=!1,E=0,z=l.charCodeAt(0);l=l.replace(/\r\n/mg,`
`);var C=d.dateNF!=null?__(d.dateNF):null;function G(){var H=l.slice(v,k),b={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)b.t="z";else if(d.raw)b.t="s",b.v=H;else if(H.trim().length===0)b.t="s",b.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(b.t="s",b.v=H.slice(2,-1).replace(/""/g,'"')):jy(H)?(b.t="n",b.f=H.slice(1)):(b.t="s",b.v=H);else if(H=="TRUE")b.t="b",b.v=!0;else if(H=="FALSE")b.t="b",b.v=!1;else if(!isNaN(w=or(H)))b.t="n",d.cellText!==!1&&(b.w=H),b.v=w;else if(!isNaN(Un(H).getDate())||C&&H.match(C)){b.z=d.dateNF||Oe[14];var X=0;C&&H.match(C)&&(H=v_(H,d.dateNF,H.match(C)||[]),X=1),d.cellDates?(b.t="d",b.v=lt(H,X)):(b.t="n",b.v=It(lt(H,X))),d.cellText!==!1&&(b.w=Kt(b.z,b.v instanceof Date?It(b.v):b.v)),d.cellNF||delete b.z}else b.t="s",b.v=H;if(b.t=="z"||(d.dense?(x[m]||(x[m]=[]),x[m][g]=b):x[Re({c:g,r:m})]=b),v=k+1,z=l.charCodeAt(v),p.e.c<g&&(p.e.c=g),p.e.r<m&&(p.e.r=m),E==A)++g;else if(g=0,++m,d.sheetRows&&d.sheetRows<=m)return!0}e:for(;k<l.length;++k)switch(E=l.charCodeAt(k)){case 34:z===34&&(F=!F);break;case A:case 10:case 13:if(!F&&G())break e;break}return k-v>0&&G(),x["!ref"]=Be(p),x}function s(l,u){return!(u&&u.PRN)||u.FS||l.slice(0,4)=="sep="||l.indexOf("	")>=0||l.indexOf(",")>=0||l.indexOf(";")>=0?i(l,u):Vn(r(l,u),u)}function o(l,u){var d="",h=u.type=="string"?[0,0,0,0]:Tc(l,u);switch(u.type){case"base64":d=Ht(l);break;case"binary":d=l;break;case"buffer":u.codepage==65001?d=l.toString("utf8"):(u.codepage,d=Ne&&Buffer.isBuffer(l)?l.toString("binary"):un(l));break;case"array":d=cn(l);break;case"string":d=l;break;default:throw new Error("Unrecognized type "+u.type)}return h[0]==239&&h[1]==187&&h[2]==191?d=Ve(d.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?d=Ve(d):u.type=="binary",d.slice(0,19)=="socialcalc:version:"?ow.to_sheet(u.type=="string"?d:Ve(d),u):s(d,u)}function c(l,u){return Wr(o(l,u),u)}function f(l){for(var u=[],d=Ze(l["!ref"]),h,x=Array.isArray(l),p=d.s.r;p<=d.e.r;++p){for(var m=[],g=d.s.c;g<=d.e.c;++g){var w=Re({r:p,c:g});if(h=x?(l[p]||[])[g]:l[w],!h||h.v==null){m.push("          ");continue}for(var v=(h.w||(Ir(h),h.w)||"").slice(0,10);v.length<10;)v+=" ";m.push(v+(g===0?" ":""))}u.push(m.join(""))}return u.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:f}}();function cw(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var a=iw.to_workbook(e,t);return t.WTF=n,a}catch(i){if(t.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Ca.to_workbook(e,r)}}var ma=function(){function e(T,K,B){if(T){dt(T,T.l||0);for(var N=B.Enum||se;T.l<T.length;){var ie=T.read_shift(2),pe=N[ie]||N[65535],le=T.read_shift(2),fe=T.l+le,he=pe.f&&pe.f(T,le,B);if(T.l=fe,K(he,pe,ie))return}}}function r(T,K){switch(K.type){case"base64":return t(nr(Ht(T)),K);case"binary":return t(nr(T),K);case"buffer":case"array":return t(T,K)}throw"Unsupported type "+K.type}function t(T,K){if(!T)return T;var B=K||{},N=B.dense?[]:{},ie="Sheet1",pe="",le=0,fe={},he=[],be=[],V={s:{r:0,c:0},e:{r:0,c:0}},Ue=B.sheetRows||0;if(T[2]==0&&(T[3]==8||T[3]==9)&&T.length>=16&&T[14]==5&&T[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(T[2]==2)B.Enum=se,e(T,function(R,O,Z){switch(Z){case 0:B.vers=R,R>=4096&&(B.qpro=!0);break;case 6:V=R;break;case 204:R&&(pe=R);break;case 222:pe=R;break;case 15:case 51:B.qpro||(R[1].v=R[1].v.slice(1));case 13:case 14:case 16:Z==14&&(R[2]&112)==112&&(R[2]&15)>1&&(R[2]&15)<15&&(R[1].z=B.dateNF||Oe[14],B.cellDates&&(R[1].t="d",R[1].v=ls(R[1].v))),B.qpro&&R[3]>le&&(N["!ref"]=Be(V),fe[ie]=N,he.push(ie),N=B.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},le=R[3],ie=pe||"Sheet"+(le+1),pe="");var ce=B.dense?(N[R[0].r]||[])[R[0].c]:N[Re(R[0])];if(ce){ce.t=R[1].t,ce.v=R[1].v,R[1].z!=null&&(ce.z=R[1].z),R[1].f!=null&&(ce.f=R[1].f);break}B.dense?(N[R[0].r]||(N[R[0].r]=[]),N[R[0].r][R[0].c]=R[1]):N[Re(R[0])]=R[1];break}},B);else if(T[2]==26||T[2]==14)B.Enum=Y,T[2]==14&&(B.qpro=!0,T.l=0),e(T,function(R,O,Z){switch(Z){case 204:ie=R;break;case 22:R[1].v=R[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(R[3]>le&&(N["!ref"]=Be(V),fe[ie]=N,he.push(ie),N=B.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},le=R[3],ie="Sheet"+(le+1)),Ue>0&&R[0].r>=Ue)break;B.dense?(N[R[0].r]||(N[R[0].r]=[]),N[R[0].r][R[0].c]=R[1]):N[Re(R[0])]=R[1],V.e.c<R[0].c&&(V.e.c=R[0].c),V.e.r<R[0].r&&(V.e.r=R[0].r);break;case 27:R[14e3]&&(be[R[14e3][0]]=R[14e3][1]);break;case 1537:be[R[0]]=R[1],R[0]==le&&(ie=R[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+T[2]);if(N["!ref"]=Be(V),fe[pe||ie]=N,he.push(pe||ie),!be.length)return{SheetNames:he,Sheets:fe};for(var y={},ae=[],J=0;J<be.length;++J)fe[he[J]]?(ae.push(be[J]||he[J]),y[be[J]]=fe[be[J]]||fe[he[J]]):(ae.push(be[J]),y[be[J]]={"!ref":"A1"});return{SheetNames:ae,Sheets:y}}function n(T,K){var B=K||{};if(+B.codepage>=0&&ar(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var N=_o(),ie=Ze(T["!ref"]),pe=Array.isArray(T),le=[];Qt(N,0,i(1030)),Qt(N,6,c(ie));for(var fe=Math.min(ie.e.r,8191),he=ie.s.r;he<=fe;++he)for(var be=xt(he),V=ie.s.c;V<=ie.e.c;++V){he===ie.s.r&&(le[V]=it(V));var Ue=le[V]+be,y=pe?(T[he]||[])[V]:T[Ue];if(!(!y||y.t=="z"))if(y.t=="n")(y.v|0)==y.v&&y.v>=-32768&&y.v<=32767?Qt(N,13,h(he,V,y.v)):Qt(N,14,p(he,V,y.v));else{var ae=Ir(y);Qt(N,15,u(he,V,ae.slice(0,239)))}}return Qt(N,1),N.end()}function a(T,K){var B=K||{};if(+B.codepage>=0&&ar(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var N=_o();Qt(N,0,s(T));for(var ie=0,pe=0;ie<T.SheetNames.length;++ie)(T.Sheets[T.SheetNames[ie]]||{})["!ref"]&&Qt(N,27,P(T.SheetNames[ie],pe++));var le=0;for(ie=0;ie<T.SheetNames.length;++ie){var fe=T.Sheets[T.SheetNames[ie]];if(!(!fe||!fe["!ref"])){for(var he=Ze(fe["!ref"]),be=Array.isArray(fe),V=[],Ue=Math.min(he.e.r,8191),y=he.s.r;y<=Ue;++y)for(var ae=xt(y),J=he.s.c;J<=he.e.c;++J){y===he.s.r&&(V[J]=it(J));var R=V[J]+ae,O=be?(fe[y]||[])[J]:fe[R];if(!(!O||O.t=="z"))if(O.t=="n")Qt(N,23,G(y,J,le,O.v));else{var Z=Ir(O);Qt(N,22,E(y,J,le,Z.slice(0,239)))}}++le}}return Qt(N,1),N.end()}function i(T){var K=at(2);return K.write_shift(2,T),K}function s(T){var K=at(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var B=0,N=0,ie=0,pe=0;pe<T.SheetNames.length;++pe){var le=T.SheetNames[pe],fe=T.Sheets[le];if(!(!fe||!fe["!ref"])){++ie;var he=Wn(fe["!ref"]);B<he.e.r&&(B=he.e.r),N<he.e.c&&(N=he.e.c)}}return B>8191&&(B=8191),K.write_shift(2,B),K.write_shift(1,ie),K.write_shift(1,N),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(T,K,B){var N={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&B.qpro?(N.s.c=T.read_shift(1),T.l++,N.s.r=T.read_shift(2),N.e.c=T.read_shift(1),T.l++,N.e.r=T.read_shift(2),N):(N.s.c=T.read_shift(2),N.s.r=T.read_shift(2),K==12&&B.qpro&&(T.l+=2),N.e.c=T.read_shift(2),N.e.r=T.read_shift(2),K==12&&B.qpro&&(T.l+=2),N.s.c==65535&&(N.s.c=N.e.c=N.s.r=N.e.r=0),N)}function c(T){var K=at(8);return K.write_shift(2,T.s.c),K.write_shift(2,T.s.r),K.write_shift(2,T.e.c),K.write_shift(2,T.e.r),K}function f(T,K,B){var N=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(N[0].c=T.read_shift(1),N[3]=T.read_shift(1),N[0].r=T.read_shift(2),T.l+=2):(N[2]=T.read_shift(1),N[0].c=T.read_shift(2),N[0].r=T.read_shift(2)),N}function l(T,K,B){var N=T.l+K,ie=f(T,K,B);if(ie[1].t="s",B.vers==20768){T.l++;var pe=T.read_shift(1);return ie[1].v=T.read_shift(pe,"utf8"),ie}return B.qpro&&T.l++,ie[1].v=T.read_shift(N-T.l,"cstr"),ie}function u(T,K,B){var N=at(7+B.length);N.write_shift(1,255),N.write_shift(2,K),N.write_shift(2,T),N.write_shift(1,39);for(var ie=0;ie<N.length;++ie){var pe=B.charCodeAt(ie);N.write_shift(1,pe>=128?95:pe)}return N.write_shift(1,0),N}function d(T,K,B){var N=f(T,K,B);return N[1].v=T.read_shift(2,"i"),N}function h(T,K,B){var N=at(7);return N.write_shift(1,255),N.write_shift(2,K),N.write_shift(2,T),N.write_shift(2,B,"i"),N}function x(T,K,B){var N=f(T,K,B);return N[1].v=T.read_shift(8,"f"),N}function p(T,K,B){var N=at(13);return N.write_shift(1,255),N.write_shift(2,K),N.write_shift(2,T),N.write_shift(8,B,"f"),N}function m(T,K,B){var N=T.l+K,ie=f(T,K,B);if(ie[1].v=T.read_shift(8,"f"),B.qpro)T.l=N;else{var pe=T.read_shift(2);k(T.slice(T.l,T.l+pe),ie),T.l+=pe}return ie}function g(T,K,B){var N=K&32768;return K&=-32769,K=(N?T:0)+(K>=8192?K-16384:K),(N?"":"$")+(B?it(K):xt(K))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(T,K){dt(T,0);for(var B=[],N=0,ie="",pe="",le="",fe="";T.l<T.length;){var he=T[T.l++];switch(he){case 0:B.push(T.read_shift(8,"f"));break;case 1:pe=g(K[0].c,T.read_shift(2),!0),ie=g(K[0].r,T.read_shift(2),!1),B.push(pe+ie);break;case 2:{var be=g(K[0].c,T.read_shift(2),!0),V=g(K[0].r,T.read_shift(2),!1);pe=g(K[0].c,T.read_shift(2),!0),ie=g(K[0].r,T.read_shift(2),!1),B.push(be+V+":"+pe+ie)}break;case 3:if(T.l<T.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(T.read_shift(2));break;case 6:{for(var Ue="";he=T[T.l++];)Ue+=String.fromCharCode(he);B.push('"'+Ue.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:fe=B.pop(),le=B.pop(),B.push(["AND","OR"][he-20]+"("+le+","+fe+")");break;default:if(he<32&&v[he])fe=B.pop(),le=B.pop(),B.push(le+v[he]+fe);else if(w[he]){if(N=w[he][1],N==69&&(N=T[T.l++]),N>B.length){console.error("WK1 bad formula parse 0x"+he.toString(16)+":|"+B.join("|")+"|");return}var y=B.slice(-N);B.length-=N,B.push(w[he][0]+"("+y.join(",")+")")}else return he<=7?console.error("WK1 invalid opcode "+he.toString(16)):he<=24?console.error("WK1 unsupported op "+he.toString(16)):he<=30?console.error("WK1 invalid opcode "+he.toString(16)):he<=115?console.error("WK1 unsupported function opcode "+he.toString(16)):console.error("WK1 unrecognized opcode "+he.toString(16))}}B.length==1?K[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function A(T){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=T.read_shift(2),K[3]=T[T.l++],K[0].c=T[T.l++],K}function F(T,K){var B=A(T);return B[1].t="s",B[1].v=T.read_shift(K-4,"cstr"),B}function E(T,K,B,N){var ie=at(6+N.length);ie.write_shift(2,T),ie.write_shift(1,B),ie.write_shift(1,K),ie.write_shift(1,39);for(var pe=0;pe<N.length;++pe){var le=N.charCodeAt(pe);ie.write_shift(1,le>=128?95:le)}return ie.write_shift(1,0),ie}function z(T,K){var B=A(T);B[1].v=T.read_shift(2);var N=B[1].v>>1;if(B[1].v&1)switch(N&7){case 0:N=(N>>3)*5e3;break;case 1:N=(N>>3)*500;break;case 2:N=(N>>3)/20;break;case 3:N=(N>>3)/200;break;case 4:N=(N>>3)/2e3;break;case 5:N=(N>>3)/2e4;break;case 6:N=(N>>3)/16;break;case 7:N=(N>>3)/64;break}return B[1].v=N,B}function C(T,K){var B=A(T),N=T.read_shift(4),ie=T.read_shift(4),pe=T.read_shift(2);if(pe==65535)return N===0&&ie===3221225472?(B[1].t="e",B[1].v=15):N===0&&ie===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var le=pe&32768;return pe=(pe&32767)-16446,B[1].v=(1-le*2)*(ie*Math.pow(2,pe+32)+N*Math.pow(2,pe)),B}function G(T,K,B,N){var ie=at(14);if(ie.write_shift(2,T),ie.write_shift(1,B),ie.write_shift(1,K),N==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var pe=0,le=0,fe=0,he=0;return N<0&&(pe=1,N=-N),le=Math.log2(N)|0,N/=Math.pow(2,le-31),he=N>>>0,(he&2147483648)==0&&(N/=2,++le,he=N>>>0),N-=he,he|=2147483648,he>>>=0,N*=Math.pow(2,32),fe=N>>>0,ie.write_shift(4,fe),ie.write_shift(4,he),le+=16383+(pe?32768:0),ie.write_shift(2,le),ie}function H(T,K){var B=C(T);return T.l+=K-14,B}function b(T,K){var B=A(T),N=T.read_shift(4);return B[1].v=N>>6,B}function X(T,K){var B=A(T),N=T.read_shift(8,"f");return B[1].v=N,B}function _(T,K){var B=X(T);return T.l+=K-10,B}function W(T,K){return T[T.l+K-1]==0?T.read_shift(K,"cstr"):""}function q(T,K){var B=T[T.l++];B>K-1&&(B=K-1);for(var N="";N.length<B;)N+=String.fromCharCode(T[T.l++]);return N}function j(T,K,B){if(!(!B.qpro||K<21)){var N=T.read_shift(1);T.l+=17,T.l+=1,T.l+=2;var ie=T.read_shift(K-21,"cstr");return[N,ie]}}function ue(T,K){for(var B={},N=T.l+K;T.l<N;){var ie=T.read_shift(2);if(ie==14e3){for(B[ie]=[0,""],B[ie][0]=T.read_shift(2);T[T.l];)B[ie][1]+=String.fromCharCode(T[T.l]),T.l++;T.l++}}return B}function P(T,K){var B=at(5+T.length);B.write_shift(2,14e3),B.write_shift(2,K);for(var N=0;N<T.length;++N){var ie=T.charCodeAt(N);B[B.l++]=ie>127?95:ie}return B[B.l++]=0,B}var se={0:{n:"BOF",f:tt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:l},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:l},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:W},222:{n:"SHEETNAMELP",f:q},65535:{n:""}},Y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ue},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:b},38:{n:"??"},39:{n:"NUMBER27",f:X},40:{n:"FORMULA28",f:_},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:W},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:j},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}}();function fw(e){var r={},t=e.match(bt),n=0,a=!1;if(t)for(;n!=t.length;++n){var i=Ce(t[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;r.cp=ec[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=i.val;break;case"<sz":r.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":i.rgb&&(r.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return r}var lw=function(){var e=Aa("t"),r=Aa("rPr");function t(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:ze(s[1])},c=i.match(r);return c&&(o.s=fw(c[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(t).filter(function(o){return o.v})}}(),uw=function(){var r=/(\r\n|\n)/g;function t(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&t(a.s,i[0],i[2]),i[0].join("")+i[1].replace(r,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),hw=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,dw=/<(?:\w+:)?r>/,pw=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function gc(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ze(Ve(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ve(e),t&&(n.h=oc(n.t))):e.match(dw)&&(n.r=Ve(e),n.t=ze(Ve((e.replace(pw,"").match(hw)||[]).join("").replace(bt,""))),t&&(n.h=uw(lw(n.r)))),n):{t:""}}var xw=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,mw=/<(?:\w+:)?(?:si|sstItem)>/g,gw=/<\/(?:\w+:)?(?:si|sstItem)>/;function _w(e,r){var t=[],n="";if(!e)return t;var a=e.match(xw);if(a){n=a[2].replace(mw,"").split(gw);for(var i=0;i!=n.length;++i){var s=gc(n[i].trim(),r);s!=null&&(t[t.length]=s)}a=Ce(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function vw(e){return[e.read_shift(4),e.read_shift(4)]}function ww(e,r){var t=[],n=!1;return Or(e,function(i,s,o){switch(o){case 159:t.Count=i[0],t.Unique=i[1];break;case 19:t.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function Bu(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function Fr(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function yw(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Fr(e,4),r.U=Fr(e,4),r.W=Fr(e,4),r}function kw(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function Ew(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(kw(e));return r}function Tw(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function bw(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Fr(e,4),r.U=Fr(e,4),r.W=Fr(e,4),r}function Aw(e){var r=bw(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function Uu(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function zu(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function Sw(e){var r=Fr(e);switch(r.Minor){case 2:return[r.Minor,Cw(e)];case 3:return[r.Minor,Fw()];case 4:return[r.Minor,Rw(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function Cw(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=Uu(e,t),a=zu(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Fw(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Rw(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(bt,function(i){var s=Ce(i);switch(vr(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function Iw(e,r){var t={},n=t.EncryptionVersionInfo=Fr(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var a=e.read_shift(4);return r-=4,t.EncryptionHeader=Uu(e,a),r-=a,t.EncryptionVerifier=zu(e,r),t}function Ow(e){var r={},t=r.EncryptionVersionInfo=Fr(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function Dw(e){var r=0,t,n=Bu(e),a=n.length+1,i,s,o,c,f;for(t=$r(a),t[0]=n.length,i=1;i!=a;++i)t[i]=n[i-1];for(i=a-1;i>=0;--i)s=t[i],o=(r&16384)===0?0:1,c=r<<1&32767,f=o|c,r=f^s;return r^52811}var $u=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=r[s.length-1],c=104,f=s.length-1;f>=0;--f)for(var l=s[f],u=0;u!=7;++u)l&64&&(o^=t[c]),l*=2,--c;return o};return function(s){for(var o=Bu(s),c=i(o),f=o.length,l=$r(16),u=0;u!=16;++u)l[u]=0;var d,h,x;for((f&1)===1&&(d=c>>8,l[f]=a(e[0],d),--f,d=c&255,h=o[o.length-1],l[f]=a(h,d));f>0;)--f,d=c>>8,l[f]=a(o[f],d),--f,d=c&255,l[f]=a(o[f],d);for(f=15,x=15-o.length;x>0;)d=c>>8,l[f]=a(e[x],d),--f,--x,d=c&255,l[f]=a(o[f],d),--f,--x;return l}}(),Pw=function(e,r,t,n,a){a||(a=r),n||(n=$u(e));var i,s;for(i=0;i!=r.length;++i)s=r[i],s^=n[t],s=(s>>5|s<<3)&255,a[i]=s,++t;return[a,t,n]},Nw=function(e){var r=0,t=$u(e);return function(n){var a=Pw("",n,r,t);return r=a[1],a[0]}};function Mw(e,r,t,n){var a={key:tt(e),verificationBytes:tt(e)};return t.password&&(a.verifier=Dw(t.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Nw(t.password)),a}function Lw(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Ow(e):n.Data=Iw(e,r),n}function Bw(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?Lw(e,r-2,n):Mw(e,t.biff>=8?r:r-2,t,n),n}var Uw=function(){function e(a,i){switch(i.type){case"base64":return r(Ht(a),i);case"binary":return r(a,i);case"buffer":return r(Ne&&Buffer.isBuffer(a)?a.toString("binary"):un(a),i);case"array":return r(cn(a),i)}throw new Error("Unrecognized type "+i.type)}function r(a,i){var s=i||{},o=s.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(l,u){Array.isArray(o)&&(o[u]=[]);for(var d=/\\\w+\b/g,h=0,x,p=-1;x=d.exec(l);){switch(x[0]){case"\\cell":var m=l.slice(h,d.lastIndex-x[0].length);if(m[0]==" "&&(m=m.slice(1)),++p,m.length){var g={v:m,t:"s"};Array.isArray(o)?o[u][p]=g:o[Re({r:u,c:p})]=g}break}h=d.lastIndex}p>f.e.c&&(f.e.c=p)}),o["!ref"]=Be(f),o}function t(a,i){return Wr(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=Ze(a["!ref"]),o,c=Array.isArray(a),f=s.s.r;f<=s.e.r;++f){i.push("\\trowd\\trautofit1");for(var l=s.s.c;l<=s.e.c;++l)i.push("\\cellx"+(l+1));for(i.push("\\pard\\intbl"),l=s.s.c;l<=s.e.c;++l){var u=Re({r:f,c:l});o=c?(a[f]||[])[l]:a[u],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Ir(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function zw(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Fa(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function $w(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,a=Math.max(r,t,n),i=Math.min(r,t,n),s=a-i;if(s===0)return[0,0,r];var o=0,c=0,f=a+i;switch(c=s/(f>1?2-f:f),a){case r:o=((t-n)/s+6)%6;break;case t:o=(n-r)/s+2;break;case n:o=(r-t)/s+4;break}return[o/6,c,f/2]}function Hw(e){var r=e[0],t=e[1],n=e[2],a=t*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*r,c;if(t!==0)switch(o|0){case 0:case 6:c=a*o,s[0]+=a,s[1]+=c;break;case 1:c=a*(2-o),s[0]+=c,s[1]+=a;break;case 2:c=a*(o-2),s[1]+=a,s[2]+=c;break;case 3:c=a*(4-o),s[1]+=c,s[2]+=a;break;case 4:c=a*(o-4),s[2]+=a,s[0]+=c;break;case 5:c=a*(6-o),s[2]+=c,s[0]+=a;break}for(var f=0;f!=3;++f)s[f]=Math.round(s[f]*255);return s}function Qi(e,r){if(r===0)return e;var t=$w(zw(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Fa(Hw(t))}var Hu=6,Ww=15,Vw=1,Ct=Hu;function es(e){return Math.floor((e+Math.round(128/Ct)/256)*Ct)}function ts(e){return Math.floor((e-5)/Ct*100+.5)/100}function ko(e){return Math.round((e*Ct+5)/Ct*256)/256}function Ls(e){return ko(ts(es(e)))}function _c(e){var r=Math.abs(e-Ls(e)),t=Ct;if(r>.005)for(Ct=Vw;Ct<Ww;++Ct)Math.abs(e-Ls(e))<=r&&(r=Math.abs(e-Ls(e)),t=Ct);Ct=t}function zn(e){e.width?(e.wpx=es(e.width),e.wch=ts(e.wpx),e.MDW=Ct):e.wpx?(e.wch=ts(e.wpx),e.width=ko(e.wch),e.MDW=Ct):typeof e.wch=="number"&&(e.width=ko(e.wch),e.wpx=es(e.width),e.MDW=Ct),e.customWidth&&delete e.customWidth}var Gw=96,Wu=Gw;function Vu(e){return e*96/Wu}function Ra(e){return e*Wu/96}var Xw={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function jw(e,r,t,n){r.Borders=[];var a={},i=!1;(e[0].match(bt)||[]).forEach(function(s){var o=Ce(s);switch(vr(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Ge(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Ge(o.diagonalDown)),r.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function Yw(e,r,t,n){r.Fills=[];var a={},i=!1;(e[0].match(bt)||[]).forEach(function(s){var o=Ce(s);switch(vr(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},r.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function Kw(e,r,t,n){r.Fonts=[];var a={},i=!1;(e[0].match(bt)||[]).forEach(function(s){var o=Ce(s);switch(vr(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=Ve(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Ge(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Ge(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Ge(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Ge(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Ge(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Ge(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Ge(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=ec[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Ge(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=nn[a.color.index];a.color.index==81&&(c=nn[1]),c||(c=nn[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Qi(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function qw(e,r,t){r.NumberFmt=[];for(var n=gr(Oe),a=0;a<n.length;++a)r.NumberFmt[n[a]]=Oe[n[a]];var i=e[0].match(bt);if(i)for(a=0;a<i.length;++a){var s=Ce(i[a]);switch(vr(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ze(Ve(s.formatCode)),c=parseInt(s.numFmtId,10);if(r.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&r.NumberFmt[c]!=null;--c);r.NumberFmt[c]=o}rn(o,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var li=["numFmtId","fillId","fontId","borderId","xfId"],ui=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Zw(e,r,t){r.CellXf=[];var n,a=!1;(e[0].match(bt)||[]).forEach(function(i){var s=Ce(i),o=0;switch(vr(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<li.length;++o)n[li[o]]&&(n[li[o]]=parseInt(n[li[o]],10));for(o=0;o<ui.length;++o)n[ui[o]]&&(n[ui[o]]=Ge(n[ui[o]]));if(r.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[o]){n.numFmtId=o;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=Ge(s.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var Jw=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,f){var l={};if(!o)return l;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var u;return(u=o.match(r))&&qw(u,l,f),(u=o.match(a))&&Kw(u,l,c,f),(u=o.match(n))&&Yw(u,l,c,f),(u=o.match(i))&&jw(u,l,c,f),(u=o.match(t))&&Zw(u,l,f),l}}();function Qw(e,r){var t=e.read_shift(2),n=Et(e);return[t,n]}function ey(e,r,t){var n={};n.sz=e.read_shift(2)/20;var a=lv(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=fv(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Et(e),n}var ty=Tt;function ry(e,r){var t=e.l+r,n=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:a}}var ny=Tt;function ay(e,r,t){var n={};n.NumberFmt=[];for(var a in Oe)n.NumberFmt[a]=Oe[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return Or(e,function(c,f,l){switch(l){case 44:n.NumberFmt[c[0]]=c[1],rn(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(c.color.rgb=Qi(r.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(l),s=!0;break;case 38:i.pop(),s=!1;break;default:if(f.T>0)i.push(l);else if(f.T<0)i.pop();else if(!s||t.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}var iy=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function sy(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(bt)||[]).forEach(function(a){var i=Ce(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(r.themeElements.clrScheme[iy.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function oy(){}function cy(){}var fy=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,ly=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,uy=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function hy(e,r,t){r.themeElements={};var n;[["clrScheme",fy,sy],["fontScheme",ly,oy],["fmtScheme",uy,cy]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,r,t)})}var dy=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Gu(e,r){(!e||e.length===0)&&(e=py());var t,n={};if(!(t=e.match(dy)))throw new Error("themeElements not found in theme");return hy(t[0],n,r),n.raw=e,n}function py(e,r){var t=[ru];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function xy(e,r,t){var n=e.l+r,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=tu(i,{type:"array"})}catch{return}var o=zt(s,"theme/theme/theme1.xml",!0);if(o)return Gu(o,t)}}function my(e){return e.read_shift(4)}function gy(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=_y(e,4);break;case 2:r.xclrValue=Iu(e);break;case 3:r.xclrValue=my(e);break;case 4:e.l+=4;break}return e.l+=8,r}function _y(e,r){return Tt(e,r)}function vy(e,r){return Tt(e,r)}function wy(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=gy(e);break;case 6:n[1]=vy(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function yy(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(wy(e,t-e.l));return{ixfe:n,ext:i}}function ky(e,r){r.forEach(function(t){t[0]})}function Ey(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Et(e)}}function Ty(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function by(e){return e.l+=4,e.read_shift(4)!=0}function Ay(e,r,t){var n={Types:[],Cell:[],Value:[]},a=t||{},i=[],s=!1,o=2;return Or(e,function(c,f,l){switch(l){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(u){o==1?n.Cell.push({type:n.Types[u[0]-1].name,index:u[1]}):o==0&&n.Value.push({type:n.Types[u[0]-1].name,index:u[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(l),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!f.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+l.toString(16))}}}),n}function Sy(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(bt,function(o){var c=Ce(o);switch(vr(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==c.name&&(s=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function Cy(e){var r=[];if(!e)return r;var t=1;return(e.match(bt)||[]).forEach(function(n){var a=Ce(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,r.push(a);break}}),r}function Fy(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Re(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function Ry(e,r,t){var n=[];return Or(e,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function Iy(e,r,t,n){if(!e)return e;var a=n||{},i=!1;Or(e,function(o,c,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function Oy(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function pf(e,r,t,n){var a=Array.isArray(e),i;r.forEach(function(s){var o=Ft(s.ref);if(a?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e[o.r][o.c]=i:e[s.ref]=i;var c=Ze(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var f=Be(c);f!==e["!ref"]&&(e["!ref"]=f)}i.c||(i.c=[]);var l={a:s.author,t:s.t,r:s.r,T:t};s.h&&(l.h=s.h);for(var u=i.c.length-1;u>=0;--u){if(!t&&i.c[u].T)return;t&&!i.c[u].T&&i.c.splice(u,1)}if(t&&n){for(u=0;u<n.length;++u)if(l.a==n[u].id){l.a=n[u].name||l.a;break}}i.c.push(l)})}function Dy(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Ce(o[0]),f={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},l=Ft(c.ref);if(!(r.sheetRows&&r.sheetRows<=l.r)){var u=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!u&&!!u[1]&&gc(u[1])||{r:"",t:"",h:""};f.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),f.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(f.h=d.h),n.push(f)}}}}),n}function Py(e,r){var t=[],n=!1,a={},i=0;return e.replace(bt,function(o,c){var f=Ce(o);switch(vr(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":a.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return o}),t}function Ny(e,r){var t=[],n=!1;return e.replace(bt,function(i){var s=Ce(i);switch(vr(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),t}function My(e){var r={};r.iauthor=e.read_shift(4);var t=dn(e);return r.rfx=t.s,r.ref=Re(t.s),e.l+=16,r}var Ly=Et;function By(e,r){var t=[],n=[],a={},i=!1;return Or(e,function(o,c,f){switch(f){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||r.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),t}var Uy="application/vnd.ms-office.vbaProject";function zy(e){var r=Le.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Le.utils.cfb_add(r,a,e.FileIndex[n].content)}}),Le.write(r)}function $y(){return{"!type":"dialog"}}function Hy(){return{"!type":"dialog"}}function Wy(){return{"!type":"macro"}}function Vy(){return{"!type":"macro"}}var Fn=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,a,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var f=i.length>0?parseInt(i,10)|0:0,l=s.length>0?parseInt(s,10)|0:0;return o?l+=r.c:--l,c?f+=r.r:--f,a+(o?"":"$")+it(l)+(c?"":"$")+xt(f)}return function(a,i){return r=i,a.replace(e,t)}}(),Xu=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Gy=function(){return function(r,t){return r.replace(Xu,function(n,a,i,s,o,c){var f=uc(s)-(i?0:t.c),l=lc(c)-(o?0:t.r),u=l==0?"":o?l+1:"["+l+"]",d=f==0?"":i?f+1:"["+f+"]";return a+"R"+u+"C"+d})}}();function ju(e,r){return e.replace(Xu,function(t,n,a,i,s,o){return n+(a=="$"?a+i:it(uc(i)+r.c))+(s=="$"?s+o:xt(lc(o)+r.r))})}function Xy(e,r,t){var n=Wn(r),a=n.s,i=Ft(t),s={r:i.r-a.r,c:i.c-a.c};return ju(e,s)}function jy(e){return e.length!=1}function xf(e){return e.replace(/_xlfn\./g,"")}function Qe(e){e.l+=1}function Hr(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Yu(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Ku(e);t.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=Hr(e),o=Hr(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Ku(e){var r=Hr(e),t=Hr(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function Yy(e,r,t){if(t.biff<8)return Ku(e);var n=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),i=Hr(e),s=Hr(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function qu(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return Ky(e);var n=e.read_shift(t&&t.biff==12?4:2),a=Hr(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Ky(e){var r=Hr(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function qy(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function Zy(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return Jy(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function Jy(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:n}}function Qy(e,r,t){var n=(e[e.l++]&96)>>5,a=Yu(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function ek(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=Yu(e,i,t);return[n,a,s]}function tk(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function rk(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function nk(e,r,t){var n=(e[e.l++]&96)>>5,a=Yy(e,r-1,t);return[n,a]}function ak(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function mf(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function ik(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function sk(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function ok(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function ck(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function fk(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function Zu(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function lk(e){return e.read_shift(2),Zu(e)}function uk(e){return e.read_shift(2),Zu(e)}function hk(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=qu(e,0,t);return[n,a]}function dk(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=Zy(e,0,t);return[n,a]}function pk(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var i=qu(e,0,t);return[n,a,i]}function xk(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[mE[a],eh[a],n]}function mk(e,r,t){var n=e[e.l++],a=e.read_shift(1),i=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:gk(e);return[a,(i[0]===0?eh:xE)[i[1]]]}function gk(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function _k(e,r,t){e.l+=t&&t.biff==2?3:4}function vk(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function wk(e){return e.l++,pn[e.read_shift(1)]}function yk(e){return e.l++,e.read_shift(2)}function kk(e){return e.l++,e.read_shift(1)!==0}function Ek(e){return e.l++,yt(e)}function Tk(e,r,t){return e.l++,Ba(e,r-1,t)}function bk(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Je(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=pn[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=yt(e);break;case 2:t[1]=xn(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Ak(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((t.biff==12?dn:us)(e));return a}function Sk(e,r,t){var n=0,a=0;t.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=bk(e,t.biff);return s}function Ck(e,r,t){var n=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,i=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function Fk(e,r,t){if(t.biff==5)return Rk(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function Rk(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function Ik(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function Ok(e,r,t){var n=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function Dk(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function Pk(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var Nk=Tt,Mk=Tt,Lk=Tt;function za(e,r,t){return e.l+=2,[qy(e)]}function vc(e){return e.l+=6,[]}var Bk=za,Uk=vc,zk=vc,$k=za;function Ju(e){return e.l+=2,[tt(e),e.read_shift(2)&1]}var Hk=za,Wk=Ju,Vk=vc,Gk=za,Xk=za,jk=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Yk(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=jk[t>>2&31];return{ixti:r,coltype:t&3,rt:s,idx:n,c:a,C:i}}function Kk(e){return e.l+=2,[e.read_shift(4)]}function qk(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function Zk(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function Jk(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function Qk(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function eE(e){return e.l+=4,[0,0]}var gf={1:{n:"PtgExp",f:vk},2:{n:"PtgTbl",f:Lk},3:{n:"PtgAdd",f:Qe},4:{n:"PtgSub",f:Qe},5:{n:"PtgMul",f:Qe},6:{n:"PtgDiv",f:Qe},7:{n:"PtgPower",f:Qe},8:{n:"PtgConcat",f:Qe},9:{n:"PtgLt",f:Qe},10:{n:"PtgLe",f:Qe},11:{n:"PtgEq",f:Qe},12:{n:"PtgGe",f:Qe},13:{n:"PtgGt",f:Qe},14:{n:"PtgNe",f:Qe},15:{n:"PtgIsect",f:Qe},16:{n:"PtgUnion",f:Qe},17:{n:"PtgRange",f:Qe},18:{n:"PtgUplus",f:Qe},19:{n:"PtgUminus",f:Qe},20:{n:"PtgPercent",f:Qe},21:{n:"PtgParen",f:Qe},22:{n:"PtgMissArg",f:Qe},23:{n:"PtgStr",f:Tk},26:{n:"PtgSheet",f:qk},27:{n:"PtgEndSheet",f:Zk},28:{n:"PtgErr",f:wk},29:{n:"PtgBool",f:kk},30:{n:"PtgInt",f:yk},31:{n:"PtgNum",f:Ek},32:{n:"PtgArray",f:ak},33:{n:"PtgFunc",f:xk},34:{n:"PtgFuncVar",f:mk},35:{n:"PtgName",f:Ck},36:{n:"PtgRef",f:hk},37:{n:"PtgArea",f:Qy},38:{n:"PtgMemArea",f:Ik},39:{n:"PtgMemErr",f:Nk},40:{n:"PtgMemNoMem",f:Mk},41:{n:"PtgMemFunc",f:Ok},42:{n:"PtgRefErr",f:Dk},43:{n:"PtgAreaErr",f:tk},44:{n:"PtgRefN",f:dk},45:{n:"PtgAreaN",f:nk},46:{n:"PtgMemAreaN",f:Jk},47:{n:"PtgMemNoMemN",f:Qk},57:{n:"PtgNameX",f:Fk},58:{n:"PtgRef3d",f:pk},59:{n:"PtgArea3d",f:ek},60:{n:"PtgRefErr3d",f:Pk},61:{n:"PtgAreaErr3d",f:rk},255:{}},tE={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},rE={1:{n:"PtgElfLel",f:Ju},2:{n:"PtgElfRw",f:Gk},3:{n:"PtgElfCol",f:Bk},6:{n:"PtgElfRwV",f:Xk},7:{n:"PtgElfColV",f:$k},10:{n:"PtgElfRadical",f:Hk},11:{n:"PtgElfRadicalS",f:Vk},13:{n:"PtgElfColS",f:Uk},15:{n:"PtgElfColSV",f:zk},16:{n:"PtgElfRadicalLel",f:Wk},25:{n:"PtgList",f:Yk},29:{n:"PtgSxName",f:Kk},255:{}},nE={0:{n:"PtgAttrNoop",f:eE},1:{n:"PtgAttrSemi",f:fk},2:{n:"PtgAttrIf",f:ok},4:{n:"PtgAttrChoose",f:ik},8:{n:"PtgAttrGoto",f:sk},16:{n:"PtgAttrSum",f:_k},32:{n:"PtgAttrBaxcel",f:mf},33:{n:"PtgAttrBaxcel",f:mf},64:{n:"PtgAttrSpace",f:lk},65:{n:"PtgAttrSpaceSemi",f:uk},128:{n:"PtgAttrIfError",f:ck},255:{}};function $a(e,r,t,n){if(n.biff<8)return Tt(e,r);for(var a=e.l+r,i=[],s=0;s!==t.length;++s)switch(t[s][0]){case"PtgArray":t[s][1]=Sk(e,0,n),i.push(t[s][1]);break;case"PtgMemArea":t[s][2]=Ak(e,t[s][1],n),i.push(t[s][2]);break;case"PtgExp":n&&n.biff==12&&(t[s][1][1]=e.read_shift(4),i.push(t[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[s][0]}return r=a-e.l,r!==0&&i.push(Tt(e,r)),i}function Ha(e,r,t){for(var n=e.l+r,a,i,s=[];n!=e.l;)r=n-e.l,i=e[e.l],a=gf[i]||gf[tE[i]],(i===24||i===25)&&(a=(i===24?rE:nE)[e[e.l+1]]),!a||!a.f?Tt(e,r):s.push([a.n,a.f(e,r,t)]);return s}function aE(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var iE={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function sE(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Qu(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function _f(e,r,t){var n=Qu(e,r,t);return n=="#REF"?n:sE(n,t)}function wt(e,r,t,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},o=[],c,f,l,u=0,d=0,h,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,m="",g=0,w=e[0].length;g<w;++g){var v=e[0][g];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),f=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:m=qe(" ",e[0][p][1][1]);break;case 1:m=qe("\r",e[0][p][1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}f=f+m,p=-1}o.push(f+iE[v[0]]+c);break;case"PtgIsect":c=o.pop(),f=o.pop(),o.push(f+" "+c);break;case"PtgUnion":c=o.pop(),f=o.pop(),o.push(f+","+c);break;case"PtgRange":c=o.pop(),f=o.pop(),o.push(f+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":l=ha(v[1][1],s,a),o.push(da(l,i));break;case"PtgRefN":l=t?ha(v[1][1],t,a):v[1][1],o.push(da(l,i));break;case"PtgRef3d":u=v[1][1],l=ha(v[1][2],s,a),x=_f(n,u,a),o.push(x+"!"+da(l,i));break;case"PtgFunc":case"PtgFuncVar":var k=v[1][0],A=v[1][1];k||(k=0),k&=127;var F=k==0?[]:o.slice(-k);o.length-=k,A==="User"&&(A=F.shift()),o.push(A+"("+F.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":h=Z0(v[1][1],t?{s:t}:s,a),o.push(Ns(h,a));break;case"PtgArea":h=Z0(v[1][1],s,a),o.push(Ns(h,a));break;case"PtgArea3d":u=v[1][1],h=v[1][2],x=_f(n,u,a),o.push(x+"!"+Ns(h,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=v[1][2];var E=(n.names||[])[d-1]||(n[0]||[])[d],z=E?E.Name:"SH33TJSNAME"+String(d);z&&z.slice(0,6)=="_xlfn."&&!a.xlfn&&(z=z.slice(6)),o.push(z);break;case"PtgNameX":var C=v[1][1];d=v[1][2];var G;if(a.biff<=5)C<0&&(C=-C),n[C]&&(G=n[C][d]);else{var H="";if(((n[C]||[])[0]||[])[0]==14849||(((n[C]||[])[0]||[])[0]==1025?n[C][d]&&n[C][d].itab>0&&(H=n.SheetNames[n[C][d].itab-1]+"!"):H=n.SheetNames[d-1]+"!"),n[C]&&n[C][d])H+=n[C][d].Name;else if(n[0]&&n[0][d])H+=n[0][d].Name;else{var b=(Qu(n,C,a)||"").split(";;");b[d-1]?H=b[d-1]:H+="SH33TJSERRX"}o.push(H);break}G||(G={Name:"SH33TJSERRY"}),o.push(G.Name);break;case"PtgParen":var X="(",_=")";if(p>=0){switch(m="",e[0][p][1][0]){case 2:X=qe(" ",e[0][p][1][1])+X;break;case 3:X=qe("\r",e[0][p][1][1])+X;break;case 4:_=qe(" ",e[0][p][1][1])+_;break;case 5:_=qe("\r",e[0][p][1][1])+_;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(X+o.pop()+_);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":l={c:v[1][1],r:v[1][0]};var W={c:t.c,r:t.r};if(n.sharedf[Re(l)]){var q=n.sharedf[Re(l)];o.push(wt(q,s,W,n,a))}else{var j=!1;for(c=0;c!=n.arrayf.length;++c)if(f=n.arrayf[c],!(l.c<f[0].s.c||l.c>f[0].e.c)&&!(l.r<f[0].s.r||l.r>f[0].e.r)){o.push(wt(f[1],s,W,n,a)),j=!0;break}j||o.push(v[1])}break;case"PtgArray":o.push("{"+aE(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var ue=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&ue.indexOf(e[0][g][0])==-1){v=e[0][p];var P=!0;switch(v[1][0]){case 4:P=!1;case 0:m=qe(" ",v[1][1]);break;case 5:P=!1;case 1:m=qe("\r",v[1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((P?m:"")+o.pop()+(P?"":m)),p=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function oE(e,r,t){var n=e.l+r,a=t.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Tt(e,r-2)];var o=Ha(e,s,t);return r!==s+a&&(i=$a(e,r-s-a,o,t)),e.l=n,[o,i]}function cE(e,r,t){var n=e.l+r,a=t.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Tt(e,r-2)];var o=Ha(e,s,t);return r!==s+a&&(i=$a(e,r-s-a,o,t)),e.l=n,[o,i]}function fE(e,r,t,n){var a=e.l+r,i=Ha(e,n,t),s;return a!==e.l&&(s=$a(e,a-e.l,i,t)),[i,s]}function lE(e,r,t){var n=e.l+r,a,i=e.read_shift(2),s=Ha(e,i,t);return i==65535?[[],Tt(e,r-2)]:(r!==i+2&&(a=$a(e,n-i-2,s,t)),[s,a])}function uE(e){var r;if(Sr(e,e.l+6)!==65535)return[yt(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Bs(e,r,t){var n=e.l+r,a=wr(e);t.biff==2&&++e.l;var i=uE(e),s=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var o=cE(e,n-e.l,t);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function hs(e,r,t){var n=e.read_shift(4),a=Ha(e,n,t),i=e.read_shift(4),s=i>0?$a(e,i,a,t):null;return[a,s]}var hE=hs,ds=hs,dE=hs,pE=hs,xE={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},eh={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},mE={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function vf(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Us(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var ga={},Rn={};function _a(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function th(e,r,t,n,a,i){try{n.cellNF&&(e.z=Oe[r])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=lt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Oe[r]==null&&rn(g_[r]||"General",r),e.t==="e")e.w=e.w||pn[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ba(e.v);else if(e.t==="d"){var s=It(e.v);(s|0)===s?e.w=s.toString(10):e.w=ba(s)}else{if(e.v===void 0)return"";e.w=on(e.v,Rn)}else e.t==="d"?e.w=Kt(r,It(e.v),Rn):e.w=Kt(r,e.v,Rn)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&t!=null)try{e.s=i.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Qi(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Qi(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function gE(e,r){var t=Ze(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Be(t))}var _E=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,vE=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,wE=/<(?:\w:)?hyperlink [^>]*>/mg,yE=/"(\w*:\w*)"/,kE=/<(?:\w:)?col\b[^>]*[\/]?>/g,EE=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,TE=/<(?:\w:)?pageMargins[^>]*\/>/g,rh=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,bE=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,AE=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function SE(e,r,t,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o=r.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",l="",u=e.match(vE);u?(f=e.slice(0,u.index),l=e.slice(u.index+u[0].length)):f=l=e;var d=f.match(rh);d?wc(d[0],o,a,t):(d=f.match(bE))&&CE(d[0],d[1]||"",o,a,t);var h=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var x=f.slice(h,h+50).match(yE);x&&gE(o,x[1])}var p=f.match(AE);p&&p[1]&&PE(p[1],a);var m=[];if(r.cellStyles){var g=f.match(kE);g&&IE(m,g)}u&&NE(u[1],o,r,c,i,s);var w=l.match(EE);w&&(o["!autofilter"]=OE(w[0]));var v=[],k=l.match(_E);if(k)for(h=0;h!=k.length;++h)v[h]=Ze(k[h].slice(k[h].indexOf('"')+1));var A=l.match(wE);A&&FE(o,A,n);var F=l.match(TE);if(F&&(o["!margins"]=RE(Ce(F[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Be(c)),r.sheetRows>0&&o["!ref"]){var E=Ze(o["!ref"]);r.sheetRows<=+E.e.r&&(E.e.r=r.sheetRows-1,E.e.r>c.e.r&&(E.e.r=c.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>c.e.c&&(E.e.c=c.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Be(E))}return m.length>0&&(o["!cols"]=m),v.length>0&&(o["!merges"]=v),o}function wc(e,r,t,n){var a=Ce(e);t.Sheets[n]||(t.Sheets[n]={}),a.codeName&&(t.Sheets[n].CodeName=ze(Ve(a.codeName)))}function CE(e,r,t,n,a){wc(e.slice(0,e.indexOf(">")),t,n,a)}function FE(e,r,t){for(var n=Array.isArray(e),a=0;a!=r.length;++a){var i=Ce(Ve(r[a]),!0);if(!i.ref)return;var s=((t||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+ze(i.location))):(i.Target="#"+ze(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Ze(i.ref),c=o.s.r;c<=o.e.r;++c)for(var f=o.s.c;f<=o.e.c;++f){var l=Re({c:f,r:c});n?(e[c]||(e[c]=[]),e[c][f]||(e[c][f]={t:"z",v:void 0}),e[c][f].l=i):(e[l]||(e[l]={t:"z",v:void 0}),e[l].l=i)}}}function RE(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function IE(e,r){for(var t=!1,n=0;n!=r.length;++n){var a=Ce(r[n],!0);a.hidden&&(a.hidden=Ge(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,_c(a.width)),zn(a);i<=s;)e[i++]=pt(a)}}function OE(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var DE=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function PE(e,r){r.Views||(r.Views=[{}]),(e.match(DE)||[]).forEach(function(t,n){var a=Ce(t);r.Views[n]||(r.Views[n]={}),+a.zoomScale&&(r.Views[n].zoom=+a.zoomScale),Ge(a.rightToLeft)&&(r.Views[n].RTL=!0)})}var NE=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Aa("v"),s=Aa("f");return function(c,f,l,u,d,h){for(var x=0,p="",m=[],g=[],w=0,v=0,k=0,A="",F,E,z=0,C=0,G,H,b=0,X=0,_=Array.isArray(h.CellXf),W,q=[],j=[],ue=Array.isArray(f),P=[],se={},Y=!1,T=!!l.sheetStubs,K=c.split(r),B=0,N=K.length;B!=N;++B){p=K[B].trim();var ie=p.length;if(ie!==0){var pe=0;e:for(x=0;x<ie;++x)switch(p[x]){case">":if(p[x-1]!="/"){++x;break e}if(l&&l.cellStyles){if(E=Ce(p.slice(pe,x),!0),z=E.r!=null?parseInt(E.r,10):z+1,C=-1,l.sheetRows&&l.sheetRows<z)continue;se={},Y=!1,E.ht&&(Y=!0,se.hpt=parseFloat(E.ht),se.hpx=Ra(se.hpt)),E.hidden=="1"&&(Y=!0,se.hidden=!0),E.outlineLevel!=null&&(Y=!0,se.level=+E.outlineLevel),Y&&(P[z-1]=se)}break;case"<":pe=x;break}if(pe>=x)break;if(E=Ce(p.slice(pe,x),!0),z=E.r!=null?parseInt(E.r,10):z+1,C=-1,!(l.sheetRows&&l.sheetRows<z)){u.s.r>z-1&&(u.s.r=z-1),u.e.r<z-1&&(u.e.r=z-1),l&&l.cellStyles&&(se={},Y=!1,E.ht&&(Y=!0,se.hpt=parseFloat(E.ht),se.hpx=Ra(se.hpt)),E.hidden=="1"&&(Y=!0,se.hidden=!0),E.outlineLevel!=null&&(Y=!0,se.level=+E.outlineLevel),Y&&(P[z-1]=se)),m=p.slice(x).split(e);for(var le=0;le!=m.length&&m[le].trim().charAt(0)=="<";++le);for(m=m.slice(le),x=0;x!=m.length;++x)if(p=m[x].trim(),p.length!==0){if(g=p.match(t),w=x,v=0,k=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,g!=null&&g.length===2){for(w=0,A=g[1],v=0;v!=A.length&&!((k=A.charCodeAt(v)-64)<1||k>26);++v)w=26*w+k;--w,C=w}else++C;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,E=Ce(p.slice(0,v),!0),E.r||(E.r=Re({r:z-1,c:C})),A=p.slice(v),F={t:""},(g=A.match(i))!=null&&g[1]!==""&&(F.v=ze(g[1])),l.cellFormula){if((g=A.match(s))!=null&&g[1]!==""){if(F.f=ze(Ve(g[1])).replace(/\r\n/g,`
`),l.xlfn||(F.f=xf(F.f)),g[0].indexOf('t="array"')>-1)F.F=(A.match(a)||[])[1],F.F.indexOf(":")>-1&&q.push([Ze(F.F),F.F]);else if(g[0].indexOf('t="shared"')>-1){H=Ce(g[0]);var fe=ze(Ve(g[1]));l.xlfn||(fe=xf(fe)),j[parseInt(H.si,10)]=[H,fe,E.r]}}else(g=A.match(/<f[^>]*\/>/))&&(H=Ce(g[0]),j[H.si]&&(F.f=Xy(j[H.si][1],j[H.si][2],E.r)));var he=Ft(E.r);for(v=0;v<q.length;++v)he.r>=q[v][0].s.r&&he.r<=q[v][0].e.r&&he.c>=q[v][0].s.c&&he.c<=q[v][0].e.c&&(F.F=q[v][1])}if(E.t==null&&F.v===void 0)if(F.f||F.F)F.v=0,F.t="n";else if(T)F.t="z";else continue;else F.t=E.t||"n";switch(u.s.c>C&&(u.s.c=C),u.e.c<C&&(u.e.c=C),F.t){case"n":if(F.v==""||F.v==null){if(!T)continue;F.t="z"}else F.v=parseFloat(F.v);break;case"s":if(typeof F.v>"u"){if(!T)continue;F.t="z"}else G=ga[parseInt(F.v,10)],F.v=G.t,F.r=G.r,l.cellHTML&&(F.h=G.h);break;case"str":F.t="s",F.v=F.v!=null?Ve(F.v):"",l.cellHTML&&(F.h=oc(F.v));break;case"inlineStr":g=A.match(n),F.t="s",g!=null&&(G=gc(g[1]))?(F.v=G.t,l.cellHTML&&(F.h=G.h)):F.v="";break;case"b":F.v=Ge(F.v);break;case"d":l.cellDates?F.v=lt(F.v,1):(F.v=It(lt(F.v,1)),F.t="n");break;case"e":(!l||l.cellText!==!1)&&(F.w=F.v),F.v=Eu[F.v];break}if(b=X=0,W=null,_&&E.s!==void 0&&(W=h.CellXf[E.s],W!=null&&(W.numFmtId!=null&&(b=W.numFmtId),l.cellStyles&&W.fillId!=null&&(X=W.fillId))),th(F,b,X,l,d,h),l.cellDates&&_&&F.t=="n"&&Hn(Oe[b])&&(F.t="d",F.v=ls(F.v)),E.cm&&l.xlmeta){var be=(l.xlmeta.Cell||[])[+E.cm-1];be&&be.type=="XLDAPR"&&(F.D=!0)}if(ue){var V=Ft(E.r);f[V.r]||(f[V.r]=[]),f[V.r][V.c]=F}else f[E.r]=F}}}}P.length>0&&(f["!rows"]=P)}}();function ME(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(t.level=i&7),i&16&&(t.hidden=!0),i&32&&(t.hpt=a/20),t}var LE=dn;function BE(){}function UE(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=ov(e),t}function zE(e){var r=qt(e);return[r]}function $E(e){var r=hn(e);return[r]}function HE(e){var r=qt(e),t=e.read_shift(1);return[r,t,"b"]}function WE(e){var r=hn(e),t=e.read_shift(1);return[r,t,"b"]}function VE(e){var r=qt(e),t=e.read_shift(1);return[r,t,"e"]}function GE(e){var r=hn(e),t=e.read_shift(1);return[r,t,"e"]}function XE(e){var r=qt(e),t=e.read_shift(4);return[r,t,"s"]}function jE(e){var r=hn(e),t=e.read_shift(4);return[r,t,"s"]}function YE(e){var r=qt(e),t=yt(e);return[r,t,"n"]}function nh(e){var r=hn(e),t=yt(e);return[r,t,"n"]}function KE(e){var r=qt(e),t=pc(e);return[r,t,"n"]}function qE(e){var r=hn(e),t=pc(e);return[r,t,"n"]}function ZE(e){var r=qt(e),t=hc(e);return[r,t,"is"]}function JE(e){var r=qt(e),t=Et(e);return[r,t,"str"]}function QE(e){var r=hn(e),t=Et(e);return[r,t,"str"]}function eT(e,r,t){var n=e.l+r,a=qt(e);a.r=t["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(t.cellFormula){e.l+=2;var o=ds(e,n-e.l,t);s[3]=wt(o,null,a,t.supbooks,t)}else e.l=n;return s}function tT(e,r,t){var n=e.l+r,a=qt(e);a.r=t["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(t.cellFormula){e.l+=2;var o=ds(e,n-e.l,t);s[3]=wt(o,null,a,t.supbooks,t)}else e.l=n;return s}function rT(e,r,t){var n=e.l+r,a=qt(e);a.r=t["!row"];var i=yt(e),s=[a,i,"n"];if(t.cellFormula){e.l+=2;var o=ds(e,n-e.l,t);s[3]=wt(o,null,a,t.supbooks,t)}else e.l=n;return s}function nT(e,r,t){var n=e.l+r,a=qt(e);a.r=t["!row"];var i=Et(e),s=[a,i,"str"];if(t.cellFormula){e.l+=2;var o=ds(e,n-e.l,t);s[3]=wt(o,null,a,t.supbooks,t)}else e.l=n;return s}var aT=dn;function iT(e,r){var t=e.l+r,n=dn(e),a=dc(e),i=Et(e),s=Et(e),o=Et(e);e.l=t;var c={rfx:n,relId:a,loc:i,display:o};return s&&(c.Tooltip=s),c}function sT(){}function oT(e,r,t){var n=e.l+r,a=wu(e),i=e.read_shift(1),s=[a];if(s[2]=i,t.cellFormula){var o=hE(e,n-e.l,t);s[1]=o}else e.l=n;return s}function cT(e,r,t){var n=e.l+r,a=dn(e),i=[a];if(t.cellFormula){var s=pE(e,n-e.l,t);i[1]=s,e.l=n}else e.l=n;return i}var fT=["left","right","top","bottom","header","footer"];function lT(e){var r={};return fT.forEach(function(t){r[t]=yt(e)}),r}function uT(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function hT(){}function dT(){}function pT(e,r,t,n,a,i,s){if(!e)return e;var o=r||{};n||(n={"!id":{}});var c=o.dense?[]:{},f,l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=!1,d=!1,h,x,p,m,g,w,v,k,A,F=[];o.biff=12,o["!row"]=0;var E=0,z=!1,C=[],G={},H=o.supbooks||a.supbooks||[[]];if(H.sharedf=G,H.arrayf=C,H.SheetNames=a.SheetNames||a.Sheets.map(function(ue){return ue.name}),!o.supbooks&&(o.supbooks=H,a.Names))for(var b=0;b<a.Names.length;++b)H[0][b+1]=a.Names[b];var X=[],_=[],W=!1;rs[16]={n:"BrtShortReal",f:nh};var q;if(Or(e,function(P,se,Y){if(!d)switch(Y){case 148:f=P;break;case 0:h=P,o.sheetRows&&o.sheetRows<=h.r&&(d=!0),k=xt(m=h.r),o["!row"]=h.r,(P.hidden||P.hpt||P.level!=null)&&(P.hpt&&(P.hpx=Ra(P.hpt)),_[P.r]=P);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:P[2]},P[2]){case"n":x.v=P[1];break;case"s":v=ga[P[1]],x.v=v.t,x.r=v.r;break;case"b":x.v=!!P[1];break;case"e":x.v=P[1],o.cellText!==!1&&(x.w=pn[x.v]);break;case"str":x.t="s",x.v=P[1];break;case"is":x.t="s",x.v=P[1].t;break}if((p=s.CellXf[P[0].iStyleRef])&&th(x,p.numFmtId,null,o,i,s),g=P[0].c==-1?g+1:P[0].c,o.dense?(c[m]||(c[m]=[]),c[m][g]=x):c[it(g)+k]=x,o.cellFormula){for(z=!1,E=0;E<C.length;++E){var T=C[E];h.r>=T[0].s.r&&h.r<=T[0].e.r&&g>=T[0].s.c&&g<=T[0].e.c&&(x.F=Be(T[0]),z=!0)}!z&&P.length>3&&(x.f=P[3])}if(l.s.r>h.r&&(l.s.r=h.r),l.s.c>g&&(l.s.c=g),l.e.r<h.r&&(l.e.r=h.r),l.e.c<g&&(l.e.c=g),o.cellDates&&p&&x.t=="n"&&Hn(Oe[p.numFmtId])){var K=Qr(x.v);K&&(x.t="d",x.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}q&&(q.type=="XLDAPR"&&(x.D=!0),q=void 0);break;case 1:case 12:if(!o.sheetStubs||u)break;x={t:"z",v:void 0},g=P[0].c==-1?g+1:P[0].c,o.dense?(c[m]||(c[m]=[]),c[m][g]=x):c[it(g)+k]=x,l.s.r>h.r&&(l.s.r=h.r),l.s.c>g&&(l.s.c=g),l.e.r<h.r&&(l.e.r=h.r),l.e.c<g&&(l.e.c=g),q&&(q.type=="XLDAPR"&&(x.D=!0),q=void 0);break;case 176:F.push(P);break;case 49:q=((o.xlmeta||{}).Cell||[])[P-1];break;case 494:var B=n["!id"][P.relId];for(B?(P.Target=B.Target,P.loc&&(P.Target+="#"+P.loc),P.Rel=B):P.relId==""&&(P.Target="#"+P.loc),m=P.rfx.s.r;m<=P.rfx.e.r;++m)for(g=P.rfx.s.c;g<=P.rfx.e.c;++g)o.dense?(c[m]||(c[m]=[]),c[m][g]||(c[m][g]={t:"z",v:void 0}),c[m][g].l=P):(w=Re({c:g,r:m}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=P);break;case 426:if(!o.cellFormula)break;C.push(P),A=o.dense?c[m][g]:c[it(g)+k],A.f=wt(P[1],l,{r:h.r,c:g},H,o),A.F=Be(P[0]);break;case 427:if(!o.cellFormula)break;G[Re(P[0].s)]=P[1],A=o.dense?c[m][g]:c[it(g)+k],A.f=wt(P[1],l,{r:h.r,c:g},H,o);break;case 60:if(!o.cellStyles)break;for(;P.e>=P.s;)X[P.e--]={width:P.w/256,hidden:!!(P.flags&1),level:P.level},W||(W=!0,_c(P.w/256)),zn(X[P.e+1]);break;case 161:c["!autofilter"]={ref:Be(P)};break;case 476:c["!margins"]=P;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),P.name&&(a.Sheets[t].CodeName=P.name),(P.above||P.left)&&(c["!outline"]={above:P.above,left:P.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),P.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:u=!0;break;case 38:u=!1;break;default:if(!se.T){if(!u||o.WTF)throw new Error("Unexpected record 0x"+Y.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(l.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(c["!ref"]=Be(f||l)),o.sheetRows&&c["!ref"]){var j=Ze(c["!ref"]);o.sheetRows<=+j.e.r&&(j.e.r=o.sheetRows-1,j.e.r>l.e.r&&(j.e.r=l.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>l.e.c&&(j.e.c=l.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Be(j))}return F.length>0&&(c["!merges"]=F),X.length>0&&(c["!cols"]=X),_.length>0&&(c["!rows"]=_),c}function xT(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(r[+s[1]]=t?+s[2]:s[2])});var a=ze((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[r,a,n]}function mT(e,r,t,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,f="A",l={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var d=xT(u);l.s.r=l.s.c=0,l.e.c=o,f=it(o),d[0].forEach(function(h,x){s[f+xt(x)]={t:"n",v:h,z:d[1]},c=x}),l.e.r<c&&(l.e.r=c),++o}),o>0&&(s["!ref"]=Be(l)),s}function gT(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(rh);return o&&wc(o[0],i,a,t),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function _T(e,r){e.l+=10;var t=Et(e);return{name:t}}function vT(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Or(e,function(c,f,l){switch(l){case 550:i["!rel"]=c;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),c.name&&(a.Sheets[t].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!s||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}},r),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var ah=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],wT=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],yT=[],kT=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function wf(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],a=0;a!=r.length;++a){var i=r[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Ge(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function yf(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ge(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function ih(e){yf(e.WBProps,ah),yf(e.CalcPr,kT),wf(e.WBView,wT),wf(e.Sheets,yT),Rn.date1904=Ge(e.WBProps.date1904)}var ET="][*?/\\".split("");function TT(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return ET.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var bT=/<\w+:workbook/;function AT(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(bt,function(c,f){var l=Ce(c);switch(vr(l[0])){case"<?xml":break;case"<workbook":c.match(bT)&&(a="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=l[a];break;case"</workbook>":break;case"<fileVersion":delete l[0],t.AppVersion=l;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ah.forEach(function(u){if(l[u[0]]!=null)switch(u[2]){case"bool":t.WBProps[u[0]]=Ge(l[u[0]]);break;case"int":t.WBProps[u[0]]=parseInt(l[u[0]],10);break;default:t.WBProps[u[0]]=l[u[0]]}}),l.codeName&&(t.WBProps.CodeName=Ve(l.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete l[0],t.WBView.push(l);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(l.state){case"hidden":l.Hidden=1;break;case"veryHidden":l.Hidden=2;break;default:l.Hidden=0}delete l.state,l.name=ze(Ve(l.name)),delete l[0],t.Sheets.push(l);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Ve(l.name),l.comment&&(i.Comment=l.comment),l.localSheetId&&(i.Sheet=+l.localSheetId),Ge(l.hidden||"0")&&(i.Hidden=!0),s=f+c.length;break;case"</definedName>":i.Ref=ze(Ve(e.slice(s,f))),t.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete l[0],t.CalcPr=l;break;case"<calcPr/>":delete l[0],t.CalcPr=l;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+l[0]+" in workbook")}return c}),V_.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return ih(t),t}function ST(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=vo(e),t.name=Et(e),t}function CT(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?Et(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function FT(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function RT(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var a=e.read_shift(4),i=cv(e),s=dE(e,0,t),o=dc(e);e.l=n;var c={Name:i,Ptg:s};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function IT(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;r||(r={}),r.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],rs[16]={n:"BrtFRTArchID$",f:FT},Or(e,function(c,f,l){switch(l){case 156:s.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(r.SID=c.Sheet),c.Ref=wt(c.Ptg,null,null,s,r),delete r.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([l,c]):s[0]=[l,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(l),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(l),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+l.toString(16))}}},r),ih(t),t.Names=i,t.supbooks=s,t}function OT(e,r,t){return r.slice(-4)===".bin"?IT(e,t):AT(e,t)}function DT(e,r,t,n,a,i,s,o){return r.slice(-4)===".bin"?pT(e,n,t,a,i,s,o):SE(e,n,t,a,i,s,o)}function PT(e,r,t,n,a,i,s,o){return r.slice(-4)===".bin"?vT(e,n,t,a,i):gT(e,n,t,a,i)}function NT(e,r,t,n,a,i,s,o){return r.slice(-4)===".bin"?Wy():Vy()}function MT(e,r,t,n,a,i,s,o){return r.slice(-4)===".bin"?$y():Hy()}function LT(e,r,t,n){return r.slice(-4)===".bin"?ay(e,t,n):Jw(e,t,n)}function BT(e,r,t){return Gu(e,t)}function UT(e,r,t){return r.slice(-4)===".bin"?ww(e,t):_w(e,t)}function zT(e,r,t){return r.slice(-4)===".bin"?By(e,t):Dy(e,t)}function $T(e,r,t){return r.slice(-4)===".bin"?Ry(e):Cy(e)}function HT(e,r,t,n){return t.slice(-4)===".bin"?Iy(e,r,t,n):void 0}function WT(e,r,t){return r.slice(-4)===".bin"?Ay(e,r,t):Sy(e,r,t)}var sh=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,oh=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Jt(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var a=e.match(sh),i,s,o,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(oh),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function VT(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(sh),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(oh),(i=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),t[s]=a[2].slice(1,a[2].length-1));return t}var va;function GT(e,r){var t=va[e]||ze(e);return t==="General"?on(r):Kt(t,r)}function XT(e,r,t,n){var a=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Ge(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=lt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[ze(r)]=a}function jT(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||pn[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ba(e.v):e.w=on(e.v):e.w=GT(r||"General",e.v)}catch(i){if(t.WTF)throw i}try{var n=va[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&Hn(n)){var a=Qr(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(t.WTF)throw i}}}function YT(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=Xw[n.Pattern]||n.Pattern)}e[r.ID]=r}function KT(e,r,t,n,a,i,s,o,c,f){var l="General",u=n.StyleID,d={};f=f||{};var h=[],x=0;for(u===void 0&&o&&(u=o.StyleID),u===void 0&&s&&(u=s.StyleID);i[u]!==void 0&&(i[u].nf&&(l=i[u].nf),i[u].Interior&&h.push(i[u].Interior),!!i[u].Parent);)u=i[u].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=Ge(e);break;case"String":n.t="s",n.r=H0(ze(e)),n.v=e.indexOf("<")>-1?ze(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(lt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ze(e):n.v<60&&(n.v=n.v-1),(!l||l=="General")&&(l="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Eu[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=H0(r||e));break}if(jT(n,l,f),f.cellFormula!==!1)if(n.Formula){var p=ze(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=Fn(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Fn("RC:RC",a):n.ArrayRange&&(n.F=Fn(n.ArrayRange,a),c.push([Ze(n.F),n.F]))}else for(x=0;x<c.length;++x)a.r>=c[x][0].s.r&&a.r<=c[x][0].e.r&&a.c>=c[x][0].s.c&&a.c<=c[x][0].e.c&&(n.F=c[x][1]);f.cellStyles&&(h.forEach(function(m){!d.patternType&&m.patternType&&(d.patternType=m.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function qT(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function zs(e,r){var t=r||{};Kl();var n=ta(cc(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=Ve(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=pt(t);return s.type="string",Ca.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(O){a.indexOf("<"+O)>=0&&(i=!0)}),i)return i4(n,t);va={"General Number":"General","General Date":Oe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Oe[15],"Short Date":Oe[14],"Long Time":Oe[19],"Medium Time":Oe[18],"Short Time":Oe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Oe[2],Standard:Oe[4],Percent:Oe[10],Scientific:Oe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],f,l={},u=[],d=t.dense?[]:{},h="",x={},p={},m=Jt('<Data ss:Type="String">'),g=0,w=0,v=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},F={},E="",z=0,C=[],G={},H={},b=0,X=[],_=[],W={},q=[],j,ue=!1,P=[],se=[],Y={},T=0,K=0,B={Sheets:[],WBProps:{date1904:!1}},N={};Sa.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";o=Sa.exec(n);)switch(o[3]=(ie=o[3]).toLowerCase()){case"data":if(ie=="data"){if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?KT(n.slice(g,o.index),E,m,c[c.length-1][0]=="comment"?W:x,{c:w,r:v},A,q[w],p,P,t):(E="",m=Jt(o[0]),g=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(_.length>0&&(x.c=_),(!t.sheetRows||t.sheetRows>v)&&x.v!==void 0&&(t.dense?(d[v]||(d[v]=[]),d[v][w]=x):d[it(w)+xt(v)]=x),x.HRef&&(x.l={Target:ze(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(T=w+(parseInt(x.MergeAcross,10)|0),K=v+(parseInt(x.MergeDown,10)|0),C.push({s:{c:w,r:v},e:{c:T,r:K}})),!t.sheetStubs)x.MergeAcross?w=T+1:++w;else if(x.MergeAcross||x.MergeDown){for(var pe=w;pe<=T;++pe)for(var le=v;le<=K;++le)(pe>w||le>v)&&(t.dense?(d[le]||(d[le]=[]),d[le][pe]={t:"z"}):d[it(pe)+xt(le)]={t:"z"});w=T+1}else++w;else x=VT(o[0]),x.Index&&(w=+x.Index-1),w<k.s.c&&(k.s.c=w),w>k.e.c&&(k.e.c=w),o[0].slice(-2)==="/>"&&++w,_=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<k.s.r&&(k.s.r=v),v>k.e.r&&(k.e.r=v),o[0].slice(-2)==="/>"&&(p=Jt(o[0]),p.Index&&(v=+p.Index-1)),w=0,++v):(p=Jt(o[0]),p.Index&&(v=+p.Index-1),Y={},(p.AutoFitHeight=="0"||p.Height)&&(Y.hpx=parseInt(p.Height,10),Y.hpt=Vu(Y.hpx),se[v]=Y),p.Hidden=="1"&&(Y.hidden=!0,se[v]=Y));break;case"worksheet":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));u.push(h),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(d["!ref"]=Be(k),t.sheetRows&&t.sheetRows<=k.e.r&&(d["!fullref"]=d["!ref"],k.e.r=t.sheetRows-1,d["!ref"]=Be(k))),C.length&&(d["!merges"]=C),q.length>0&&(d["!cols"]=q),se.length>0&&(d["!rows"]=se),l[h]=d}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=w=0,c.push([o[3],!1]),f=Jt(o[0]),h=ze(f.Name),d=t.dense?[]:{},C=[],P=[],se=[],N={name:h,Hidden:0},B.Sheets.push(N);break;case"table":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),q=[],ue=!1}break;case"style":o[1]==="/"?YT(A,F,t):F=Jt(o[0]);break;case"numberformat":F.nf=ze(Jt(o[0]).Format||"General"),va[F.nf]&&(F.nf=va[F.nf]);for(var fe=0;fe!=392&&Oe[fe]!=F.nf;++fe);if(fe==392){for(fe=57;fe!=392;++fe)if(Oe[fe]==null){rn(F.nf,fe);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(j=Jt(o[0]),j.Hidden&&(j.hidden=!0,delete j.Hidden),j.Width&&(j.wpx=parseInt(j.Width,10)),!ue&&j.wpx>10){ue=!0,Ct=Hu;for(var he=0;he<q.length;++he)q[he]&&zn(q[he])}ue&&zn(j),q[j.Index-1||q.length]=j;for(var be=0;be<+j.Span;++be)q[q.length]=pt(j);break;case"namedrange":if(o[1]==="/")break;B.Names||(B.Names=[]);var V=Ce(o[0]),Ue={Name:V.Name,Ref:Fn(V.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(Ue.Sheet=B.Sheets.length-1),B.Names.push(Ue);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=n.slice(z,o.index):z=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;F.Interior=Jt(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?Dv(G,ie,n.slice(b,o.index)):b=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));qT(W),_.push(W)}else c.push([o[3],!1]),f=Jt(o[0]),W={a:f.Author};break;case"autofilter":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var y=Jt(o[0]);d["!autofilter"]={ref:Fn(y.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Sf(n,t);var ae=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ae=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ae=!1}break;case"excelworkbook":switch(o[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ae=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ae=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(b,o.index)){case"SheetHidden":N.Hidden=1;break;case"SheetVeryHidden":N.Hidden=2;break}else b=o.index+o[0].length;break;case"header":d["!margins"]||_a(d["!margins"]={},"xlml"),isNaN(+Ce(o[0]).Margin)||(d["!margins"].header=+Ce(o[0]).Margin);break;case"footer":d["!margins"]||_a(d["!margins"]={},"xlml"),isNaN(+Ce(o[0]).Margin)||(d["!margins"].footer=+Ce(o[0]).Margin);break;case"pagemargins":var J=Ce(o[0]);d["!margins"]||_a(d["!margins"]={},"xlml"),isNaN(+J.Top)||(d["!margins"].top=+J.Top),isNaN(+J.Left)||(d["!margins"].left=+J.Left),isNaN(+J.Right)||(d["!margins"].right=+J.Right),isNaN(+J.Bottom)||(d["!margins"].bottom=+J.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ae=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ae=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ae=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ae=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ae=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ae=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ae=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ae=!1}break;case"smarttags":break;default:ae=!1;break}if(ae||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?XT(H,ie,X,n.slice(b,o.index)):(X=o,b=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var R={};return!t.bookSheets&&!t.bookProps&&(R.Sheets=l),R.SheetNames=u,R.Workbook=B,R.SSF=pt(Oe),R.Props=G,R.Custprops=H,R}function Eo(e,r){switch(Ec(r=r||{}),r.type||"base64"){case"base64":return zs(Ht(e),r);case"binary":case"buffer":case"file":return zs(e,r);case"array":return zs(un(e),r)}}function ZT(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=uv(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=hv(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var JT=[60,1084,2066,2165,2175];function QT(e,r,t,n,a){var i=n,s=[],o=t.slice(t.l,t.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),t.l+=i;for(var c=Sr(t,t.l),f=To[c],l=0;f!=null&&JT.indexOf(c)>-1;)i=Sr(t,t.l+2),l=t.l+4,c==2066?l+=4:(c==2165||c==2175)&&(l+=12),o=t.slice(l,t.l+4+i),s.push(o),t.l+=4+i,f=To[c=Sr(t,t.l)];var u=Lr(s);dt(u,0);var d=0;u.lens=[];for(var h=0;h<s.length;++h)u.lens.push(d),d+=s[h].length;if(u.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+n;return r.f(u,u.length,a)}function fr(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=Oe[n])}catch(i){if(r.WTF)throw i}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||pn[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ba(e.v):e.w=on(e.v):e.w=Kt(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(i){if(r.WTF)throw i}if(r.cellDates&&n&&e.t=="n"&&Hn(Oe[n]||String(n))){var a=Qr(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function hi(e,r,t){return{v:e,ixfe:r,t}}function e4(e,r){var t={opts:{}},n={},a=r.dense?[]:{},i={},s={},o=null,c=[],f="",l={},u,d="",h,x,p,m,g={},w=[],v,k,A=[],F=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},z={},C=function(Fe){return Fe<8?nn[Fe]:Fe<64&&F[Fe-8]||nn[Fe]},G=function(Fe,He,ot){var De=He.XF.data;if(!(!De||!De.patternType||!ot||!ot.cellStyles)){He.s={},He.s.patternType=De.patternType;var Wt;(Wt=Fa(C(De.icvFore)))&&(He.s.fgColor={rgb:Wt}),(Wt=Fa(C(De.icvBack)))&&(He.s.bgColor={rgb:Wt})}},H=function(Fe,He,ot){if(!(Y>1)&&!(ot.sheetRows&&Fe.r>=ot.sheetRows)){if(ot.cellStyles&&He.XF&&He.XF.data&&G(Fe,He,ot),delete He.ixfe,delete He.XF,u=Fe,d=Re(Fe),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Fe.r<s.s.r&&(s.s.r=Fe.r),Fe.c<s.s.c&&(s.s.c=Fe.c),Fe.r+1>s.e.r&&(s.e.r=Fe.r+1),Fe.c+1>s.e.c&&(s.e.c=Fe.c+1),ot.cellFormula&&He.f){for(var De=0;De<w.length;++De)if(!(w[De][0].s.c>Fe.c||w[De][0].s.r>Fe.r)&&!(w[De][0].e.c<Fe.c||w[De][0].e.r<Fe.r)){He.F=Be(w[De][0]),(w[De][0].s.c!=Fe.c||w[De][0].s.r!=Fe.r)&&delete He.f,He.f&&(He.f=""+wt(w[De][1],s,Fe,P,b));break}}ot.dense?(a[Fe.r]||(a[Fe.r]=[]),a[Fe.r][Fe.c]=He):a[d]=He}},b={enc:!1,sbcch:0,snames:[],sharedf:g,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(b.password=r.password);var X,_=[],W=[],q=[],j=[],ue=!1,P=[];P.SheetNames=b.snames,P.sharedf=b.sharedf,P.arrayf=b.arrayf,P.names=[],P.XTI=[];var se=0,Y=0,T=0,K=[],B=[],N;b.codepage=1200,ar(1200);for(var ie=!1;e.l<e.length-1;){var pe=e.l,le=e.read_shift(2);if(le===0&&se===10)break;var fe=e.l===e.length?0:e.read_shift(2),he=To[le];if(he&&he.f){if(r.bookSheets&&se===133&&le!==133)break;if(se=le,he.r===2||he.r==12){var be=e.read_shift(2);if(fe-=2,!b.enc&&be!==le&&((be&255)<<8|be>>8)!==le)throw new Error("rt mismatch: "+be+"!="+le);he.r==12&&(e.l+=10,fe-=10)}var V={};if(le===10?V=he.f(e,fe,b):V=QT(le,he,e,fe,b),Y==0&&[9,521,1033,2057].indexOf(se)===-1)continue;switch(le){case 34:t.opts.Date1904=E.WBProps.date1904=V;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(b.enc||(e.l=0),b.enc=V,!r.password)throw new Error("File is password-protected");if(V.valid==null)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:b.lastuser=V;break;case 66:var Ue=Number(V);switch(Ue){case 21010:Ue=1200;break;case 32768:Ue=1e4;break;case 32769:Ue=1252;break}ar(b.codepage=Ue),ie=!0;break;case 317:b.rrtabid=V;break;case 25:b.winlocked=V;break;case 439:t.opts.RefreshAll=V;break;case 12:t.opts.CalcCount=V;break;case 16:t.opts.CalcDelta=V;break;case 17:t.opts.CalcIter=V;break;case 13:t.opts.CalcMode=V;break;case 14:t.opts.CalcPrecision=V;break;case 95:t.opts.CalcSaveRecalc=V;break;case 15:b.CalcRefMode=V;break;case 2211:t.opts.FullCalc=V;break;case 129:V.fDialog&&(a["!type"]="dialog"),V.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),V.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:A.push(V);break;case 430:P.push([V]),P[P.length-1].XTI=[];break;case 35:case 547:P[P.length-1].push(V);break;case 24:case 536:N={Name:V.Name,Ref:wt(V.rgce,s,null,P,b)},V.itab>0&&(N.Sheet=V.itab-1),P.names.push(N),P[0]||(P[0]=[],P[0].XTI=[]),P[P.length-1].push(V),V.Name=="_xlnm._FilterDatabase"&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&V.rgce[0][0][0]=="PtgArea3d"&&(B[V.itab-1]={ref:Be(V.rgce[0][0][1][2])});break;case 22:b.ExternCount=V;break;case 23:P.length==0&&(P[0]=[],P[0].XTI=[]),P[P.length-1].XTI=P[P.length-1].XTI.concat(V),P.XTI=P.XTI.concat(V);break;case 2196:if(b.biff<8)break;N!=null&&(N.Comment=V[1]);break;case 18:a["!protect"]=V;break;case 19:V!==0&&b.WTF&&console.error("Password verifier: "+V);break;case 133:i[V.pos]=V,b.snames.push(V.name);break;case 10:{if(--Y)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=Be(s),r.sheetRows&&r.sheetRows<=s.e.r){var y=s.e.r;s.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Be(s),s.e.r=y}s.e.r++,s.e.c++}_.length>0&&(a["!merges"]=_),W.length>0&&(a["!objects"]=W),q.length>0&&(a["!cols"]=q),j.length>0&&(a["!rows"]=j),E.Sheets.push(z)}f===""?l=a:n[f]=a,a=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(b.biff===8&&(b.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),b.biffguess=V.BIFFVer==0,V.BIFFVer==0&&V.dt==4096&&(b.biff=5,ie=!0,ar(b.codepage=28591)),b.biff==8&&V.BIFFVer==0&&V.dt==16&&(b.biff=2),Y++)break;if(a=r.dense?[]:{},b.biff<8&&!ie&&(ie=!0,ar(b.codepage=r.codepage||1252)),b.biff<5||V.BIFFVer==0&&V.dt==4096){f===""&&(f="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var ae={pos:e.l-fe,name:f};i[ae.pos]=ae,b.snames.push(f)}else f=(i[pe]||{name:""}).name;V.dt==32&&(a["!type"]="chart"),V.dt==64&&(a["!type"]="macro"),_=[],W=[],b.arrayf=w=[],q=[],j=[],ue=!1,z={Hidden:(i[pe]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(r.dense?(a[V.r]||[])[V.c]:a[Re({c:V.c,r:V.r})])&&++V.c,v={ixfe:V.ixfe,XF:A[V.ixfe]||{},v:V.val,t:"n"},T>0&&(v.z=K[v.ixfe>>8&63]),fr(v,r,t.opts.Date1904),H({c:V.c,r:V.r},v,r);break;case 5:case 517:v={ixfe:V.ixfe,XF:A[V.ixfe],v:V.val,t:V.t},T>0&&(v.z=K[v.ixfe>>8&63]),fr(v,r,t.opts.Date1904),H({c:V.c,r:V.r},v,r);break;case 638:v={ixfe:V.ixfe,XF:A[V.ixfe],v:V.rknum,t:"n"},T>0&&(v.z=K[v.ixfe>>8&63]),fr(v,r,t.opts.Date1904),H({c:V.c,r:V.r},v,r);break;case 189:for(var J=V.c;J<=V.C;++J){var R=V.rkrec[J-V.c][0];v={ixfe:R,XF:A[R],v:V.rkrec[J-V.c][1],t:"n"},T>0&&(v.z=K[v.ixfe>>8&63]),fr(v,r,t.opts.Date1904),H({c:J,r:V.r},v,r)}break;case 6:case 518:case 1030:{if(V.val=="String"){o=V;break}if(v=hi(V.val,V.cell.ixfe,V.tt),v.XF=A[v.ixfe],r.cellFormula){var O=V.formula;if(O&&O[0]&&O[0][0]&&O[0][0][0]=="PtgExp"){var Z=O[0][0][1][0],ce=O[0][0][1][1],de=Re({r:Z,c:ce});g[de]?v.f=""+wt(V.formula,s,V.cell,P,b):v.F=((r.dense?(a[Z]||[])[ce]:a[de])||{}).F}else v.f=""+wt(V.formula,s,V.cell,P,b)}T>0&&(v.z=K[v.ixfe>>8&63]),fr(v,r,t.opts.Date1904),H(V.cell,v,r),o=V}break;case 7:case 519:if(o)o.val=V,v=hi(V,o.cell.ixfe,"s"),v.XF=A[v.ixfe],r.cellFormula&&(v.f=""+wt(o.formula,s,o.cell,P,b)),T>0&&(v.z=K[v.ixfe>>8&63]),fr(v,r,t.opts.Date1904),H(o.cell,v,r),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(V);var Q=Re(V[0].s);if(h=r.dense?(a[V[0].s.r]||[])[V[0].s.c]:a[Q],r.cellFormula&&h){if(!o||!Q||!h)break;h.f=""+wt(V[1],s,V[0],P,b),h.F=Be(V[0])}}break;case 1212:{if(!r.cellFormula)break;if(d){if(!o)break;g[Re(o.cell)]=V[0],h=r.dense?(a[o.cell.r]||[])[o.cell.c]:a[Re(o.cell)],(h||{}).f=""+wt(V[0],s,u,P,b)}}break;case 253:v=hi(c[V.isst].t,V.ixfe,"s"),c[V.isst].h&&(v.h=c[V.isst].h),v.XF=A[v.ixfe],T>0&&(v.z=K[v.ixfe>>8&63]),fr(v,r,t.opts.Date1904),H({c:V.c,r:V.r},v,r);break;case 513:r.sheetStubs&&(v={ixfe:V.ixfe,XF:A[V.ixfe],t:"z"},T>0&&(v.z=K[v.ixfe>>8&63]),fr(v,r,t.opts.Date1904),H({c:V.c,r:V.r},v,r));break;case 190:if(r.sheetStubs)for(var xe=V.c;xe<=V.C;++xe){var ve=V.ixfe[xe-V.c];v={ixfe:ve,XF:A[ve],t:"z"},T>0&&(v.z=K[v.ixfe>>8&63]),fr(v,r,t.opts.Date1904),H({c:xe,r:V.r},v,r)}break;case 214:case 516:case 4:v=hi(V.val,V.ixfe,"s"),v.XF=A[v.ixfe],T>0&&(v.z=K[v.ixfe>>8&63]),fr(v,r,t.opts.Date1904),H({c:V.c,r:V.r},v,r);break;case 0:case 512:Y===1&&(s=V);break;case 252:c=V;break;case 1054:if(b.biff==4){K[T++]=V[1];for(var me=0;me<T+163&&Oe[me]!=V[1];++me);me>=163&&rn(V[1],T+163)}else rn(V[1],V[0]);break;case 30:{K[T++]=V;for(var Ee=0;Ee<T+163&&Oe[Ee]!=V;++Ee);Ee>=163&&rn(V,T+163)}break;case 229:_=_.concat(V);break;case 93:W[V.cmo[0]]=b.lastobj=V;break;case 438:b.lastobj.TxO=V;break;case 127:b.lastobj.ImData=V;break;case 440:for(m=V[0].s.r;m<=V[0].e.r;++m)for(p=V[0].s.c;p<=V[0].e.c;++p)h=r.dense?(a[m]||[])[p]:a[Re({c:p,r:m})],h&&(h.l=V[1]);break;case 2048:for(m=V[0].s.r;m<=V[0].e.r;++m)for(p=V[0].s.c;p<=V[0].e.c;++p)h=r.dense?(a[m]||[])[p]:a[Re({c:p,r:m})],h&&h.l&&(h.l.Tooltip=V[1]);break;case 28:{if(b.biff<=5&&b.biff>=2)break;h=r.dense?(a[V[0].r]||[])[V[0].c]:a[Re(V[0])];var $e=W[V[2]];h||(r.dense?(a[V[0].r]||(a[V[0].r]=[]),h=a[V[0].r][V[0].c]={t:"z"}):h=a[Re(V[0])]={t:"z"},s.e.r=Math.max(s.e.r,V[0].r),s.s.r=Math.min(s.s.r,V[0].r),s.e.c=Math.max(s.e.c,V[0].c),s.s.c=Math.min(s.s.c,V[0].c)),h.c||(h.c=[]),x={a:V[1],t:$e.TxO.t},h.c.push(x)}break;case 2173:ky(A[V.ixfe],V.ext);break;case 125:{if(!b.cellStyles)break;for(;V.e>=V.s;)q[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(V.flags&1)},ue||(ue=!0,_c(V.w/256)),zn(q[V.e+1])}break;case 520:{var Ae={};V.level!=null&&(j[V.r]=Ae,Ae.level=V.level),V.hidden&&(j[V.r]=Ae,Ae.hidden=!0),V.hpt&&(j[V.r]=Ae,Ae.hpt=V.hpt,Ae.hpx=Ra(V.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||_a(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=V;break;case 161:a["!margins"]||_a(a["!margins"]={}),a["!margins"].header=V.header,a["!margins"].footer=V.footer;break;case 574:V.RTL&&(E.Views[0].RTL=!0);break;case 146:F=V;break;case 2198:X=V;break;case 140:k=V;break;case 442:f?z.CodeName=V||z.name:E.WBProps.CodeName=V||"ThisWorkbook";break}}else he||console.error("Missing Info for XLS Record 0x"+le.toString(16)),e.l+=fe}return t.SheetNames=gr(i).sort(function(Xe,Fe){return Number(Xe)-Number(Fe)}).map(function(Xe){return i[Xe].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&l["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=l)):t.Preamble=l,t.Sheets&&B.forEach(function(Xe,Fe){t.Sheets[t.SheetNames[Fe]]["!autofilter"]=Xe}),t.Strings=c,t.SSF=pt(Oe),b.enc&&(t.Encryption=b.enc),X&&(t.Themes=X),t.Metadata={},k!==void 0&&(t.Metadata.Country=k),P.names.length>0&&(E.Names=P.names),t.Workbook=E,t}var kf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function t4(e,r,t){var n=Le.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=af(n,_v,kf.DSI);for(var i in a)r[i]=a[i]}catch(f){if(t.WTF)throw f}var s=Le.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=af(s,vv,kf.SI);for(var c in o)r[c]==null&&(r[c]=o[c])}catch(f){if(t.WTF)throw f}r.HeadingPairs&&r.TitlesOfParts&&(bu(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function ch(e,r){r||(r={}),Ec(r),Ll(),r.codepage&&tc(r.codepage);var t,n;if(e.FullPaths){if(Le.find(e,"/encryption"))throw new Error("File is password-protected");t=Le.find(e,"!CompObj"),n=Le.find(e,"/Workbook")||Le.find(e,"/Book")}else{switch(r.type){case"base64":e=nr(Ht(e));break;case"binary":e=nr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}dt(e,0),n={content:e}}var a,i;if(t&&ZT(t),r.bookProps&&!r.bookSheets)a={};else{var s=Ne?"buffer":"array";if(n&&n.content)a=e4(n.content,r);else if((i=Le.find(e,"PerfectOffice_MAIN"))&&i.content)a=ma.to_workbook(i.content,(r.type=s,r));else if((i=Le.find(e,"NativeContent_MAIN"))&&i.content)a=ma.to_workbook(i.content,(r.type=s,r));else throw(i=Le.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&Le.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=zy(e))}var o={};return e.FullPaths&&t4(e,o,r),a.Props=a.Custprops=o,r.bookFiles&&(a.cfb=e),a}var rs={0:{f:ME},1:{f:zE},2:{f:KE},3:{f:VE},4:{f:HE},5:{f:YE},6:{f:JE},7:{f:XE},8:{f:nT},9:{f:rT},10:{f:eT},11:{f:tT},12:{f:$E},13:{f:qE},14:{f:GE},15:{f:WE},16:{f:nh},17:{f:QE},18:{f:jE},19:{f:hc},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:RT},40:{},42:{},43:{f:ey},44:{f:Qw},45:{f:ty},46:{f:ny},47:{f:ry},48:{},49:{f:av},50:{},51:{f:Ty},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Lu},62:{f:ZE},63:{f:Fy},64:{f:hT},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Tt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:uT},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:UE},148:{f:LE,p:16},151:{f:sT},152:{},153:{f:CT},154:{},155:{},156:{f:ST},157:{},158:{},159:{T:1,f:vw},160:{T:-1},161:{T:1,f:dn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:aT},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Ey},336:{T:-1},337:{f:by,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:vo},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Mu},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:oT},427:{f:cT},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:lT},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:BE},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:iT},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:vo},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Ly},633:{T:1},634:{T:-1},635:{T:1,f:My},636:{T:-1},637:{f:sv},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:_T},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:dT},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},To={6:{f:Bs},10:{f:Dr},12:{f:tt},13:{f:tt},14:{f:Je},15:{f:Je},16:{f:yt},17:{f:Je},18:{f:Je},19:{f:tt},20:{f:ff},21:{f:ff},23:{f:Mu},24:{f:uf},25:{f:Je},26:{},27:{},28:{f:P2},29:{},34:{f:Je},35:{f:lf},38:{f:yt},39:{f:yt},40:{f:yt},41:{f:yt},42:{f:Je},43:{f:Je},47:{f:Bw},49:{f:x2},51:{f:tt},60:{},61:{f:h2},64:{f:Je},65:{f:p2},66:{f:tt},77:{},80:{},81:{},82:{},85:{f:tt},89:{},90:{},91:{},92:{f:a2},93:{f:M2},94:{},95:{f:Je},96:{},97:{},99:{f:Je},125:{f:Lu},128:{f:b2},129:{f:i2},130:{f:tt},131:{f:Je},132:{f:Je},133:{f:s2},134:{},140:{f:H2},141:{f:tt},144:{},146:{f:V2},151:{},152:{},153:{},154:{},155:{},156:{f:tt},157:{},158:{},160:{f:K2},161:{f:X2},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:y2},190:{f:k2},193:{f:Dr},197:{},198:{},199:{},200:{},201:{},202:{f:Je},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:tt},220:{},221:{f:Je},222:{},224:{f:T2},225:{f:n2},226:{f:Dr},227:{},229:{f:N2},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:o2},253:{f:m2},255:{f:c2},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Ru},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Je},353:{f:Dr},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:S2},431:{f:Je},432:{},433:{},434:{},437:{},438:{f:U2},439:{f:Je},440:{f:z2},441:{},442:{f:Ua},443:{},444:{f:tt},445:{},446:{},448:{f:Dr},449:{f:u2,r:2},450:{f:Dr},512:{f:of},513:{f:Y2},515:{f:A2},516:{f:g2},517:{f:cf},519:{f:q2},520:{f:f2},523:{},545:{f:hf},549:{f:sf},566:{},574:{f:d2},638:{f:w2},659:{},1048:{},1054:{f:_2},1084:{},1212:{f:I2},2048:{f:$2},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:fi},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Dr},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:G2,r:12},2173:{f:yy,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Je,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:R2,r:12},2197:{},2198:{f:xy,r:12},2199:{},2200:{},2201:{},2202:{f:O2,r:12},2203:{f:Dr},2204:{},2205:{},2206:{},2207:{},2211:{f:l2},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:tt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:j2},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:W2},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:of},1:{},2:{f:ew},3:{f:Q2},4:{f:J2},5:{f:cf},7:{f:tw},8:{},9:{f:fi},11:{},22:{f:tt},30:{f:v2},31:{},32:{},33:{f:hf},36:{},37:{f:sf},50:{f:rw},62:{},52:{},67:{},68:{f:tt},69:{},86:{},126:{},127:{f:Z2},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:nw},223:{},234:{},354:{},421:{},518:{f:Bs},521:{f:fi},536:{f:uf},547:{f:lf},561:{},579:{},1030:{f:Bs},1033:{f:fi},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Qt(e,r,t,n){var a=r;if(!isNaN(a)){var i=(t||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&gu(t)&&e.push(t)}}function Ef(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,c=A_(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,l=0,u=0,d=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(s=0;s<c.length;++s){var p=c[s].trim(),m=p.slice(0,3).toLowerCase();if(m=="<tr"){if(++f,t.sheetRows&&t.sheetRows<=f){--f;break}l=0;continue}if(!(m!="<td"&&m!="<th")){var g=p.split(/<\/t[dh]>/i);for(o=0;o<g.length;++o){var w=g[o].trim();if(w.match(/<t[dh]/i)){for(var v=w,k=0;v.charAt(0)=="<"&&(k=v.indexOf(">"))>-1;)v=v.slice(k+1);for(var A=0;A<x.length;++A){var F=x[A];F.s.c==l&&F.s.r<f&&f<=F.e.r&&(l=F.e.c+1,A=-1)}var E=Ce(w.slice(0,w.indexOf(">")));d=E.colspan?+E.colspan:1,((u=+E.rowspan)>1||d>1)&&x.push({s:{r:f,c:l},e:{r:f+(u||1)-1,c:l+d-1}});var z=E.t||E["data-t"]||"";if(!v.length){l+=d;continue}if(v=au(v),h.s.r>f&&(h.s.r=f),h.e.r<f&&(h.e.r=f),h.s.c>l&&(h.s.c=l),h.e.c<l&&(h.e.c=l),!v.length){l+=d;continue}var C={t:"s",v};t.raw||!v.trim().length||z=="s"||(v==="TRUE"?C={t:"b",v:!0}:v==="FALSE"?C={t:"b",v:!1}:isNaN(or(v))?isNaN(Un(v).getDate())||(C={t:"d",v:lt(v)},t.cellDates||(C={t:"n",v:It(C.v)}),C.z=t.dateNF||Oe[14]):C={t:"n",v:or(v)}),t.dense?(n[f]||(n[f]=[]),n[f][l]=C):n[Re({r:f,c:l})]=C,l+=d}}}}return n["!ref"]=Be(h),x.length&&(n["!merges"]=x),n}function r4(e,r,t,n){for(var a=e["!merges"]||[],i=[],s=r.s.c;s<=r.e.c;++s){for(var o=0,c=0,f=0;f<a.length;++f)if(!(a[f].s.r>t||a[f].s.c>s)&&!(a[f].e.r<t||a[f].e.c<s)){if(a[f].s.r<t||a[f].s.c<s){o=-1;break}o=a[f].e.r-a[f].s.r+1,c=a[f].e.c-a[f].s.c+1;break}if(!(o<0)){var l=Re({r:t,c:s}),u=n.dense?(e[t]||[])[s]:e[l],d=u&&u.v!=null&&(u.h||oc(u.w||(Ir(u),u.w)||""))||"",h={};o>1&&(h.rowspan=o),c>1&&(h.colspan=c),n.editable?d='<span contenteditable="true">'+d+"</span>":u&&(h["data-t"]=u&&u.t||"z",u.v!=null&&(h["data-v"]=u.v),u.z!=null&&(h["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+u.l.Target+'">'+d+"</a>")),h.id=(n.id||"sjs")+"-"+l,i.push(H_("td",d,h))}}var x="<tr>";return x+i.join("")+"</tr>"}var n4='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',a4="</body></html>";function i4(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Wr(Ef(t[0],r),r);var n=bc();return t.forEach(function(a,i){Ac(n,Ef(a,r),"Sheet"+(i+1))}),n}function s4(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function o4(e,r){var t=r||{},n=t.header!=null?t.header:n4,a=t.footer!=null?t.footer:a4,i=[n],s=Wn(e["!ref"]);t.dense=Array.isArray(e),i.push(s4(e,s,t));for(var o=s.s.r;o<=s.e.r;++o)i.push(r4(e,s,o,t));return i.push("</table>"+a),i.join("")}function fh(e,r,t){var n=t||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Ft(n.origin):n.origin;a=s.r,i=s.c}var o=r.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),f={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var l=Wn(e["!ref"]);f.s.r=Math.min(f.s.r,l.s.r),f.s.c=Math.min(f.s.c,l.s.c),f.e.r=Math.max(f.e.r,l.e.r),f.e.c=Math.max(f.e.c,l.e.c),a==-1&&(f.e.r=a=l.e.r+1)}var u=[],d=0,h=e["!rows"]||(e["!rows"]=[]),x=0,p=0,m=0,g=0,w=0,v=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&p<c;++x){var k=o[x];if(Tf(k)){if(n.display)continue;h[p]={hidden:!0}}var A=k.children;for(m=g=0;m<A.length;++m){var F=A[m];if(!(n.display&&Tf(F))){var E=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):au(F.innerHTML),z=F.getAttribute("data-z")||F.getAttribute("z");for(d=0;d<u.length;++d){var C=u[d];C.s.c==g+i&&C.s.r<p+a&&p+a<=C.e.r&&(g=C.e.c+1-i,d=-1)}v=+F.getAttribute("colspan")||1,((w=+F.getAttribute("rowspan")||1)>1||v>1)&&u.push({s:{r:p+a,c:g+i},e:{r:p+a+(w||1)-1,c:g+i+(v||1)-1}});var G={t:"s",v:E},H=F.getAttribute("data-t")||F.getAttribute("t")||"";E!=null&&(E.length==0?G.t=H||"z":n.raw||E.trim().length==0||H=="s"||(E==="TRUE"?G={t:"b",v:!0}:E==="FALSE"?G={t:"b",v:!1}:isNaN(or(E))?isNaN(Un(E).getDate())||(G={t:"d",v:lt(E)},n.cellDates||(G={t:"n",v:It(G.v)}),G.z=n.dateNF||Oe[14]):G={t:"n",v:or(E)})),G.z===void 0&&z!=null&&(G.z=z);var b="",X=F.getElementsByTagName("A");if(X&&X.length)for(var _=0;_<X.length&&!(X[_].hasAttribute("href")&&(b=X[_].getAttribute("href"),b.charAt(0)!="#"));++_);b&&b.charAt(0)!="#"&&(G.l={Target:b}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][g+i]=G):e[Re({c:g+i,r:p+a})]=G,f.e.c<g+i&&(f.e.c=g+i),g+=v}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),f.e.r=Math.max(f.e.r,p-1+a),e["!ref"]=Be(f),p>=c&&(e["!fullref"]=Be((f.e.r=o.length-x+p-1+a,f))),e}function lh(e,r){var t=r||{},n=t.dense?[]:{};return fh(n,e,r)}function c4(e,r){return Wr(lh(e,r),r)}function Tf(e){var r="",t=f4(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function f4(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function l4(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=ze(r.replace(/<[^>]*>/g,""));return[t]}var bf={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function uh(e,r){var t=r||{},n=cc(e),a=[],i,s,o={name:""},c="",f=0,l,u,d={},h=[],x=t.dense?[]:{},p,m,g={value:""},w="",v=0,k=[],A=-1,F=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},z=0,C={},G=[],H={},b=0,X=0,_=[],W=1,q=1,j=[],ue={Names:[]},P={},se=["",""],Y=[],T={},K="",B=0,N=!1,ie=!1,pe=0;for(Sa.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Sa.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?x["!ref"]=Be(E):x["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=E.e.r&&(x["!fullref"]=x["!ref"],E.e.r=t.sheetRows-1,x["!ref"]=Be(E)),G.length&&(x["!merges"]=G),_.length&&(x["!rows"]=_),l.name=l.名称||l.name,typeof JSON<"u"&&JSON.stringify(l),h.push(l.name),d[l.name]=x,ie=!1):p[0].charAt(p[0].length-2)!=="/"&&(l=Ce(p[0],!1),A=F=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,x=t.dense?[]:{},G=[],_=[],ie=!0);break;case"table-row-group":p[1]==="/"?--z:++z;break;case"table-row":case"行":if(p[1]==="/"){A+=W,W=1;break}if(u=Ce(p[0],!1),u.行号?A=u.行号-1:A==-1&&(A=0),W=+u["number-rows-repeated"]||1,W<10)for(pe=0;pe<W;++pe)z>0&&(_[A+pe]={level:z});F=-1;break;case"covered-table-cell":p[1]!=="/"&&++F,t.sheetStubs&&(t.dense?(x[A]||(x[A]=[]),x[A][F]={t:"z"}):x[Re({r:A,c:F})]={t:"z"}),w="",k=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++F,g=Ce(p[0],!1),q=parseInt(g["number-columns-repeated"]||"1",10),m={t:"z",v:null},g.formula&&t.cellFormula!=!1&&(m.f=vf(ze(g.formula))),(g.数据类型||g["value-type"])=="string"&&(m.t="s",m.v=ze(g["string-value"]||""),t.dense?(x[A]||(x[A]=[]),x[A][F]=m):x[Re({r:A,c:F})]=m),F+=q-1;else if(p[1]!=="/"){++F,w="",v=0,k=[],q=1;var le=W?A+W-1:A;if(F>E.e.c&&(E.e.c=F),F<E.s.c&&(E.s.c=F),A<E.s.r&&(E.s.r=A),le>E.e.r&&(E.e.r=le),g=Ce(p[0],!1),Y=[],T={},m={t:g.数据类型||g["value-type"],v:null},t.cellFormula)if(g.formula&&(g.formula=ze(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(b=parseInt(g["number-matrix-rows-spanned"],10)||0,X=parseInt(g["number-matrix-columns-spanned"],10)||0,H={s:{r:A,c:F},e:{r:A+b-1,c:F+X-1}},m.F=Be(H),j.push([H,m.F])),g.formula)m.f=vf(g.formula);else for(pe=0;pe<j.length;++pe)A>=j[pe][0].s.r&&A<=j[pe][0].e.r&&F>=j[pe][0].s.c&&F<=j[pe][0].e.c&&(m.F=j[pe][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(b=parseInt(g["number-rows-spanned"],10)||0,X=parseInt(g["number-columns-spanned"],10)||0,H={s:{r:A,c:F},e:{r:A+b-1,c:F+X-1}},G.push(H)),g["number-columns-repeated"]&&(q=parseInt(g["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=Ge(g["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(g.value);break;case"percentage":m.t="n",m.v=parseFloat(g.value);break;case"currency":m.t="n",m.v=parseFloat(g.value);break;case"date":m.t="d",m.v=lt(g["date-value"]),t.cellDates||(m.t="n",m.v=It(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=E_(g["time-value"])/86400,t.cellDates&&(m.t="d",m.v=ls(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(g.数据数值);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",g["string-value"]!=null&&(w=ze(g["string-value"]),k=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(N=!1,m.t==="s"&&(m.v=w||"",k.length&&(m.R=k),N=v==0),P.Target&&(m.l=P),Y.length>0&&(m.c=Y,Y=[]),w&&t.cellText!==!1&&(m.w=w),N&&(m.t="z",delete m.v),(!N||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=A))for(var fe=0;fe<W;++fe){if(q=parseInt(g["number-columns-repeated"]||"1",10),t.dense)for(x[A+fe]||(x[A+fe]=[]),x[A+fe][F]=fe==0?m:pt(m);--q>0;)x[A+fe][F+q]=pt(m);else for(x[Re({r:A+fe,c:F})]=m;--q>0;)x[Re({r:A+fe,c:F+q})]=pt(m);E.e.c<=F&&(E.e.c=F)}q=parseInt(g["number-columns-repeated"]||"1",10),F+=q-1,q=0,m={},w="",k=[]}P={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i;T.t=w,k.length&&(T.R=k),T.a=K,Y.push(T)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);K="",B=0,w="",v=0,k=[];break;case"creator":p[1]==="/"?K=n.slice(B,p.index):B=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);w="",v=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(C[o.name]=c,(i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(c="",o=Ce(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Ce(p[0],!1),c+=bf[p[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Ce(p[0],!1),c+=bf[p[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(f,p.index);break}else f=p.index+p[0].length;break;case"named-range":s=Ce(p[0],!1),se=Us(s["cell-range-address"]);var he={Name:s.name,Ref:se[0]+"!"+se[1]};ie&&(he.Sheet=h.length),ue.Names.push(he);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!g||!g["string-value"])){var be=l4(n.slice(v,p.index));w=(w.length>0?w+`
`:"")+be[0]}else Ce(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{se=Us(Ce(p[0])["target-range-address"]),d[se[0]]["!autofilter"]={ref:se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(P=Ce(p[0],!1),!P.href)break;P.Target=ze(P.href),delete P.href,P.Target.charAt(0)=="#"&&P.Target.indexOf(".")>-1?(se=Us(P.Target.slice(1)),P.Target="#"+se[0]+"!"+se[1]):P.Target.match(/^\.\.[\\\/]/)&&(P.Target=P.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(p)}}var V={Sheets:d,SheetNames:h,Workbook:ue};return t.bookSheets&&delete V.Sheets,V}function Af(e,r){r=r||{},Xt(e,"META-INF/manifest.xml")&&Av(et(e,"META-INF/manifest.xml"),r);var t=zt(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=uh(Ve(t),r);return Xt(e,"meta.xml")&&(n.Props=Tu(et(e,"meta.xml"))),n}function Sf(e,r){return uh(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function yc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function bo(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ve(un(e))}function Ao(e){var r=e.reduce(function(a,i){return a+i.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(a){t.set(a,n),n+=a.length}),t}function Cf(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function u4(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,a=r+13;a>=r;--a)n=n*256+e[a];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function Ia(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function st(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function kt(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],a=Ia(e,t),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var c=t[0];e[t[0]++]>=128;);o=e.slice(c,t[0])}break;case 5:s=4,o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 1:s=8,o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 2:s=Ia(e,t),o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var f={data:o,type:i};r[a]==null?r[a]=[f]:r[a].push(f)}return r}function kc(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function h4(e){for(var r,t=[],n=[0];n[0]<e.length;){var a=Ia(e,n),i=kt(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:st(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=kt(o.data),f=st(c[3][0].data);s.messages.push({meta:c,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(r=i[3])!=null&&r[0]&&(s.merge=st(i[3][0].data)>>>0>0),t.push(s)}return t}function d4(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=Ia(r,t),a=[];t[0]<r.length;){var i=r[t[0]]&3;if(i==0){var s=r[t[0]++]>>2;if(s<60)++s;else{var o=s-59;s=r[t[0]],o>1&&(s|=r[t[0]+1]<<8),o>2&&(s|=r[t[0]+2]<<16),o>3&&(s|=r[t[0]+3]<<24),s>>>=0,s++,t[0]+=o}a.push(r.slice(t[0],t[0]+s)),t[0]+=s;continue}else{var c=0,f=0;if(i==1?(f=(r[t[0]]>>2&7)+4,c=(r[t[0]++]&224)<<3,c|=r[t[0]++]):(f=(r[t[0]++]>>2)+1,i==2?(c=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(c=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),a=[Ao(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(f>=c)for(a.push(a[0].slice(-c)),f-=c;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-c,-c+f))}}var l=Ao(a);if(l.length!=n)throw new Error("Unexpected length: ".concat(l.length," != ").concat(n));return l}function p4(e){for(var r=[],t=0;t<e.length;){var n=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(d4(n,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Ao(r)}function x4(e,r,t,n){var a=yc(e),i=a.getUint32(4,!0),s=(n>1?12:8)+Cf(i&(n>1?3470:398))*4,o=-1,c=-1,f=NaN,l=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=Cf(i&(n>1?12288:4096))*4,i&16&&(c=a.getUint32(s,!0),s+=4),i&32&&(f=a.getFloat64(s,!0),s+=8),i&64&&(l.setTime(l.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var u;switch(e[2]){case 0:break;case 2:u={t:"n",v:f};break;case 3:u={t:"s",v:r[c]};break;case 5:u={t:"d",v:l};break;case 6:u={t:"b",v:f>0};break;case 7:u={t:"n",v:f/86400};break;case 8:u={t:"e",v:0};break;case 9:if(o>-1)u={t:"s",v:t[o]};else if(c>-1)u={t:"s",v:r[c]};else if(!isNaN(f))u={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return u}function m4(e,r,t){var n=yc(e),a=n.getUint32(8,!0),i=12,s=-1,o=-1,c=NaN,f=NaN,l=new Date(2001,0,1);a&1&&(c=u4(e,i),i+=16),a&2&&(f=n.getFloat64(i,!0),i+=8),a&4&&(l.setTime(l.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var u;switch(e[1]){case 0:break;case 2:u={t:"n",v:c};break;case 3:u={t:"s",v:r[o]};break;case 5:u={t:"d",v:l};break;case 6:u={t:"b",v:f>0};break;case 7:u={t:"n",v:f/86400};break;case 8:u={t:"e",v:0};break;case 9:if(s>-1)u={t:"s",v:t[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:u={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return u}function g4(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return x4(e,r,t,e[0]);case 5:return m4(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function zr(e){var r=kt(e);return Ia(r[1][0].data)}function Ff(e,r){var t=kt(r.data),n=st(t[1][0].data),a=t[3],i=[];return(a||[]).forEach(function(s){var o=kt(s.data),c=st(o[1][0].data)>>>0;switch(n){case 1:i[c]=bo(o[3][0].data);break;case 8:{var f=e[zr(o[9][0].data)][0],l=kt(f.data),u=e[zr(l[1][0].data)][0],d=st(u.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var h=kt(u.data);i[c]=h[3].map(function(x){return bo(x.data)}).join("")}break}}),i}function _4(e,r){var t,n,a,i,s,o,c,f,l,u,d,h,x,p,m=kt(e),g=st(m[1][0].data)>>>0,w=st(m[2][0].data)>>>0,v=((n=(t=m[8])==null?void 0:t[0])==null?void 0:n.data)&&st(m[8][0].data)>0||!1,k,A;if((i=(a=m[7])==null?void 0:a[0])!=null&&i.data&&r!=0)k=(o=(s=m[7])==null?void 0:s[0])==null?void 0:o.data,A=(f=(c=m[6])==null?void 0:c[0])==null?void 0:f.data;else if((u=(l=m[4])==null?void 0:l[0])!=null&&u.data&&r!=1)k=(h=(d=m[4])==null?void 0:d[0])==null?void 0:h.data,A=(p=(x=m[3])==null?void 0:x[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var F=v?4:1,E=yc(k),z=[],C=0;C<k.length/2;++C){var G=E.getUint16(C*2,!0);G<65535&&z.push([C,G])}if(z.length!=w)throw"Expected ".concat(w," cells, found ").concat(z.length);var H=[];for(C=0;C<z.length-1;++C)H[z[C][0]]=A.subarray(z[C][1]*F,z[C+1][1]*F);return z.length>=1&&(H[z[z.length-1][0]]=A.subarray(z[z.length-1][1]*F)),{R:g,cells:H}}function v4(e,r){var t,n=kt(r.data),a=(t=n==null?void 0:n[7])!=null&&t[0]?st(n[7][0].data)>>>0>0?1:0:-1,i=kc(n[5],function(s){return _4(s,a)});return{nrows:st(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(c,f){if(s[o.R][f])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(f));s[o.R][f]=c}),s},[])}}function w4(e,r,t){var n,a=kt(r.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(st(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(st(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=Be(i);var s=kt(a[4][0].data),o=Ff(e,e[zr(s[4][0].data)][0]),c=(n=s[17])!=null&&n[0]?Ff(e,e[zr(s[17][0].data)][0]):[],f=kt(s[3][0].data),l=0;f[1].forEach(function(u){var d=kt(u.data),h=e[zr(d[2][0].data)][0],x=st(h.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var p=v4(e,h);p.data.forEach(function(m,g){m.forEach(function(w,v){var k=Re({r:l+g,c:v}),A=g4(w,o,c);A&&(t[k]=A)})}),l+=p.nrows})}function y4(e,r){var t=kt(r.data),n={"!ref":"A1"},a=e[zr(t[2][0].data)],i=st(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return w4(e,a[0],n),n}function k4(e,r){var t,n=kt(r.data),a={name:(t=n[1])!=null&&t[0]?bo(n[1][0].data):"",sheets:[]},i=kc(n[2],zr);return i.forEach(function(s){e[s].forEach(function(o){var c=st(o.meta[1][0].data);c==6e3&&a.sheets.push(y4(e,o))})}),a}function E4(e,r){var t=bc(),n=kt(r.data),a=kc(n[1],zr);if(a.forEach(function(i){e[i].forEach(function(s){var o=st(s.meta[1][0].data);if(o==2){var c=k4(e,s);c.sheets.forEach(function(f,l){Ac(t,f,l==0?c.name:c.name+"_"+l,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function $s(e){var r,t,n,a,i={},s=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var f;try{f=p4(c.content)}catch(u){return console.log("?? "+c.content.length+" "+(u.message||u))}var l;try{l=h4(f)}catch(u){return console.log("## "+(u.message||u))}l.forEach(function(u){i[u.id]=u.messages,s.push(u.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(t=(r=i==null?void 0:i[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&st(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(c){i[c].forEach(function(f){var l=st(f.meta[1][0].data)>>>0;if(l==1)if(!o)o=f;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return E4(i,o)}function T4(e){return function(t){for(var n=0;n!=e.length;++n){var a=e[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function Ec(e){T4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function b4(e){return bn.WS.indexOf(e)>-1?"sheet":e==bn.CS?"chart":e==bn.DS?"dialog":e==bn.MS?"macro":e&&e.length?e:"sheet"}function A4(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,b4(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function S4(e,r,t,n,a,i,s,o,c,f,l,u){try{i[n]=pa(zt(e,t,!0),r);var d=et(e,r),h;switch(o){case"sheet":h=DT(d,r,a,c,i[n],f,l,u);break;case"chart":if(h=PT(d,r,a,c,i[n],f,l,u),!h||!h["!drawel"])break;var x=na(h["!drawel"].Target,r),p=wo(x),m=Oy(zt(e,x,!0),pa(zt(e,p,!0),x)),g=na(m,x),w=wo(g);h=mT(zt(e,g,!0),g,c,pa(zt(e,w,!0),g),f,h);break;case"macro":h=NT(d,r,a,c,i[n],f,l,u);break;case"dialog":h=MT(d,r,a,c,i[n],f,l,u);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=h;var v=[];i&&i[n]&&gr(i[n]).forEach(function(k){var A="";if(i[n][k].Type==bn.CMNT){A=na(i[n][k].Target,r);var F=zT(et(e,A,!0),A,c);if(!F||!F.length)return;pf(h,F,!1)}i[n][k].Type==bn.TCMNT&&(A=na(i[n][k].Target,r),v=v.concat(Py(et(e,A,!0),c)))}),v&&v.length&&pf(h,v,!0,c.people||[])}catch(k){if(c.WTF)throw k}}function Vt(e){return e.charAt(0)=="/"?e.slice(1):e}function C4(e,r){if(Kl(),r=r||{},Ec(r),Xt(e,"META-INF/manifest.xml")||Xt(e,"objectdata.xml"))return Af(e,r);if(Xt(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof $s<"u"){if(e.FileIndex)return $s(e);var t=Le.utils.cfb_new();return z0(e).forEach(function(_){F_(t,_,C_(e,_))}),$s(t)}throw new Error("Unsupported NUMBERS file")}if(!Xt(e,"[Content_Types].xml"))throw Xt(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Xt(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=z0(e),a=Tv(zt(e,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",et(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!et(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},f={};if(!r.bookSheets&&!r.bookProps){if(ga=[],a.sst)try{ga=UT(et(e,Vt(a.sst)),a.sst,r)}catch(_){if(r.WTF)throw _}r.cellStyles&&a.themes.length&&(c=BT(zt(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(f=LT(et(e,Vt(a.style)),a.style,c,r))}a.links.map(function(_){try{var W=pa(zt(e,wo(Vt(_))),_);return HT(et(e,Vt(_)),W,_,r)}catch{}});var l=OT(et(e,Vt(a.workbooks[0])),a.workbooks[0],r),u={},d="";a.coreprops.length&&(d=et(e,Vt(a.coreprops[0]),!0),d&&(u=Tu(d)),a.extprops.length!==0&&(d=et(e,Vt(a.extprops[0]),!0),d&&Fv(d,u,r)));var h={};(!r.bookSheets||r.bookProps)&&a.custprops.length!==0&&(d=zt(e,Vt(a.custprops[0]),!0),d&&(h=Iv(d,r)));var x={};if((r.bookSheets||r.bookProps)&&(l.Sheets?s=l.Sheets.map(function(W){return W.name}):u.Worksheets&&u.SheetNames.length>0&&(s=u.SheetNames),r.bookProps&&(x.Props=u,x.Custprops=h),r.bookSheets&&typeof s<"u"&&(x.SheetNames=s),r.bookSheets?x.SheetNames:r.bookProps))return x;s={};var p={};r.bookDeps&&a.calcchain&&(p=$T(et(e,Vt(a.calcchain)),a.calcchain));var m=0,g={},w,v;{var k=l.Sheets;u.Worksheets=k.length,u.SheetNames=[];for(var A=0;A!=k.length;++A)u.SheetNames[A]=k[A].name}var F=i?"bin":"xml",E=a.workbooks[0].lastIndexOf("/"),z=(a.workbooks[0].slice(0,E+1)+"_rels/"+a.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");Xt(e,z)||(z="xl/_rels/workbook."+F+".rels");var C=pa(zt(e,z,!0),z.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=WT(et(e,Vt(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=Ny(et(e,Vt(a.people[0])),r)),C&&(C=A4(C,l.Sheets));var G=et(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=u.Worksheets;++m){var H="sheet";if(C&&C[m]?(w="xl/"+C[m][1].replace(/[\/]?xl\//,""),Xt(e,w)||(w=C[m][1]),Xt(e,w)||(w=z.replace(/_rels\/.*$/,"")+C[m][1]),H=C[m][2]):(w="xl/worksheets/sheet"+(m+1-G)+"."+F,w=w.replace(/sheet0\./,"sheet.")),v=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(m!=r.sheets)continue e;break;case"string":if(u.SheetNames[m].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var b=!1,X=0;X!=r.sheets.length;++X)typeof r.sheets[X]=="number"&&r.sheets[X]==m&&(b=1),typeof r.sheets[X]=="string"&&r.sheets[X].toLowerCase()==u.SheetNames[m].toLowerCase()&&(b=1);if(!b)continue e}}S4(e,w,v,u.SheetNames[m],m,g,s,H,r,l,c,f)}return x={Directory:a,Workbook:l,Props:u,Custprops:h,Deps:p,Sheets:s,SheetNames:u.SheetNames,Strings:ga,Styles:f,Themes:c,SSF:pt(Oe)},r&&r.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(_,W){_=_.replace(/^Root Entry[\/]/,""),x.keys.push(_),x.files[_]=e.FileIndex[W]}))),r&&r.bookVBA&&(a.vba.length>0?x.vbaraw=et(e,Vt(a.vba[0]),!0):a.defaults&&a.defaults.bin===Uy&&(x.vbaraw=et(e,"xl/vbaProject.bin",!0))),x}function F4(e,r){var t=r||{},n="Workbook",a=Le.find(e,n);try{if(n="/!DataSpaces/Version",a=Le.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(yw(a.content),n="/!DataSpaces/DataSpaceMap",a=Le.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Ew(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Le.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Tw(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Le.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Aw(a.content)}catch{}if(n="/EncryptionInfo",a=Le.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Sw(a.content);if(n="/EncryptedPackage",a=Le.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function Tc(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Ht(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function R4(e,r){return Le.find(e,"EncryptedPackage")?F4(e,r):ch(e,r)}function I4(e,r){var t,n=e,a=r||{};return a.type||(a.type=Ne&&Buffer.isBuffer(e)?"buffer":"base64"),t=tu(n,a),C4(t,a)}function hh(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Eo(e.slice(t),r);default:break e}return Ca.to_workbook(e,r)}function O4(e,r){var t="",n=Tc(e,r);switch(r.type){case"base64":t=Ht(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=cn(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=Ve(t)),r.type="binary",hh(t,r)}function D4(e,r){var t=e;return r.type=="base64"&&(t=Ht(t)),t=go.utils.decode(1200,t.slice(2),"str"),r.type="binary",hh(t,r)}function P4(e){return e.match(/[^\x00-\x7F]/)?aa(e):e}function Hs(e,r,t,n){return n?(t.type="string",Ca.to_workbook(e,t)):Ca.to_workbook(r,t)}function So(e,r){Ll();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return So(new Uint8Array(e),(t=pt(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Rn={},t.dateNF&&(Rn.dateNF=t.dateNF),t.type||(t.type=Ne&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Ne?"buffer":"binary",n=y_(e),typeof Uint8Array<"u"&&!Ne&&(t.type="array")),t.type=="string"&&(i=!0,t.type="binary",t.codepage=65001,n=P4(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return t=pt(t),t.type="array",So(rc(n),t)}switch((a=Tc(n,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return R4(Le.read(n,t),t);break;case 9:if(a[1]<=8)return ch(n,t);break;case 60:return Eo(n,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return cw(n,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return sw.to_workbook(n,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?I4(n,t):Hs(e,n,t,i);case 239:return a[3]===60?Eo(n,t):Hs(e,n,t,i);case 255:if(a[1]===254)return D4(n,t);if(a[1]===0&&a[2]===2&&a[3]===0)return ma.to_workbook(n,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return ma.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return df.to_workbook(n,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Uw.to_workbook(n,t);break;case 10:case 13:case 32:return O4(n,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return aw.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?df.to_workbook(n,t):Hs(e,n,t,i)}function N4(e,r,t,n,a,i,s,o){var c=xt(t),f=o.defval,l=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,d=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:t,enumerable:!1})}catch{d.__rowNum__=t}else d.__rowNum__=t;if(!s||e[t])for(var h=r.s.c;h<=r.e.c;++h){var x=s?e[t][h]:e[n[h]+c];if(x===void 0||x.t===void 0){if(f===void 0)continue;i[h]!=null&&(d[i[h]]=f);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[h]!=null){if(p==null)if(x.t=="e"&&p===null)d[i[h]]=null;else if(f!==void 0)d[i[h]]=f;else if(l&&p===null)d[i[h]]=null;else continue;else d[i[h]]=l&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?p:Ir(x,p,o);p!=null&&(u=!1)}}return{row:d,isempty:u}}function Co(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},f=r||{},l=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof l){case"string":c=Ze(l);break;case"number":c=Ze(e["!ref"]),c.s.r=l;break;default:c=l}n>0&&(a=0);var u=xt(c.s.r),d=[],h=[],x=0,p=0,m=Array.isArray(e),g=c.s.r,w=0,v={};m&&!e[g]&&(e[g]=[]);var k=f.skipHidden&&e["!cols"]||[],A=f.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(k[w]||{}).hidden)switch(d[w]=it(w),t=m?e[g][w]:e[d[w]+u],n){case 1:i[w]=w-c.s.c;break;case 2:i[w]=d[w];break;case 3:i[w]=f.header[w-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=s=Ir(t,null,f),p=v[s]||0,!p)v[s]=1;else{do o=s+"_"+p++;while(v[o]);v[s]=p,v[o]=1}i[w]=o}for(g=c.s.r+a;g<=c.e.r;++g)if(!(A[g]||{}).hidden){var F=N4(e,c,g,d,n,i,m,f);(F.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(h[x++]=F.row)}return h.length=x,h}var Rf=/"/g;function M4(e,r,t,n,a,i,s,o){for(var c=!0,f=[],l="",u=xt(t),d=r.s.c;d<=r.e.c;++d)if(n[d]){var h=o.dense?(e[t]||[])[d]:e[n[d]+u];if(h==null)l="";else if(h.v!=null){c=!1,l=""+(o.rawNumbers&&h.t=="n"?h.v:Ir(h,null,o));for(var x=0,p=0;x!==l.length;++x)if((p=l.charCodeAt(x))===a||p===i||p===34||o.forceQuotes){l='"'+l.replace(Rf,'""')+'"';break}l=="ID"&&(l='"ID"')}else h.f!=null&&!h.F?(c=!1,l="="+h.f,l.indexOf(",")>=0&&(l='"'+l.replace(Rf,'""')+'"')):l="";f.push(l)}return o.blankrows===!1&&c?null:f.join(s)}function dh(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var a=Ze(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),f=new RegExp((i=="|"?"\\|":i)+"+$"),l="",u=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(d[x]||{}).hidden||(u[x]=it(x));for(var p=0,m=a.s.r;m<=a.e.r;++m)(h[m]||{}).hidden||(l=M4(e,a,m,u,s,c,i,n),l!=null&&(n.strip&&(l=l.replace(f,"")),(l||n.blankrows!==!1)&&t.push((p++?o:"")+l)));return delete n.dense,t.join("")}function L4(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=dh(e,r);return t}function B4(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var a=Ze(e["!ref"]),i="",s=[],o,c=[],f=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=it(o);for(var l=a.s.r;l<=a.e.r;++l)for(i=xt(l),o=a.s.c;o<=a.e.c;++o)if(r=s[o]+i,t=f?(e[l]||[])[o]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}c[c.length]=r+"="+n}return c}function ph(e,r,t){var n=t||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Ft(n.origin):n.origin;s=c.r,o=c.c}var f,l={s:{c:0,r:0},e:{c:o,r:s+r.length-1+a}};if(i["!ref"]){var u=Ze(i["!ref"]);l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),s==-1&&(s=u.e.r+1,l.e.r=s+r.length-1+a)}else s==-1&&(s=0,l.e.r=r.length-1+a);var d=n.header||[],h=0;r.forEach(function(p,m){gr(p).forEach(function(g){(h=d.indexOf(g))==-1&&(d[h=d.length]=g);var w=p[g],v="z",k="",A=Re({c:o+h,r:s+m+a});f=Oa(i,A),w&&typeof w=="object"&&!(w instanceof Date)?i[A]=w:(typeof w=="number"?v="n":typeof w=="boolean"?v="b":typeof w=="string"?v="s":w instanceof Date?(v="d",n.cellDates||(v="n",w=It(w)),k=n.dateNF||Oe[14]):w===null&&n.nullError&&(v="e",w=0),f?(f.t=v,f.v=w,delete f.w,delete f.R,k&&(f.z=k)):i[A]=f={t:v,v:w},k&&(f.z=k))})}),l.e.c=Math.max(l.e.c,o+d.length-1);var x=xt(s);if(a)for(h=0;h<d.length;++h)i[it(h+o)+x]={t:"s",v:d[h]};return i["!ref"]=Be(l),i}function U4(e,r){return ph(null,e,r)}function Oa(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=Ft(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Oa(e,Re(r)):Oa(e,Re({r,c:t||0}))}function z4(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function bc(){return{SheetNames:[],Sheets:{}}}function Ac(e,r,t,n){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var i=t.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=s+a)!=-1;++a);}if(TT(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function $4(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=z4(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function H4(e,r){return e.z=r,e}function xh(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function W4(e,r,t){return xh(e,"#"+r,t)}function V4(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function G4(e,r,t,n){for(var a=typeof r!="string"?r:Ze(r),i=typeof r=="string"?r:Be(r),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var c=Oa(e,s,o);c.t="n",c.F=i,delete c.v,s==a.s.r&&o==a.s.c&&(c.f=t,n&&(c.D=!0))}return e}var X4={encode_col:it,encode_row:xt,encode_cell:Re,encode_range:Be,decode_col:uc,decode_row:lc,split_cell:nv,decode_cell:Ft,decode_range:Wn,format_cell:Ir,sheet_add_aoa:vu,sheet_add_json:ph,sheet_add_dom:fh,aoa_to_sheet:Vn,json_to_sheet:U4,table_to_sheet:lh,table_to_book:c4,sheet_to_csv:dh,sheet_to_txt:L4,sheet_to_json:Co,sheet_to_html:o4,sheet_to_formulae:B4,sheet_to_row_object_array:Co,sheet_get_cell:Oa,book_new:bc,book_append_sheet:Ac,book_set_sheet_visibility:$4,cell_set_number_format:H4,cell_set_hyperlink:xh,cell_set_internal_link:W4,cell_add_comment:V4,sheet_set_array_formula:G4,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class j4 extends HTMLElement{constructor(){super();At(this,"chartContainer");At(this,"tooltipContainer");const t=this.attachShadow({mode:"open"});t.innerHTML=`
      <style>
        #container { display: flex; 
          background:var(--container-bg);
          color: var(--color-text);
          padding: 5px;
        }
        #settings { 
          width: 300px; 
          padding-right: 10px; 
          margin-top: 10px;
          margin-left: 10px;
          margin-bottom: 10px;
          margin-right: 10px;
        }
        #tooltipContainer {
          flex: 1;
          border: 1px solid #ddd;
          padding: 10px;
          min-height: 100px;
          margin-left: 10px;
          margin-right: 10px;
          margin-top: 10px;
          border-radius: 10px;
          background: #353d46;
          color: white;
          overflow-y: auto;
          opacity: 1;
          transition: opacity 0.2s ease-in-out;
        }
        #chart { height: 600px; border: 1px solid #ccc; margin-top: 10px; 
          background: #353d46;
          margin-bottom: 20px;
          position: relative;
          border-radius: 20px;
          margin-left: 10px;
          margin-right: 10px;

        }
        #chart svg { width: 100%; height: 100%; }
      </style>

      <div id="container">
        <div id="settings">
          <input type="file" id="fileUpload" accept=".xlsx, .csv" />
          <button id="retryUpload">🔄 Retry</button>

          <div id="column-selectors" style="display:none;">
            <label>Parent Column:</label>
            <select id="parentSelect"></select>
            <label>Child Column:</label>
            <select id="childSelect"></select>
            <button id="renderButton">Render Tree</button>

            <div>
              <label>Tooltip Fields (Ctrl+Click for multiple):</label>
              <select id="tooltipFields" multiple style="height:100px;width:200px;"></select>
            </div>
          </div>
        </div>

        <div id="tooltipContainer">Hover a node to see details here.</div>
      </div>

      <div id="chart"></div>
    `}connectedCallback(){const t=this.shadowRoot,n=t.getElementById("fileUpload"),a=t.getElementById("retryUpload"),i=t.getElementById("parentSelect"),s=t.getElementById("childSelect"),o=t.getElementById("renderButton"),c=t.getElementById("column-selectors"),f=t.getElementById("tooltipFields");this.chartContainer=t.getElementById("chart"),this.tooltipContainer=t.getElementById("tooltipContainer");let l=[];a.onclick=()=>{n.value="",c.style.display="none",this.chartContainer.innerHTML="",this.tooltipContainer.textContent="Hover a node to see details here.",l=[]},n.onchange=()=>{var h;const u=(h=n.files)==null?void 0:h[0];if(!u)return;const d=new FileReader;d.onload=x=>{var v;const p=new Uint8Array((v=x.target)==null?void 0:v.result),m=So(p,{type:"array"}),g=m.Sheets[m.SheetNames[0]];l=X4.sheet_to_json(g,{header:0,defval:""});const w=Object.keys(l[0]);i.innerHTML=s.innerHTML=f.innerHTML="",w.forEach(k=>{[i,s,f].forEach(A=>{const F=document.createElement("option");F.value=F.textContent=k,A.appendChild(F.cloneNode(!0))})}),c.style.display="block"},d.readAsArrayBuffer(u)},o.onclick=()=>{const u=i.value,d=s.value,h=Array.from(f.selectedOptions).map(x=>x.value);if(u===d){alert("Parent and Child columns must be different.");return}this.renderTree(l,u,d,h)}}renderTree(t,n,a,i){const s=ug().id((d,h)=>`${d[a]}_${h}`).parentId(d=>t.find(h=>h[a]===d[n])?`${d[n]}_${t.indexOf(t.find(h=>h[a]===d[n]))}`:null)(t);_g().nodeSize([160,100])(s),s.eachAfter(d=>d.data.nodeCount=d.children?d.children.reduce((h,x)=>h+(x.data.nodeCount||0),0)+d.children.length:0);const c=Pl(Sg).domain([qd(s.descendants(),d=>d.data.nodeCount)||1,0]),f=Op("svg").attr("viewBox",[-1e3,-500,2e3,2e3]),l=f.append("g");f.call(Vg().on("zoom",d=>{const{transform:h}=d;l.attr("transform",h.toString())})),l.selectAll("path").data(s.links()).enter().append("path").attr("fill","none").attr("stroke","#ccc").attr("stroke-width",4).attr("d",Lg().source(d=>[d.source.x,d.source.y]).target(d=>[d.target.x,d.target.y]));const u=l.selectAll("g").data(s.descendants()).enter().append("g").attr("transform",d=>`translate(${d.x},${d.y})`).style("cursor","pointer").on("mouseover",(d,h)=>{jt(this.tooltipContainer).transition().duration(200).style("opacity",0).on("end",()=>{this.tooltipContainer.innerHTML=i.map(x=>`<strong>${x}</strong>: ${h.data[x]}`).join("<br>"),jt(this.tooltipContainer).transition().duration(200).style("opacity",1)}),jt(d.currentTarget).select("rect").transition().duration(200).attr("stroke-width",5).attr("stroke","white")}).on("mouseout",(d,h)=>{jt(d.currentTarget).select("rect").transition().duration(200).attr("stroke-width",1).attr("stroke","#333")});u.append("rect").attr("width",120).attr("height",50).attr("x",-60).attr("y",-25).attr("rx",10).attr("ry",10).attr("fill",d=>c(d.data.nodeCount??0)).attr("stroke","#333").attr("stroke-width",1),u.append("text").attr("text-anchor","middle").attr("dy",".35em").attr("fill","white").style("font-weight","bold").style("font-size","14px").text(d=>String(d.data[a]).slice(0,15)),this.chartContainer.innerHTML="",this.chartContainer.append(f.node())}}customElements.define("tree-bom-page",j4);async function mh(){const e="https://partsmanual.blob.core.windows.net/authenticationhash/credentials.json?sp=racwdli&st=2025-03-10T16:47:55Z&se=2025-08-01T00:47:55Z&sv=2022-11-02&sr=c&sig=4BjCw6SBZmI606wTM3GEQUYRcuhRQMlgKrj0Wy%2B4Y8g%3D";try{const r=await fetch(e,{cache:"no-cache"});if(!r.ok)throw new Error(`Failed to fetch whitelisted emails: ${r.statusText}`);const t=await r.json(),n=new Set;return t.forEach(a=>{n.add(a.Email.toLowerCase())}),console.log("Fetched whitelisted emails:",n),n}catch(r){return console.error("Error fetching whitelist. Returning fallback set:",r),new Set(["hshields@trebro.com"])}}let gh=[];(async()=>{const e=await mh();gh=Array.from(e)})();function Y4(e){const r=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));return r?decodeURIComponent(r[2]):null}class K4{async isAuthenticated(){return!!Y4("auth")}async setUserData(r){const t=r.email.toLowerCase();if(!gh.includes(t))throw new Error("Email not registered. Please request access.");window.localStorage.zeaUserData=JSON.stringify({email:t})}async getUserData(){const{zeaUserData:r}=window.localStorage;return r?JSON.parse(r):null}async signOut(){localStorage.removeItem("zeaUserData"),document.cookie="auth=; Path=/; Max-Age=0"}}const Fo=new K4;let Ws=null;function q4(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}class Z4 extends HTMLElement{constructor(){super();At(this,"modal");At(this,"content");At(this,"onCloseCallback");At(this,"initialBtnHTML");const t=this.attachShadow({mode:"open"});this.modal=document.createElement("div"),this.modal.classList.add("modal"),t.appendChild(this.modal),this.content=document.createElement("div"),this.content.classList.add("modal-content"),this.modal.appendChild(this.content),this.content.innerHTML=`
      <div class="container">
        <div class="imgcontainer">
          <img src="data/Crescent1.png" alt="Logo" class="logo">
        </div>
        <label for="uname"><b>Email</b></label>
        <input id="uname" type="text" placeholder="Enter Email" name="uname" required>

        <!-- CHANGED: remove password container entirely -->
        <button id="sendLinkBtn" class="btn">
          <span class="icon-text">
            <i class="fas fa-paper-plane"></i>
            <span class="text">Send Magic Link</span>
          </span>
          <span class="wave-spinner">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </span>
        </button>

        <!-- Microsoft Form container (unchanged) -->
        <div id="msFormContainer" style="display: none; margin-top: 1rem;">
          <p>If you don’t have an account, please fill out the form below:</p>
          <iframe id="msForm"
            width="640px"
            height="480px"
            frameborder="0"
            marginwidth="0"
            marginheight="0"
            style="border: none; max-width: 100%; max-height: 100vh;"
            allowfullscreen
            webkitallowfullscreen
            mozallowfullscreen
            msallowfullscreen
          ></iframe>
        </div>
      </div>
    `;const n=this.shadowRoot.getElementById("uname"),a=this.shadowRoot.getElementById("sendLinkBtn"),i=this.shadowRoot.getElementById("msFormContainer"),s=[{step0:"rgb(255, 255, 255)",step40:"rgb(255, 160, 105)",step50:"#f36f21"},{step0:"rgb(255, 255, 255)",step40:"rgb(255, 228, 141)",step50:"#FABF35"},{step0:"rgb(255, 255, 255)",step40:"rgb(255, 143, 143)",step50:"#EA3546"},{step0:"rgb(255, 255, 255)",step40:"rgb(136, 148, 255)",step50:"#345995"}];a.querySelectorAll(".wave-spinner > div").forEach(u=>{const d=s[Math.floor(Math.random()*s.length)];u.style.setProperty("--wave-color-0",d.step0),u.style.setProperty("--wave-color-40",d.step40),u.style.setProperty("--wave-color-50",d.step50)}),a.style.display="none",n.addEventListener("input",async()=>{const u=n.value.trim().toLowerCase();Ws||(Ws=await mh()),q4(u)?Array.from(Ws).some(h=>h.startsWith(u))?(a.style.display="block",i.style.display="none"):(a.style.display="none",i.style.display="block"):(a.style.display="none",i.style.display="none")}),this.initialBtnHTML=a.innerHTML;const c=a.innerHTML,f=async()=>{const u=n.value.trim().toLowerCase();await Fo.setUserData({email:u}),a.disabled=!0,a.classList.add("loading"),setTimeout(()=>{a.classList.remove("loading"),a.classList.add("success"),a.textContent="Success! Check your email",document.cookie="auth=testing; path=/;",a.innerHTML=c,a.classList.add("success"),a.textContent="Success! Check your email",this.content.classList.add("minimized"),a.onclick=f,setTimeout(()=>{document.dispatchEvent(new CustomEvent("login-success"))},1e3)},1500)};a.onclick=f;const l=document.createElement("style");l.appendChild(document.createTextNode(`
        @keyframes slideDown {
          0% {
            opacity: 0;
            transform: translateY(-50px);
          }
          100% {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes slideUp {
          0% {
            opacity: 1;
            transform: translateY(0);
          }
          100% {
            opacity: 0;
            transform: translateY(-50px);
          }
        }
        /* The Modal (background) */
        .modal {
          display: none; /* Hidden by default */
          position: fixed; /* Stay in place */
          z-index: 1; /* Sit on top */
          left: 0;
          top: 0;
          width: 100%; /* Full width */
          height: 100%; /* Full height */
          overflow: auto; /* Enable scroll if needed */
          background-color: rgb(0,0,0); /* Fallback color */
          background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        }

        /* Modal Content initial state */
        .modal-content {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          transition: transform 1.5s ease-in-out, top 1.5s ease-in-out, left 1.5s ease-in-out, width 1.5s ease-in-out, height 1.5s ease-in-out, opacity 1.5s ease-in-out;
          width: 80%;
          max-width: 600px;
          border-radius: 10px;
          z-index: 1000;
          background:var(--container-bg);
        }
        label {
          color: var(--color-text);
          display: block; /* So it sits on its own line */
        }
        .modal-content.minimized {
          opacity: 0;
        }

        /* Transition for the logo image */
        .logo {
          transition: transform 0.6s ease-in-out, width 0.6s ease-in-out;
        }

        /* When modal-content is minimized, the logo scales down */
        .modal-content.minimized .logo {
          transform: scale(0.5) rotate(-90deg);
          /* Alternatively, you can set a new width:
            width: 100px; 
          */
        }
        /* By default, hide animations (unless class is added) */
        opacity: 0;
        transform: translateY(-50px);
       }

        /* Opening animation */
        .opening-animation {
          animation: slideDown 0.4s ease forwards;
        }

        /* Closing animation */
        .closing-animation {
          animation: slideUp 0.4s ease forwards;
        }

        /* The Close Button */
        .close {
          color: #aaa;
          float: right;
          font-size: 28px;
          font-weight: bold;
        }

        .close:hover,
        .close:focus {
          color: black;
          text-decoration: none;
          cursor: pointer;
        }

        /* Full-width inputs */
        input[type=text], input[type=password] {
          width: 100%;
          padding: 12px 20px;
          margin: 12px 0;
          display: inline-block;
          border: 1px solid #ccc;
          box-sizing: border-box;
          border-radius: 12px;
        }

        /* Set a style for all buttons */
        button {
          background-color: #f36f21;
          color: black;
          padding: 14px 20px;
          margin: 8px 0;
          border: none;
          cursor: pointer;
          width: 100%;
        }

        /* Add a hover effect for buttons */
        button:hover {
          opacity: 0.8;
        }

        /* Extra style for the cancel button (red) */
        .cancelbtn {
          width: auto;
          padding: 10px 18px;
          background-color: #f44336;
        }

        /* Center the avatar image inside this container */
        .imgcontainer {
          text-align: center;
          margin: 24px 0 12px 0;
        }

        /* Avatar image */
        img.avatar {
          height: 40px;
        }

        /* Add padding to containers */
        .container {
          padding: 16px;
        }

        /* The "Forgot password" text */
        span.psw {
          float: right;
          padding-top: 16px;
        }

        /* Change styles for span and cancel button on extra small screens */
        @media screen and (max-width: 300px) {
          span.psw {
            display: block;
            float: none;
          }
          .cancelbtn {
            width: 100%;
          }
        }

        /* Style for the logo image */
        .logo {
          width: 200px; /* Adjust the width as needed */
          height: auto;
        }
              /* Base Button Styles */
      .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background:var(--container-bg);
      color: var(--color-text);
      font-size: 14px;
      font-weight: bold;
      border-radius: 12px;
      cursor: pointer;
      height: 45px;
      border: 3px solid var(--color-text);
      margin: auto;
      padding: 0 16px;
      transition: width 0.25s ease, height 0.25s ease, padding 0.25s ease;
      overflow: hidden;
      }
      

      .btn:hover {
      background-color: #e36a1e;
      color: white;
      border: none;
      
      }

      /* Container for Icon and Text */
      .btn .icon-text {
      display: absolute;
      align-items: center;
      justify-content: center;
      transition: opacity 0.25s ease;
      }

      .btn .icon-text i {
      margin-right: 8px;
      }

      /* Wave Spinner Container (hidden by default) */
      .btn .wave-spinner {
      display: none;
      }

      /* Loading State: Button shrinks to a specific size */
      .btn.loading {
      width: 140px;
      height: 60px;
      border-radius: 25px;
      border: none;
      background:var(--container-bg);
      padding: 0; /* Remove extra padding */
      animation: colorTransition 0.5s ease forwards; /* Add color transition */
      }

      /* In Loading State, remove the icon/text and reveal the spinner */
      .btn.loading .icon-text {
      display: none;
      }

      .btn.loading .wave-spinner {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      }

      /* Wave Spinner Dot Styles */
      .wave-spinner {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      }

      .wave-spinner > div {
      width: 6px;
      height: 8px;
      margin: 0 6px;
      border-radius: 20%; /* Rotate to form diamond shape */
      background:var(--container-bg);
      animation: scaling 1.2s ease-in-out infinite;
      }

      /* Set staggered animation delays for a wave effect */
      .wave-spinner > div:nth-child(1) {
      animation-delay: -0.6s;
      }
      .wave-spinner > div:nth-child(2) {
      animation-delay: -0.4s;
      }
      .wave-spinner > div:nth-child(3) {
      animation-delay: -0.2s;
      }
      .wave-spinner > div:nth-child(4) {
      animation-delay: 0s;
      }
      .wave-spinner > div:nth-child(5) {
      animation-delay: 0.2s;
      }

      @keyframes scaling {
        0%, 100% {
          transform: scaleY(0.5);
          background-color: var( --container-bg);
        }
        40% {
          transform: scaleY(1.5);
          background-color: var(--wave-color-40, rgb(255, 160, 105));
        }
        50% {
          transform: scaleY(3);
          background-color: var(--wave-color-50, #f36f21);
        }
      }

      /* Color Transition Animation */
      @keyframes colorTransition {
      0% {
      background-color: #f36f21;
      }
      100% {
      background:var(--container-bg);
      }
      }

      @keyframes successTransition {
        0% {
         background:var(--container-bg);
        }
        50% {
         background:var(--container-bg);
        }
        100% {
          background-color: #28a745;
        }
      }

      /* Success State Styling */
      .btn.success {
        animation: successTransition 0.7s ease forwards;
        background-color: #28a745;  /* Green */
        border: none;
        color: #fff;
      }
      `)),t.appendChild(l)}minimizeAndClose(){const t=document.querySelector(".modal-content");t&&t.classList.add("minimized"),setTimeout(()=>{t&&(t.style.display="none"),document.dispatchEvent(new CustomEvent("login-success"))},1500)}resetSendLinkButton(){const t=this.shadowRoot.getElementById("sendLinkBtn");t.disabled=!1,t.classList.remove("loading","success"),t.innerHTML=this.initialBtnHTML}show(t){console.log("login-dialog show() invoked"),this.content.classList.remove("minimized"),this.onCloseCallback=t,this.style.display="block",this.hidden=!1,this.modal.style.display="block"}close(){console.log("login-dialog close() invoked"),this.modal.style.display="none",this.style.display="none",this.hidden=!0,this.onCloseCallback&&this.onCloseCallback()}}customElements.define("login-dialog",Z4);let If=!1;class J4 extends HTMLElement{constructor(){super();At(this,"modal");At(this,"content");At(this,"loadFileCallback");const t=this.attachShadow({mode:"open"});this.modal=document.createElement("div"),this.modal.classList.add("modal"),t.appendChild(this.modal),this.content=document.createElement("div"),this.content.classList.add("modal-content"),this.modal.appendChild(this.content),this.content.innerHTML=`<div id="fileDropZone" class="fixed w-full flex h-screen">
    <input
      accept=".zcad, .gltf, .glb, gltf, .obj"
      multiple
      type="file"
      class="absolute inset-0 z-50 m-0 p-0 w-full h-full outline-none opacity-0"
      id="dropHotSpot"
    />
      <div
        class="border-2 border-gray-400 py-12 justify-center items-center p-4 m-auto rounded-lg w-3/12 h-1/3 bg-gray-200 bg-opacity-25 hover:bg-blue-200 hover:bg-opacity-25 text-black grid justify-items-center"
      >
        <div class="m-auto">
          <div class="flex flex-col space-y-2 items-center justify-center">
            <i class="fas fa-cloud-upload-alt fa-3x text-currentColor" />
            <p class="text-gray-700 text-center">Drag your gltf, obj or zcad files here or click in this area.</p>
          </div>
        </div>
      </div>
  </div>`;const n=l=>{If&&this.shadowRoot.getElementById("fileDropZone").classList.remove("pointer-events-none"),l.preventDefault()},a=l=>{l.preventDefault()},i=l=>{if(l.dataTransfer){for(var u=0;u<l.dataTransfer.items.length;u++)if(l.dataTransfer.items[u].kind==="file"){const d=l.dataTransfer.items[u].getAsFile();d&&o(d)}}l.preventDefault()},s=l=>{for(var u=0;u<l.target.files.length;u++){let d=l.target.files[u];o(d)}l.preventDefault()},o=l=>{const u=new FileReader;u.addEventListener("load",()=>{const d=u.result,h=l.name;this.loadFile(d,h)},!1),u.readAsDataURL(l)},c=this.shadowRoot.getElementById("dropHotSpot");c.addEventListener("change",s),c.addEventListener("drop",i),document.body.addEventListener("dragover",a),document.body.addEventListener("dragenter",n),document.body.addEventListener("drop",i);const f=document.createElement("style");f.appendChild(document.createTextNode(`
/* The Modal (background) */
.modal {
  display: block; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content/Box */
.modal-content {
  background-color: #eeeeee88;
  margin: 15% auto; /* 15% from the top and centered */
  padding: 20px;
  border: 1px solid #888;
  width: 80%; /* Could be more or less, depending on screen size */
  max-width: 600px;
}

`)),t.appendChild(f),this.hide()}display(t){this.loadFileCallback=t,this.modal.style.setProperty("pointer-events","auto"),this.modal.style.setProperty("display","block")}hide(){this.modal.style.setProperty("pointer-events","none"),this.modal.style.setProperty("display","none")}loadFile(t,n){this.hide(),If=!0,this.loadFileCallback&&this.loadFileCallback(t,n)}}customElements.define("drop-zone",J4);class Q4 extends HTMLElement{constructor(){super();const r=this.attachShadow({mode:"open"});r.innerHTML=`
        <style>
          header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: var(--container-bg);
            padding: 10px 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            font-family: sans-serif;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 5px 10px black (0, 0, 0, 0.2);
          }
            .logo-container {
            display: flex;
            align-items: center;
            color: var(--color-text);
            }

          #darkModeToggle {
            margin-left: 10px;
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            transition: transform 0.3s ease;
          }

          #darkModeToggle:hover {
            transform: rotate(20deg) scale(1.2);
          }
            
            @keyframes slideRight {
            to {
                transform: translateX(0) rotate(90);
                opacity: 1;
            }
            }

            .logo {
            height: 40px;
            margin-right: 10px;
            transform: scale(0.5) rotate(-90deg);
            opacity: 0;
            animation: logoScaleIn 1.4s ease forwards;
            }

            @keyframes logoScaleIn {
            to {
                transform: scale(1);
                opacity: 1;
            }
            }
          .header-buttons {
            display: flex;
            gap: 10px;
          }
          /* Style header buttons similar to sendmagiclinkbtn */
          .header-btn {
            background-color: var(--container-bg);
            color: var(--color-text);
            font-size: 14px;
            font-weight: bold;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            padding: 10px 16px;
            transition: background-color 0.25s ease;
          }

          .header-btn:hover {
            background-color: #e36a1e;
            transform: scale(1.1);
            transition: transform 0.1s ease;
            color: white;
          }
          /* Initially hide the logout button; you'll show it when needed */
          .header-btn#logoutButton {
            background-color: red
            color: white;
          }
          .header-btn#logoutButton {
            background-color:rgb(194, 69, 47);  /* or a different base color if you prefer */
            color: white;
            /* Don’t forget the semicolon! */
          }
          .header-btn#logoutButton:hover {
            background-color: darkred; /* or just 'red' if you want no change */
            transform: scale(1.1);
            color: white;
          }
          .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 28px;
            margin-left: 10px;
          }

          .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
          }

          .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0;
            right: 0; bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 34px;
          }

          .slider::before {
            position: absolute;
            content: "☀️";
            height: 22px;
            width: 22px;
            left: 3px;
            bottom: 3px;
            background-color: var(--container-bg);
            border-radius: 50%;
            transition: 0.4s;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
          }

          input:checked + .slider {
            background-color: #555;
          }

          input:checked + .slider::before {
            transform: translateX(22px);
            content: "🌙";
          }

            
        </style>
        <header>
          <div class="logo-container">
            <img src="data/Crescent1.png" alt="Logo" class="logo">
            <span>fettle</span>
            <label class="toggle-switch" title="Toggle Dark Mode">
              <input type="checkbox" id="darkModeToggle" />
              <span class="slider"></span>
            </label>
          </div>
          <div class="header-buttons">
            <button class="header-btn" id="homeButton">Home</button>
            <button class="header-btn" id="goCluster">Cluster</button>
            <button class="header-btn" id="goLogo">Logo</button>
            <button class="header-btn" id="goTreeBOM">TreeBOM</button>
            <button class="header-btn" id="featuresButton">Features</button>
            <button class="header-btn" id="logoutButton">Logout</button>
          </div>
        </header>
      `}connectedCallback(){const r=this.shadowRoot,t=r.getElementById("darkModeToggle"),n=localStorage.getItem("darkMode")==="true";t.checked=n,t.addEventListener("change",()=>{document.dispatchEvent(new CustomEvent("toggleDarkMode"))}),r.getElementById("homeButton").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"home"})),r.getElementById("featuresButton").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"features"})),r.getElementById("goCluster").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"cluster"})),r.getElementById("goTreeBOM").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"treebom"})),r.getElementById("goLogo").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"logo"})),r.getElementById("logoutButton").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"logout"}))}}customElements.define("main-header",Q4);function Vs(){const e=20+Math.random()*40,r=20+Math.random()*40,t=20+Math.random()*40,n=20+Math.random()*40,a=20+Math.random()*40,i=20+Math.random()*40;return`polygon(
      0% ${e}%,
      15% ${n}%,
      33% ${r}%,
      50% ${a}%,
      66% ${t}%,
      82% ${i}%,
      100% ${e}%,
      100% 100%,
      0 100%
    )`}function Of(){const e=document.body.style,r=Vs(),t=Vs(),n=Vs();e.setProperty("--wave1-clip",r),e.setProperty("--wave2-clip",t),e.setProperty("--wave3-clip",n)}function eb(){Of(),setInterval(Of,3e3)}const Ro="RFC3986",Io={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},tb="RFC1738",rb=Array.isArray,lr=(()=>{const e=[];for(let r=0;r<256;++r)e.push("%"+((r<16?"0":"")+r.toString(16)).toUpperCase());return e})(),Gs=1024,nb=(e,r,t,n,a)=>{if(e.length===0)return e;let i=e;if(typeof e=="symbol"?i=Symbol.prototype.toString.call(e):typeof e!="string"&&(i=String(e)),t==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let s="";for(let o=0;o<i.length;o+=Gs){const c=i.length>=Gs?i.slice(o,o+Gs):i,f=[];for(let l=0;l<c.length;++l){let u=c.charCodeAt(l);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||a===tb&&(u===40||u===41)){f[f.length]=c.charAt(l);continue}if(u<128){f[f.length]=lr[u];continue}if(u<2048){f[f.length]=lr[192|u>>6]+lr[128|u&63];continue}if(u<55296||u>=57344){f[f.length]=lr[224|u>>12]+lr[128|u>>6&63]+lr[128|u&63];continue}l+=1,u=65536+((u&1023)<<10|c.charCodeAt(l)&1023),f[f.length]=lr[240|u>>18]+lr[128|u>>12&63]+lr[128|u>>6&63]+lr[128|u&63]}s+=f.join("")}return s};function ab(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function Df(e,r){if(rb(e)){const t=[];for(let n=0;n<e.length;n+=1)t.push(r(e[n]));return t}return r(e)}const ib=Object.prototype.hasOwnProperty,_h={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,r){return String(e)+"["+r+"]"},repeat(e){return String(e)}},hr=Array.isArray,sb=Array.prototype.push,vh=function(e,r){sb.apply(e,hr(r)?r:[r])},ob=Date.prototype.toISOString,nt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:nb,encodeValuesOnly:!1,format:Ro,formatter:Io[Ro],indices:!1,serializeDate(e){return ob.call(e)},skipNulls:!1,strictNullHandling:!1};function cb(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const Xs={};function wh(e,r,t,n,a,i,s,o,c,f,l,u,d,h,x,p,m,g){let w=e,v=g,k=0,A=!1;for(;(v=v.get(Xs))!==void 0&&!A;){const G=v.get(e);if(k+=1,typeof G<"u"){if(G===k)throw new RangeError("Cyclic object value");A=!0}typeof v.get(Xs)>"u"&&(k=0)}if(typeof f=="function"?w=f(r,w):w instanceof Date?w=d==null?void 0:d(w):t==="comma"&&hr(w)&&(w=Df(w,function(G){return G instanceof Date?d==null?void 0:d(G):G})),w===null){if(i)return c&&!p?c(r,nt.encoder,m,"key",h):r;w=""}if(cb(w)||ab(w)){if(c){const G=p?r:c(r,nt.encoder,m,"key",h);return[(x==null?void 0:x(G))+"="+(x==null?void 0:x(c(w,nt.encoder,m,"value",h)))]}return[(x==null?void 0:x(r))+"="+(x==null?void 0:x(String(w)))]}const F=[];if(typeof w>"u")return F;let E;if(t==="comma"&&hr(w))p&&c&&(w=Df(w,c)),E=[{value:w.length>0?w.join(",")||null:void 0}];else if(hr(f))E=f;else{const G=Object.keys(w);E=l?G.sort(l):G}const z=o?String(r).replace(/\./g,"%2E"):String(r),C=n&&hr(w)&&w.length===1?z+"[]":z;if(a&&hr(w)&&w.length===0)return C+"[]";for(let G=0;G<E.length;++G){const H=E[G],b=typeof H=="object"&&typeof H.value<"u"?H.value:w[H];if(s&&b===null)continue;const X=u&&o?H.replace(/\./g,"%2E"):H,_=hr(w)?typeof t=="function"?t(C,X):C:C+(u?"."+X:"["+X+"]");g.set(e,k);const W=new WeakMap;W.set(Xs,g),vh(F,wh(b,_,t,n,a,i,s,o,t==="comma"&&p&&hr(w)?null:c,f,l,u,d,h,x,p,m,W))}return F}function fb(e=nt){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const r=e.charset||nt.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=Ro;if(typeof e.format<"u"){if(!ib.call(Io,e.format))throw new TypeError("Unknown format option provided.");t=e.format}const n=Io[t];let a=nt.filter;(typeof e.filter=="function"||hr(e.filter))&&(a=e.filter);let i;if(e.arrayFormat&&e.arrayFormat in _h?i=e.arrayFormat:"indices"in e?i=e.indices?"indices":"repeat":i=nt.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const s=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:nt.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:nt.addQueryPrefix,allowDots:s,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:nt.allowEmptyArrays,arrayFormat:i,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:nt.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?nt.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:nt.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:nt.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:nt.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:nt.encodeValuesOnly,filter:a,format:t,formatter:n,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:nt.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:nt.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:nt.strictNullHandling}}function lb(e,r={}){let t=e;const n=fb(r);let a,i;typeof n.filter=="function"?(i=n.filter,t=i("",t)):hr(n.filter)&&(i=n.filter,a=i);const s=[];if(typeof t!="object"||t===null)return"";const o=_h[n.arrayFormat],c=o==="comma"&&n.commaRoundTrip;a||(a=Object.keys(t)),n.sort&&a.sort(n.sort);const f=new WeakMap;for(let d=0;d<a.length;++d){const h=a[d];n.skipNulls&&t[h]===null||vh(s,wh(t[h],h,o,c,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,f))}const l=s.join(n.delimiter);let u=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?u+="utf8=%26%2310003%3B&":u+="utf8=%E2%9C%93&"),l.length>0?u+l:""}const En="4.90.0";let Pf=!1,wa,yh,kh,Oo,Eh,Th,bh,Ah,Sh;function ub(e,r={auto:!1}){if(Pf)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(wa)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${wa}'\``);Pf=r.auto,wa=e.kind,yh=e.fetch,kh=e.FormData,Oo=e.File,Eh=e.ReadableStream,Th=e.getMultipartRequestOptions,bh=e.getDefaultAgent,Ah=e.fileFromPath,Sh=e.isFsReadStream}class hb{constructor(r){this.body=r}get[Symbol.toStringTag](){return"MultipartBody"}}function db({manuallyImported:e}={}){const r=e?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,n,a,i;try{t=fetch,n=Request,a=Response,i=Headers}catch(s){throw new Error(`this environment is missing the following Web Fetch API type: ${s.message}. ${r}`)}return{kind:"web",fetch:t,Request:n,Response:a,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${r}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${r}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${r}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${r}`)}},getMultipartRequestOptions:async(s,o)=>({...o,body:new hb(s)}),getDefaultAgent:s=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:s=>!1}}const Ch=()=>{wa||ub(db(),{auto:!0})};Ch();class Se extends Error{}class mt extends Se{constructor(r,t,n,a){super(`${mt.makeMessage(r,t,n)}`),this.status=r,this.headers=a,this.request_id=a==null?void 0:a["x-request-id"],this.error=t;const i=t;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(r,t,n){const a=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return r&&a?`${r} ${a}`:r?`${r} status code (no body)`:a||"(no status code or body)"}static generate(r,t,n,a){if(!r||!a)return new ps({message:n,cause:Po(t)});const i=t==null?void 0:t.error;return r===400?new Fh(r,i,n,a):r===401?new Rh(r,i,n,a):r===403?new Ih(r,i,n,a):r===404?new Oh(r,i,n,a):r===409?new Dh(r,i,n,a):r===422?new Ph(r,i,n,a):r===429?new Nh(r,i,n,a):r>=500?new Mh(r,i,n,a):new mt(r,i,n,a)}}class Yt extends mt{constructor({message:r}={}){super(void 0,void 0,r||"Request was aborted.",void 0)}}class ps extends mt{constructor({message:r,cause:t}){super(void 0,void 0,r||"Connection error.",void 0),t&&(this.cause=t)}}class Sc extends ps{constructor({message:r}={}){super({message:r??"Request timed out."})}}class Fh extends mt{}class Rh extends mt{}class Ih extends mt{}class Oh extends mt{}class Dh extends mt{}class Ph extends mt{}class Nh extends mt{}class Mh extends mt{}class Lh extends Se{constructor(){super("Could not parse response content as the length limit was reached")}}class Bh extends Se{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var di=function(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t},Yr=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},Lt;class xs{constructor(){Lt.set(this,void 0),this.buffer=new Uint8Array,di(this,Lt,null,"f")}decode(r){if(r==null)return[];const t=r instanceof ArrayBuffer?new Uint8Array(r):typeof r=="string"?new TextEncoder().encode(r):r;let n=new Uint8Array(this.buffer.length+t.length);n.set(this.buffer),n.set(t,this.buffer.length),this.buffer=n;const a=[];let i;for(;(i=pb(this.buffer,Yr(this,Lt,"f")))!=null;){if(i.carriage&&Yr(this,Lt,"f")==null){di(this,Lt,i.index,"f");continue}if(Yr(this,Lt,"f")!=null&&(i.index!==Yr(this,Lt,"f")+1||i.carriage)){a.push(this.decodeText(this.buffer.slice(0,Yr(this,Lt,"f")-1))),this.buffer=this.buffer.slice(Yr(this,Lt,"f")),di(this,Lt,null,"f");continue}const s=Yr(this,Lt,"f")!==null?i.preceding-1:i.preceding,o=this.decodeText(this.buffer.slice(0,s));a.push(o),this.buffer=this.buffer.slice(i.index),di(this,Lt,null,"f")}return a}decodeText(r){if(r==null)return"";if(typeof r=="string")return r;if(typeof Buffer<"u"){if(r instanceof Buffer)return r.toString();if(r instanceof Uint8Array)return Buffer.from(r).toString();throw new Se(`Unexpected: received non-Uint8Array (${r.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(r instanceof Uint8Array||r instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(r);throw new Se(`Unexpected: received non-Uint8Array/ArrayBuffer (${r.constructor.name}) in a web platform. Please report this error.`)}throw new Se("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}Lt=new WeakMap;xs.NEWLINE_CHARS=new Set([`
`,"\r"]);xs.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function pb(e,r){for(let a=r??0;a<e.length;a++){if(e[a]===10)return{preceding:a,index:a+1,carriage:!1};if(e[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function xb(e){for(let n=0;n<e.length-1;n++){if(e[n]===10&&e[n+1]===10||e[n]===13&&e[n+1]===13)return n+2;if(e[n]===13&&e[n+1]===10&&n+3<e.length&&e[n+2]===13&&e[n+3]===10)return n+4}return-1}function Uh(e){if(e[Symbol.asyncIterator])return e;const r=e.getReader();return{async next(){try{const t=await r.read();return t!=null&&t.done&&r.releaseLock(),t}catch(t){throw r.releaseLock(),t}},async return(){const t=r.cancel();return r.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class xr{constructor(r,t){this.iterator=r,this.controller=t}static fromSSEResponse(r,t){let n=!1;async function*a(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let i=!1;try{for await(const s of mb(r,t))if(!i){if(s.data.startsWith("[DONE]")){i=!0;continue}if(s.event===null||s.event.startsWith("response.")||s.event.startsWith("transcript.")){let o;try{o=JSON.parse(s.data)}catch(c){throw console.error("Could not parse message into JSON:",s.data),console.error("From chunk:",s.raw),c}if(o&&o.error)throw new mt(void 0,o.error,void 0,Xh(r.headers));yield o}else{let o;try{o=JSON.parse(s.data)}catch(c){throw console.error("Could not parse message into JSON:",s.data),console.error("From chunk:",s.raw),c}if(s.event=="error")throw new mt(void 0,o.error,o.message,void 0);yield{event:s.event,data:o}}}i=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{i||t.abort()}}return new xr(a,t)}static fromReadableStream(r,t){let n=!1;async function*a(){const s=new xs,o=Uh(r);for await(const c of o)for(const f of s.decode(c))yield f;for(const c of s.flush())yield c}async function*i(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let s=!1;try{for await(const o of a())s||o&&(yield JSON.parse(o));s=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{s||t.abort()}}return new xr(i,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const r=[],t=[],n=this.iterator(),a=i=>({next:()=>{if(i.length===0){const s=n.next();r.push(s),t.push(s)}return i.shift()}});return[new xr(()=>a(r),this.controller),new xr(()=>a(t),this.controller)]}toReadableStream(){const r=this;let t;const n=new TextEncoder;return new Eh({async start(){t=r[Symbol.asyncIterator]()},async pull(a){try{const{value:i,done:s}=await t.next();if(s)return a.close();const o=n.encode(JSON.stringify(i)+`
`);a.enqueue(o)}catch(i){a.error(i)}},async cancel(){var a;await((a=t.return)==null?void 0:a.call(t))}})}}async function*mb(e,r){if(!e.body)throw r.abort(),new Se("Attempted to iterate over a response with no body");const t=new _b,n=new xs,a=Uh(e.body);for await(const i of gb(a))for(const s of n.decode(i)){const o=t.decode(s);o&&(yield o)}for(const i of n.flush()){const s=t.decode(i);s&&(yield s)}}async function*gb(e){let r=new Uint8Array;for await(const t of e){if(t==null)continue;const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let a=new Uint8Array(r.length+n.length);a.set(r),a.set(n,r.length),r=a;let i;for(;(i=xb(r))!==-1;)yield r.slice(0,i),r=r.slice(i)}r.length>0&&(yield r)}class _b{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(r){if(r.endsWith("\r")&&(r=r.substring(0,r.length-1)),!r){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(r),r.startsWith(":"))return null;let[t,n,a]=vb(r,":");return a.startsWith(" ")&&(a=a.substring(1)),t==="event"?this.event=a:t==="data"&&this.data.push(a),null}}function vb(e,r){const t=e.indexOf(r);return t!==-1?[e.substring(0,t),r,e.substring(t+r.length)]:[e,"",""]}const zh=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",$h=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&ms(e),ms=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",wb=e=>$h(e)||zh(e)||Sh(e);async function Hh(e,r,t){var a;if(e=await e,$h(e))return e;if(zh(e)){const i=await e.blob();r||(r=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const s=ms(i)?[await i.arrayBuffer()]:[i];return new Oo(s,r,t)}const n=await yb(e);if(r||(r=Eb(e)??"unknown_file"),!(t!=null&&t.type)){const i=(a=n[0])==null?void 0:a.type;typeof i=="string"&&(t={...t,type:i})}return new Oo(n,r,t)}async function yb(e){var t;let r=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)r.push(e);else if(ms(e))r.push(await e.arrayBuffer());else if(Tb(e))for await(const n of e)r.push(n);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(t=e==null?void 0:e.constructor)==null?void 0:t.name}; props: ${kb(e)}`);return r}function kb(e){return`[${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}function Eb(e){var r;return js(e.name)||js(e.filename)||((r=js(e.path))==null?void 0:r.split(/[\\/]/).pop())}const js=e=>{if(typeof e=="string")return e;if(typeof Buffer<"u"&&e instanceof Buffer)return String(e)},Tb=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",Nf=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",$n=async e=>{const r=await bb(e.body);return Th(r,e)},bb=async e=>{const r=new kh;return await Promise.all(Object.entries(e||{}).map(([t,n])=>Do(r,t,n))),r},Do=async(e,r,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${r}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")e.append(r,String(t));else if(wb(t)){const n=await Hh(t);e.append(r,n)}else if(Array.isArray(t))await Promise.all(t.map(n=>Do(e,r+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,a])=>Do(e,`${r}[${n}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var In={},Ab=function(e,r,t,n,a){if(typeof r=="function"?e!==r||!0:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r.set(e,t),t},Sb=function(e,r,t,n){if(typeof r=="function"?e!==r||!0:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},pi;Ch();async function Wh(e){var s;const{response:r}=e;if(e.options.stream)return On("response",r.status,r.url,r.headers,r.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(r,e.controller):xr.fromSSEResponse(r,e.controller);if(r.status===204)return null;if(e.options.__binaryResponse)return r;const t=r.headers.get("content-type"),n=(s=t==null?void 0:t.split(";")[0])==null?void 0:s.trim();if((n==null?void 0:n.includes("application/json"))||(n==null?void 0:n.endsWith("+json"))){const o=await r.json();return On("response",r.status,r.url,r.headers,o),Vh(o,r)}const i=await r.text();return On("response",r.status,r.url,r.headers,i),i}function Vh(e,r){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:r.headers.get("x-request-id"),enumerable:!1})}class gs extends Promise{constructor(r,t=Wh){super(n=>{n(null)}),this.responsePromise=r,this.parseResponse=t}_thenUnwrap(r){return new gs(this.responsePromise,async t=>Vh(r(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(r=>r.response)}async withResponse(){const[r,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:r,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(r,t){return this.parse().then(r,t)}catch(r){return this.parse().catch(r)}finally(r){return this.parse().finally(r)}}class Cb{constructor({baseURL:r,maxRetries:t=2,timeout:n=6e5,httpAgent:a,fetch:i}){this.baseURL=r,this.maxRetries=Ys("maxRetries",t),this.timeout=Ys("timeout",n),this.httpAgent=a,this.fetch=i??yh}authHeaders(r){return{}}defaultHeaders(r){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Db(),...this.authHeaders(r)}}validateHeaders(r,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Lb()}`}get(r,t){return this.methodRequest("get",r,t)}post(r,t){return this.methodRequest("post",r,t)}patch(r,t){return this.methodRequest("patch",r,t)}put(r,t){return this.methodRequest("put",r,t)}delete(r,t){return this.methodRequest("delete",r,t)}methodRequest(r,t,n){return this.request(Promise.resolve(n).then(async a=>{const i=a&&ms(a==null?void 0:a.body)?new DataView(await a.body.arrayBuffer()):(a==null?void 0:a.body)instanceof DataView?a.body:(a==null?void 0:a.body)instanceof ArrayBuffer?new DataView(a.body):a&&ArrayBuffer.isView(a==null?void 0:a.body)?new DataView(a.body.buffer):a==null?void 0:a.body;return{method:r,path:t,...a,body:i}}))}getAPIList(r,t,n){return this.requestAPIList(t,{method:"get",path:r,...n})}calculateContentLength(r){if(typeof r=="string"){if(typeof Buffer<"u")return Buffer.byteLength(r,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(r).length.toString()}else if(ArrayBuffer.isView(r))return r.byteLength.toString();return null}buildRequest(r,{retryCount:t=0}={}){var x;r={...r};const{method:n,path:a,query:i,headers:s={}}=r,o=ArrayBuffer.isView(r.body)||r.__binaryRequest&&typeof r.body=="string"?r.body:Nf(r.body)?r.body.body:r.body?JSON.stringify(r.body,null,2):null,c=this.calculateContentLength(o),f=this.buildURL(a,i);"timeout"in r&&Ys("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const l=r.httpAgent??this.httpAgent??bh(f),u=r.timeout+1e3;typeof((x=l==null?void 0:l.options)==null?void 0:x.timeout)=="number"&&u>(l.options.timeout??0)&&(l.options.timeout=u),this.idempotencyHeader&&n!=="get"&&(r.idempotencyKey||(r.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=r.idempotencyKey);const d=this.buildHeaders({options:r,headers:s,contentLength:c,retryCount:t});return{req:{method:n,...o&&{body:o},headers:d,...l&&{agent:l},signal:r.signal??null},url:f,timeout:r.timeout}}buildHeaders({options:r,headers:t,contentLength:n,retryCount:a}){const i={};n&&(i["content-length"]=n);const s=this.defaultHeaders(r);return Uf(i,s),Uf(i,t),Nf(r.body)&&wa!=="node"&&delete i["content-type"],mi(s,"x-stainless-retry-count")===void 0&&mi(t,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(a)),mi(s,"x-stainless-timeout")===void 0&&mi(t,"x-stainless-timeout")===void 0&&r.timeout&&(i["x-stainless-timeout"]=String(r.timeout)),this.validateHeaders(i,t),i}async prepareOptions(r){}async prepareRequest(r,{url:t,options:n}){}parseHeaders(r){return r?Symbol.iterator in r?Object.fromEntries(Array.from(r).map(t=>[...t])):{...r}:{}}makeStatusError(r,t,n,a){return mt.generate(r,t,n,a)}request(r,t=null){return new gs(this.makeRequest(r,t))}async makeRequest(r,t){var u,d;const n=await r,a=n.maxRetries??this.maxRetries;t==null&&(t=a),await this.prepareOptions(n);const{req:i,url:s,timeout:o}=this.buildRequest(n,{retryCount:a-t});if(await this.prepareRequest(i,{url:s,options:n}),On("request",s,n,i.headers),(u=n.signal)!=null&&u.aborted)throw new Yt;const c=new AbortController,f=await this.fetchWithTimeout(s,i,o,c).catch(Po);if(f instanceof Error){if((d=n.signal)!=null&&d.aborted)throw new Yt;if(t)return this.retryRequest(n,t);throw f.name==="AbortError"?new Sc:new ps({cause:f})}const l=Xh(f.headers);if(!f.ok){if(t&&this.shouldRetry(f)){const w=`retrying, ${t} attempts remaining`;return On(`response (error; ${w})`,f.status,s,l),this.retryRequest(n,t,l)}const h=await f.text().catch(w=>Po(w).message),x=Pb(h),p=x?void 0:h;throw On(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,f.status,s,l,p),this.makeStatusError(f.status,x,p,l)}return{response:f,options:n,controller:c}}requestAPIList(r,t){const n=this.makeRequest(t,null);return new Fb(this,n,r)}buildURL(r,t){const n=Mb(r)?new URL(r):new URL(this.baseURL+(this.baseURL.endsWith("/")&&r.startsWith("/")?r.slice(1):r)),a=this.defaultQuery();return jh(a)||(t={...a,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(r){return Object.entries(r).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new Se(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(r,t,n,a){const{signal:i,...s}=t||{};i&&i.addEventListener("abort",()=>a.abort());const o=setTimeout(()=>a.abort(),n),c={signal:a.signal,...s};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,r,c).finally(()=>{clearTimeout(o)})}shouldRetry(r){const t=r.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:r.status===408||r.status===409||r.status===429||r.status>=500}async retryRequest(r,t,n){let a;const i=n==null?void 0:n["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(a=o)}const s=n==null?void 0:n["retry-after"];if(s&&!a){const o=parseFloat(s);Number.isNaN(o)?a=Date.parse(s)-Date.now():a=o*1e3}if(!(a&&0<=a&&a<60*1e3)){const o=r.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(t,o)}return await Wa(a),this.makeRequest(r,t-1)}calculateDefaultRetryTimeoutMillis(r,t){const i=t-r,s=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return s*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${En}`}}class Gh{constructor(r,t,n,a){pi.set(this,void 0),Ab(this,pi,r),this.options=a,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const r=this.nextPageInfo();if(!r)throw new Se("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in r&&typeof t.query=="object")t.query={...t.query,...r.params};else if("url"in r){const n=[...Object.entries(t.query||{}),...r.url.searchParams.entries()];for(const[a,i]of n)r.url.searchParams.set(a,i);t.query=void 0,t.path=r.url.toString()}return await Sb(this,pi,"f").requestAPIList(this.constructor,t)}async*iterPages(){let r=this;for(yield r;r.hasNextPage();)r=await r.getNextPage(),yield r}async*[(pi=new WeakMap,Symbol.asyncIterator)](){for await(const r of this.iterPages())for(const t of r.getPaginatedItems())yield t}}class Fb extends gs{constructor(r,t,n){super(t,async a=>new n(r,a.response,await Wh(a),a.options))}async*[Symbol.asyncIterator](){const r=await this;for await(const t of r)yield t}}const Xh=e=>new Proxy(Object.fromEntries(e.entries()),{get(r,t){const n=t.toString();return r[n.toLowerCase()]||r[n]}}),Rb={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},ut=e=>typeof e=="object"&&e!==null&&!jh(e)&&Object.keys(e).every(r=>Yh(Rb,r)),Ib=()=>{var r;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":En,"X-Stainless-OS":Lf(Deno.build.os),"X-Stainless-Arch":Mf(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((r=Deno.version)==null?void 0:r.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":En,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":En,"X-Stainless-OS":Lf(process.platform),"X-Stainless-Arch":Mf(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const e=Ob();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":En,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":En,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Ob(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:r,pattern:t}of e){const n=t.exec(navigator.userAgent);if(n){const a=n[1]||0,i=n[2]||0,s=n[3]||0;return{browser:r,version:`${a}.${i}.${s}`}}}return null}const Mf=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",Lf=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let Bf;const Db=()=>Bf??(Bf=Ib()),Pb=e=>{try{return JSON.parse(e)}catch{return}},Nb=/^[a-z][a-z0-9+.-]*:/i,Mb=e=>Nb.test(e),Wa=e=>new Promise(r=>setTimeout(r,e)),Ys=(e,r)=>{if(typeof r!="number"||!Number.isInteger(r))throw new Se(`${e} must be an integer`);if(r<0)throw new Se(`${e} must be a positive integer`);return r},Po=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},xi=e=>{var r,t,n,a;if(typeof process<"u")return((r=In==null?void 0:In[e])==null?void 0:r.trim())??void 0;if(typeof Deno<"u")return(a=(n=(t=Deno.env)==null?void 0:t.get)==null?void 0:n.call(t,e))==null?void 0:a.trim()};function jh(e){if(!e)return!0;for(const r in e)return!1;return!0}function Yh(e,r){return Object.prototype.hasOwnProperty.call(e,r)}function Uf(e,r){for(const t in r){if(!Yh(r,t))continue;const n=t.toLowerCase();if(!n)continue;const a=r[t];a===null?delete e[n]:a!==void 0&&(e[n]=a)}}const zf=new Set(["authorization","api-key"]);function On(e,...r){if(typeof process<"u"&&(In==null?void 0:In.DEBUG)==="true"){const t=r.map(n=>{if(!n)return n;if(n.headers){const i={...n,headers:{...n.headers}};for(const s in n.headers)zf.has(s.toLowerCase())&&(i.headers[s]="REDACTED");return i}let a=null;for(const i in n)zf.has(i.toLowerCase())&&(a??(a={...n}),a[i]="REDACTED");return a??n});console.log(`OpenAI:DEBUG:${e}`,...t)}}const Lb=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const r=Math.random()*16|0;return(e==="x"?r:r&3|8).toString(16)}),Bb=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Ub=e=>typeof(e==null?void 0:e.get)=="function",mi=(e,r)=>{var n;const t=r.toLowerCase();if(Ub(e)){const a=((n=r[0])==null?void 0:n.toUpperCase())+r.substring(1).replace(/([^\w])(\w)/g,(i,s,o)=>s+o.toUpperCase());for(const i of[r,t,r.toUpperCase(),a]){const s=e.get(i);if(s)return s}}for(const[a,i]of Object.entries(e))if(a.toLowerCase()===t)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${r} header, using the first entry.`),i[0]):i};function Ks(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}class Cc extends Gh{constructor(r,t,n,a){super(r,t,n,a),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Nt extends Gh{constructor(r,t,n,a){super(r,t,n,a),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const r=this.nextPageInfo();if(!r)return null;if("params"in r)return r.params;const t=Object.fromEntries(r.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var n;const r=this.getPaginatedItems();if(!r.length)return null;const t=(n=r[r.length-1])==null?void 0:n.id;return t?{params:{after:t}}:null}}class Me{constructor(r){this._client=r}}let Kh=class extends Me{list(r,t={},n){return ut(t)?this.list(r,{},t):this._client.getAPIList(`/chat/completions/${r}/messages`,zb,{query:t,...n})}},_s=class extends Me{constructor(){super(...arguments),this.messages=new Kh(this._client)}create(r,t){return this._client.post("/chat/completions",{body:r,...t,stream:r.stream??!1})}retrieve(r,t){return this._client.get(`/chat/completions/${r}`,t)}update(r,t,n){return this._client.post(`/chat/completions/${r}`,{body:t,...n})}list(r={},t){return ut(r)?this.list({},r):this._client.getAPIList("/chat/completions",vs,{query:r,...t})}del(r,t){return this._client.delete(`/chat/completions/${r}`,t)}};class vs extends Nt{}class zb extends Nt{}_s.ChatCompletionsPage=vs;_s.Messages=Kh;let ws=class extends Me{constructor(){super(...arguments),this.completions=new _s(this._client)}};ws.Completions=_s;ws.ChatCompletionsPage=vs;class qh extends Me{create(r,t){return this._client.post("/audio/speech",{body:r,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}class Zh extends Me{create(r,t){return this._client.post("/audio/transcriptions",$n({body:r,...t,stream:r.stream??!1,__metadata:{model:r.model}}))}}class Jh extends Me{create(r,t){return this._client.post("/audio/translations",$n({body:r,...t,__metadata:{model:r.model}}))}}class Va extends Me{constructor(){super(...arguments),this.transcriptions=new Zh(this._client),this.translations=new Jh(this._client),this.speech=new qh(this._client)}}Va.Transcriptions=Zh;Va.Translations=Jh;Va.Speech=qh;class Fc extends Me{create(r,t){return this._client.post("/batches",{body:r,...t})}retrieve(r,t){return this._client.get(`/batches/${r}`,t)}list(r={},t){return ut(r)?this.list({},r):this._client.getAPIList("/batches",Rc,{query:r,...t})}cancel(r,t){return this._client.post(`/batches/${r}/cancel`,t)}}class Rc extends Nt{}Fc.BatchesPage=Rc;class Ic extends Me{create(r,t){return this._client.post("/assistants",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(r,t){return this._client.get(`/assistants/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(r,t,n){return this._client.post(`/assistants/${r}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(r={},t){return ut(r)?this.list({},r):this._client.getAPIList("/assistants",Oc,{query:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(r,t){return this._client.delete(`/assistants/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Oc extends Nt{}Ic.AssistantsPage=Oc;function $f(e){return typeof e.parse=="function"}const Dn=e=>(e==null?void 0:e.role)==="assistant",Qh=e=>(e==null?void 0:e.role)==="function",ed=e=>(e==null?void 0:e.role)==="tool";var er=function(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t},Ke=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},No,Fi,Ri,ia,sa,Ii,oa,br,ca,ns,as,Tn,td;class Dc{constructor(){No.add(this),this.controller=new AbortController,Fi.set(this,void 0),Ri.set(this,()=>{}),ia.set(this,()=>{}),sa.set(this,void 0),Ii.set(this,()=>{}),oa.set(this,()=>{}),br.set(this,{}),ca.set(this,!1),ns.set(this,!1),as.set(this,!1),Tn.set(this,!1),er(this,Fi,new Promise((r,t)=>{er(this,Ri,r,"f"),er(this,ia,t,"f")}),"f"),er(this,sa,new Promise((r,t)=>{er(this,Ii,r,"f"),er(this,oa,t,"f")}),"f"),Ke(this,Fi,"f").catch(()=>{}),Ke(this,sa,"f").catch(()=>{})}_run(r){setTimeout(()=>{r().then(()=>{this._emitFinal(),this._emit("end")},Ke(this,No,"m",td).bind(this))},0)}_connected(){this.ended||(Ke(this,Ri,"f").call(this),this._emit("connect"))}get ended(){return Ke(this,ca,"f")}get errored(){return Ke(this,ns,"f")}get aborted(){return Ke(this,as,"f")}abort(){this.controller.abort()}on(r,t){return(Ke(this,br,"f")[r]||(Ke(this,br,"f")[r]=[])).push({listener:t}),this}off(r,t){const n=Ke(this,br,"f")[r];if(!n)return this;const a=n.findIndex(i=>i.listener===t);return a>=0&&n.splice(a,1),this}once(r,t){return(Ke(this,br,"f")[r]||(Ke(this,br,"f")[r]=[])).push({listener:t,once:!0}),this}emitted(r){return new Promise((t,n)=>{er(this,Tn,!0,"f"),r!=="error"&&this.once("error",n),this.once(r,t)})}async done(){er(this,Tn,!0,"f"),await Ke(this,sa,"f")}_emit(r,...t){if(Ke(this,ca,"f"))return;r==="end"&&(er(this,ca,!0,"f"),Ke(this,Ii,"f").call(this));const n=Ke(this,br,"f")[r];if(n&&(Ke(this,br,"f")[r]=n.filter(a=>!a.once),n.forEach(({listener:a})=>a(...t))),r==="abort"){const a=t[0];!Ke(this,Tn,"f")&&!(n!=null&&n.length)&&Promise.reject(a),Ke(this,ia,"f").call(this,a),Ke(this,oa,"f").call(this,a),this._emit("end");return}if(r==="error"){const a=t[0];!Ke(this,Tn,"f")&&!(n!=null&&n.length)&&Promise.reject(a),Ke(this,ia,"f").call(this,a),Ke(this,oa,"f").call(this,a),this._emit("end")}}_emitFinal(){}}Fi=new WeakMap,Ri=new WeakMap,ia=new WeakMap,sa=new WeakMap,Ii=new WeakMap,oa=new WeakMap,br=new WeakMap,ca=new WeakMap,ns=new WeakMap,as=new WeakMap,Tn=new WeakMap,No=new WeakSet,td=function(r){if(er(this,ns,!0,"f"),r instanceof Error&&r.name==="AbortError"&&(r=new Yt),r instanceof Yt)return er(this,as,!0,"f"),this._emit("abort",r);if(r instanceof Se)return this._emit("error",r);if(r instanceof Error){const t=new Se(r.message);return t.cause=r,this._emit("error",t)}return this._emit("error",new Se(String(r)))};function Pc(e){return(e==null?void 0:e.$brand)==="auto-parseable-response-format"}function Ga(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function $b(e,r){return!r||!rd(r)?{...e,choices:e.choices.map(t=>({...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:Nc(e,r)}function Nc(e,r){const t=e.choices.map(n=>{var a;if(n.finish_reason==="length")throw new Lh;if(n.finish_reason==="content_filter")throw new Bh;return{...n,message:{...n.message,...n.message.tool_calls?{tool_calls:((a=n.message.tool_calls)==null?void 0:a.map(i=>Wb(r,i)))??void 0}:void 0,parsed:n.message.content&&!n.message.refusal?Hb(r,n.message.content):null}}});return{...e,choices:t}}function Hb(e,r){var t,n;return((t=e.response_format)==null?void 0:t.type)!=="json_schema"?null:((n=e.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(r):JSON.parse(r):null}function Wb(e,r){var n;const t=(n=e.tools)==null?void 0:n.find(a=>{var i;return((i=a.function)==null?void 0:i.name)===r.function.name});return{...r,function:{...r.function,parsed_arguments:Ga(t)?t.$parseRaw(r.function.arguments):t!=null&&t.function.strict?JSON.parse(r.function.arguments):null}}}function Vb(e,r){var n;if(!e)return!1;const t=(n=e.tools)==null?void 0:n.find(a=>{var i;return((i=a.function)==null?void 0:i.name)===r.function.name});return Ga(t)||(t==null?void 0:t.function.strict)||!1}function rd(e){var r;return Pc(e.response_format)?!0:((r=e.tools)==null?void 0:r.some(t=>Ga(t)||t.type==="function"&&t.function.strict===!0))??!1}function Gb(e){for(const r of e??[]){if(r.type!=="function")throw new Se(`Currently only \`function\` tool types support auto-parsing; Received \`${r.type}\``);if(r.function.strict!==!0)throw new Se(`The \`${r.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Ot=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},vt,Mo,is,Lo,Bo,Uo,nd,zo;const Hf=10;class ad extends Dc{constructor(){super(...arguments),vt.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(r){var n;this._chatCompletions.push(r),this._emit("chatCompletion",r);const t=(n=r.choices[0])==null?void 0:n.message;return t&&this._addMessage(t),r}_addMessage(r,t=!0){if("content"in r||(r.content=null),this.messages.push(r),t){if(this._emit("message",r),(Qh(r)||ed(r))&&r.content)this._emit("functionCallResult",r.content);else if(Dn(r)&&r.function_call)this._emit("functionCall",r.function_call);else if(Dn(r)&&r.tool_calls)for(const n of r.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();const r=this._chatCompletions[this._chatCompletions.length-1];if(!r)throw new Se("stream ended without producing a ChatCompletion");return r}async finalContent(){return await this.done(),Ot(this,vt,"m",Mo).call(this)}async finalMessage(){return await this.done(),Ot(this,vt,"m",is).call(this)}async finalFunctionCall(){return await this.done(),Ot(this,vt,"m",Lo).call(this)}async finalFunctionCallResult(){return await this.done(),Ot(this,vt,"m",Bo).call(this)}async totalUsage(){return await this.done(),Ot(this,vt,"m",Uo).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const r=this._chatCompletions[this._chatCompletions.length-1];r&&this._emit("finalChatCompletion",r);const t=Ot(this,vt,"m",is).call(this);t&&this._emit("finalMessage",t);const n=Ot(this,vt,"m",Mo).call(this);n&&this._emit("finalContent",n);const a=Ot(this,vt,"m",Lo).call(this);a&&this._emit("finalFunctionCall",a);const i=Ot(this,vt,"m",Bo).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(s=>s.usage)&&this._emit("totalUsage",Ot(this,vt,"m",Uo).call(this))}async _createChatCompletion(r,t,n){const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Ot(this,vt,"m",nd).call(this,t);const i=await r.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Nc(i,t))}async _runChatCompletion(r,t,n){for(const a of t.messages)this._addMessage(a,!1);return await this._createChatCompletion(r,t,n)}async _runFunctions(r,t,n){var d;const a="function",{function_call:i="auto",stream:s,...o}=t,c=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:f=Hf}=n||{},l={};for(const h of t.functions)l[h.name||h.function.name]=h;const u=t.functions.map(h=>({name:h.name||h.function.name,parameters:h.parameters,description:h.description}));for(const h of t.messages)this._addMessage(h,!1);for(let h=0;h<f;++h){const p=(d=(await this._createChatCompletion(r,{...o,function_call:i,functions:u,messages:[...this.messages]},n)).choices[0])==null?void 0:d.message;if(!p)throw new Se("missing message in ChatCompletion response");if(!p.function_call)return;const{name:m,arguments:g}=p.function_call,w=l[m];if(w){if(c&&c!==m){const F=`Invalid function_call: ${JSON.stringify(m)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,name:m,content:F});continue}}else{const F=`Invalid function_call: ${JSON.stringify(m)}. Available options are: ${u.map(E=>JSON.stringify(E.name)).join(", ")}. Please try again`;this._addMessage({role:a,name:m,content:F});continue}let v;try{v=$f(w)?await w.parse(g):g}catch(F){this._addMessage({role:a,name:m,content:F instanceof Error?F.message:String(F)});continue}const k=await w.function(v,this),A=Ot(this,vt,"m",zo).call(this,k);if(this._addMessage({role:a,name:m,content:A}),c)return}}async _runTools(r,t,n){var h,x,p;const a="tool",{tool_choice:i="auto",stream:s,...o}=t,c=typeof i!="string"&&((h=i==null?void 0:i.function)==null?void 0:h.name),{maxChatCompletions:f=Hf}=n||{},l=t.tools.map(m=>{if(Ga(m)){if(!m.$callback)throw new Se("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:m.$callback,name:m.function.name,description:m.function.description||"",parameters:m.function.parameters,parse:m.$parseRaw,strict:!0}}}return m}),u={};for(const m of l)m.type==="function"&&(u[m.function.name||m.function.function.name]=m.function);const d="tools"in t?l.map(m=>m.type==="function"?{type:"function",function:{name:m.function.name||m.function.function.name,parameters:m.function.parameters,description:m.function.description,strict:m.function.strict}}:m):void 0;for(const m of t.messages)this._addMessage(m,!1);for(let m=0;m<f;++m){const w=(x=(await this._createChatCompletion(r,{...o,tool_choice:i,tools:d,messages:[...this.messages]},n)).choices[0])==null?void 0:x.message;if(!w)throw new Se("missing message in ChatCompletion response");if(!((p=w.tool_calls)!=null&&p.length))return;for(const v of w.tool_calls){if(v.type!=="function")continue;const k=v.id,{name:A,arguments:F}=v.function,E=u[A];if(E){if(c&&c!==A){const H=`Invalid tool_call: ${JSON.stringify(A)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,tool_call_id:k,content:H});continue}}else{const H=`Invalid tool_call: ${JSON.stringify(A)}. Available options are: ${Object.keys(u).map(b=>JSON.stringify(b)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:k,content:H});continue}let z;try{z=$f(E)?await E.parse(F):F}catch(H){const b=H instanceof Error?H.message:String(H);this._addMessage({role:a,tool_call_id:k,content:b});continue}const C=await E.function(z,this),G=Ot(this,vt,"m",zo).call(this,C);if(this._addMessage({role:a,tool_call_id:k,content:G}),c)return}}}}vt=new WeakSet,Mo=function(){return Ot(this,vt,"m",is).call(this).content??null},is=function(){let r=this.messages.length;for(;r-- >0;){const t=this.messages[r];if(Dn(t)){const{function_call:n,...a}=t,i={...a,content:t.content??null,refusal:t.refusal??null};return n&&(i.function_call=n),i}}throw new Se("stream ended without producing a ChatCompletionMessage with role=assistant")},Lo=function(){var r,t;for(let n=this.messages.length-1;n>=0;n--){const a=this.messages[n];if(Dn(a)&&(a!=null&&a.function_call))return a.function_call;if(Dn(a)&&((r=a==null?void 0:a.tool_calls)!=null&&r.length))return(t=a.tool_calls.at(-1))==null?void 0:t.function}},Bo=function(){for(let r=this.messages.length-1;r>=0;r--){const t=this.messages[r];if(Qh(t)&&t.content!=null||ed(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var a;return n.role==="assistant"&&((a=n.tool_calls)==null?void 0:a.some(i=>i.type==="function"&&i.id===t.tool_call_id))}))return t.content}},Uo=function(){const r={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(r.completion_tokens+=t.completion_tokens,r.prompt_tokens+=t.prompt_tokens,r.total_tokens+=t.total_tokens);return r},nd=function(r){if(r.n!=null&&r.n>1)throw new Se("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},zo=function(r){return typeof r=="string"?r:r===void 0?"undefined":JSON.stringify(r)};class Da extends ad{static runFunctions(r,t,n){const a=new Da,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(r,t,i)),a}static runTools(r,t,n){const a=new Da,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(r,t,i)),a}_addMessage(r,t=!0){super._addMessage(r,t),Dn(r)&&r.content&&this._emit("content",r.content)}}const id=1,sd=2,od=4,cd=8,fd=16,ld=32,ud=64,hd=128,dd=256,pd=hd|dd,xd=fd|ld|pd|ud,md=id|sd|xd,gd=od|cd,Xb=md|gd,ct={STR:id,NUM:sd,ARR:od,OBJ:cd,NULL:fd,BOOL:ld,NAN:ud,INFINITY:hd,MINUS_INFINITY:dd,INF:pd,SPECIAL:xd,ATOM:md,COLLECTION:gd,ALL:Xb};class jb extends Error{}class Yb extends Error{}function Kb(e,r=ct.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return qb(e.trim(),r)}const qb=(e,r)=>{const t=e.length;let n=0;const a=d=>{throw new jb(`${d} at position ${n}`)},i=d=>{throw new Yb(`${d} at position ${n}`)},s=()=>(u(),n>=t&&a("Unexpected end of input"),e[n]==='"'?o():e[n]==="{"?c():e[n]==="["?f():e.substring(n,n+4)==="null"||ct.NULL&r&&t-n<4&&"null".startsWith(e.substring(n))?(n+=4,null):e.substring(n,n+4)==="true"||ct.BOOL&r&&t-n<4&&"true".startsWith(e.substring(n))?(n+=4,!0):e.substring(n,n+5)==="false"||ct.BOOL&r&&t-n<5&&"false".startsWith(e.substring(n))?(n+=5,!1):e.substring(n,n+8)==="Infinity"||ct.INFINITY&r&&t-n<8&&"Infinity".startsWith(e.substring(n))?(n+=8,1/0):e.substring(n,n+9)==="-Infinity"||ct.MINUS_INFINITY&r&&1<t-n&&t-n<9&&"-Infinity".startsWith(e.substring(n))?(n+=9,-1/0):e.substring(n,n+3)==="NaN"||ct.NAN&r&&t-n<3&&"NaN".startsWith(e.substring(n))?(n+=3,NaN):l()),o=()=>{const d=n;let h=!1;for(n++;n<t&&(e[n]!=='"'||h&&e[n-1]==="\\");)h=e[n]==="\\"?!h:!1,n++;if(e.charAt(n)=='"')try{return JSON.parse(e.substring(d,++n-Number(h)))}catch(x){i(String(x))}else if(ct.STR&r)try{return JSON.parse(e.substring(d,n-Number(h))+'"')}catch{return JSON.parse(e.substring(d,e.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},c=()=>{n++,u();const d={};try{for(;e[n]!=="}";){if(u(),n>=t&&ct.OBJ&r)return d;const h=o();u(),n++;try{const x=s();Object.defineProperty(d,h,{value:x,writable:!0,enumerable:!0,configurable:!0})}catch(x){if(ct.OBJ&r)return d;throw x}u(),e[n]===","&&n++}}catch{if(ct.OBJ&r)return d;a("Expected '}' at end of object")}return n++,d},f=()=>{n++;const d=[];try{for(;e[n]!=="]";)d.push(s()),u(),e[n]===","&&n++}catch{if(ct.ARR&r)return d;a("Expected ']' at end of array")}return n++,d},l=()=>{if(n===0){e==="-"&&ct.NUM&r&&a("Not sure what '-' is");try{return JSON.parse(e)}catch(h){if(ct.NUM&r)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}i(String(h))}}const d=n;for(e[n]==="-"&&n++;e[n]&&!",]}".includes(e[n]);)n++;n==t&&!(ct.NUM&r)&&a("Unterminated number literal");try{return JSON.parse(e.substring(d,n))}catch{e.substring(d,n)==="-"&&ct.NUM&r&&a("Not sure what '-' is");try{return JSON.parse(e.substring(d,e.lastIndexOf("e")))}catch(x){i(String(x))}}},u=()=>{for(;n<t&&` 
\r	`.includes(e[n]);)n++};return s()},Wf=e=>Kb(e,ct.ALL^ct.NUM);var _n=function(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t},We=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},rt,Tr,vn,Pr,qs,gi,Zs,Js,Qs,_i,eo,Vf;class Pa extends ad{constructor(r){super(),rt.add(this),Tr.set(this,void 0),vn.set(this,void 0),Pr.set(this,void 0),_n(this,Tr,r,"f"),_n(this,vn,[],"f")}get currentChatCompletionSnapshot(){return We(this,Pr,"f")}static fromReadableStream(r){const t=new Pa(null);return t._run(()=>t._fromReadableStream(r)),t}static createChatCompletion(r,t,n){const a=new Pa(t);return a._run(()=>a._runChatCompletion(r,{...t,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(r,t,n){var s;super._createChatCompletion;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),We(this,rt,"m",qs).call(this);const i=await r.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of i)We(this,rt,"m",Zs).call(this,o);if((s=i.controller.signal)!=null&&s.aborted)throw new Yt;return this._addChatCompletion(We(this,rt,"m",_i).call(this))}async _fromReadableStream(r,t){var s;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),We(this,rt,"m",qs).call(this),this._connected();const a=xr.fromReadableStream(r,this.controller);let i;for await(const o of a)i&&i!==o.id&&this._addChatCompletion(We(this,rt,"m",_i).call(this)),We(this,rt,"m",Zs).call(this,o),i=o.id;if((s=a.controller.signal)!=null&&s.aborted)throw new Yt;return this._addChatCompletion(We(this,rt,"m",_i).call(this))}[(Tr=new WeakMap,vn=new WeakMap,Pr=new WeakMap,rt=new WeakSet,qs=function(){this.ended||_n(this,Pr,void 0,"f")},gi=function(t){let n=We(this,vn,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},We(this,vn,"f")[t.index]=n,n)},Zs=function(t){var a,i,s,o,c,f,l,u,d,h,x,p,m,g,w;if(this.ended)return;const n=We(this,rt,"m",Vf).call(this,t);this._emit("chunk",t,n);for(const v of t.choices){const k=n.choices[v.index];v.delta.content!=null&&((a=k.message)==null?void 0:a.role)==="assistant"&&((i=k.message)!=null&&i.content)&&(this._emit("content",v.delta.content,k.message.content),this._emit("content.delta",{delta:v.delta.content,snapshot:k.message.content,parsed:k.message.parsed})),v.delta.refusal!=null&&((s=k.message)==null?void 0:s.role)==="assistant"&&((o=k.message)!=null&&o.refusal)&&this._emit("refusal.delta",{delta:v.delta.refusal,snapshot:k.message.refusal}),((c=v.logprobs)==null?void 0:c.content)!=null&&((f=k.message)==null?void 0:f.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(l=v.logprobs)==null?void 0:l.content,snapshot:((u=k.logprobs)==null?void 0:u.content)??[]}),((d=v.logprobs)==null?void 0:d.refusal)!=null&&((h=k.message)==null?void 0:h.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(x=v.logprobs)==null?void 0:x.refusal,snapshot:((p=k.logprobs)==null?void 0:p.refusal)??[]});const A=We(this,rt,"m",gi).call(this,k);k.finish_reason&&(We(this,rt,"m",Qs).call(this,k),A.current_tool_call_index!=null&&We(this,rt,"m",Js).call(this,k,A.current_tool_call_index));for(const F of v.delta.tool_calls??[])A.current_tool_call_index!==F.index&&(We(this,rt,"m",Qs).call(this,k),A.current_tool_call_index!=null&&We(this,rt,"m",Js).call(this,k,A.current_tool_call_index)),A.current_tool_call_index=F.index;for(const F of v.delta.tool_calls??[]){const E=(m=k.message.tool_calls)==null?void 0:m[F.index];E!=null&&E.type&&((E==null?void 0:E.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(g=E.function)==null?void 0:g.name,index:F.index,arguments:E.function.arguments,parsed_arguments:E.function.parsed_arguments,arguments_delta:((w=F.function)==null?void 0:w.arguments)??""}):(E==null||E.type,void 0))}}},Js=function(t,n){var s,o,c;if(We(this,rt,"m",gi).call(this,t).done_tool_calls.has(n))return;const i=(s=t.message.tool_calls)==null?void 0:s[n];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const f=(c=(o=We(this,Tr,"f"))==null?void 0:o.tools)==null?void 0:c.find(l=>l.type==="function"&&l.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:n,arguments:i.function.arguments,parsed_arguments:Ga(f)?f.$parseRaw(i.function.arguments):f!=null&&f.function.strict?JSON.parse(i.function.arguments):null})}else i.type},Qs=function(t){var a,i;const n=We(this,rt,"m",gi).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const s=We(this,rt,"m",eo).call(this);this._emit("content.done",{content:t.message.content,parsed:s?s.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(a=t.logprobs)!=null&&a.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(i=t.logprobs)!=null&&i.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},_i=function(){if(this.ended)throw new Se("stream has ended, this shouldn't happen");const t=We(this,Pr,"f");if(!t)throw new Se("request ended without sending any chunks");return _n(this,Pr,void 0,"f"),_n(this,vn,[],"f"),Zb(t,We(this,Tr,"f"))},eo=function(){var n;const t=(n=We(this,Tr,"f"))==null?void 0:n.response_format;return Pc(t)?t:null},Vf=function(t){var n,a,i,s;let o=We(this,Pr,"f");const{choices:c,...f}=t;o?Object.assign(o,f):o=_n(this,Pr,{...f,choices:[]},"f");for(const{delta:l,finish_reason:u,index:d,logprobs:h=null,...x}of t.choices){let p=o.choices[d];if(p||(p=o.choices[d]={finish_reason:u,index:d,message:{},logprobs:h,...x}),h)if(!p.logprobs)p.logprobs=Object.assign({},h);else{const{content:F,refusal:E,...z}=h;Object.assign(p.logprobs,z),F&&((n=p.logprobs).content??(n.content=[]),p.logprobs.content.push(...F)),E&&((a=p.logprobs).refusal??(a.refusal=[]),p.logprobs.refusal.push(...E))}if(u&&(p.finish_reason=u,We(this,Tr,"f")&&rd(We(this,Tr,"f")))){if(u==="length")throw new Lh;if(u==="content_filter")throw new Bh}if(Object.assign(p,x),!l)continue;const{content:m,refusal:g,function_call:w,role:v,tool_calls:k,...A}=l;if(Object.assign(p.message,A),g&&(p.message.refusal=(p.message.refusal||"")+g),v&&(p.message.role=v),w&&(p.message.function_call?(w.name&&(p.message.function_call.name=w.name),w.arguments&&((i=p.message.function_call).arguments??(i.arguments=""),p.message.function_call.arguments+=w.arguments)):p.message.function_call=w),m&&(p.message.content=(p.message.content||"")+m,!p.message.refusal&&We(this,rt,"m",eo).call(this)&&(p.message.parsed=Wf(p.message.content))),k){p.message.tool_calls||(p.message.tool_calls=[]);for(const{index:F,id:E,type:z,function:C,...G}of k){const H=(s=p.message.tool_calls)[F]??(s[F]={});Object.assign(H,G),E&&(H.id=E),z&&(H.type=z),C&&(H.function??(H.function={name:C.name??"",arguments:""})),C!=null&&C.name&&(H.function.name=C.name),C!=null&&C.arguments&&(H.function.arguments+=C.arguments,Vb(We(this,Tr,"f"),H)&&(H.function.parsed_arguments=Wf(H.function.arguments)))}}}return o},Symbol.asyncIterator)](){const r=[],t=[];let n=!1;return this.on("chunk",a=>{const i=t.shift();i?i.resolve(a):r.push(a)}),this.on("end",()=>{n=!0;for(const a of t)a.resolve(void 0);t.length=0}),this.on("abort",a=>{n=!0;for(const i of t)i.reject(a);t.length=0}),this.on("error",a=>{n=!0;for(const i of t)i.reject(a);t.length=0}),{next:async()=>r.length?{value:r.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,s)=>t.push({resolve:i,reject:s})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new xr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Zb(e,r){const{id:t,choices:n,created:a,model:i,system_fingerprint:s,...o}=e,c={...o,id:t,choices:n.map(({message:f,finish_reason:l,index:u,logprobs:d,...h})=>{if(!l)throw new Se(`missing finish_reason for choice ${u}`);const{content:x=null,function_call:p,tool_calls:m,...g}=f,w=f.role;if(!w)throw new Se(`missing role for choice ${u}`);if(p){const{arguments:v,name:k}=p;if(v==null)throw new Se(`missing function_call.arguments for choice ${u}`);if(!k)throw new Se(`missing function_call.name for choice ${u}`);return{...h,message:{content:x,function_call:{arguments:v,name:k},role:w,refusal:f.refusal??null},finish_reason:l,index:u,logprobs:d}}return m?{...h,index:u,finish_reason:l,logprobs:d,message:{...g,role:w,content:x,refusal:f.refusal??null,tool_calls:m.map((v,k)=>{const{function:A,type:F,id:E,...z}=v,{arguments:C,name:G,...H}=A||{};if(E==null)throw new Se(`missing choices[${u}].tool_calls[${k}].id
${vi(e)}`);if(F==null)throw new Se(`missing choices[${u}].tool_calls[${k}].type
${vi(e)}`);if(G==null)throw new Se(`missing choices[${u}].tool_calls[${k}].function.name
${vi(e)}`);if(C==null)throw new Se(`missing choices[${u}].tool_calls[${k}].function.arguments
${vi(e)}`);return{...z,id:E,type:F,function:{...H,name:G,arguments:C}}})}}:{...h,message:{...g,content:x,role:w,refusal:f.refusal??null},finish_reason:l,index:u,logprobs:d}}),created:a,model:i,object:"chat.completion",...s?{system_fingerprint:s}:{}};return $b(c,r)}function vi(e){return JSON.stringify(e)}class Pn extends Pa{static fromReadableStream(r){const t=new Pn(null);return t._run(()=>t._fromReadableStream(r)),t}static runFunctions(r,t,n){const a=new Pn(null),i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(r,t,i)),a}static runTools(r,t,n){const a=new Pn(t),i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(r,t,i)),a}}let _d=class extends Me{parse(r,t){return Gb(r.tools),this._client.chat.completions.create(r,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>Nc(n,r))}runFunctions(r,t){return r.stream?Pn.runFunctions(this._client,r,t):Da.runFunctions(this._client,r,t)}runTools(r,t){return r.stream?Pn.runTools(this._client,r,t):Da.runTools(this._client,r,t)}stream(r,t){return Pa.createChatCompletion(this._client,r,t)}};class $o extends Me{constructor(){super(...arguments),this.completions=new _d(this._client)}}(function(e){e.Completions=_d})($o||($o={}));class vd extends Me{create(r,t){return this._client.post("/realtime/sessions",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class wd extends Me{create(r,t){return this._client.post("/realtime/transcription_sessions",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class ys extends Me{constructor(){super(...arguments),this.sessions=new vd(this._client),this.transcriptionSessions=new wd(this._client)}}ys.Sessions=vd;ys.TranscriptionSessions=wd;var Te=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},Mt=function(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t},ht,Ho,dr,Oi,tr,en,An,Zr,ss,Bt,Di,Pi,ya,fa,la,Gf,Xf,jf,Yf,Kf,qf,Zf;class sr extends Dc{constructor(){super(...arguments),ht.add(this),Ho.set(this,[]),dr.set(this,{}),Oi.set(this,{}),tr.set(this,void 0),en.set(this,void 0),An.set(this,void 0),Zr.set(this,void 0),ss.set(this,void 0),Bt.set(this,void 0),Di.set(this,void 0),Pi.set(this,void 0),ya.set(this,void 0)}[(Ho=new WeakMap,dr=new WeakMap,Oi=new WeakMap,tr=new WeakMap,en=new WeakMap,An=new WeakMap,Zr=new WeakMap,ss=new WeakMap,Bt=new WeakMap,Di=new WeakMap,Pi=new WeakMap,ya=new WeakMap,ht=new WeakSet,Symbol.asyncIterator)](){const r=[],t=[];let n=!1;return this.on("event",a=>{const i=t.shift();i?i.resolve(a):r.push(a)}),this.on("end",()=>{n=!0;for(const a of t)a.resolve(void 0);t.length=0}),this.on("abort",a=>{n=!0;for(const i of t)i.reject(a);t.length=0}),this.on("error",a=>{n=!0;for(const i of t)i.reject(a);t.length=0}),{next:async()=>r.length?{value:r.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,s)=>t.push({resolve:i,reject:s})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(r){const t=new sr;return t._run(()=>t._fromReadableStream(r)),t}async _fromReadableStream(r,t){var i;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=xr.fromReadableStream(r,this.controller);for await(const s of a)Te(this,ht,"m",fa).call(this,s);if((i=a.controller.signal)!=null&&i.aborted)throw new Yt;return this._addRun(Te(this,ht,"m",la).call(this))}toReadableStream(){return new xr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(r,t,n,a,i){const s=new sr;return s._run(()=>s._runToolAssistantStream(r,t,n,a,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createToolAssistantStream(r,t,n,a,i){var f;const s=i==null?void 0:i.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const o={...a,stream:!0},c=await r.submitToolOutputs(t,n,o,{...i,signal:this.controller.signal});this._connected();for await(const l of c)Te(this,ht,"m",fa).call(this,l);if((f=c.controller.signal)!=null&&f.aborted)throw new Yt;return this._addRun(Te(this,ht,"m",la).call(this))}static createThreadAssistantStream(r,t,n){const a=new sr;return a._run(()=>a._threadAssistantStream(r,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(r,t,n,a){const i=new sr;return i._run(()=>i._runAssistantStream(r,t,n,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return Te(this,Di,"f")}currentRun(){return Te(this,Pi,"f")}currentMessageSnapshot(){return Te(this,tr,"f")}currentRunStepSnapshot(){return Te(this,ya,"f")}async finalRunSteps(){return await this.done(),Object.values(Te(this,dr,"f"))}async finalMessages(){return await this.done(),Object.values(Te(this,Oi,"f"))}async finalRun(){if(await this.done(),!Te(this,en,"f"))throw Error("Final run was not received.");return Te(this,en,"f")}async _createThreadAssistantStream(r,t,n){var o;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...t,stream:!0},s=await r.createAndRun(i,{...n,signal:this.controller.signal});this._connected();for await(const c of s)Te(this,ht,"m",fa).call(this,c);if((o=s.controller.signal)!=null&&o.aborted)throw new Yt;return this._addRun(Te(this,ht,"m",la).call(this))}async _createAssistantStream(r,t,n,a){var c;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const s={...n,stream:!0},o=await r.create(t,s,{...a,signal:this.controller.signal});this._connected();for await(const f of o)Te(this,ht,"m",fa).call(this,f);if((c=o.controller.signal)!=null&&c.aborted)throw new Yt;return this._addRun(Te(this,ht,"m",la).call(this))}static accumulateDelta(r,t){for(const[n,a]of Object.entries(t)){if(!r.hasOwnProperty(n)){r[n]=a;continue}let i=r[n];if(i==null){r[n]=a;continue}if(n==="index"||n==="type"){r[n]=a;continue}if(typeof i=="string"&&typeof a=="string")i+=a;else if(typeof i=="number"&&typeof a=="number")i+=a;else if(Ks(i)&&Ks(a))i=this.accumulateDelta(i,a);else if(Array.isArray(i)&&Array.isArray(a)){if(i.every(s=>typeof s=="string"||typeof s=="number")){i.push(...a);continue}for(const s of a){if(!Ks(s))throw new Error(`Expected array delta entry to be an object but got: ${s}`);const o=s.index;if(o==null)throw console.error(s),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const c=i[o];c==null?i.push(s):i[o]=this.accumulateDelta(c,s)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${a}, accValue: ${i}`);r[n]=i}return r}_addRun(r){return r}async _threadAssistantStream(r,t,n){return await this._createThreadAssistantStream(t,r,n)}async _runAssistantStream(r,t,n,a){return await this._createAssistantStream(t,r,n,a)}async _runToolAssistantStream(r,t,n,a,i){return await this._createToolAssistantStream(n,r,t,a,i)}}fa=function(r){if(!this.ended)switch(Mt(this,Di,r,"f"),Te(this,ht,"m",jf).call(this,r),r.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Te(this,ht,"m",Zf).call(this,r);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Te(this,ht,"m",Xf).call(this,r);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Te(this,ht,"m",Gf).call(this,r);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},la=function(){if(this.ended)throw new Se("stream has ended, this shouldn't happen");if(!Te(this,en,"f"))throw Error("Final run has not been received");return Te(this,en,"f")},Gf=function(r){const[t,n]=Te(this,ht,"m",Kf).call(this,r,Te(this,tr,"f"));Mt(this,tr,t,"f"),Te(this,Oi,"f")[t.id]=t;for(const a of n){const i=t.content[a.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(r.event){case"thread.message.created":this._emit("messageCreated",r.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",r.data.delta,t),r.data.delta.content)for(const a of r.data.delta.content){if(a.type=="text"&&a.text){let i=a.text,s=t.content[a.index];if(s&&s.type=="text")this._emit("textDelta",i,s.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=Te(this,An,"f")){if(Te(this,Zr,"f"))switch(Te(this,Zr,"f").type){case"text":this._emit("textDone",Te(this,Zr,"f").text,Te(this,tr,"f"));break;case"image_file":this._emit("imageFileDone",Te(this,Zr,"f").image_file,Te(this,tr,"f"));break}Mt(this,An,a.index,"f")}Mt(this,Zr,t.content[a.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(Te(this,An,"f")!==void 0){const a=r.data.content[Te(this,An,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,Te(this,tr,"f"));break;case"text":this._emit("textDone",a.text,Te(this,tr,"f"));break}}Te(this,tr,"f")&&this._emit("messageDone",r.data),Mt(this,tr,void 0,"f")}},Xf=function(r){const t=Te(this,ht,"m",Yf).call(this,r);switch(Mt(this,ya,t,"f"),r.event){case"thread.run.step.created":this._emit("runStepCreated",r.data);break;case"thread.run.step.delta":const n=r.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const i of n.step_details.tool_calls)i.index==Te(this,ss,"f")?this._emit("toolCallDelta",i,t.step_details.tool_calls[i.index]):(Te(this,Bt,"f")&&this._emit("toolCallDone",Te(this,Bt,"f")),Mt(this,ss,i.index,"f"),Mt(this,Bt,t.step_details.tool_calls[i.index],"f"),Te(this,Bt,"f")&&this._emit("toolCallCreated",Te(this,Bt,"f")));this._emit("runStepDelta",r.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Mt(this,ya,void 0,"f"),r.data.step_details.type=="tool_calls"&&Te(this,Bt,"f")&&(this._emit("toolCallDone",Te(this,Bt,"f")),Mt(this,Bt,void 0,"f")),this._emit("runStepDone",r.data,t);break}},jf=function(r){Te(this,Ho,"f").push(r),this._emit("event",r)},Yf=function(r){switch(r.event){case"thread.run.step.created":return Te(this,dr,"f")[r.data.id]=r.data,r.data;case"thread.run.step.delta":let t=Te(this,dr,"f")[r.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=r.data;if(n.delta){const a=sr.accumulateDelta(t,n.delta);Te(this,dr,"f")[r.data.id]=a}return Te(this,dr,"f")[r.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Te(this,dr,"f")[r.data.id]=r.data;break}if(Te(this,dr,"f")[r.data.id])return Te(this,dr,"f")[r.data.id];throw new Error("No snapshot available")},Kf=function(r,t){let n=[];switch(r.event){case"thread.message.created":return[r.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=r.data;if(a.delta.content)for(const i of a.delta.content)if(i.index in t.content){let s=t.content[i.index];t.content[i.index]=Te(this,ht,"m",qf).call(this,i,s)}else t.content[i.index]=i,n.push(i);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},qf=function(r,t){return sr.accumulateDelta(t,r)},Zf=function(r){switch(Mt(this,Pi,r.data,"f"),r.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Mt(this,en,r.data,"f"),Te(this,Bt,"f")&&(this._emit("toolCallDone",Te(this,Bt,"f")),Mt(this,Bt,void 0,"f"));break}};class Mc extends Me{create(r,t,n){return this._client.post(`/threads/${r}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(r,t,n){return this._client.get(`/threads/${r}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(r,t,n,a){return this._client.post(`/threads/${r}/messages/${t}`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(r,t={},n){return ut(t)?this.list(r,{},t):this._client.getAPIList(`/threads/${r}/messages`,Lc,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(r,t,n){return this._client.delete(`/threads/${r}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Lc extends Nt{}Mc.MessagesPage=Lc;class Bc extends Me{retrieve(r,t,n,a={},i){return ut(a)?this.retrieve(r,t,n,{},a):this._client.get(`/threads/${r}/runs/${t}/steps/${n}`,{query:a,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(r,t,n={},a){return ut(n)?this.list(r,t,{},n):this._client.getAPIList(`/threads/${r}/runs/${t}/steps`,Uc,{query:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class Uc extends Nt{}Bc.RunStepsPage=Uc;class Xa extends Me{constructor(){super(...arguments),this.steps=new Bc(this._client)}create(r,t,n){const{include:a,...i}=t;return this._client.post(`/threads/${r}/runs`,{query:{include:a},body:i,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}retrieve(r,t,n){return this._client.get(`/threads/${r}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(r,t,n,a){return this._client.post(`/threads/${r}/runs/${t}`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(r,t={},n){return ut(t)?this.list(r,{},t):this._client.getAPIList(`/threads/${r}/runs`,zc,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(r,t,n){return this._client.post(`/threads/${r}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(r,t,n){const a=await this.create(r,t,n);return await this.poll(r,a.id,n)}createAndStream(r,t,n){return sr.createAssistantStream(r,this._client.beta.threads.runs,t,n)}async poll(r,t,n){const a={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:i,response:s}=await this.retrieve(r,t,{...n,headers:{...n==null?void 0:n.headers,...a}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const c=s.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(o=f)}}await Wa(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(r,t,n){return sr.createAssistantStream(r,this._client.beta.threads.runs,t,n)}submitToolOutputs(r,t,n,a){return this._client.post(`/threads/${r}/runs/${t}/submit_tool_outputs`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(r,t,n,a){const i=await this.submitToolOutputs(r,t,n,a);return await this.poll(r,i.id,a)}submitToolOutputsStream(r,t,n,a){return sr.createToolAssistantStream(r,t,this._client.beta.threads.runs,n,a)}}class zc extends Nt{}Xa.RunsPage=zc;Xa.Steps=Bc;Xa.RunStepsPage=Uc;class Gn extends Me{constructor(){super(...arguments),this.runs=new Xa(this._client),this.messages=new Mc(this._client)}create(r={},t){return ut(r)?this.create({},r):this._client.post("/threads",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(r,t){return this._client.get(`/threads/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(r,t,n){return this._client.post(`/threads/${r}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(r,t){return this._client.delete(`/threads/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(r,t){return this._client.post("/threads/runs",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:r.stream??!1})}async createAndRunPoll(r,t){const n=await this.createAndRun(r,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(r,t){return sr.createThreadAssistantStream(r,this._client.beta.threads,t)}}Gn.Runs=Xa;Gn.RunsPage=zc;Gn.Messages=Mc;Gn.MessagesPage=Lc;class Xn extends Me{constructor(){super(...arguments),this.realtime=new ys(this._client),this.chat=new $o(this._client),this.assistants=new Ic(this._client),this.threads=new Gn(this._client)}}Xn.Realtime=ys;Xn.Assistants=Ic;Xn.AssistantsPage=Oc;Xn.Threads=Gn;class yd extends Me{create(r,t){return this._client.post("/completions",{body:r,...t,stream:r.stream??!1})}}class kd extends Me{create(r,t){return this._client.post("/embeddings",{body:r,...t})}}let $c=class extends Me{create(r,t){return this._client.post("/files",$n({body:r,...t}))}retrieve(r,t){return this._client.get(`/files/${r}`,t)}list(r={},t){return ut(r)?this.list({},r):this._client.getAPIList("/files",Hc,{query:r,...t})}del(r,t){return this._client.delete(`/files/${r}`,t)}content(r,t){return this._client.get(`/files/${r}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(r,t){return this._client.get(`/files/${r}/content`,t)}async waitForProcessing(r,{pollInterval:t=5e3,maxWait:n=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),i=Date.now();let s=await this.retrieve(r);for(;!s.status||!a.has(s.status);)if(await Wa(t),s=await this.retrieve(r),Date.now()-i>n)throw new Sc({message:`Giving up on waiting for file ${r} to finish processing after ${n} milliseconds.`});return s}};class Hc extends Nt{}$c.FileObjectsPage=Hc;class Wc extends Me{list(r,t={},n){return ut(t)?this.list(r,{},t):this._client.getAPIList(`/fine_tuning/jobs/${r}/checkpoints`,Vc,{query:t,...n})}}class Vc extends Nt{}Wc.FineTuningJobCheckpointsPage=Vc;class jn extends Me{constructor(){super(...arguments),this.checkpoints=new Wc(this._client)}create(r,t){return this._client.post("/fine_tuning/jobs",{body:r,...t})}retrieve(r,t){return this._client.get(`/fine_tuning/jobs/${r}`,t)}list(r={},t){return ut(r)?this.list({},r):this._client.getAPIList("/fine_tuning/jobs",Gc,{query:r,...t})}cancel(r,t){return this._client.post(`/fine_tuning/jobs/${r}/cancel`,t)}listEvents(r,t={},n){return ut(t)?this.listEvents(r,{},t):this._client.getAPIList(`/fine_tuning/jobs/${r}/events`,Xc,{query:t,...n})}}class Gc extends Nt{}class Xc extends Nt{}jn.FineTuningJobsPage=Gc;jn.FineTuningJobEventsPage=Xc;jn.Checkpoints=Wc;jn.FineTuningJobCheckpointsPage=Vc;class ja extends Me{constructor(){super(...arguments),this.jobs=new jn(this._client)}}ja.Jobs=jn;ja.FineTuningJobsPage=Gc;ja.FineTuningJobEventsPage=Xc;class Ed extends Me{createVariation(r,t){return this._client.post("/images/variations",$n({body:r,...t}))}edit(r,t){return this._client.post("/images/edits",$n({body:r,...t}))}generate(r,t){return this._client.post("/images/generations",{body:r,...t})}}class jc extends Me{retrieve(r,t){return this._client.get(`/models/${r}`,t)}list(r){return this._client.getAPIList("/models",Yc,r)}del(r,t){return this._client.delete(`/models/${r}`,t)}}class Yc extends Cc{}jc.ModelsPage=Yc;class Td extends Me{create(r,t){return this._client.post("/moderations",{body:r,...t})}}function Jb(e,r){return!r||!eA(r)?{...e,output_parsed:null,output:e.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(n=>({...n,parsed:null}))}:t)}:bd(e,r)}function bd(e,r){const t=e.output.map(a=>{if(a.type==="function_call")return{...a,parsed_arguments:nA(r,a)};if(a.type==="message"){const i=a.content.map(s=>s.type==="output_text"?{...s,parsed:Qb(r,s.text)}:s);return{...a,content:i}}return a}),n=Object.assign({},e,{output:t});return Object.getOwnPropertyDescriptor(e,"output_text")||Ad(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(const a of n.output)if(a.type==="message"){for(const i of a.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),n}function Qb(e,r){var t,n,a,i;return((n=(t=e.text)==null?void 0:t.format)==null?void 0:n.type)!=="json_schema"?null:"$parseRaw"in((a=e.text)==null?void 0:a.format)?((i=e.text)==null?void 0:i.format).$parseRaw(r):JSON.parse(r)}function eA(e){var r;return!!Pc((r=e.text)==null?void 0:r.format)}function tA(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function rA(e,r){return e.find(t=>t.type==="function"&&t.name===r)}function nA(e,r){const t=rA(e.tools??[],r.name);return{...r,...r,parsed_arguments:tA(t)?t.$parseRaw(r.arguments):t!=null&&t.strict?JSON.parse(r.arguments):null}}function Ad(e){const r=[];for(const t of e.output)if(t.type==="message")for(const n of t.content)n.type==="output_text"&&r.push(n.text);e.output_text=r.join("")}class Sd extends Me{list(r,t={},n){return ut(t)?this.list(r,{},t):this._client.getAPIList(`/responses/${r}/input_items`,iA,{query:t,...n})}}var wn=function(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t},Nr=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},yn,wi,Mr,yi,Jf,Qf,el,tl;class Kc extends Dc{constructor(r){super(),yn.add(this),wi.set(this,void 0),Mr.set(this,void 0),yi.set(this,void 0),wn(this,wi,r,"f")}static createResponse(r,t,n){const a=new Kc(t);return a._run(()=>a._createResponse(r,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createResponse(r,t,n){var s;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Nr(this,yn,"m",Jf).call(this);const i=await r.responses.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of i)Nr(this,yn,"m",Qf).call(this,o);if((s=i.controller.signal)!=null&&s.aborted)throw new Yt;return Nr(this,yn,"m",el).call(this)}[(wi=new WeakMap,Mr=new WeakMap,yi=new WeakMap,yn=new WeakSet,Jf=function(){this.ended||wn(this,Mr,void 0,"f")},Qf=function(t){if(this.ended)return;const n=Nr(this,yn,"m",tl).call(this,t);switch(this._emit("event",t),t.type){case"response.output_text.delta":{const a=n.output[t.output_index];if(!a)throw new Se(`missing output at index ${t.output_index}`);if(a.type==="message"){const i=a.content[t.content_index];if(!i)throw new Se(`missing content at index ${t.content_index}`);if(i.type!=="output_text")throw new Se(`expected content to be 'output_text', got ${i.type}`);this._emit("response.output_text.delta",{...t,snapshot:i.text})}break}case"response.function_call_arguments.delta":{const a=n.output[t.output_index];if(!a)throw new Se(`missing output at index ${t.output_index}`);a.type==="function_call"&&this._emit("response.function_call_arguments.delta",{...t,snapshot:a.arguments});break}default:this._emit(t.type,t);break}},el=function(){if(this.ended)throw new Se("stream has ended, this shouldn't happen");const t=Nr(this,Mr,"f");if(!t)throw new Se("request ended without sending any events");wn(this,Mr,void 0,"f");const n=aA(t,Nr(this,wi,"f"));return wn(this,yi,n,"f"),n},tl=function(t){let n=Nr(this,Mr,"f");if(!n){if(t.type!=="response.created")throw new Se(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return n=wn(this,Mr,t.response,"f"),n}switch(t.type){case"response.output_item.added":{n.output.push(t.item);break}case"response.content_part.added":{const a=n.output[t.output_index];if(!a)throw new Se(`missing output at index ${t.output_index}`);a.type==="message"&&a.content.push(t.part);break}case"response.output_text.delta":{const a=n.output[t.output_index];if(!a)throw new Se(`missing output at index ${t.output_index}`);if(a.type==="message"){const i=a.content[t.content_index];if(!i)throw new Se(`missing content at index ${t.content_index}`);if(i.type!=="output_text")throw new Se(`expected content to be 'output_text', got ${i.type}`);i.text+=t.delta}break}case"response.function_call_arguments.delta":{const a=n.output[t.output_index];if(!a)throw new Se(`missing output at index ${t.output_index}`);a.type==="function_call"&&(a.arguments+=t.delta);break}case"response.completed":{wn(this,Mr,t.response,"f");break}}return n},Symbol.asyncIterator)](){const r=[],t=[];let n=!1;return this.on("event",a=>{const i=t.shift();i?i.resolve(a):r.push(a)}),this.on("end",()=>{n=!0;for(const a of t)a.resolve(void 0);t.length=0}),this.on("abort",a=>{n=!0;for(const i of t)i.reject(a);t.length=0}),this.on("error",a=>{n=!0;for(const i of t)i.reject(a);t.length=0}),{next:async()=>r.length?{value:r.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,s)=>t.push({resolve:i,reject:s})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const r=Nr(this,yi,"f");if(!r)throw new Se("stream ended without producing a ChatCompletion");return r}}function aA(e,r){return Jb(e,r)}class qc extends Me{constructor(){super(...arguments),this.inputItems=new Sd(this._client)}create(r,t){return this._client.post("/responses",{body:r,...t,stream:r.stream??!1})._thenUnwrap(n=>("object"in n&&n.object==="response"&&Ad(n),n))}retrieve(r,t={},n){return ut(t)?this.retrieve(r,{},t):this._client.get(`/responses/${r}`,{query:t,...n})}del(r,t){return this._client.delete(`/responses/${r}`,{...t,headers:{Accept:"*/*",...t==null?void 0:t.headers}})}parse(r,t){return this._client.responses.create(r,t)._thenUnwrap(n=>bd(n,r))}stream(r,t){return Kc.createResponse(this._client,r,t)}}class iA extends Nt{}qc.InputItems=Sd;class Cd extends Me{create(r,t,n){return this._client.post(`/uploads/${r}/parts`,$n({body:t,...n}))}}class Zc extends Me{constructor(){super(...arguments),this.parts=new Cd(this._client)}create(r,t){return this._client.post("/uploads",{body:r,...t})}cancel(r,t){return this._client.post(`/uploads/${r}/cancel`,t)}complete(r,t,n){return this._client.post(`/uploads/${r}/complete`,{body:t,...n})}}Zc.Parts=Cd;const sA=async e=>{const r=await Promise.allSettled(e),t=r.filter(a=>a.status==="rejected");if(t.length){for(const a of t)console.error(a.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const n=[];for(const a of r)a.status==="fulfilled"&&n.push(a.value);return n};class ks extends Me{create(r,t,n){return this._client.post(`/vector_stores/${r}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(r,t,n){return this._client.get(`/vector_stores/${r}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(r,t,n,a){return this._client.post(`/vector_stores/${r}/files/${t}`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(r,t={},n){return ut(t)?this.list(r,{},t):this._client.getAPIList(`/vector_stores/${r}/files`,Es,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(r,t,n){return this._client.delete(`/vector_stores/${r}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(r,t,n){const a=await this.create(r,t,n);return await this.poll(r,a.id,n)}async poll(r,t,n){const a={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const i=await this.retrieve(r,t,{...n,headers:a}).withResponse(),s=i.data;switch(s.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const c=i.response.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(o=f)}}await Wa(o);break;case"failed":case"completed":return s}}}async upload(r,t,n){const a=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(r,{file_id:a.id},n)}async uploadAndPoll(r,t,n){const a=await this.upload(r,t,n);return await this.poll(r,a.id,n)}content(r,t,n){return this._client.getAPIList(`/vector_stores/${r}/files/${t}/content`,Jc,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Es extends Nt{}class Jc extends Cc{}ks.VectorStoreFilesPage=Es;ks.FileContentResponsesPage=Jc;class Fd extends Me{create(r,t,n){return this._client.post(`/vector_stores/${r}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(r,t,n){return this._client.get(`/vector_stores/${r}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(r,t,n){return this._client.post(`/vector_stores/${r}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(r,t,n){const a=await this.create(r,t);return await this.poll(r,a.id,n)}listFiles(r,t,n={},a){return ut(n)?this.listFiles(r,t,{},n):this._client.getAPIList(`/vector_stores/${r}/file_batches/${t}/files`,Es,{query:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async poll(r,t,n){const a={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:i,response:s}=await this.retrieve(r,t,{...n,headers:a}).withResponse();switch(i.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const c=s.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(o=f)}}await Wa(o);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(r,{files:t,fileIds:n=[]},a){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(a==null?void 0:a.maxConcurrency)??5,s=Math.min(i,t.length),o=this._client,c=t.values(),f=[...n];async function l(d){for(let h of d){const x=await o.files.create({file:h,purpose:"assistants"},a);f.push(x.id)}}const u=Array(s).fill(c).map(l);return await sA(u),await this.createAndPoll(r,{file_ids:f})}}class Vr extends Me{constructor(){super(...arguments),this.files=new ks(this._client),this.fileBatches=new Fd(this._client)}create(r,t){return this._client.post("/vector_stores",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(r,t){return this._client.get(`/vector_stores/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(r,t,n){return this._client.post(`/vector_stores/${r}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(r={},t){return ut(r)?this.list({},r):this._client.getAPIList("/vector_stores",Qc,{query:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(r,t){return this._client.delete(`/vector_stores/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}search(r,t,n){return this._client.getAPIList(`/vector_stores/${r}/search`,e0,{body:t,method:"post",...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Qc extends Nt{}class e0 extends Cc{}Vr.VectorStoresPage=Qc;Vr.VectorStoreSearchResponsesPage=e0;Vr.Files=ks;Vr.VectorStoreFilesPage=Es;Vr.FileContentResponsesPage=Jc;Vr.FileBatches=Fd;var Rd;class Pe extends Cb{constructor({baseURL:r=xi("OPENAI_BASE_URL"),apiKey:t=xi("OPENAI_API_KEY"),organization:n=xi("OPENAI_ORG_ID")??null,project:a=xi("OPENAI_PROJECT_ID")??null,...i}={}){if(t===void 0)throw new Se("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const s={apiKey:t,organization:n,project:a,...i,baseURL:r||"https://api.openai.com/v1"};if(!s.dangerouslyAllowBrowser&&Bb())throw new Se(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:s.baseURL,timeout:s.timeout??6e5,httpAgent:s.httpAgent,maxRetries:s.maxRetries,fetch:s.fetch}),this.completions=new yd(this),this.chat=new ws(this),this.embeddings=new kd(this),this.files=new $c(this),this.images=new Ed(this),this.audio=new Va(this),this.moderations=new Td(this),this.models=new jc(this),this.fineTuning=new ja(this),this.vectorStores=new Vr(this),this.beta=new Xn(this),this.batches=new Fc(this),this.uploads=new Zc(this),this.responses=new qc(this),this._options=s,this.apiKey=t,this.organization=n,this.project=a}defaultQuery(){return this._options.defaultQuery}defaultHeaders(r){return{...super.defaultHeaders(r),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(r){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(r){return lb(r,{arrayFormat:"brackets"})}}Rd=Pe;Pe.OpenAI=Rd;Pe.DEFAULT_TIMEOUT=6e5;Pe.OpenAIError=Se;Pe.APIError=mt;Pe.APIConnectionError=ps;Pe.APIConnectionTimeoutError=Sc;Pe.APIUserAbortError=Yt;Pe.NotFoundError=Oh;Pe.ConflictError=Dh;Pe.RateLimitError=Nh;Pe.BadRequestError=Fh;Pe.AuthenticationError=Rh;Pe.InternalServerError=Mh;Pe.PermissionDeniedError=Ih;Pe.UnprocessableEntityError=Ph;Pe.toFile=Hh;Pe.fileFromPath=Ah;Pe.Completions=yd;Pe.Chat=ws;Pe.ChatCompletionsPage=vs;Pe.Embeddings=kd;Pe.Files=$c;Pe.FileObjectsPage=Hc;Pe.Images=Ed;Pe.Audio=Va;Pe.Moderations=Td;Pe.Models=jc;Pe.ModelsPage=Yc;Pe.FineTuning=ja;Pe.VectorStores=Vr;Pe.VectorStoresPage=Qc;Pe.VectorStoreSearchResponsesPage=e0;Pe.Beta=Xn;Pe.Batches=Fc;Pe.BatchesPage=Rc;Pe.Uploads=Zc;Pe.Responses=qc;const t0=new Pe({apiKey:void 0,dangerouslyAllowBrowser:!0});async function oA(e,r,t,n){let a="";if(n){const c="fileSearch";r(c,`[FileSearch] Searching in "${n}" for context...`);try{const f=await t0.responses.create({model:"gpt-4o-mini",input:`Summarize any relevant info about: ${e}`,tools:[{type:"file_search",vector_store_ids:[n]}]});t(c,`[FileSearch] Done searching in "${n}".`),a=f.output_text||""}catch(f){t(c,`[FileSearch] Failed: ${String(f)}`)}}const i="planProject";r(i,"[planProject] Requesting project plan...");const s=await cA(e,a);t(i,"[planProject] Plan generated & parsed.");const o={};for(const c of s){const f=`generateFile:${c.filePath}`;r(f,`[Orchestrator] Generating file "${c.filePath}"...`);const l=await fA(c,a);t(f,`[Orchestrator] Finished "${c.filePath}".`),o[c.filePath]=l}return o}async function cA(e,r){console.log("[planProject] Sending request to openai.responses.create...");const t=`
      You are an expert architect.
      The user wants: "${e}"
  
      Additional reference info (if any):
      ${r}
  
      Please return a JSON array describing each needed file (filePath + short description).
      Keep it minimal if the user asked for a small project, or more thorough if complex.
      If it is an Azure Python function, etc...
    `,n=await t0.responses.create({model:"o3-mini",input:t,reasoning:{effort:"medium"}});console.log("[planProject] Raw response from OpenAI:",n);let a=[];try{const i=n.output_text;a=JSON.parse(i),console.log("[planProject] Successfully parsed response:",a)}catch(i){console.warn("[planProject] Failed to parse JSON. Using fallback plan. Error:",i),a=[{filePath:"index.html",description:"Front-end HTML"},{filePath:"index.ts",description:"Front-end TS logic"},{filePath:"azure-functions/__init__.py",description:"Azure Function entry point"}]}return a}async function fA(e,r){console.log("[generateOneFile] Requesting content for:",e.filePath);const t=`
      You are a code generator. 
      The user also provided extra reference info:
      ${r}
  
      Generate the file: "${e.filePath}" 
      Description: ${e.description}
      Return ONLY the file content, no extra commentary.
    `,n=await t0.responses.create({model:"o3-mini",input:t,reasoning:{effort:"high"}});return console.log("[generateOneFile] Raw file content from OpenAI:",n),(n.output_text||"").trim()}var ki=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lA(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ei(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var to={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var rl;function uA(){return rl||(rl=1,function(e,r){(function(t){e.exports=t()})(function(){return function t(n,a,i){function s(f,l){if(!a[f]){if(!n[f]){var u=typeof Ei=="function"&&Ei;if(!l&&u)return u(f,!0);if(o)return o(f,!0);var d=new Error("Cannot find module '"+f+"'");throw d.code="MODULE_NOT_FOUND",d}var h=a[f]={exports:{}};n[f][0].call(h.exports,function(x){var p=n[f][1][x];return s(p||x)},h,h.exports,t,n,a,i)}return a[f].exports}for(var o=typeof Ei=="function"&&Ei,c=0;c<i.length;c++)s(i[c]);return s}({1:[function(t,n,a){var i=t("./utils"),s=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(c){for(var f,l,u,d,h,x,p,m=[],g=0,w=c.length,v=w,k=i.getTypeOf(c)!=="string";g<c.length;)v=w-g,u=k?(f=c[g++],l=g<w?c[g++]:0,g<w?c[g++]:0):(f=c.charCodeAt(g++),l=g<w?c.charCodeAt(g++):0,g<w?c.charCodeAt(g++):0),d=f>>2,h=(3&f)<<4|l>>4,x=1<v?(15&l)<<2|u>>6:64,p=2<v?63&u:64,m.push(o.charAt(d)+o.charAt(h)+o.charAt(x)+o.charAt(p));return m.join("")},a.decode=function(c){var f,l,u,d,h,x,p=0,m=0,g="data:";if(c.substr(0,g.length)===g)throw new Error("Invalid base64 input, it looks like a data url.");var w,v=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===o.charAt(64)&&v--,c.charAt(c.length-2)===o.charAt(64)&&v--,v%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=s.uint8array?new Uint8Array(0|v):new Array(0|v);p<c.length;)f=o.indexOf(c.charAt(p++))<<2|(d=o.indexOf(c.charAt(p++)))>>4,l=(15&d)<<4|(h=o.indexOf(c.charAt(p++)))>>2,u=(3&h)<<6|(x=o.indexOf(c.charAt(p++))),w[m++]=f,h!==64&&(w[m++]=l),x!==64&&(w[m++]=u);return w}},{"./support":30,"./utils":32}],2:[function(t,n,a){var i=t("./external"),s=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),c=t("./stream/DataLengthProbe");function f(l,u,d,h,x){this.compressedSize=l,this.uncompressedSize=u,this.crc32=d,this.compression=h,this.compressedContent=x}f.prototype={getContentWorker:function(){var l=new s(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),u=this;return l.on("end",function(){if(this.streamInfo.data_length!==u.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),l},getCompressedWorker:function(){return new s(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(l,u,d){return l.pipe(new o).pipe(new c("uncompressedSize")).pipe(u.compressWorker(d)).pipe(new c("compressedSize")).withStreamInfo("compression",u)},n.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,n,a){var i=t("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},a.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,n,a){var i=t("./utils"),s=function(){for(var o,c=[],f=0;f<256;f++){o=f;for(var l=0;l<8;l++)o=1&o?3988292384^o>>>1:o>>>1;c[f]=o}return c}();n.exports=function(o,c){return o!==void 0&&o.length?i.getTypeOf(o)!=="string"?function(f,l,u,d){var h=s,x=d+u;f^=-1;for(var p=d;p<x;p++)f=f>>>8^h[255&(f^l[p])];return-1^f}(0|c,o,o.length,0):function(f,l,u,d){var h=s,x=d+u;f^=-1;for(var p=d;p<x;p++)f=f>>>8^h[255&(f^l.charCodeAt(p))];return-1^f}(0|c,o,o.length,0):0}},{"./utils":32}],5:[function(t,n,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(t,n,a){var i=null;i=typeof Promise<"u"?Promise:t("lie"),n.exports={Promise:i}},{lie:37}],7:[function(t,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=t("pako"),o=t("./utils"),c=t("./stream/GenericWorker"),f=i?"uint8array":"array";function l(u,d){c.call(this,"FlateWorker/"+u),this._pako=null,this._pakoAction=u,this._pakoOptions=d,this.meta={}}a.magic="\b\0",o.inherits(l,c),l.prototype.processChunk=function(u){this.meta=u.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(f,u.data),!1)},l.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var u=this;this._pako.onData=function(d){u.push({data:d,meta:u.meta})}},a.compressWorker=function(u){return new l("Deflate",u)},a.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,n,a){function i(h,x){var p,m="";for(p=0;p<x;p++)m+=String.fromCharCode(255&h),h>>>=8;return m}function s(h,x,p,m,g,w){var v,k,A=h.file,F=h.compression,E=w!==f.utf8encode,z=o.transformTo("string",w(A.name)),C=o.transformTo("string",f.utf8encode(A.name)),G=A.comment,H=o.transformTo("string",w(G)),b=o.transformTo("string",f.utf8encode(G)),X=C.length!==A.name.length,_=b.length!==G.length,W="",q="",j="",ue=A.dir,P=A.date,se={crc32:0,compressedSize:0,uncompressedSize:0};x&&!p||(se.crc32=h.crc32,se.compressedSize=h.compressedSize,se.uncompressedSize=h.uncompressedSize);var Y=0;x&&(Y|=8),E||!X&&!_||(Y|=2048);var T=0,K=0;ue&&(T|=16),g==="UNIX"?(K=798,T|=function(N,ie){var pe=N;return N||(pe=ie?16893:33204),(65535&pe)<<16}(A.unixPermissions,ue)):(K=20,T|=function(N){return 63&(N||0)}(A.dosPermissions)),v=P.getUTCHours(),v<<=6,v|=P.getUTCMinutes(),v<<=5,v|=P.getUTCSeconds()/2,k=P.getUTCFullYear()-1980,k<<=4,k|=P.getUTCMonth()+1,k<<=5,k|=P.getUTCDate(),X&&(q=i(1,1)+i(l(z),4)+C,W+="up"+i(q.length,2)+q),_&&(j=i(1,1)+i(l(H),4)+b,W+="uc"+i(j.length,2)+j);var B="";return B+=`
\0`,B+=i(Y,2),B+=F.magic,B+=i(v,2),B+=i(k,2),B+=i(se.crc32,4),B+=i(se.compressedSize,4),B+=i(se.uncompressedSize,4),B+=i(z.length,2),B+=i(W.length,2),{fileRecord:u.LOCAL_FILE_HEADER+B+z+W,dirRecord:u.CENTRAL_FILE_HEADER+i(K,2)+B+i(H.length,2)+"\0\0\0\0"+i(T,4)+i(m,4)+z+W+H}}var o=t("../utils"),c=t("../stream/GenericWorker"),f=t("../utf8"),l=t("../crc32"),u=t("../signature");function d(h,x,p,m){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=x,this.zipPlatform=p,this.encodeFileName=m,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(d,c),d.prototype.push=function(h){var x=h.meta.percent||0,p=this.entriesCount,m=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,c.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:p?(x+100*(p-m-1))/p:100}}))},d.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var x=this.streamFiles&&!h.file.dir;if(x){var p=s(h,x,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:p.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(h){this.accumulate=!1;var x=this.streamFiles&&!h.file.dir,p=s(h,x,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(p.dirRecord),x)this.push({data:function(m){return u.DATA_DESCRIPTOR+i(m.crc32,4)+i(m.compressedSize,4)+i(m.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:p.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var h=this.bytesWritten,x=0;x<this.dirRecords.length;x++)this.push({data:this.dirRecords[x],meta:{percent:100}});var p=this.bytesWritten-h,m=function(g,w,v,k,A){var F=o.transformTo("string",A(k));return u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(g,2)+i(g,2)+i(w,4)+i(v,4)+i(F.length,2)+F}(this.dirRecords.length,p,h,this.zipComment,this.encodeFileName);this.push({data:m,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(h){this._sources.push(h);var x=this;return h.on("data",function(p){x.processChunk(p)}),h.on("end",function(){x.closedSource(x.previous.streamInfo),x._sources.length?x.prepareNextSource():x.end()}),h.on("error",function(p){x.error(p)}),this},d.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(h){var x=this._sources;if(!c.prototype.error.call(this,h))return!1;for(var p=0;p<x.length;p++)try{x[p].error(h)}catch{}return!0},d.prototype.lock=function(){c.prototype.lock.call(this);for(var h=this._sources,x=0;x<h.length;x++)h[x].lock()},n.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,n,a){var i=t("../compressions"),s=t("./ZipFileWorker");a.generateWorker=function(o,c,f){var l=new s(c.streamFiles,f,c.platform,c.encodeFileName),u=0;try{o.forEach(function(d,h){u++;var x=function(w,v){var k=w||v,A=i[k];if(!A)throw new Error(k+" is not a valid compression method !");return A}(h.options.compression,c.compression),p=h.options.compressionOptions||c.compressionOptions||{},m=h.dir,g=h.date;h._compressWorker(x,p).withStreamInfo("file",{name:d,dir:m,date:g,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(l)}),l.entriesCount=u}catch(d){l.error(d)}return l}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,n,a){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new i;for(var o in this)typeof this[o]!="function"&&(s[o]=this[o]);return s}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.10.1",i.loadAsync=function(s,o){return new i().loadAsync(s,o)},i.external=t("./external"),n.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,n,a){var i=t("./utils"),s=t("./external"),o=t("./utf8"),c=t("./zipEntries"),f=t("./stream/Crc32Probe"),l=t("./nodejsUtils");function u(d){return new s.Promise(function(h,x){var p=d.decompressed.getContentWorker().pipe(new f);p.on("error",function(m){x(m)}).on("end",function(){p.streamInfo.crc32!==d.decompressed.crc32?x(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}n.exports=function(d,h){var x=this;return h=i.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),l.isNode&&l.isStream(d)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",d,!0,h.optimizedBinaryString,h.base64).then(function(p){var m=new c(h);return m.load(p),m}).then(function(p){var m=[s.Promise.resolve(p)],g=p.files;if(h.checkCRC32)for(var w=0;w<g.length;w++)m.push(u(g[w]));return s.Promise.all(m)}).then(function(p){for(var m=p.shift(),g=m.files,w=0;w<g.length;w++){var v=g[w],k=v.fileNameStr,A=i.resolve(v.fileNameStr);x.file(A,v.decompressed,{binary:!0,optimizedBinaryString:!0,date:v.date,dir:v.dir,comment:v.fileCommentStr.length?v.fileCommentStr:null,unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions,createFolders:h.createFolders}),v.dir||(x.file(A).unsafeOriginalName=k)}return m.zipComment.length&&(x.comment=m.zipComment),x})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,n,a){var i=t("../utils"),s=t("../stream/GenericWorker");function o(c,f){s.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(f)}i.inherits(o,s),o.prototype._bindStream=function(c){var f=this;(this._stream=c).pause(),c.on("data",function(l){f.push({data:l,meta:{percent:0}})}).on("error",function(l){f.isPaused?this.generatedError=l:f.error(l)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},o.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,n,a){var i=t("readable-stream").Readable;function s(o,c,f){i.call(this,c),this._helper=o;var l=this;o.on("data",function(u,d){l.push(u)||l._helper.pause(),f&&f(d)}).on("error",function(u){l.emit("error",u)}).on("end",function(){l.push(null)})}t("../utils").inherits(s,i),s.prototype._read=function(){this._helper.resume()},n.exports=s},{"../utils":32,"readable-stream":16}],14:[function(t,n,a){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,s);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,s)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var s=new Buffer(i);return s.fill(0),s},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(t,n,a){function i(A,F,E){var z,C=o.getTypeOf(F),G=o.extend(E||{},l);G.date=G.date||new Date,G.compression!==null&&(G.compression=G.compression.toUpperCase()),typeof G.unixPermissions=="string"&&(G.unixPermissions=parseInt(G.unixPermissions,8)),G.unixPermissions&&16384&G.unixPermissions&&(G.dir=!0),G.dosPermissions&&16&G.dosPermissions&&(G.dir=!0),G.dir&&(A=g(A)),G.createFolders&&(z=m(A))&&w.call(this,z,!0);var H=C==="string"&&G.binary===!1&&G.base64===!1;E&&E.binary!==void 0||(G.binary=!H),(F instanceof u&&F.uncompressedSize===0||G.dir||!F||F.length===0)&&(G.base64=!1,G.binary=!0,F="",G.compression="STORE",C="string");var b=null;b=F instanceof u||F instanceof c?F:x.isNode&&x.isStream(F)?new p(A,F):o.prepareContent(A,F,G.binary,G.optimizedBinaryString,G.base64);var X=new d(A,b,G);this.files[A]=X}var s=t("./utf8"),o=t("./utils"),c=t("./stream/GenericWorker"),f=t("./stream/StreamHelper"),l=t("./defaults"),u=t("./compressedObject"),d=t("./zipObject"),h=t("./generate"),x=t("./nodejsUtils"),p=t("./nodejs/NodejsStreamInputAdapter"),m=function(A){A.slice(-1)==="/"&&(A=A.substring(0,A.length-1));var F=A.lastIndexOf("/");return 0<F?A.substring(0,F):""},g=function(A){return A.slice(-1)!=="/"&&(A+="/"),A},w=function(A,F){return F=F!==void 0?F:l.createFolders,A=g(A),this.files[A]||i.call(this,A,null,{dir:!0,createFolders:F}),this.files[A]};function v(A){return Object.prototype.toString.call(A)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(A){var F,E,z;for(F in this.files)z=this.files[F],(E=F.slice(this.root.length,F.length))&&F.slice(0,this.root.length)===this.root&&A(E,z)},filter:function(A){var F=[];return this.forEach(function(E,z){A(E,z)&&F.push(z)}),F},file:function(A,F,E){if(arguments.length!==1)return A=this.root+A,i.call(this,A,F,E),this;if(v(A)){var z=A;return this.filter(function(G,H){return!H.dir&&z.test(G)})}var C=this.files[this.root+A];return C&&!C.dir?C:null},folder:function(A){if(!A)return this;if(v(A))return this.filter(function(C,G){return G.dir&&A.test(C)});var F=this.root+A,E=w.call(this,F),z=this.clone();return z.root=E.name,z},remove:function(A){A=this.root+A;var F=this.files[A];if(F||(A.slice(-1)!=="/"&&(A+="/"),F=this.files[A]),F&&!F.dir)delete this.files[A];else for(var E=this.filter(function(C,G){return G.name.slice(0,A.length)===A}),z=0;z<E.length;z++)delete this.files[E[z].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(A){var F,E={};try{if((E=o.extend(A||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=E.type.toLowerCase(),E.compression=E.compression.toUpperCase(),E.type==="binarystring"&&(E.type="string"),!E.type)throw new Error("No output type specified.");o.checkSupport(E.type),E.platform!=="darwin"&&E.platform!=="freebsd"&&E.platform!=="linux"&&E.platform!=="sunos"||(E.platform="UNIX"),E.platform==="win32"&&(E.platform="DOS");var z=E.comment||this.comment||"";F=h.generateWorker(this,E,z)}catch(C){(F=new c("error")).error(C)}return new f(F,E.type||"string",E.mimeType)},generateAsync:function(A,F){return this.generateInternalStream(A).accumulate(F)},generateNodeStream:function(A,F){return(A=A||{}).type||(A.type="nodebuffer"),this.generateInternalStream(A).toNodejsStream(F)}};n.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,n,a){n.exports=t("stream")},{stream:void 0}],17:[function(t,n,a){var i=t("./DataReader");function s(o){i.call(this,o);for(var c=0;c<this.data.length;c++)o[c]=255&o[c]}t("../utils").inherits(s,i),s.prototype.byteAt=function(o){return this.data[this.zero+o]},s.prototype.lastIndexOfSignature=function(o){for(var c=o.charCodeAt(0),f=o.charCodeAt(1),l=o.charCodeAt(2),u=o.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===c&&this.data[d+1]===f&&this.data[d+2]===l&&this.data[d+3]===u)return d-this.zero;return-1},s.prototype.readAndCheckSignature=function(o){var c=o.charCodeAt(0),f=o.charCodeAt(1),l=o.charCodeAt(2),u=o.charCodeAt(3),d=this.readData(4);return c===d[0]&&f===d[1]&&l===d[2]&&u===d[3]},s.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=s},{"../utils":32,"./DataReader":18}],18:[function(t,n,a){var i=t("../utils");function s(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var c,f=0;for(this.checkOffset(o),c=this.index+o-1;c>=this.index;c--)f=(f<<8)+this.byteAt(c);return this.index+=o,f},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},n.exports=s},{"../utils":32}],19:[function(t,n,a){var i=t("./Uint8ArrayReader");function s(o){i.call(this,o)}t("../utils").inherits(s,i),s.prototype.readData=function(o){this.checkOffset(o);var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,n,a){var i=t("./DataReader");function s(o){i.call(this,o)}t("../utils").inherits(s,i),s.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},s.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},s.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},s.prototype.readData=function(o){this.checkOffset(o);var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=s},{"../utils":32,"./DataReader":18}],21:[function(t,n,a){var i=t("./ArrayReader");function s(o){i.call(this,o)}t("../utils").inherits(s,i),s.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(t,n,a){var i=t("../utils"),s=t("../support"),o=t("./ArrayReader"),c=t("./StringReader"),f=t("./NodeBufferReader"),l=t("./Uint8ArrayReader");n.exports=function(u){var d=i.getTypeOf(u);return i.checkSupport(d),d!=="string"||s.uint8array?d==="nodebuffer"?new f(u):s.uint8array?new l(i.transformTo("uint8array",u)):new o(i.transformTo("array",u)):new c(u)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,n,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,n,a){var i=t("./GenericWorker"),s=t("../utils");function o(c){i.call(this,"ConvertWorker to "+c),this.destType=c}s.inherits(o,i),o.prototype.processChunk=function(c){this.push({data:s.transformTo(this.destType,c.data),meta:c.meta})},n.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,n,a){var i=t("./GenericWorker"),s=t("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,i),o.prototype.processChunk=function(c){this.streamInfo.crc32=s(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,n,a){var i=t("../utils"),s=t("./GenericWorker");function o(c){s.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}i.inherits(o,s),o.prototype.processChunk=function(c){if(c){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+c.data.length}s.prototype.processChunk.call(this,c)},n.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,n,a){var i=t("../utils"),s=t("./GenericWorker");function o(c){s.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(l){f.dataIsReady=!0,f.data=l,f.max=l&&l.length||0,f.type=i.getTypeOf(l),f.isPaused||f._tickAndRepeat()},function(l){f.error(l)})}i.inherits(o,s),o.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,f);break;case"uint8array":c=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":c=this.data.slice(this.index,f)}return this.index=f,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,n,a){function i(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,o){return this._listeners[s].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,o){if(this._listeners[s])for(var c=0;c<this._listeners[s].length;c++)this._listeners[s][c].call(this,o)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var o=this;return s.on("data",function(c){o.processChunk(c)}),s.on("end",function(){o.end()}),s.on("error",function(c){o.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,o){return this.extraStreamInfo[s]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},n.exports=i},{}],29:[function(t,n,a){var i=t("../utils"),s=t("./ConvertWorker"),o=t("./GenericWorker"),c=t("../base64"),f=t("../support"),l=t("../external"),u=null;if(f.nodestream)try{u=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(x,p){return new l.Promise(function(m,g){var w=[],v=x._internalType,k=x._outputType,A=x._mimeType;x.on("data",function(F,E){w.push(F),p&&p(E)}).on("error",function(F){w=[],g(F)}).on("end",function(){try{var F=function(E,z,C){switch(E){case"blob":return i.newBlob(i.transformTo("arraybuffer",z),C);case"base64":return c.encode(z);default:return i.transformTo(E,z)}}(k,function(E,z){var C,G=0,H=null,b=0;for(C=0;C<z.length;C++)b+=z[C].length;switch(E){case"string":return z.join("");case"array":return Array.prototype.concat.apply([],z);case"uint8array":for(H=new Uint8Array(b),C=0;C<z.length;C++)H.set(z[C],G),G+=z[C].length;return H;case"nodebuffer":return Buffer.concat(z);default:throw new Error("concat : unsupported type '"+E+"'")}}(v,w),A);m(F)}catch(E){g(E)}w=[]}).resume()})}function h(x,p,m){var g=p;switch(p){case"blob":case"arraybuffer":g="uint8array";break;case"base64":g="string"}try{this._internalType=g,this._outputType=p,this._mimeType=m,i.checkSupport(g),this._worker=x.pipe(new s(g)),x.lock()}catch(w){this._worker=new o("error"),this._worker.error(w)}}h.prototype={accumulate:function(x){return d(this,x)},on:function(x,p){var m=this;return x==="data"?this._worker.on(x,function(g){p.call(m,g.data,g.meta)}):this._worker.on(x,function(){i.delay(p,arguments,m)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(x){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:this._outputType!=="nodebuffer"},x)}},n.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,n,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var i=new ArrayBuffer(0);try{a.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(i),a.blob=s.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!t("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(t,n,a){for(var i=t("./utils"),s=t("./support"),o=t("./nodejsUtils"),c=t("./stream/GenericWorker"),f=new Array(256),l=0;l<256;l++)f[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;f[254]=f[254]=1;function u(){c.call(this,"utf-8 decode"),this.leftOver=null}function d(){c.call(this,"utf-8 encode")}a.utf8encode=function(h){return s.nodebuffer?o.newBufferFrom(h,"utf-8"):function(x){var p,m,g,w,v,k=x.length,A=0;for(w=0;w<k;w++)(64512&(m=x.charCodeAt(w)))==55296&&w+1<k&&(64512&(g=x.charCodeAt(w+1)))==56320&&(m=65536+(m-55296<<10)+(g-56320),w++),A+=m<128?1:m<2048?2:m<65536?3:4;for(p=s.uint8array?new Uint8Array(A):new Array(A),w=v=0;v<A;w++)(64512&(m=x.charCodeAt(w)))==55296&&w+1<k&&(64512&(g=x.charCodeAt(w+1)))==56320&&(m=65536+(m-55296<<10)+(g-56320),w++),m<128?p[v++]=m:(m<2048?p[v++]=192|m>>>6:(m<65536?p[v++]=224|m>>>12:(p[v++]=240|m>>>18,p[v++]=128|m>>>12&63),p[v++]=128|m>>>6&63),p[v++]=128|63&m);return p}(h)},a.utf8decode=function(h){return s.nodebuffer?i.transformTo("nodebuffer",h).toString("utf-8"):function(x){var p,m,g,w,v=x.length,k=new Array(2*v);for(p=m=0;p<v;)if((g=x[p++])<128)k[m++]=g;else if(4<(w=f[g]))k[m++]=65533,p+=w-1;else{for(g&=w===2?31:w===3?15:7;1<w&&p<v;)g=g<<6|63&x[p++],w--;1<w?k[m++]=65533:g<65536?k[m++]=g:(g-=65536,k[m++]=55296|g>>10&1023,k[m++]=56320|1023&g)}return k.length!==m&&(k.subarray?k=k.subarray(0,m):k.length=m),i.applyFromCharCode(k)}(h=i.transformTo(s.uint8array?"uint8array":"array",h))},i.inherits(u,c),u.prototype.processChunk=function(h){var x=i.transformTo(s.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var p=x;(x=new Uint8Array(p.length+this.leftOver.length)).set(this.leftOver,0),x.set(p,this.leftOver.length)}else x=this.leftOver.concat(x);this.leftOver=null}var m=function(w,v){var k;for((v=v||w.length)>w.length&&(v=w.length),k=v-1;0<=k&&(192&w[k])==128;)k--;return k<0||k===0?v:k+f[w[k]]>v?k:v}(x),g=x;m!==x.length&&(s.uint8array?(g=x.subarray(0,m),this.leftOver=x.subarray(m,x.length)):(g=x.slice(0,m),this.leftOver=x.slice(m,x.length))),this.push({data:a.utf8decode(g),meta:h.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=u,i.inherits(d,c),d.prototype.processChunk=function(h){this.push({data:a.utf8encode(h.data),meta:h.meta})},a.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,n,a){var i=t("./support"),s=t("./base64"),o=t("./nodejsUtils"),c=t("./external");function f(p){return p}function l(p,m){for(var g=0;g<p.length;++g)m[g]=255&p.charCodeAt(g);return m}t("setimmediate"),a.newBlob=function(p,m){a.checkSupport("blob");try{return new Blob([p],{type:m})}catch{try{var g=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return g.append(p),g.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(p,m,g){var w=[],v=0,k=p.length;if(k<=g)return String.fromCharCode.apply(null,p);for(;v<k;)m==="array"||m==="nodebuffer"?w.push(String.fromCharCode.apply(null,p.slice(v,Math.min(v+g,k)))):w.push(String.fromCharCode.apply(null,p.subarray(v,Math.min(v+g,k)))),v+=g;return w.join("")},stringifyByChar:function(p){for(var m="",g=0;g<p.length;g++)m+=String.fromCharCode(p[g]);return m},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function d(p){var m=65536,g=a.getTypeOf(p),w=!0;if(g==="uint8array"?w=u.applyCanBeUsed.uint8array:g==="nodebuffer"&&(w=u.applyCanBeUsed.nodebuffer),w)for(;1<m;)try{return u.stringifyByChunk(p,g,m)}catch{m=Math.floor(m/2)}return u.stringifyByChar(p)}function h(p,m){for(var g=0;g<p.length;g++)m[g]=p[g];return m}a.applyFromCharCode=d;var x={};x.string={string:f,array:function(p){return l(p,new Array(p.length))},arraybuffer:function(p){return x.string.uint8array(p).buffer},uint8array:function(p){return l(p,new Uint8Array(p.length))},nodebuffer:function(p){return l(p,o.allocBuffer(p.length))}},x.array={string:d,array:f,arraybuffer:function(p){return new Uint8Array(p).buffer},uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return o.newBufferFrom(p)}},x.arraybuffer={string:function(p){return d(new Uint8Array(p))},array:function(p){return h(new Uint8Array(p),new Array(p.byteLength))},arraybuffer:f,uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return o.newBufferFrom(new Uint8Array(p))}},x.uint8array={string:d,array:function(p){return h(p,new Array(p.length))},arraybuffer:function(p){return p.buffer},uint8array:f,nodebuffer:function(p){return o.newBufferFrom(p)}},x.nodebuffer={string:d,array:function(p){return h(p,new Array(p.length))},arraybuffer:function(p){return x.nodebuffer.uint8array(p).buffer},uint8array:function(p){return h(p,new Uint8Array(p.length))},nodebuffer:f},a.transformTo=function(p,m){if(m=m||"",!p)return m;a.checkSupport(p);var g=a.getTypeOf(m);return x[g][p](m)},a.resolve=function(p){for(var m=p.split("/"),g=[],w=0;w<m.length;w++){var v=m[w];v==="."||v===""&&w!==0&&w!==m.length-1||(v===".."?g.pop():g.push(v))}return g.join("/")},a.getTypeOf=function(p){return typeof p=="string"?"string":Object.prototype.toString.call(p)==="[object Array]"?"array":i.nodebuffer&&o.isBuffer(p)?"nodebuffer":i.uint8array&&p instanceof Uint8Array?"uint8array":i.arraybuffer&&p instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(p){if(!i[p.toLowerCase()])throw new Error(p+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(p){var m,g,w="";for(g=0;g<(p||"").length;g++)w+="\\x"+((m=p.charCodeAt(g))<16?"0":"")+m.toString(16).toUpperCase();return w},a.delay=function(p,m,g){setImmediate(function(){p.apply(g||null,m||[])})},a.inherits=function(p,m){function g(){}g.prototype=m.prototype,p.prototype=new g},a.extend=function(){var p,m,g={};for(p=0;p<arguments.length;p++)for(m in arguments[p])Object.prototype.hasOwnProperty.call(arguments[p],m)&&g[m]===void 0&&(g[m]=arguments[p][m]);return g},a.prepareContent=function(p,m,g,w,v){return c.Promise.resolve(m).then(function(k){return i.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new c.Promise(function(A,F){var E=new FileReader;E.onload=function(z){A(z.target.result)},E.onerror=function(z){F(z.target.error)},E.readAsArrayBuffer(k)}):k}).then(function(k){var A=a.getTypeOf(k);return A?(A==="arraybuffer"?k=a.transformTo("uint8array",k):A==="string"&&(v?k=s.decode(k):g&&w!==!0&&(k=function(F){return l(F,i.uint8array?new Uint8Array(F.length):new Array(F.length))}(k))),k):c.Promise.reject(new Error("Can't read the data of '"+p+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,n,a){var i=t("./reader/readerFor"),s=t("./utils"),o=t("./signature"),c=t("./zipEntry"),f=t("./support");function l(u){this.files=[],this.loadOptions=u}l.prototype={checkSignature:function(u){if(!this.reader.readAndCheckSignature(u)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(d)+", expected "+s.pretty(u)+")")}},isSignature:function(u,d){var h=this.reader.index;this.reader.setIndex(u);var x=this.reader.readString(4)===d;return this.reader.setIndex(h),x},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var u=this.reader.readData(this.zipCommentLength),d=f.uint8array?"uint8array":"array",h=s.transformTo(d,u);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var u,d,h,x=this.zip64EndOfCentralSize-44;0<x;)u=this.reader.readInt(2),d=this.reader.readInt(4),h=this.reader.readData(d),this.zip64ExtensibleData[u]={id:u,length:d,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var u,d;for(u=0;u<this.files.length;u++)d=this.files[u],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var u;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(u=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(u);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var u=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(u<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(u);var d=u;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(u=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(u),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var x=d-h;if(0<x)this.isSignature(d,o.CENTRAL_FILE_HEADER)||(this.reader.zero=x);else if(x<0)throw new Error("Corrupted zip: missing "+Math.abs(x)+" bytes.")},prepareReader:function(u){this.reader=i(u)},load:function(u){this.prepareReader(u),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,n,a){var i=t("./reader/readerFor"),s=t("./utils"),o=t("./compressedObject"),c=t("./crc32"),f=t("./utf8"),l=t("./compressions"),u=t("./support");function d(h,x){this.options=h,this.loadOptions=x}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var x,p;if(h.skip(22),this.fileNameLength=h.readInt(2),p=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(p),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((x=function(m){for(var g in l)if(Object.prototype.hasOwnProperty.call(l,g)&&l[g].magic===m)return l[g];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,x,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var x=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(x),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=i(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var x,p,m,g=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<g;)x=h.readInt(2),p=h.readInt(2),m=h.readData(p),this.extraFields[x]={id:x,length:p,value:m};h.setIndex(g)},handleUTF8:function(){var h=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var x=this.findExtraFieldUnicodePath();if(x!==null)this.fileNameStr=x;else{var p=s.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(p)}var m=this.findExtraFieldUnicodeComment();if(m!==null)this.fileCommentStr=m;else{var g=s.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(g)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var x=i(h.value);return x.readInt(1)!==1||c(this.fileName)!==x.readInt(4)?null:f.utf8decode(x.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var x=i(h.value);return x.readInt(1)!==1||c(this.fileComment)!==x.readInt(4)?null:f.utf8decode(x.readData(h.length-5))}return null}},n.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,n,a){function i(x,p,m){this.name=x,this.dir=m.dir,this.date=m.date,this.comment=m.comment,this.unixPermissions=m.unixPermissions,this.dosPermissions=m.dosPermissions,this._data=p,this._dataBinary=m.binary,this.options={compression:m.compression,compressionOptions:m.compressionOptions}}var s=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),c=t("./utf8"),f=t("./compressedObject"),l=t("./stream/GenericWorker");i.prototype={internalStream:function(x){var p=null,m="string";try{if(!x)throw new Error("No output type specified.");var g=(m=x.toLowerCase())==="string"||m==="text";m!=="binarystring"&&m!=="text"||(m="string"),p=this._decompressWorker();var w=!this._dataBinary;w&&!g&&(p=p.pipe(new c.Utf8EncodeWorker)),!w&&g&&(p=p.pipe(new c.Utf8DecodeWorker))}catch(v){(p=new l("error")).error(v)}return new s(p,m,"")},async:function(x,p){return this.internalStream(x).accumulate(p)},nodeStream:function(x,p){return this.internalStream(x||"nodebuffer").toNodejsStream(p)},_compressWorker:function(x,p){if(this._data instanceof f&&this._data.compression.magic===x.magic)return this._data.getCompressedWorker();var m=this._decompressWorker();return this._dataBinary||(m=m.pipe(new c.Utf8EncodeWorker)),f.createWorkerFrom(m,x,p)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof l?this._data:new o(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<u.length;h++)i.prototype[u[h]]=d;n.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,n,a){(function(i){var s,o,c=i.MutationObserver||i.WebKitMutationObserver;if(c){var f=0,l=new c(x),u=i.document.createTextNode("");l.observe(u,{characterData:!0}),s=function(){u.data=f=++f%2}}else if(i.setImmediate||i.MessageChannel===void 0)s="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var p=i.document.createElement("script");p.onreadystatechange=function(){x(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},i.document.documentElement.appendChild(p)}:function(){setTimeout(x,0)};else{var d=new i.MessageChannel;d.port1.onmessage=x,s=function(){d.port2.postMessage(0)}}var h=[];function x(){var p,m;o=!0;for(var g=h.length;g;){for(m=h,h=[],p=-1;++p<g;)m[p]();g=h.length}o=!1}n.exports=function(p){h.push(p)!==1||o||s()}}).call(this,typeof ki<"u"?ki:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,n,a){var i=t("immediate");function s(){}var o={},c=["REJECTED"],f=["FULFILLED"],l=["PENDING"];function u(g){if(typeof g!="function")throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,g!==s&&p(this,g)}function d(g,w,v){this.promise=g,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof v=="function"&&(this.onRejected=v,this.callRejected=this.otherCallRejected)}function h(g,w,v){i(function(){var k;try{k=w(v)}catch(A){return o.reject(g,A)}k===g?o.reject(g,new TypeError("Cannot resolve promise with itself")):o.resolve(g,k)})}function x(g){var w=g&&g.then;if(g&&(typeof g=="object"||typeof g=="function")&&typeof w=="function")return function(){w.apply(g,arguments)}}function p(g,w){var v=!1;function k(E){v||(v=!0,o.reject(g,E))}function A(E){v||(v=!0,o.resolve(g,E))}var F=m(function(){w(A,k)});F.status==="error"&&k(F.value)}function m(g,w){var v={};try{v.value=g(w),v.status="success"}catch(k){v.status="error",v.value=k}return v}(n.exports=u).prototype.finally=function(g){if(typeof g!="function")return this;var w=this.constructor;return this.then(function(v){return w.resolve(g()).then(function(){return v})},function(v){return w.resolve(g()).then(function(){throw v})})},u.prototype.catch=function(g){return this.then(null,g)},u.prototype.then=function(g,w){if(typeof g!="function"&&this.state===f||typeof w!="function"&&this.state===c)return this;var v=new this.constructor(s);return this.state!==l?h(v,this.state===f?g:w,this.outcome):this.queue.push(new d(v,g,w)),v},d.prototype.callFulfilled=function(g){o.resolve(this.promise,g)},d.prototype.otherCallFulfilled=function(g){h(this.promise,this.onFulfilled,g)},d.prototype.callRejected=function(g){o.reject(this.promise,g)},d.prototype.otherCallRejected=function(g){h(this.promise,this.onRejected,g)},o.resolve=function(g,w){var v=m(x,w);if(v.status==="error")return o.reject(g,v.value);var k=v.value;if(k)p(g,k);else{g.state=f,g.outcome=w;for(var A=-1,F=g.queue.length;++A<F;)g.queue[A].callFulfilled(w)}return g},o.reject=function(g,w){g.state=c,g.outcome=w;for(var v=-1,k=g.queue.length;++v<k;)g.queue[v].callRejected(w);return g},u.resolve=function(g){return g instanceof this?g:o.resolve(new this(s),g)},u.reject=function(g){var w=new this(s);return o.reject(w,g)},u.all=function(g){var w=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=g.length,k=!1;if(!v)return this.resolve([]);for(var A=new Array(v),F=0,E=-1,z=new this(s);++E<v;)C(g[E],E);return z;function C(G,H){w.resolve(G).then(function(b){A[H]=b,++F!==v||k||(k=!0,o.resolve(z,A))},function(b){k||(k=!0,o.reject(z,b))})}},u.race=function(g){var w=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=g.length,k=!1;if(!v)return this.resolve([]);for(var A=-1,F=new this(s);++A<v;)E=g[A],w.resolve(E).then(function(z){k||(k=!0,o.resolve(F,z))},function(z){k||(k=!0,o.reject(F,z))});var E;return F}},{immediate:36}],38:[function(t,n,a){var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),n.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,n,a){var i=t("./zlib/deflate"),s=t("./utils/common"),o=t("./utils/strings"),c=t("./zlib/messages"),f=t("./zlib/zstream"),l=Object.prototype.toString,u=0,d=-1,h=0,x=8;function p(g){if(!(this instanceof p))return new p(g);this.options=s.assign({level:d,method:x,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},g||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var v=i.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(v!==u)throw new Error(c[v]);if(w.header&&i.deflateSetHeader(this.strm,w.header),w.dictionary){var k;if(k=typeof w.dictionary=="string"?o.string2buf(w.dictionary):l.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(v=i.deflateSetDictionary(this.strm,k))!==u)throw new Error(c[v]);this._dict_set=!0}}function m(g,w){var v=new p(w);if(v.push(g,!0),v.err)throw v.msg||c[v.err];return v.result}p.prototype.push=function(g,w){var v,k,A=this.strm,F=this.options.chunkSize;if(this.ended)return!1;k=w===~~w?w:w===!0?4:0,typeof g=="string"?A.input=o.string2buf(g):l.call(g)==="[object ArrayBuffer]"?A.input=new Uint8Array(g):A.input=g,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new s.Buf8(F),A.next_out=0,A.avail_out=F),(v=i.deflate(A,k))!==1&&v!==u)return this.onEnd(v),!(this.ended=!0);A.avail_out!==0&&(A.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(s.shrinkBuf(A.output,A.next_out))):this.onData(s.shrinkBuf(A.output,A.next_out)))}while((0<A.avail_in||A.avail_out===0)&&v!==1);return k===4?(v=i.deflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===u):k!==2||(this.onEnd(u),!(A.avail_out=0))},p.prototype.onData=function(g){this.chunks.push(g)},p.prototype.onEnd=function(g){g===u&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},a.Deflate=p,a.deflate=m,a.deflateRaw=function(g,w){return(w=w||{}).raw=!0,m(g,w)},a.gzip=function(g,w){return(w=w||{}).gzip=!0,m(g,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,n,a){var i=t("./zlib/inflate"),s=t("./utils/common"),o=t("./utils/strings"),c=t("./zlib/constants"),f=t("./zlib/messages"),l=t("./zlib/zstream"),u=t("./zlib/gzheader"),d=Object.prototype.toString;function h(p){if(!(this instanceof h))return new h(p);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},p||{});var m=this.options;m.raw&&0<=m.windowBits&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),!(0<=m.windowBits&&m.windowBits<16)||p&&p.windowBits||(m.windowBits+=32),15<m.windowBits&&m.windowBits<48&&(15&m.windowBits)==0&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var g=i.inflateInit2(this.strm,m.windowBits);if(g!==c.Z_OK)throw new Error(f[g]);this.header=new u,i.inflateGetHeader(this.strm,this.header)}function x(p,m){var g=new h(m);if(g.push(p,!0),g.err)throw g.msg||f[g.err];return g.result}h.prototype.push=function(p,m){var g,w,v,k,A,F,E=this.strm,z=this.options.chunkSize,C=this.options.dictionary,G=!1;if(this.ended)return!1;w=m===~~m?m:m===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof p=="string"?E.input=o.binstring2buf(p):d.call(p)==="[object ArrayBuffer]"?E.input=new Uint8Array(p):E.input=p,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new s.Buf8(z),E.next_out=0,E.avail_out=z),(g=i.inflate(E,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&C&&(F=typeof C=="string"?o.string2buf(C):d.call(C)==="[object ArrayBuffer]"?new Uint8Array(C):C,g=i.inflateSetDictionary(this.strm,F)),g===c.Z_BUF_ERROR&&G===!0&&(g=c.Z_OK,G=!1),g!==c.Z_STREAM_END&&g!==c.Z_OK)return this.onEnd(g),!(this.ended=!0);E.next_out&&(E.avail_out!==0&&g!==c.Z_STREAM_END&&(E.avail_in!==0||w!==c.Z_FINISH&&w!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(v=o.utf8border(E.output,E.next_out),k=E.next_out-v,A=o.buf2string(E.output,v),E.next_out=k,E.avail_out=z-k,k&&s.arraySet(E.output,E.output,v,k,0),this.onData(A)):this.onData(s.shrinkBuf(E.output,E.next_out)))),E.avail_in===0&&E.avail_out===0&&(G=!0)}while((0<E.avail_in||E.avail_out===0)&&g!==c.Z_STREAM_END);return g===c.Z_STREAM_END&&(w=c.Z_FINISH),w===c.Z_FINISH?(g=i.inflateEnd(this.strm),this.onEnd(g),this.ended=!0,g===c.Z_OK):w!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(E.avail_out=0))},h.prototype.onData=function(p){this.chunks.push(p)},h.prototype.onEnd=function(p){p===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},a.Inflate=h,a.inflate=x,a.inflateRaw=function(p,m){return(m=m||{}).raw=!0,x(p,m)},a.ungzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(c){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var l=f.shift();if(l){if(typeof l!="object")throw new TypeError(l+"must be non-object");for(var u in l)l.hasOwnProperty(u)&&(c[u]=l[u])}}return c},a.shrinkBuf=function(c,f){return c.length===f?c:c.subarray?c.subarray(0,f):(c.length=f,c)};var s={arraySet:function(c,f,l,u,d){if(f.subarray&&c.subarray)c.set(f.subarray(l,l+u),d);else for(var h=0;h<u;h++)c[d+h]=f[l+h]},flattenChunks:function(c){var f,l,u,d,h,x;for(f=u=0,l=c.length;f<l;f++)u+=c[f].length;for(x=new Uint8Array(u),f=d=0,l=c.length;f<l;f++)h=c[f],x.set(h,d),d+=h.length;return x}},o={arraySet:function(c,f,l,u,d){for(var h=0;h<u;h++)c[d+h]=f[l+h]},flattenChunks:function(c){return[].concat.apply([],c)}};a.setTyped=function(c){c?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,s)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,o))},a.setTyped(i)},{}],42:[function(t,n,a){var i=t("./common"),s=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var c=new i.Buf8(256),f=0;f<256;f++)c[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function l(u,d){if(d<65537&&(u.subarray&&o||!u.subarray&&s))return String.fromCharCode.apply(null,i.shrinkBuf(u,d));for(var h="",x=0;x<d;x++)h+=String.fromCharCode(u[x]);return h}c[254]=c[254]=1,a.string2buf=function(u){var d,h,x,p,m,g=u.length,w=0;for(p=0;p<g;p++)(64512&(h=u.charCodeAt(p)))==55296&&p+1<g&&(64512&(x=u.charCodeAt(p+1)))==56320&&(h=65536+(h-55296<<10)+(x-56320),p++),w+=h<128?1:h<2048?2:h<65536?3:4;for(d=new i.Buf8(w),p=m=0;m<w;p++)(64512&(h=u.charCodeAt(p)))==55296&&p+1<g&&(64512&(x=u.charCodeAt(p+1)))==56320&&(h=65536+(h-55296<<10)+(x-56320),p++),h<128?d[m++]=h:(h<2048?d[m++]=192|h>>>6:(h<65536?d[m++]=224|h>>>12:(d[m++]=240|h>>>18,d[m++]=128|h>>>12&63),d[m++]=128|h>>>6&63),d[m++]=128|63&h);return d},a.buf2binstring=function(u){return l(u,u.length)},a.binstring2buf=function(u){for(var d=new i.Buf8(u.length),h=0,x=d.length;h<x;h++)d[h]=u.charCodeAt(h);return d},a.buf2string=function(u,d){var h,x,p,m,g=d||u.length,w=new Array(2*g);for(h=x=0;h<g;)if((p=u[h++])<128)w[x++]=p;else if(4<(m=c[p]))w[x++]=65533,h+=m-1;else{for(p&=m===2?31:m===3?15:7;1<m&&h<g;)p=p<<6|63&u[h++],m--;1<m?w[x++]=65533:p<65536?w[x++]=p:(p-=65536,w[x++]=55296|p>>10&1023,w[x++]=56320|1023&p)}return l(w,x)},a.utf8border=function(u,d){var h;for((d=d||u.length)>u.length&&(d=u.length),h=d-1;0<=h&&(192&u[h])==128;)h--;return h<0||h===0?d:h+c[u[h]]>d?h:d}},{"./common":41}],43:[function(t,n,a){n.exports=function(i,s,o,c){for(var f=65535&i|0,l=i>>>16&65535|0,u=0;o!==0;){for(o-=u=2e3<o?2e3:o;l=l+(f=f+s[c++]|0)|0,--u;);f%=65521,l%=65521}return f|l<<16|0}},{}],44:[function(t,n,a){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,n,a){var i=function(){for(var s,o=[],c=0;c<256;c++){s=c;for(var f=0;f<8;f++)s=1&s?3988292384^s>>>1:s>>>1;o[c]=s}return o}();n.exports=function(s,o,c,f){var l=i,u=f+c;s^=-1;for(var d=f;d<u;d++)s=s>>>8^l[255&(s^o[d])];return-1^s}},{}],46:[function(t,n,a){var i,s=t("../utils/common"),o=t("./trees"),c=t("./adler32"),f=t("./crc32"),l=t("./messages"),u=0,d=4,h=0,x=-2,p=-1,m=4,g=2,w=8,v=9,k=286,A=30,F=19,E=2*k+1,z=15,C=3,G=258,H=G+C+1,b=42,X=113,_=1,W=2,q=3,j=4;function ue(y,ae){return y.msg=l[ae],ae}function P(y){return(y<<1)-(4<y?9:0)}function se(y){for(var ae=y.length;0<=--ae;)y[ae]=0}function Y(y){var ae=y.state,J=ae.pending;J>y.avail_out&&(J=y.avail_out),J!==0&&(s.arraySet(y.output,ae.pending_buf,ae.pending_out,J,y.next_out),y.next_out+=J,ae.pending_out+=J,y.total_out+=J,y.avail_out-=J,ae.pending-=J,ae.pending===0&&(ae.pending_out=0))}function T(y,ae){o._tr_flush_block(y,0<=y.block_start?y.block_start:-1,y.strstart-y.block_start,ae),y.block_start=y.strstart,Y(y.strm)}function K(y,ae){y.pending_buf[y.pending++]=ae}function B(y,ae){y.pending_buf[y.pending++]=ae>>>8&255,y.pending_buf[y.pending++]=255&ae}function N(y,ae){var J,R,O=y.max_chain_length,Z=y.strstart,ce=y.prev_length,de=y.nice_match,Q=y.strstart>y.w_size-H?y.strstart-(y.w_size-H):0,xe=y.window,ve=y.w_mask,me=y.prev,Ee=y.strstart+G,$e=xe[Z+ce-1],Ae=xe[Z+ce];y.prev_length>=y.good_match&&(O>>=2),de>y.lookahead&&(de=y.lookahead);do if(xe[(J=ae)+ce]===Ae&&xe[J+ce-1]===$e&&xe[J]===xe[Z]&&xe[++J]===xe[Z+1]){Z+=2,J++;do;while(xe[++Z]===xe[++J]&&xe[++Z]===xe[++J]&&xe[++Z]===xe[++J]&&xe[++Z]===xe[++J]&&xe[++Z]===xe[++J]&&xe[++Z]===xe[++J]&&xe[++Z]===xe[++J]&&xe[++Z]===xe[++J]&&Z<Ee);if(R=G-(Ee-Z),Z=Ee-G,ce<R){if(y.match_start=ae,de<=(ce=R))break;$e=xe[Z+ce-1],Ae=xe[Z+ce]}}while((ae=me[ae&ve])>Q&&--O!=0);return ce<=y.lookahead?ce:y.lookahead}function ie(y){var ae,J,R,O,Z,ce,de,Q,xe,ve,me=y.w_size;do{if(O=y.window_size-y.lookahead-y.strstart,y.strstart>=me+(me-H)){for(s.arraySet(y.window,y.window,me,me,0),y.match_start-=me,y.strstart-=me,y.block_start-=me,ae=J=y.hash_size;R=y.head[--ae],y.head[ae]=me<=R?R-me:0,--J;);for(ae=J=me;R=y.prev[--ae],y.prev[ae]=me<=R?R-me:0,--J;);O+=me}if(y.strm.avail_in===0)break;if(ce=y.strm,de=y.window,Q=y.strstart+y.lookahead,xe=O,ve=void 0,ve=ce.avail_in,xe<ve&&(ve=xe),J=ve===0?0:(ce.avail_in-=ve,s.arraySet(de,ce.input,ce.next_in,ve,Q),ce.state.wrap===1?ce.adler=c(ce.adler,de,ve,Q):ce.state.wrap===2&&(ce.adler=f(ce.adler,de,ve,Q)),ce.next_in+=ve,ce.total_in+=ve,ve),y.lookahead+=J,y.lookahead+y.insert>=C)for(Z=y.strstart-y.insert,y.ins_h=y.window[Z],y.ins_h=(y.ins_h<<y.hash_shift^y.window[Z+1])&y.hash_mask;y.insert&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[Z+C-1])&y.hash_mask,y.prev[Z&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=Z,Z++,y.insert--,!(y.lookahead+y.insert<C)););}while(y.lookahead<H&&y.strm.avail_in!==0)}function pe(y,ae){for(var J,R;;){if(y.lookahead<H){if(ie(y),y.lookahead<H&&ae===u)return _;if(y.lookahead===0)break}if(J=0,y.lookahead>=C&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+C-1])&y.hash_mask,J=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),J!==0&&y.strstart-J<=y.w_size-H&&(y.match_length=N(y,J)),y.match_length>=C)if(R=o._tr_tally(y,y.strstart-y.match_start,y.match_length-C),y.lookahead-=y.match_length,y.match_length<=y.max_lazy_match&&y.lookahead>=C){for(y.match_length--;y.strstart++,y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+C-1])&y.hash_mask,J=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart,--y.match_length!=0;);y.strstart++}else y.strstart+=y.match_length,y.match_length=0,y.ins_h=y.window[y.strstart],y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+1])&y.hash_mask;else R=o._tr_tally(y,0,y.window[y.strstart]),y.lookahead--,y.strstart++;if(R&&(T(y,!1),y.strm.avail_out===0))return _}return y.insert=y.strstart<C-1?y.strstart:C-1,ae===d?(T(y,!0),y.strm.avail_out===0?q:j):y.last_lit&&(T(y,!1),y.strm.avail_out===0)?_:W}function le(y,ae){for(var J,R,O;;){if(y.lookahead<H){if(ie(y),y.lookahead<H&&ae===u)return _;if(y.lookahead===0)break}if(J=0,y.lookahead>=C&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+C-1])&y.hash_mask,J=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),y.prev_length=y.match_length,y.prev_match=y.match_start,y.match_length=C-1,J!==0&&y.prev_length<y.max_lazy_match&&y.strstart-J<=y.w_size-H&&(y.match_length=N(y,J),y.match_length<=5&&(y.strategy===1||y.match_length===C&&4096<y.strstart-y.match_start)&&(y.match_length=C-1)),y.prev_length>=C&&y.match_length<=y.prev_length){for(O=y.strstart+y.lookahead-C,R=o._tr_tally(y,y.strstart-1-y.prev_match,y.prev_length-C),y.lookahead-=y.prev_length-1,y.prev_length-=2;++y.strstart<=O&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+C-1])&y.hash_mask,J=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),--y.prev_length!=0;);if(y.match_available=0,y.match_length=C-1,y.strstart++,R&&(T(y,!1),y.strm.avail_out===0))return _}else if(y.match_available){if((R=o._tr_tally(y,0,y.window[y.strstart-1]))&&T(y,!1),y.strstart++,y.lookahead--,y.strm.avail_out===0)return _}else y.match_available=1,y.strstart++,y.lookahead--}return y.match_available&&(R=o._tr_tally(y,0,y.window[y.strstart-1]),y.match_available=0),y.insert=y.strstart<C-1?y.strstart:C-1,ae===d?(T(y,!0),y.strm.avail_out===0?q:j):y.last_lit&&(T(y,!1),y.strm.avail_out===0)?_:W}function fe(y,ae,J,R,O){this.good_length=y,this.max_lazy=ae,this.nice_length=J,this.max_chain=R,this.func=O}function he(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*E),this.dyn_dtree=new s.Buf16(2*(2*A+1)),this.bl_tree=new s.Buf16(2*(2*F+1)),se(this.dyn_ltree),se(this.dyn_dtree),se(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(z+1),this.heap=new s.Buf16(2*k+1),se(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*k+1),se(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function be(y){var ae;return y&&y.state?(y.total_in=y.total_out=0,y.data_type=g,(ae=y.state).pending=0,ae.pending_out=0,ae.wrap<0&&(ae.wrap=-ae.wrap),ae.status=ae.wrap?b:X,y.adler=ae.wrap===2?0:1,ae.last_flush=u,o._tr_init(ae),h):ue(y,x)}function V(y){var ae=be(y);return ae===h&&function(J){J.window_size=2*J.w_size,se(J.head),J.max_lazy_match=i[J.level].max_lazy,J.good_match=i[J.level].good_length,J.nice_match=i[J.level].nice_length,J.max_chain_length=i[J.level].max_chain,J.strstart=0,J.block_start=0,J.lookahead=0,J.insert=0,J.match_length=J.prev_length=C-1,J.match_available=0,J.ins_h=0}(y.state),ae}function Ue(y,ae,J,R,O,Z){if(!y)return x;var ce=1;if(ae===p&&(ae=6),R<0?(ce=0,R=-R):15<R&&(ce=2,R-=16),O<1||v<O||J!==w||R<8||15<R||ae<0||9<ae||Z<0||m<Z)return ue(y,x);R===8&&(R=9);var de=new he;return(y.state=de).strm=y,de.wrap=ce,de.gzhead=null,de.w_bits=R,de.w_size=1<<de.w_bits,de.w_mask=de.w_size-1,de.hash_bits=O+7,de.hash_size=1<<de.hash_bits,de.hash_mask=de.hash_size-1,de.hash_shift=~~((de.hash_bits+C-1)/C),de.window=new s.Buf8(2*de.w_size),de.head=new s.Buf16(de.hash_size),de.prev=new s.Buf16(de.w_size),de.lit_bufsize=1<<O+6,de.pending_buf_size=4*de.lit_bufsize,de.pending_buf=new s.Buf8(de.pending_buf_size),de.d_buf=1*de.lit_bufsize,de.l_buf=3*de.lit_bufsize,de.level=ae,de.strategy=Z,de.method=J,V(y)}i=[new fe(0,0,0,0,function(y,ae){var J=65535;for(J>y.pending_buf_size-5&&(J=y.pending_buf_size-5);;){if(y.lookahead<=1){if(ie(y),y.lookahead===0&&ae===u)return _;if(y.lookahead===0)break}y.strstart+=y.lookahead,y.lookahead=0;var R=y.block_start+J;if((y.strstart===0||y.strstart>=R)&&(y.lookahead=y.strstart-R,y.strstart=R,T(y,!1),y.strm.avail_out===0)||y.strstart-y.block_start>=y.w_size-H&&(T(y,!1),y.strm.avail_out===0))return _}return y.insert=0,ae===d?(T(y,!0),y.strm.avail_out===0?q:j):(y.strstart>y.block_start&&(T(y,!1),y.strm.avail_out),_)}),new fe(4,4,8,4,pe),new fe(4,5,16,8,pe),new fe(4,6,32,32,pe),new fe(4,4,16,16,le),new fe(8,16,32,32,le),new fe(8,16,128,128,le),new fe(8,32,128,256,le),new fe(32,128,258,1024,le),new fe(32,258,258,4096,le)],a.deflateInit=function(y,ae){return Ue(y,ae,w,15,8,0)},a.deflateInit2=Ue,a.deflateReset=V,a.deflateResetKeep=be,a.deflateSetHeader=function(y,ae){return y&&y.state?y.state.wrap!==2?x:(y.state.gzhead=ae,h):x},a.deflate=function(y,ae){var J,R,O,Z;if(!y||!y.state||5<ae||ae<0)return y?ue(y,x):x;if(R=y.state,!y.output||!y.input&&y.avail_in!==0||R.status===666&&ae!==d)return ue(y,y.avail_out===0?-5:x);if(R.strm=y,J=R.last_flush,R.last_flush=ae,R.status===b)if(R.wrap===2)y.adler=0,K(R,31),K(R,139),K(R,8),R.gzhead?(K(R,(R.gzhead.text?1:0)+(R.gzhead.hcrc?2:0)+(R.gzhead.extra?4:0)+(R.gzhead.name?8:0)+(R.gzhead.comment?16:0)),K(R,255&R.gzhead.time),K(R,R.gzhead.time>>8&255),K(R,R.gzhead.time>>16&255),K(R,R.gzhead.time>>24&255),K(R,R.level===9?2:2<=R.strategy||R.level<2?4:0),K(R,255&R.gzhead.os),R.gzhead.extra&&R.gzhead.extra.length&&(K(R,255&R.gzhead.extra.length),K(R,R.gzhead.extra.length>>8&255)),R.gzhead.hcrc&&(y.adler=f(y.adler,R.pending_buf,R.pending,0)),R.gzindex=0,R.status=69):(K(R,0),K(R,0),K(R,0),K(R,0),K(R,0),K(R,R.level===9?2:2<=R.strategy||R.level<2?4:0),K(R,3),R.status=X);else{var ce=w+(R.w_bits-8<<4)<<8;ce|=(2<=R.strategy||R.level<2?0:R.level<6?1:R.level===6?2:3)<<6,R.strstart!==0&&(ce|=32),ce+=31-ce%31,R.status=X,B(R,ce),R.strstart!==0&&(B(R,y.adler>>>16),B(R,65535&y.adler)),y.adler=1}if(R.status===69)if(R.gzhead.extra){for(O=R.pending;R.gzindex<(65535&R.gzhead.extra.length)&&(R.pending!==R.pending_buf_size||(R.gzhead.hcrc&&R.pending>O&&(y.adler=f(y.adler,R.pending_buf,R.pending-O,O)),Y(y),O=R.pending,R.pending!==R.pending_buf_size));)K(R,255&R.gzhead.extra[R.gzindex]),R.gzindex++;R.gzhead.hcrc&&R.pending>O&&(y.adler=f(y.adler,R.pending_buf,R.pending-O,O)),R.gzindex===R.gzhead.extra.length&&(R.gzindex=0,R.status=73)}else R.status=73;if(R.status===73)if(R.gzhead.name){O=R.pending;do{if(R.pending===R.pending_buf_size&&(R.gzhead.hcrc&&R.pending>O&&(y.adler=f(y.adler,R.pending_buf,R.pending-O,O)),Y(y),O=R.pending,R.pending===R.pending_buf_size)){Z=1;break}Z=R.gzindex<R.gzhead.name.length?255&R.gzhead.name.charCodeAt(R.gzindex++):0,K(R,Z)}while(Z!==0);R.gzhead.hcrc&&R.pending>O&&(y.adler=f(y.adler,R.pending_buf,R.pending-O,O)),Z===0&&(R.gzindex=0,R.status=91)}else R.status=91;if(R.status===91)if(R.gzhead.comment){O=R.pending;do{if(R.pending===R.pending_buf_size&&(R.gzhead.hcrc&&R.pending>O&&(y.adler=f(y.adler,R.pending_buf,R.pending-O,O)),Y(y),O=R.pending,R.pending===R.pending_buf_size)){Z=1;break}Z=R.gzindex<R.gzhead.comment.length?255&R.gzhead.comment.charCodeAt(R.gzindex++):0,K(R,Z)}while(Z!==0);R.gzhead.hcrc&&R.pending>O&&(y.adler=f(y.adler,R.pending_buf,R.pending-O,O)),Z===0&&(R.status=103)}else R.status=103;if(R.status===103&&(R.gzhead.hcrc?(R.pending+2>R.pending_buf_size&&Y(y),R.pending+2<=R.pending_buf_size&&(K(R,255&y.adler),K(R,y.adler>>8&255),y.adler=0,R.status=X)):R.status=X),R.pending!==0){if(Y(y),y.avail_out===0)return R.last_flush=-1,h}else if(y.avail_in===0&&P(ae)<=P(J)&&ae!==d)return ue(y,-5);if(R.status===666&&y.avail_in!==0)return ue(y,-5);if(y.avail_in!==0||R.lookahead!==0||ae!==u&&R.status!==666){var de=R.strategy===2?function(Q,xe){for(var ve;;){if(Q.lookahead===0&&(ie(Q),Q.lookahead===0)){if(xe===u)return _;break}if(Q.match_length=0,ve=o._tr_tally(Q,0,Q.window[Q.strstart]),Q.lookahead--,Q.strstart++,ve&&(T(Q,!1),Q.strm.avail_out===0))return _}return Q.insert=0,xe===d?(T(Q,!0),Q.strm.avail_out===0?q:j):Q.last_lit&&(T(Q,!1),Q.strm.avail_out===0)?_:W}(R,ae):R.strategy===3?function(Q,xe){for(var ve,me,Ee,$e,Ae=Q.window;;){if(Q.lookahead<=G){if(ie(Q),Q.lookahead<=G&&xe===u)return _;if(Q.lookahead===0)break}if(Q.match_length=0,Q.lookahead>=C&&0<Q.strstart&&(me=Ae[Ee=Q.strstart-1])===Ae[++Ee]&&me===Ae[++Ee]&&me===Ae[++Ee]){$e=Q.strstart+G;do;while(me===Ae[++Ee]&&me===Ae[++Ee]&&me===Ae[++Ee]&&me===Ae[++Ee]&&me===Ae[++Ee]&&me===Ae[++Ee]&&me===Ae[++Ee]&&me===Ae[++Ee]&&Ee<$e);Q.match_length=G-($e-Ee),Q.match_length>Q.lookahead&&(Q.match_length=Q.lookahead)}if(Q.match_length>=C?(ve=o._tr_tally(Q,1,Q.match_length-C),Q.lookahead-=Q.match_length,Q.strstart+=Q.match_length,Q.match_length=0):(ve=o._tr_tally(Q,0,Q.window[Q.strstart]),Q.lookahead--,Q.strstart++),ve&&(T(Q,!1),Q.strm.avail_out===0))return _}return Q.insert=0,xe===d?(T(Q,!0),Q.strm.avail_out===0?q:j):Q.last_lit&&(T(Q,!1),Q.strm.avail_out===0)?_:W}(R,ae):i[R.level].func(R,ae);if(de!==q&&de!==j||(R.status=666),de===_||de===q)return y.avail_out===0&&(R.last_flush=-1),h;if(de===W&&(ae===1?o._tr_align(R):ae!==5&&(o._tr_stored_block(R,0,0,!1),ae===3&&(se(R.head),R.lookahead===0&&(R.strstart=0,R.block_start=0,R.insert=0))),Y(y),y.avail_out===0))return R.last_flush=-1,h}return ae!==d?h:R.wrap<=0?1:(R.wrap===2?(K(R,255&y.adler),K(R,y.adler>>8&255),K(R,y.adler>>16&255),K(R,y.adler>>24&255),K(R,255&y.total_in),K(R,y.total_in>>8&255),K(R,y.total_in>>16&255),K(R,y.total_in>>24&255)):(B(R,y.adler>>>16),B(R,65535&y.adler)),Y(y),0<R.wrap&&(R.wrap=-R.wrap),R.pending!==0?h:1)},a.deflateEnd=function(y){var ae;return y&&y.state?(ae=y.state.status)!==b&&ae!==69&&ae!==73&&ae!==91&&ae!==103&&ae!==X&&ae!==666?ue(y,x):(y.state=null,ae===X?ue(y,-3):h):x},a.deflateSetDictionary=function(y,ae){var J,R,O,Z,ce,de,Q,xe,ve=ae.length;if(!y||!y.state||(Z=(J=y.state).wrap)===2||Z===1&&J.status!==b||J.lookahead)return x;for(Z===1&&(y.adler=c(y.adler,ae,ve,0)),J.wrap=0,ve>=J.w_size&&(Z===0&&(se(J.head),J.strstart=0,J.block_start=0,J.insert=0),xe=new s.Buf8(J.w_size),s.arraySet(xe,ae,ve-J.w_size,J.w_size,0),ae=xe,ve=J.w_size),ce=y.avail_in,de=y.next_in,Q=y.input,y.avail_in=ve,y.next_in=0,y.input=ae,ie(J);J.lookahead>=C;){for(R=J.strstart,O=J.lookahead-(C-1);J.ins_h=(J.ins_h<<J.hash_shift^J.window[R+C-1])&J.hash_mask,J.prev[R&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=R,R++,--O;);J.strstart=R,J.lookahead=C-1,ie(J)}return J.strstart+=J.lookahead,J.block_start=J.strstart,J.insert=J.lookahead,J.lookahead=0,J.match_length=J.prev_length=C-1,J.match_available=0,y.next_in=de,y.input=Q,y.avail_in=ce,J.wrap=Z,h},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,n,a){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,n,a){n.exports=function(i,s){var o,c,f,l,u,d,h,x,p,m,g,w,v,k,A,F,E,z,C,G,H,b,X,_,W;o=i.state,c=i.next_in,_=i.input,f=c+(i.avail_in-5),l=i.next_out,W=i.output,u=l-(s-i.avail_out),d=l+(i.avail_out-257),h=o.dmax,x=o.wsize,p=o.whave,m=o.wnext,g=o.window,w=o.hold,v=o.bits,k=o.lencode,A=o.distcode,F=(1<<o.lenbits)-1,E=(1<<o.distbits)-1;e:do{v<15&&(w+=_[c++]<<v,v+=8,w+=_[c++]<<v,v+=8),z=k[w&F];t:for(;;){if(w>>>=C=z>>>24,v-=C,(C=z>>>16&255)===0)W[l++]=65535&z;else{if(!(16&C)){if((64&C)==0){z=k[(65535&z)+(w&(1<<C)-1)];continue t}if(32&C){o.mode=12;break e}i.msg="invalid literal/length code",o.mode=30;break e}G=65535&z,(C&=15)&&(v<C&&(w+=_[c++]<<v,v+=8),G+=w&(1<<C)-1,w>>>=C,v-=C),v<15&&(w+=_[c++]<<v,v+=8,w+=_[c++]<<v,v+=8),z=A[w&E];r:for(;;){if(w>>>=C=z>>>24,v-=C,!(16&(C=z>>>16&255))){if((64&C)==0){z=A[(65535&z)+(w&(1<<C)-1)];continue r}i.msg="invalid distance code",o.mode=30;break e}if(H=65535&z,v<(C&=15)&&(w+=_[c++]<<v,(v+=8)<C&&(w+=_[c++]<<v,v+=8)),h<(H+=w&(1<<C)-1)){i.msg="invalid distance too far back",o.mode=30;break e}if(w>>>=C,v-=C,(C=l-u)<H){if(p<(C=H-C)&&o.sane){i.msg="invalid distance too far back",o.mode=30;break e}if(X=g,(b=0)===m){if(b+=x-C,C<G){for(G-=C;W[l++]=g[b++],--C;);b=l-H,X=W}}else if(m<C){if(b+=x+m-C,(C-=m)<G){for(G-=C;W[l++]=g[b++],--C;);if(b=0,m<G){for(G-=C=m;W[l++]=g[b++],--C;);b=l-H,X=W}}}else if(b+=m-C,C<G){for(G-=C;W[l++]=g[b++],--C;);b=l-H,X=W}for(;2<G;)W[l++]=X[b++],W[l++]=X[b++],W[l++]=X[b++],G-=3;G&&(W[l++]=X[b++],1<G&&(W[l++]=X[b++]))}else{for(b=l-H;W[l++]=W[b++],W[l++]=W[b++],W[l++]=W[b++],2<(G-=3););G&&(W[l++]=W[b++],1<G&&(W[l++]=W[b++]))}break}}break}}while(c<f&&l<d);c-=G=v>>3,w&=(1<<(v-=G<<3))-1,i.next_in=c,i.next_out=l,i.avail_in=c<f?f-c+5:5-(c-f),i.avail_out=l<d?d-l+257:257-(l-d),o.hold=w,o.bits=v}},{}],49:[function(t,n,a){var i=t("../utils/common"),s=t("./adler32"),o=t("./crc32"),c=t("./inffast"),f=t("./inftrees"),l=1,u=2,d=0,h=-2,x=1,p=852,m=592;function g(b){return(b>>>24&255)+(b>>>8&65280)+((65280&b)<<8)+((255&b)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function v(b){var X;return b&&b.state?(X=b.state,b.total_in=b.total_out=X.total=0,b.msg="",X.wrap&&(b.adler=1&X.wrap),X.mode=x,X.last=0,X.havedict=0,X.dmax=32768,X.head=null,X.hold=0,X.bits=0,X.lencode=X.lendyn=new i.Buf32(p),X.distcode=X.distdyn=new i.Buf32(m),X.sane=1,X.back=-1,d):h}function k(b){var X;return b&&b.state?((X=b.state).wsize=0,X.whave=0,X.wnext=0,v(b)):h}function A(b,X){var _,W;return b&&b.state?(W=b.state,X<0?(_=0,X=-X):(_=1+(X>>4),X<48&&(X&=15)),X&&(X<8||15<X)?h:(W.window!==null&&W.wbits!==X&&(W.window=null),W.wrap=_,W.wbits=X,k(b))):h}function F(b,X){var _,W;return b?(W=new w,(b.state=W).window=null,(_=A(b,X))!==d&&(b.state=null),_):h}var E,z,C=!0;function G(b){if(C){var X;for(E=new i.Buf32(512),z=new i.Buf32(32),X=0;X<144;)b.lens[X++]=8;for(;X<256;)b.lens[X++]=9;for(;X<280;)b.lens[X++]=7;for(;X<288;)b.lens[X++]=8;for(f(l,b.lens,0,288,E,0,b.work,{bits:9}),X=0;X<32;)b.lens[X++]=5;f(u,b.lens,0,32,z,0,b.work,{bits:5}),C=!1}b.lencode=E,b.lenbits=9,b.distcode=z,b.distbits=5}function H(b,X,_,W){var q,j=b.state;return j.window===null&&(j.wsize=1<<j.wbits,j.wnext=0,j.whave=0,j.window=new i.Buf8(j.wsize)),W>=j.wsize?(i.arraySet(j.window,X,_-j.wsize,j.wsize,0),j.wnext=0,j.whave=j.wsize):(W<(q=j.wsize-j.wnext)&&(q=W),i.arraySet(j.window,X,_-W,q,j.wnext),(W-=q)?(i.arraySet(j.window,X,_-W,W,0),j.wnext=W,j.whave=j.wsize):(j.wnext+=q,j.wnext===j.wsize&&(j.wnext=0),j.whave<j.wsize&&(j.whave+=q))),0}a.inflateReset=k,a.inflateReset2=A,a.inflateResetKeep=v,a.inflateInit=function(b){return F(b,15)},a.inflateInit2=F,a.inflate=function(b,X){var _,W,q,j,ue,P,se,Y,T,K,B,N,ie,pe,le,fe,he,be,V,Ue,y,ae,J,R,O=0,Z=new i.Buf8(4),ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!b||!b.state||!b.output||!b.input&&b.avail_in!==0)return h;(_=b.state).mode===12&&(_.mode=13),ue=b.next_out,q=b.output,se=b.avail_out,j=b.next_in,W=b.input,P=b.avail_in,Y=_.hold,T=_.bits,K=P,B=se,ae=d;e:for(;;)switch(_.mode){case x:if(_.wrap===0){_.mode=13;break}for(;T<16;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}if(2&_.wrap&&Y===35615){Z[_.check=0]=255&Y,Z[1]=Y>>>8&255,_.check=o(_.check,Z,2,0),T=Y=0,_.mode=2;break}if(_.flags=0,_.head&&(_.head.done=!1),!(1&_.wrap)||(((255&Y)<<8)+(Y>>8))%31){b.msg="incorrect header check",_.mode=30;break}if((15&Y)!=8){b.msg="unknown compression method",_.mode=30;break}if(T-=4,y=8+(15&(Y>>>=4)),_.wbits===0)_.wbits=y;else if(y>_.wbits){b.msg="invalid window size",_.mode=30;break}_.dmax=1<<y,b.adler=_.check=1,_.mode=512&Y?10:12,T=Y=0;break;case 2:for(;T<16;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}if(_.flags=Y,(255&_.flags)!=8){b.msg="unknown compression method",_.mode=30;break}if(57344&_.flags){b.msg="unknown header flags set",_.mode=30;break}_.head&&(_.head.text=Y>>8&1),512&_.flags&&(Z[0]=255&Y,Z[1]=Y>>>8&255,_.check=o(_.check,Z,2,0)),T=Y=0,_.mode=3;case 3:for(;T<32;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}_.head&&(_.head.time=Y),512&_.flags&&(Z[0]=255&Y,Z[1]=Y>>>8&255,Z[2]=Y>>>16&255,Z[3]=Y>>>24&255,_.check=o(_.check,Z,4,0)),T=Y=0,_.mode=4;case 4:for(;T<16;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}_.head&&(_.head.xflags=255&Y,_.head.os=Y>>8),512&_.flags&&(Z[0]=255&Y,Z[1]=Y>>>8&255,_.check=o(_.check,Z,2,0)),T=Y=0,_.mode=5;case 5:if(1024&_.flags){for(;T<16;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}_.length=Y,_.head&&(_.head.extra_len=Y),512&_.flags&&(Z[0]=255&Y,Z[1]=Y>>>8&255,_.check=o(_.check,Z,2,0)),T=Y=0}else _.head&&(_.head.extra=null);_.mode=6;case 6:if(1024&_.flags&&(P<(N=_.length)&&(N=P),N&&(_.head&&(y=_.head.extra_len-_.length,_.head.extra||(_.head.extra=new Array(_.head.extra_len)),i.arraySet(_.head.extra,W,j,N,y)),512&_.flags&&(_.check=o(_.check,W,N,j)),P-=N,j+=N,_.length-=N),_.length))break e;_.length=0,_.mode=7;case 7:if(2048&_.flags){if(P===0)break e;for(N=0;y=W[j+N++],_.head&&y&&_.length<65536&&(_.head.name+=String.fromCharCode(y)),y&&N<P;);if(512&_.flags&&(_.check=o(_.check,W,N,j)),P-=N,j+=N,y)break e}else _.head&&(_.head.name=null);_.length=0,_.mode=8;case 8:if(4096&_.flags){if(P===0)break e;for(N=0;y=W[j+N++],_.head&&y&&_.length<65536&&(_.head.comment+=String.fromCharCode(y)),y&&N<P;);if(512&_.flags&&(_.check=o(_.check,W,N,j)),P-=N,j+=N,y)break e}else _.head&&(_.head.comment=null);_.mode=9;case 9:if(512&_.flags){for(;T<16;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}if(Y!==(65535&_.check)){b.msg="header crc mismatch",_.mode=30;break}T=Y=0}_.head&&(_.head.hcrc=_.flags>>9&1,_.head.done=!0),b.adler=_.check=0,_.mode=12;break;case 10:for(;T<32;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}b.adler=_.check=g(Y),T=Y=0,_.mode=11;case 11:if(_.havedict===0)return b.next_out=ue,b.avail_out=se,b.next_in=j,b.avail_in=P,_.hold=Y,_.bits=T,2;b.adler=_.check=1,_.mode=12;case 12:if(X===5||X===6)break e;case 13:if(_.last){Y>>>=7&T,T-=7&T,_.mode=27;break}for(;T<3;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}switch(_.last=1&Y,T-=1,3&(Y>>>=1)){case 0:_.mode=14;break;case 1:if(G(_),_.mode=20,X!==6)break;Y>>>=2,T-=2;break e;case 2:_.mode=17;break;case 3:b.msg="invalid block type",_.mode=30}Y>>>=2,T-=2;break;case 14:for(Y>>>=7&T,T-=7&T;T<32;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}if((65535&Y)!=(Y>>>16^65535)){b.msg="invalid stored block lengths",_.mode=30;break}if(_.length=65535&Y,T=Y=0,_.mode=15,X===6)break e;case 15:_.mode=16;case 16:if(N=_.length){if(P<N&&(N=P),se<N&&(N=se),N===0)break e;i.arraySet(q,W,j,N,ue),P-=N,j+=N,se-=N,ue+=N,_.length-=N;break}_.mode=12;break;case 17:for(;T<14;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}if(_.nlen=257+(31&Y),Y>>>=5,T-=5,_.ndist=1+(31&Y),Y>>>=5,T-=5,_.ncode=4+(15&Y),Y>>>=4,T-=4,286<_.nlen||30<_.ndist){b.msg="too many length or distance symbols",_.mode=30;break}_.have=0,_.mode=18;case 18:for(;_.have<_.ncode;){for(;T<3;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}_.lens[ce[_.have++]]=7&Y,Y>>>=3,T-=3}for(;_.have<19;)_.lens[ce[_.have++]]=0;if(_.lencode=_.lendyn,_.lenbits=7,J={bits:_.lenbits},ae=f(0,_.lens,0,19,_.lencode,0,_.work,J),_.lenbits=J.bits,ae){b.msg="invalid code lengths set",_.mode=30;break}_.have=0,_.mode=19;case 19:for(;_.have<_.nlen+_.ndist;){for(;fe=(O=_.lencode[Y&(1<<_.lenbits)-1])>>>16&255,he=65535&O,!((le=O>>>24)<=T);){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}if(he<16)Y>>>=le,T-=le,_.lens[_.have++]=he;else{if(he===16){for(R=le+2;T<R;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}if(Y>>>=le,T-=le,_.have===0){b.msg="invalid bit length repeat",_.mode=30;break}y=_.lens[_.have-1],N=3+(3&Y),Y>>>=2,T-=2}else if(he===17){for(R=le+3;T<R;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}T-=le,y=0,N=3+(7&(Y>>>=le)),Y>>>=3,T-=3}else{for(R=le+7;T<R;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}T-=le,y=0,N=11+(127&(Y>>>=le)),Y>>>=7,T-=7}if(_.have+N>_.nlen+_.ndist){b.msg="invalid bit length repeat",_.mode=30;break}for(;N--;)_.lens[_.have++]=y}}if(_.mode===30)break;if(_.lens[256]===0){b.msg="invalid code -- missing end-of-block",_.mode=30;break}if(_.lenbits=9,J={bits:_.lenbits},ae=f(l,_.lens,0,_.nlen,_.lencode,0,_.work,J),_.lenbits=J.bits,ae){b.msg="invalid literal/lengths set",_.mode=30;break}if(_.distbits=6,_.distcode=_.distdyn,J={bits:_.distbits},ae=f(u,_.lens,_.nlen,_.ndist,_.distcode,0,_.work,J),_.distbits=J.bits,ae){b.msg="invalid distances set",_.mode=30;break}if(_.mode=20,X===6)break e;case 20:_.mode=21;case 21:if(6<=P&&258<=se){b.next_out=ue,b.avail_out=se,b.next_in=j,b.avail_in=P,_.hold=Y,_.bits=T,c(b,B),ue=b.next_out,q=b.output,se=b.avail_out,j=b.next_in,W=b.input,P=b.avail_in,Y=_.hold,T=_.bits,_.mode===12&&(_.back=-1);break}for(_.back=0;fe=(O=_.lencode[Y&(1<<_.lenbits)-1])>>>16&255,he=65535&O,!((le=O>>>24)<=T);){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}if(fe&&(240&fe)==0){for(be=le,V=fe,Ue=he;fe=(O=_.lencode[Ue+((Y&(1<<be+V)-1)>>be)])>>>16&255,he=65535&O,!(be+(le=O>>>24)<=T);){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}Y>>>=be,T-=be,_.back+=be}if(Y>>>=le,T-=le,_.back+=le,_.length=he,fe===0){_.mode=26;break}if(32&fe){_.back=-1,_.mode=12;break}if(64&fe){b.msg="invalid literal/length code",_.mode=30;break}_.extra=15&fe,_.mode=22;case 22:if(_.extra){for(R=_.extra;T<R;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}_.length+=Y&(1<<_.extra)-1,Y>>>=_.extra,T-=_.extra,_.back+=_.extra}_.was=_.length,_.mode=23;case 23:for(;fe=(O=_.distcode[Y&(1<<_.distbits)-1])>>>16&255,he=65535&O,!((le=O>>>24)<=T);){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}if((240&fe)==0){for(be=le,V=fe,Ue=he;fe=(O=_.distcode[Ue+((Y&(1<<be+V)-1)>>be)])>>>16&255,he=65535&O,!(be+(le=O>>>24)<=T);){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}Y>>>=be,T-=be,_.back+=be}if(Y>>>=le,T-=le,_.back+=le,64&fe){b.msg="invalid distance code",_.mode=30;break}_.offset=he,_.extra=15&fe,_.mode=24;case 24:if(_.extra){for(R=_.extra;T<R;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}_.offset+=Y&(1<<_.extra)-1,Y>>>=_.extra,T-=_.extra,_.back+=_.extra}if(_.offset>_.dmax){b.msg="invalid distance too far back",_.mode=30;break}_.mode=25;case 25:if(se===0)break e;if(N=B-se,_.offset>N){if((N=_.offset-N)>_.whave&&_.sane){b.msg="invalid distance too far back",_.mode=30;break}ie=N>_.wnext?(N-=_.wnext,_.wsize-N):_.wnext-N,N>_.length&&(N=_.length),pe=_.window}else pe=q,ie=ue-_.offset,N=_.length;for(se<N&&(N=se),se-=N,_.length-=N;q[ue++]=pe[ie++],--N;);_.length===0&&(_.mode=21);break;case 26:if(se===0)break e;q[ue++]=_.length,se--,_.mode=21;break;case 27:if(_.wrap){for(;T<32;){if(P===0)break e;P--,Y|=W[j++]<<T,T+=8}if(B-=se,b.total_out+=B,_.total+=B,B&&(b.adler=_.check=_.flags?o(_.check,q,B,ue-B):s(_.check,q,B,ue-B)),B=se,(_.flags?Y:g(Y))!==_.check){b.msg="incorrect data check",_.mode=30;break}T=Y=0}_.mode=28;case 28:if(_.wrap&&_.flags){for(;T<32;){if(P===0)break e;P--,Y+=W[j++]<<T,T+=8}if(Y!==(4294967295&_.total)){b.msg="incorrect length check",_.mode=30;break}T=Y=0}_.mode=29;case 29:ae=1;break e;case 30:ae=-3;break e;case 31:return-4;case 32:default:return h}return b.next_out=ue,b.avail_out=se,b.next_in=j,b.avail_in=P,_.hold=Y,_.bits=T,(_.wsize||B!==b.avail_out&&_.mode<30&&(_.mode<27||X!==4))&&H(b,b.output,b.next_out,B-b.avail_out)?(_.mode=31,-4):(K-=b.avail_in,B-=b.avail_out,b.total_in+=K,b.total_out+=B,_.total+=B,_.wrap&&B&&(b.adler=_.check=_.flags?o(_.check,q,B,b.next_out-B):s(_.check,q,B,b.next_out-B)),b.data_type=_.bits+(_.last?64:0)+(_.mode===12?128:0)+(_.mode===20||_.mode===15?256:0),(K==0&&B===0||X===4)&&ae===d&&(ae=-5),ae)},a.inflateEnd=function(b){if(!b||!b.state)return h;var X=b.state;return X.window&&(X.window=null),b.state=null,d},a.inflateGetHeader=function(b,X){var _;return b&&b.state?(2&(_=b.state).wrap)==0?h:((_.head=X).done=!1,d):h},a.inflateSetDictionary=function(b,X){var _,W=X.length;return b&&b.state?(_=b.state).wrap!==0&&_.mode!==11?h:_.mode===11&&s(1,X,W,0)!==_.check?-3:H(b,X,W,W)?(_.mode=31,-4):(_.havedict=1,d):h},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,n,a){var i=t("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(l,u,d,h,x,p,m,g){var w,v,k,A,F,E,z,C,G,H=g.bits,b=0,X=0,_=0,W=0,q=0,j=0,ue=0,P=0,se=0,Y=0,T=null,K=0,B=new i.Buf16(16),N=new i.Buf16(16),ie=null,pe=0;for(b=0;b<=15;b++)B[b]=0;for(X=0;X<h;X++)B[u[d+X]]++;for(q=H,W=15;1<=W&&B[W]===0;W--);if(W<q&&(q=W),W===0)return x[p++]=20971520,x[p++]=20971520,g.bits=1,0;for(_=1;_<W&&B[_]===0;_++);for(q<_&&(q=_),b=P=1;b<=15;b++)if(P<<=1,(P-=B[b])<0)return-1;if(0<P&&(l===0||W!==1))return-1;for(N[1]=0,b=1;b<15;b++)N[b+1]=N[b]+B[b];for(X=0;X<h;X++)u[d+X]!==0&&(m[N[u[d+X]]++]=X);if(E=l===0?(T=ie=m,19):l===1?(T=s,K-=257,ie=o,pe-=257,256):(T=c,ie=f,-1),b=_,F=p,ue=X=Y=0,k=-1,A=(se=1<<(j=q))-1,l===1&&852<se||l===2&&592<se)return 1;for(;;){for(z=b-ue,G=m[X]<E?(C=0,m[X]):m[X]>E?(C=ie[pe+m[X]],T[K+m[X]]):(C=96,0),w=1<<b-ue,_=v=1<<j;x[F+(Y>>ue)+(v-=w)]=z<<24|C<<16|G|0,v!==0;);for(w=1<<b-1;Y&w;)w>>=1;if(w!==0?(Y&=w-1,Y+=w):Y=0,X++,--B[b]==0){if(b===W)break;b=u[d+m[X]]}if(q<b&&(Y&A)!==k){for(ue===0&&(ue=q),F+=_,P=1<<(j=b-ue);j+ue<W&&!((P-=B[j+ue])<=0);)j++,P<<=1;if(se+=1<<j,l===1&&852<se||l===2&&592<se)return 1;x[k=Y&A]=q<<24|j<<16|F-p|0}}return Y!==0&&(x[F+Y]=b-ue<<24|64<<16|0),g.bits=q,0}},{"../utils/common":41}],51:[function(t,n,a){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,n,a){var i=t("../utils/common"),s=0,o=1;function c(O){for(var Z=O.length;0<=--Z;)O[Z]=0}var f=0,l=29,u=256,d=u+1+l,h=30,x=19,p=2*d+1,m=15,g=16,w=7,v=256,k=16,A=17,F=18,E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=new Array(2*(d+2));c(H);var b=new Array(2*h);c(b);var X=new Array(512);c(X);var _=new Array(256);c(_);var W=new Array(l);c(W);var q,j,ue,P=new Array(h);function se(O,Z,ce,de,Q){this.static_tree=O,this.extra_bits=Z,this.extra_base=ce,this.elems=de,this.max_length=Q,this.has_stree=O&&O.length}function Y(O,Z){this.dyn_tree=O,this.max_code=0,this.stat_desc=Z}function T(O){return O<256?X[O]:X[256+(O>>>7)]}function K(O,Z){O.pending_buf[O.pending++]=255&Z,O.pending_buf[O.pending++]=Z>>>8&255}function B(O,Z,ce){O.bi_valid>g-ce?(O.bi_buf|=Z<<O.bi_valid&65535,K(O,O.bi_buf),O.bi_buf=Z>>g-O.bi_valid,O.bi_valid+=ce-g):(O.bi_buf|=Z<<O.bi_valid&65535,O.bi_valid+=ce)}function N(O,Z,ce){B(O,ce[2*Z],ce[2*Z+1])}function ie(O,Z){for(var ce=0;ce|=1&O,O>>>=1,ce<<=1,0<--Z;);return ce>>>1}function pe(O,Z,ce){var de,Q,xe=new Array(m+1),ve=0;for(de=1;de<=m;de++)xe[de]=ve=ve+ce[de-1]<<1;for(Q=0;Q<=Z;Q++){var me=O[2*Q+1];me!==0&&(O[2*Q]=ie(xe[me]++,me))}}function le(O){var Z;for(Z=0;Z<d;Z++)O.dyn_ltree[2*Z]=0;for(Z=0;Z<h;Z++)O.dyn_dtree[2*Z]=0;for(Z=0;Z<x;Z++)O.bl_tree[2*Z]=0;O.dyn_ltree[2*v]=1,O.opt_len=O.static_len=0,O.last_lit=O.matches=0}function fe(O){8<O.bi_valid?K(O,O.bi_buf):0<O.bi_valid&&(O.pending_buf[O.pending++]=O.bi_buf),O.bi_buf=0,O.bi_valid=0}function he(O,Z,ce,de){var Q=2*Z,xe=2*ce;return O[Q]<O[xe]||O[Q]===O[xe]&&de[Z]<=de[ce]}function be(O,Z,ce){for(var de=O.heap[ce],Q=ce<<1;Q<=O.heap_len&&(Q<O.heap_len&&he(Z,O.heap[Q+1],O.heap[Q],O.depth)&&Q++,!he(Z,de,O.heap[Q],O.depth));)O.heap[ce]=O.heap[Q],ce=Q,Q<<=1;O.heap[ce]=de}function V(O,Z,ce){var de,Q,xe,ve,me=0;if(O.last_lit!==0)for(;de=O.pending_buf[O.d_buf+2*me]<<8|O.pending_buf[O.d_buf+2*me+1],Q=O.pending_buf[O.l_buf+me],me++,de===0?N(O,Q,Z):(N(O,(xe=_[Q])+u+1,Z),(ve=E[xe])!==0&&B(O,Q-=W[xe],ve),N(O,xe=T(--de),ce),(ve=z[xe])!==0&&B(O,de-=P[xe],ve)),me<O.last_lit;);N(O,v,Z)}function Ue(O,Z){var ce,de,Q,xe=Z.dyn_tree,ve=Z.stat_desc.static_tree,me=Z.stat_desc.has_stree,Ee=Z.stat_desc.elems,$e=-1;for(O.heap_len=0,O.heap_max=p,ce=0;ce<Ee;ce++)xe[2*ce]!==0?(O.heap[++O.heap_len]=$e=ce,O.depth[ce]=0):xe[2*ce+1]=0;for(;O.heap_len<2;)xe[2*(Q=O.heap[++O.heap_len]=$e<2?++$e:0)]=1,O.depth[Q]=0,O.opt_len--,me&&(O.static_len-=ve[2*Q+1]);for(Z.max_code=$e,ce=O.heap_len>>1;1<=ce;ce--)be(O,xe,ce);for(Q=Ee;ce=O.heap[1],O.heap[1]=O.heap[O.heap_len--],be(O,xe,1),de=O.heap[1],O.heap[--O.heap_max]=ce,O.heap[--O.heap_max]=de,xe[2*Q]=xe[2*ce]+xe[2*de],O.depth[Q]=(O.depth[ce]>=O.depth[de]?O.depth[ce]:O.depth[de])+1,xe[2*ce+1]=xe[2*de+1]=Q,O.heap[1]=Q++,be(O,xe,1),2<=O.heap_len;);O.heap[--O.heap_max]=O.heap[1],function(Ae,Xe){var Fe,He,ot,De,Wt,mn,Zt=Xe.dyn_tree,Ya=Xe.max_code,Ka=Xe.stat_desc.static_tree,qa=Xe.stat_desc.has_stree,Za=Xe.stat_desc.extra_bits,Ja=Xe.stat_desc.extra_base,Gr=Xe.stat_desc.max_length,yr=0;for(De=0;De<=m;De++)Ae.bl_count[De]=0;for(Zt[2*Ae.heap[Ae.heap_max]+1]=0,Fe=Ae.heap_max+1;Fe<p;Fe++)Gr<(De=Zt[2*Zt[2*(He=Ae.heap[Fe])+1]+1]+1)&&(De=Gr,yr++),Zt[2*He+1]=De,Ya<He||(Ae.bl_count[De]++,Wt=0,Ja<=He&&(Wt=Za[He-Ja]),mn=Zt[2*He],Ae.opt_len+=mn*(De+Wt),qa&&(Ae.static_len+=mn*(Ka[2*He+1]+Wt)));if(yr!==0){do{for(De=Gr-1;Ae.bl_count[De]===0;)De--;Ae.bl_count[De]--,Ae.bl_count[De+1]+=2,Ae.bl_count[Gr]--,yr-=2}while(0<yr);for(De=Gr;De!==0;De--)for(He=Ae.bl_count[De];He!==0;)Ya<(ot=Ae.heap[--Fe])||(Zt[2*ot+1]!==De&&(Ae.opt_len+=(De-Zt[2*ot+1])*Zt[2*ot],Zt[2*ot+1]=De),He--)}}(O,Z),pe(xe,$e,O.bl_count)}function y(O,Z,ce){var de,Q,xe=-1,ve=Z[1],me=0,Ee=7,$e=4;for(ve===0&&(Ee=138,$e=3),Z[2*(ce+1)+1]=65535,de=0;de<=ce;de++)Q=ve,ve=Z[2*(de+1)+1],++me<Ee&&Q===ve||(me<$e?O.bl_tree[2*Q]+=me:Q!==0?(Q!==xe&&O.bl_tree[2*Q]++,O.bl_tree[2*k]++):me<=10?O.bl_tree[2*A]++:O.bl_tree[2*F]++,xe=Q,$e=(me=0)===ve?(Ee=138,3):Q===ve?(Ee=6,3):(Ee=7,4))}function ae(O,Z,ce){var de,Q,xe=-1,ve=Z[1],me=0,Ee=7,$e=4;for(ve===0&&(Ee=138,$e=3),de=0;de<=ce;de++)if(Q=ve,ve=Z[2*(de+1)+1],!(++me<Ee&&Q===ve)){if(me<$e)for(;N(O,Q,O.bl_tree),--me!=0;);else Q!==0?(Q!==xe&&(N(O,Q,O.bl_tree),me--),N(O,k,O.bl_tree),B(O,me-3,2)):me<=10?(N(O,A,O.bl_tree),B(O,me-3,3)):(N(O,F,O.bl_tree),B(O,me-11,7));xe=Q,$e=(me=0)===ve?(Ee=138,3):Q===ve?(Ee=6,3):(Ee=7,4)}}c(P);var J=!1;function R(O,Z,ce,de){B(O,(f<<1)+(de?1:0),3),function(Q,xe,ve,me){fe(Q),K(Q,ve),K(Q,~ve),i.arraySet(Q.pending_buf,Q.window,xe,ve,Q.pending),Q.pending+=ve}(O,Z,ce)}a._tr_init=function(O){J||(function(){var Z,ce,de,Q,xe,ve=new Array(m+1);for(Q=de=0;Q<l-1;Q++)for(W[Q]=de,Z=0;Z<1<<E[Q];Z++)_[de++]=Q;for(_[de-1]=Q,Q=xe=0;Q<16;Q++)for(P[Q]=xe,Z=0;Z<1<<z[Q];Z++)X[xe++]=Q;for(xe>>=7;Q<h;Q++)for(P[Q]=xe<<7,Z=0;Z<1<<z[Q]-7;Z++)X[256+xe++]=Q;for(ce=0;ce<=m;ce++)ve[ce]=0;for(Z=0;Z<=143;)H[2*Z+1]=8,Z++,ve[8]++;for(;Z<=255;)H[2*Z+1]=9,Z++,ve[9]++;for(;Z<=279;)H[2*Z+1]=7,Z++,ve[7]++;for(;Z<=287;)H[2*Z+1]=8,Z++,ve[8]++;for(pe(H,d+1,ve),Z=0;Z<h;Z++)b[2*Z+1]=5,b[2*Z]=ie(Z,5);q=new se(H,E,u+1,d,m),j=new se(b,z,0,h,m),ue=new se(new Array(0),C,0,x,w)}(),J=!0),O.l_desc=new Y(O.dyn_ltree,q),O.d_desc=new Y(O.dyn_dtree,j),O.bl_desc=new Y(O.bl_tree,ue),O.bi_buf=0,O.bi_valid=0,le(O)},a._tr_stored_block=R,a._tr_flush_block=function(O,Z,ce,de){var Q,xe,ve=0;0<O.level?(O.strm.data_type===2&&(O.strm.data_type=function(me){var Ee,$e=4093624447;for(Ee=0;Ee<=31;Ee++,$e>>>=1)if(1&$e&&me.dyn_ltree[2*Ee]!==0)return s;if(me.dyn_ltree[18]!==0||me.dyn_ltree[20]!==0||me.dyn_ltree[26]!==0)return o;for(Ee=32;Ee<u;Ee++)if(me.dyn_ltree[2*Ee]!==0)return o;return s}(O)),Ue(O,O.l_desc),Ue(O,O.d_desc),ve=function(me){var Ee;for(y(me,me.dyn_ltree,me.l_desc.max_code),y(me,me.dyn_dtree,me.d_desc.max_code),Ue(me,me.bl_desc),Ee=x-1;3<=Ee&&me.bl_tree[2*G[Ee]+1]===0;Ee--);return me.opt_len+=3*(Ee+1)+5+5+4,Ee}(O),Q=O.opt_len+3+7>>>3,(xe=O.static_len+3+7>>>3)<=Q&&(Q=xe)):Q=xe=ce+5,ce+4<=Q&&Z!==-1?R(O,Z,ce,de):O.strategy===4||xe===Q?(B(O,2+(de?1:0),3),V(O,H,b)):(B(O,4+(de?1:0),3),function(me,Ee,$e,Ae){var Xe;for(B(me,Ee-257,5),B(me,$e-1,5),B(me,Ae-4,4),Xe=0;Xe<Ae;Xe++)B(me,me.bl_tree[2*G[Xe]+1],3);ae(me,me.dyn_ltree,Ee-1),ae(me,me.dyn_dtree,$e-1)}(O,O.l_desc.max_code+1,O.d_desc.max_code+1,ve+1),V(O,O.dyn_ltree,O.dyn_dtree)),le(O),de&&fe(O)},a._tr_tally=function(O,Z,ce){return O.pending_buf[O.d_buf+2*O.last_lit]=Z>>>8&255,O.pending_buf[O.d_buf+2*O.last_lit+1]=255&Z,O.pending_buf[O.l_buf+O.last_lit]=255&ce,O.last_lit++,Z===0?O.dyn_ltree[2*ce]++:(O.matches++,Z--,O.dyn_ltree[2*(_[ce]+u+1)]++,O.dyn_dtree[2*T(Z)]++),O.last_lit===O.lit_bufsize-1},a._tr_align=function(O){B(O,2,3),N(O,v,H),function(Z){Z.bi_valid===16?(K(Z,Z.bi_buf),Z.bi_buf=0,Z.bi_valid=0):8<=Z.bi_valid&&(Z.pending_buf[Z.pending++]=255&Z.bi_buf,Z.bi_buf>>=8,Z.bi_valid-=8)}(O)}},{"../utils/common":41}],53:[function(t,n,a){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,n,a){(function(i){(function(s,o){if(!s.setImmediate){var c,f,l,u,d=1,h={},x=!1,p=s.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(s);m=m&&m.setTimeout?m:s,c={}.toString.call(s.process)==="[object process]"?function(k){process.nextTick(function(){w(k)})}:function(){if(s.postMessage&&!s.importScripts){var k=!0,A=s.onmessage;return s.onmessage=function(){k=!1},s.postMessage("","*"),s.onmessage=A,k}}()?(u="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",v,!1):s.attachEvent("onmessage",v),function(k){s.postMessage(u+k,"*")}):s.MessageChannel?((l=new MessageChannel).port1.onmessage=function(k){w(k.data)},function(k){l.port2.postMessage(k)}):p&&"onreadystatechange"in p.createElement("script")?(f=p.documentElement,function(k){var A=p.createElement("script");A.onreadystatechange=function(){w(k),A.onreadystatechange=null,f.removeChild(A),A=null},f.appendChild(A)}):function(k){setTimeout(w,0,k)},m.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var A=new Array(arguments.length-1),F=0;F<A.length;F++)A[F]=arguments[F+1];var E={callback:k,args:A};return h[d]=E,c(d),d++},m.clearImmediate=g}function g(k){delete h[k]}function w(k){if(x)setTimeout(w,0,k);else{var A=h[k];if(A){x=!0;try{(function(F){var E=F.callback,z=F.args;switch(z.length){case 0:E();break;case 1:E(z[0]);break;case 2:E(z[0],z[1]);break;case 3:E(z[0],z[1],z[2]);break;default:E.apply(o,z)}})(A)}finally{g(k),x=!1}}}}function v(k){k.source===s&&typeof k.data=="string"&&k.data.indexOf(u)===0&&w(+k.data.slice(u.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof ki<"u"?ki:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(to)),to.exports}var hA=uA();const dA=lA(hA);class pA extends HTMLElement{constructor(){super();At(this,"shadow");At(this,"stepCards",new Map);At(this,"isFilesVisible",!1);At(this,"_projectResultCache",{});this.shadow=this.attachShadow({mode:"open"}),this.shadow.innerHTML=`
      <style>
        .cluster-container {
          display: flex;
          flex-direction: column;
          padding: 16px;
          font-family: sans-serif;
          overflow-x: hidden;
        }
        .actions {
          margin-top: 12px;
          display: flex;
          flex-wrap: wrap;
          align-items: center;
          gap: 8px; /* spacing between elements */
          width: auto;
        }
        .results {
          margin-top: 16px;
          white-space: pre-wrap;
          font-size: 0.9rem;
          background: #e36a1e;
          color: white;
          padding: 12px;
          border-radius: 6px;
          max-height: 180px;
          overflow-y: scroll;
        }
        button {
          background-color: var(--container-bg);
          color: var(--color-text);
          font-size: 14px;
          font-weight: bold;
          border: black 3px solid;
          border-radius: 12px;
          cursor: pointer;
          transform: scale(0.9);
          padding: 10px 16px;
          transition: background-color 0.25s ease, transform 0.1s ease;
        }
        button:hover {
          background-color: #e36a1e;
          border: #e36a1e 3px solid;
          transform: scale(1);
          color: white;
        }

        /* Distinct styling for "Download All" button */
        .download-all-btn {
          background-color: #128712;
          border-color: #128712;
          color: #fff;
        }
        .download-all-btn:hover {
          background-color: #0f6b0f;
          border-color: #0f6b0f;
        }

        /* Hidden container for individual file downloads */
        .file-downloads-container {
          margin-top: 16px;
          display: none; /* hidden by default */
          flex-wrap: wrap;
          gap: 8px;
          overflow-y: scroll;
          max-height: 85px;
        }
        .file-downloads-container.show {
          display: flex; /* show it when toggled */
        }

        /* The store selector styling */
        select.store-selector {
          background-color: var(--container-bg);
          color: var(--color-text);
          font-size: 14px;
          font-weight: bold;
          border: black 3px solid;
          border-radius: 12px;
          cursor: pointer;
          transform: scale(0.9);
          padding: 8px 16px;
          transition: background-color 0.25s ease;
        }
        select.store-selector:hover {
          background-color: #e36a1e;
          border: #e36a1e 3px solid;
          transform: scale(1);
          color: white;
        }

        textarea {
          padding: 12px;
          min-height: 100px;
        }

        .download-buttons {
          margin-top: 16px;
        }

        /* Carousel: new cards on the left, older cards fade out right */
        .carousel {
          display: flex;
          flex-direction: row;
          overflow-x: auto;
          gap: 16px;
          margin-top: 16px;
          padding-bottom: 8px;
          overflow-x: hidden;
        }
        .log-card {
          min-width: 240px;
          background: var(--container-bg);
          border-radius: 8px;
          box-shadow: 0 2px 4px rgba(0,0,0,0.15);
          flex-shrink: 0;
          padding: 12px;
          display: flex;
          flex-direction: row;
          align-items: center;
          transition: opacity 0.6s ease;
        }
        .pulse-hex {
          width: 60px;
          height: 60px;
          margin-right: 12px;
        }
        .log-text {
          font-size: 0.85rem;
          color: var(--color-text);
          line-height: 1.4;
          display: inline-block;
        }
        /* Wave animation (continuous) */
        @keyframes waveUpDown {
          0%, 100% { transform: translateY(0); }
          50%      { transform: translateY(-8px); }
        }
        .wave-char {
          display: inline-block;
          animation: waveUpDown 1s ease-in-out infinite;
        }
        /* On finish, we transition from mid-wave back to baseline */
        @keyframes waveFadeOut {
          from { transform: translateY(-8px); }
          to   { transform: translateY(0); }
        }
        .wave-char-final {
          display: inline-block;
          animation: waveFadeOut 0.4s ease forwards;
        }

        /* Pulse for the hex polygons */
        @keyframes flashOrange {
          0%, 100% { fill: var(--original-fill); transform: scale(1); }
          50%      { fill: var(--container-bg); transform: scale(1); }
        }
        .pulse {
          animation: flashOrange 1.2s ease-in-out infinite;
        }

        /* 
         * NEW: #loweractions container. Initially hidden (with transition).
         * We'll fade+scale it in once files are ready.
         */
        #loweractions {
          display: flex;            /* so it's in the layout, but invisible */
          opacity: 0;
          pointer-events: none;
          transform: scale(0.95);
          transition: opacity 0.4s ease, transform 0.4s ease;
          margin-top: 16px;
          gap: 12px;
        }
        #loweractions.show {
          opacity: 1;
          pointer-events: auto;
          transform: scale(1);
        }
      </style>

      <div class="cluster-container">
        <h2>Cluster Page</h2>
        <p>Describe your desired project:</p>
        <textarea id="projectDescription" placeholder="e.g., 'Build an Azure Function backend...'"></textarea>

        <div class="actions">
          <!-- The store selector -->
          <select class="store-selector" id="storeSelector">
            <option value="">Null</option>
            <option value="vector_store_1">Vector Store 1</option>
            <option value="vector_store_2">Vector Store 2</option>
            <option value="vector_store_3">Vector Store 3</option>
          </select>

          <!-- Normal generate button -->
          <button id="generateBtn">Generate Project</button>
        </div>

        <div class="carousel" id="logCarousel"></div>
        
        <div class="results" id="results"></div>

        <!-- 
          The new loweractions container that will be hidden 
          until files exist, then fade in.
        -->
        <div class="actions" id="loweractions">
          <!-- Distinct "Download All" button -->
          <button id="downloadAllBtn" class="download-all-btn">Download All (ZIP)</button>

          <!-- Toggle button for showing/hiding the individual file downloads -->
          <button id="toggleFilesBtn">See All Project Files</button>
        </div>

        <!-- The hidden container for the individual file download buttons -->
        <div class="file-downloads-container" id="fileDownloadsContainer">
          <!-- We'll fill this dynamically after generation -->
        </div>
      </div>
    `}connectedCallback(){this.shadow.getElementById("generateBtn").addEventListener("click",()=>this.onGenerateProject()),this.shadow.getElementById("toggleFilesBtn").addEventListener("click",()=>this.onToggleFiles()),this.shadow.getElementById("downloadAllBtn").addEventListener("click",()=>this.downloadAllAsZip())}async onGenerateProject(){const t=this.shadow.getElementById("projectDescription"),n=this.shadow.getElementById("results"),a=this.shadow.getElementById("logCarousel"),i=this.shadow.getElementById("fileDownloadsContainer"),o=this.shadow.getElementById("storeSelector").value;n.innerText="",i.innerHTML="",a.innerHTML="",this.stepCards.clear(),this._projectResultCache={};const c=this.shadow.getElementById("loweractions");c.classList.remove("show");const f=t.value.trim();if(!f){n.innerText="Please provide a project description.";return}n.innerText=`Generating project...
`;try{const l=await oA(f,(h,x)=>this.startLogCard(h,x),(h,x)=>this.finishLogCard(h,x),o),u=Object.keys(l);let d=`Project successfully generated!

Files:`;if(u.length===0)d+=`
(No files were generated)`;else{c.classList.add("show");for(const h of u)d+=`
- ${h}`}n.textContent="",xA(n,d,40),u.forEach(h=>{const x=l[h],p=document.createElement("button");p.innerText=`Download ${h}`,p.addEventListener("click",()=>{const m=new Blob([x],{type:"text/plain"}),g=URL.createObjectURL(m),w=document.createElement("a");w.href=g,w.download=h,w.click(),URL.revokeObjectURL(g)}),i.appendChild(p)}),this._projectResultCache=l}catch(l){n.innerText=`Error: ${l}`}}onToggleFiles(){const t=this.shadow.getElementById("fileDownloadsContainer");this.isFilesVisible=!this.isFilesVisible,this.isFilesVisible?t.classList.add("show"):t.classList.remove("show")}async downloadAllAsZip(){if(!this._projectResultCache||Object.keys(this._projectResultCache).length===0){alert("No project files found. Please generate a project first.");return}const t=new dA;for(const[s,o]of Object.entries(this._projectResultCache))t.file(s,o);const n=await t.generateAsync({type:"blob"}),a=URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download="project_files.zip",i.click(),URL.revokeObjectURL(a)}startLogCard(t,n){const a=this.shadow.getElementById("logCarousel"),i=n.replace(/\[.*?\]\s*/g,""),s=this.createWaveText(i),o=document.createElement("div");o.classList.add("log-card");const c=this.createPulseHex(),f=document.createElement("div");f.classList.add("log-text"),f.appendChild(s),o.appendChild(c),o.appendChild(f),a.firstChild?a.insertBefore(o,a.firstChild):a.appendChild(o),this.stepCards.set(t,o),this.updateCardOpacity()}finishLogCard(t,n){const a=this.stepCards.get(t);if(!a)return;const i=n.replace(/\[.*?\]\s*/g,""),s=this.createWaveText(i,!1),o=a.querySelector(".log-text");o&&(o.innerHTML="",o.appendChild(s)),a.querySelectorAll("polygon").forEach(f=>{f.classList.remove("pulse")})}createPulseHex(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.setAttribute("viewBox","0 0 200 200"),t.classList.add("pulse-hex"),[{points:"100,100 152,70   152,130",fill:"#EA3546"},{points:"100,100 152,130  100,160",fill:"#EA3546"},{points:"100,100 100,160  48,130",fill:"#FABF35"},{points:"100,100 48,130   48,70",fill:"#FABF35"},{points:"100,100 48,70    100,40",fill:"#345995"},{points:"100,100 100,40   152,70",fill:"#345995"}].forEach((a,i)=>{const s=document.createElementNS("http://www.w3.org/2000/svg","polygon");s.setAttribute("points",a.points),s.setAttribute("fill",a.fill),s.style.setProperty("--original-fill",a.fill),s.style.setProperty("--color-bg","#FFF"),s.classList.add("pulse"),s.style.animationDelay=`${i*.1}s`,t.appendChild(s)}),t}createWaveText(t,n=!0){const a=document.createElement("span");return t.split("").forEach((i,s)=>{const o=document.createElement("span");if(o.textContent=i,i.trim()===""){a.appendChild(o);return}n?(o.classList.add("wave-char"),o.style.animationDelay=`${s*.01}s`):o.classList.add("wave-char-final"),a.appendChild(o)}),a}updateCardOpacity(){const t=this.shadow.getElementById("logCarousel");Array.from(t.querySelectorAll(".log-card")).forEach((a,i)=>{const s=1-i*.15,o=Math.max(.3,s);a.style.opacity=String(o)})}}function xA(e,r,t=50,n){let a=0;e.textContent="";const i=setInterval(()=>{e.textContent+=r.charAt(a),e.scrollTop=e.scrollHeight,a++,a>=r.length&&clearInterval(i)},t)}customElements.define("cluster-page",pA);const mA=750,gA=0;class _A extends HTMLElement{constructor(){super();At(this,"shadow");this.shadow=this.attachShadow({mode:"open"}),this.shadow.innerHTML=`
      <style>
        .cluster-container {
          display: flex;
          flex-direction: column;
          padding: 16px;
          font-family: sans-serif;
          align-items: center;
          max-height: 90vh;
          overflow-y: auto;
          overflow-x: hidden;
        }

        .logo-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
          gap: 24px;
          width: 100%;
          justify-items: center;
          align-items: center;
          padding: 16px;
          overflow-y: auto;
          overflow-x: hidden;
        }

        .logo-wrapper svg {
          width: 200px;
          height: 200px;
          margin: 20px auto;
        }
        .logo-wrapper:hover {
          transform: scale(1.1) rotate(10deg);
        }

        polygon {
          transform-origin: 100px 100px;
          transition: fill 0.3s ease;
        }

        @keyframes flashOrange {
          0%, 100% { fill: var(--original-fill); transform: scale(1);}
          50%      { fill: var(--color-bg); transform: scale(1); }
        }
        
        @keyframes rotateColors {
          0%   { fill: var(--c0); }
          16%  { fill: var(--c5); }
          33%  { fill: var(--c4); }
          50%  { fill: var(--c3); }
          66%  { fill: var(--c2); }
          83%  { fill: var(--c1); }
          100% { fill: var(--c0); }
        }

        .rotate {
          animation: rotateColors 2.4s linear 3;
        }

        .pulse {
          animation: flashOrange 1.2s ease-in-out 3;
        }
        @keyframes groupPulse {
          0%, 100% {
            transform: translate(0, 0);
          }
          50% {
            transform: var(--move);
          }
        }

        .group-animate {
          animation: groupPulse 1.5s ease-in-out 3;
        }
      </style>

      <div class="cluster-container">
        <h2>Logo Page</h2>
            <div class="logo-grid">
              <div class="logo-wrapper"></div>
              <div class="logo-wrapper"></div>
              <div class="logo-wrapper"></div>
              <div class="logo-wrapper"></div> <!-- New one -->
            </div>
      </div>
    `}connectedCallback(){this.loadSVG().then(()=>{this.shadow.querySelectorAll(".logo-wrapper").forEach(t=>{t.addEventListener("click",()=>{const n=t.querySelectorAll("polygon");n.forEach(a=>{const i=a.classList,s=i.contains("pulse"),o=i.contains("rotate"),c=i.contains("group-animate");a.classList.remove("pulse","rotate","group-animate"),a.getBoundingClientRect().width,s&&a.classList.add("pulse"),o&&a.classList.add("rotate"),c&&[[0,1],[2,3],[4,5]].forEach((l,u)=>{l.forEach((d,h)=>{const x=u*mA+h*gA;setTimeout(()=>{n[d].classList.add("group-animate")},x)})})})})})})}async loadSVG(){try{const n=await(await fetch("./data/hexlogo.html")).text(),s=new DOMParser().parseFromString(n,"text/html").querySelector("svg"),o=this.shadow.querySelectorAll(".logo-wrapper");if(s&&o[0]){const c=s.cloneNode(!0);o[0].appendChild(c),c.querySelectorAll("polygon").forEach((l,u)=>{const d=l.getAttribute("fill")||"#000";l.style.setProperty("--original-fill",d),l.classList.add("pulse"),l.style.animationDelay=`${u*.4}s`})}if(s&&o[1]){const c=s.cloneNode(!0);o[1].appendChild(c);const f=c.querySelectorAll("polygon"),l=["#EA3546","#EA3546","#FABF35","#FABF35","#345995","#345995"];f.forEach((u,d)=>{u.style.setProperty("--c0",l[d%6]),u.style.setProperty("--c1",l[(d+1)%6]),u.style.setProperty("--c2",l[(d+2)%6]),u.style.setProperty("--c3",l[(d+3)%6]),u.style.setProperty("--c4",l[(d+4)%6]),u.style.setProperty("--c5",l[(d+5)%6]),u.classList.add("rotate")})}if(s&&o[2]){const c=s.cloneNode(!0);o[2].appendChild(c),c.querySelectorAll("polygon").forEach((l,u)=>{const d=l.getAttribute("fill")||"#000";l.style.setProperty("--original-fill",d),l.classList.add("pulse");const h=Math.floor(u/2);l.style.animationDelay=`${h*.4}s`})}if(s&&o[3]){const c=s.cloneNode(!0);o[3].appendChild(c);const f=c.querySelectorAll("polygon");f.forEach((u,d)=>{const h=u.getAttribute("fill")||"#000";u.style.setProperty("--original-fill",h);let x="";d===0||d===1?x="translate(15px, 15px)":d===2||d===3?x="translate(-15px, 15px)":(d===4||d===5)&&(x="translate(0px, -15px)"),u.style.setProperty("--move",x)}),[[0,1],[2,3],[4,5]].forEach((u,d)=>{u.forEach(h=>{const x=f[h];setTimeout(()=>{x.classList.add("group-animate")},d*1500)})})}}catch(t){console.error("Failed to load SVG:",t)}}}customElements.define("logo-page",_A);window.addEventListener("DOMContentLoaded",()=>{eb();let e=document.querySelector("main-header");e||(e=document.createElement("main-header"),document.body.prepend(e));let r=document.getElementById("mainContainer");r||(r=document.createElement("div"),r.id="mainContainer",document.body.appendChild(r)),Id()});async function Id(){const e=document.querySelector("main-header"),r=document.getElementById("mainContainer"),t=document.getElementById("login"),n=document.querySelector("main-header").shadowRoot.querySelector("#logoutButton");n.onclick=async()=>{console.log("Logout button clicked"),await Fo.signOut(),r.innerHTML="",e.style.display="none",n.style.display="none",e.classList.remove("visible"),r.classList.remove("visible"),r.classList.add("hidden"),t.resetSendLinkButton(),t.show()},await Fo.isAuthenticated()?(console.log("User is authenticated - showing header + main container"),e.style.display="block",n.style.display="block",r.classList.remove("hidden"),t.style.display="none",r.innerHTML="",r.appendChild(document.createElement("tree-bom-page")),vA(),setTimeout(()=>{e.classList.add("visible"),r.classList.add("visible")},50)):(console.log("User is NOT authenticated - hiding header + showing login"),e.style.display="none",n.style.display="none",r.innerHTML="",t.show())}function ro(e){const r=document.getElementById("mainContainer");r.innerHTML="",e.classList.add("page-content","slide-up-enter"),r.appendChild(e),requestAnimationFrame(()=>{e.classList.add("slide-up-enter-active")}),setTimeout(()=>{e.classList.remove("slide-up-enter","slide-up-enter-active")},300)}function vA(){document.addEventListener("navigate",e=>{const r=e.detail;r==="treebom"?ro(document.createElement("tree-bom-page")):r==="cluster"?ro(document.createElement("cluster-page")):r==="logo"&&ro(document.createElement("logo-page"))})}let no=!1;document.addEventListener("toggleDarkMode",()=>{no=!no,document.body.classList.toggle("dark-mode",no)});document.addEventListener("login-success",()=>{console.log("login-success event received - re-checking auth via init()"),Id()});
