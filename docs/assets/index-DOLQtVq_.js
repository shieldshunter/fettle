var Ud=Object.defineProperty;var $d=(e,r,t)=>r in e?Ud(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var At=(e,r,t)=>$d(e,typeof r!="symbol"?r+"":r,t);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();const Hd=Math.sqrt(50),Wd=Math.sqrt(10),Vd=Math.sqrt(2);function As(e,r,t){const n=(r-e)/Math.max(0,t),a=Math.floor(Math.log10(n)),s=n/Math.pow(10,a),i=s>=Hd?10:s>=Wd?5:s>=Vd?2:1;let c,f,o;return a<0?(o=Math.pow(10,-a)/i,c=Math.round(e*o),f=Math.round(r*o),c/o<e&&++c,f/o>r&&--f,o=-o):(o=Math.pow(10,a)*i,c=Math.round(e/o),f=Math.round(r/o),c*o<e&&++c,f*o>r&&--f),f<c&&.5<=t&&t<2?As(e,r,t*2):[c,f,o]}function Gd(e,r,t){if(r=+r,e=+e,t=+t,!(t>0))return[];if(e===r)return[e];const n=r<e,[a,s,i]=n?As(r,e,t):As(e,r,t);if(!(s>=a))return[];const c=s-a+1,f=new Array(c);if(n)if(i<0)for(let o=0;o<c;++o)f[o]=(s-o)/-i;else for(let o=0;o<c;++o)f[o]=(s-o)*i;else if(i<0)for(let o=0;o<c;++o)f[o]=(a+o)/-i;else for(let o=0;o<c;++o)f[o]=(a+o)*i;return f}function Yi(e,r,t){return r=+r,e=+e,t=+t,As(e,r,t)[2]}function zd(e,r,t){r=+r,e=+e,t=+t;const n=r<e,a=n?Yi(r,e,t):Yi(e,r,t);return(n?-1:1)*(a<0?1/-a:a)}function Xd(e,r){let t;if(r===void 0)for(const n of e)n!=null&&(t<n||t===void 0&&n>=n)&&(t=n);else{let n=-1;for(let a of e)(a=r(a,++n,e))!=null&&(t<a||t===void 0&&a>=a)&&(t=a)}return t}var Yd={value:()=>{}};function I0(){for(var e=0,r=arguments.length,t={},n;e<r;++e){if(!(n=arguments[e]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new xs(t)}function xs(e){this._=e}function jd(e,r){return e.trim().split(/^|\s+/).map(function(t){var n="",a=t.indexOf(".");if(a>=0&&(n=t.slice(a+1),t=t.slice(0,a)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}xs.prototype=I0.prototype={constructor:xs,on:function(e,r){var t=this._,n=jd(e+"",t),a,s=-1,i=n.length;if(arguments.length<2){for(;++s<i;)if((a=(e=n[s]).type)&&(a=Kd(t[a],e.name)))return a;return}if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++s<i;)if(a=(e=n[s]).type)t[a]=jc(t[a],e.name,r);else if(r==null)for(a in t)t[a]=jc(t[a],e.name,null);return this},copy:function(){var e={},r=this._;for(var t in r)e[t]=r[t].slice();return new xs(e)},call:function(e,r){if((a=arguments.length-2)>0)for(var t=new Array(a),n=0,a,s;n<a;++n)t[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],n=0,a=s.length;n<a;++n)s[n].value.apply(r,t)},apply:function(e,r,t){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],a=0,s=n.length;a<s;++a)n[a].value.apply(r,t)}};function Kd(e,r){for(var t=0,n=e.length,a;t<n;++t)if((a=e[t]).name===r)return a.value}function jc(e,r,t){for(var n=0,a=e.length;n<a;++n)if(e[n].name===r){e[n]=Yd,e=e.slice(0,n).concat(e.slice(n+1));break}return t!=null&&e.push({name:r,value:t}),e}var ji="http://www.w3.org/1999/xhtml";const Kc={svg:"http://www.w3.org/2000/svg",xhtml:ji,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Js(e){var r=e+="",t=r.indexOf(":");return t>=0&&(r=e.slice(0,t))!=="xmlns"&&(e=e.slice(t+1)),Kc.hasOwnProperty(r)?{space:Kc[r],local:e}:e}function qd(e){return function(){var r=this.ownerDocument,t=this.namespaceURI;return t===ji&&r.documentElement.namespaceURI===ji?r.createElement(e):r.createElementNS(t,e)}}function Jd(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function O0(e){var r=Js(e);return(r.local?Jd:qd)(r)}function Zd(){}function D0(e){return e==null?Zd:function(){return this.querySelector(e)}}function Qd(e){typeof e!="function"&&(e=D0(e));for(var r=this._groups,t=r.length,n=new Array(t),a=0;a<t;++a)for(var s=r[a],i=s.length,c=n[a]=new Array(i),f,o,l=0;l<i;++l)(f=s[l])&&(o=e.call(f,f.__data__,l,s))&&("__data__"in f&&(o.__data__=f.__data__),c[l]=o);return new It(n,this._parents)}function e1(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function t1(){return[]}function Kf(e){return e==null?t1:function(){return this.querySelectorAll(e)}}function r1(e){return function(){return e1(e.apply(this,arguments))}}function n1(e){typeof e=="function"?e=r1(e):e=Kf(e);for(var r=this._groups,t=r.length,n=[],a=[],s=0;s<t;++s)for(var i=r[s],c=i.length,f,o=0;o<c;++o)(f=i[o])&&(n.push(e.call(f,f.__data__,o,i)),a.push(f));return new It(n,a)}function qf(e){return function(){return this.matches(e)}}function Jf(e){return function(r){return r.matches(e)}}var a1=Array.prototype.find;function s1(e){return function(){return a1.call(this.children,e)}}function i1(){return this.firstElementChild}function c1(e){return this.select(e==null?i1:s1(typeof e=="function"?e:Jf(e)))}var o1=Array.prototype.filter;function f1(){return Array.from(this.children)}function l1(e){return function(){return o1.call(this.children,e)}}function u1(e){return this.selectAll(e==null?f1:l1(typeof e=="function"?e:Jf(e)))}function h1(e){typeof e!="function"&&(e=qf(e));for(var r=this._groups,t=r.length,n=new Array(t),a=0;a<t;++a)for(var s=r[a],i=s.length,c=n[a]=[],f,o=0;o<i;++o)(f=s[o])&&e.call(f,f.__data__,o,s)&&c.push(f);return new It(n,this._parents)}function Zf(e){return new Array(e.length)}function d1(){return new It(this._enter||this._groups.map(Zf),this._parents)}function Ss(e,r){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=r}Ss.prototype={constructor:Ss,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,r){return this._parent.insertBefore(e,r)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function x1(e){return function(){return e}}function p1(e,r,t,n,a,s){for(var i=0,c,f=r.length,o=s.length;i<o;++i)(c=r[i])?(c.__data__=s[i],n[i]=c):t[i]=new Ss(e,s[i]);for(;i<f;++i)(c=r[i])&&(a[i]=c)}function m1(e,r,t,n,a,s,i){var c,f,o=new Map,l=r.length,u=s.length,h=new Array(l),d;for(c=0;c<l;++c)(f=r[c])&&(h[c]=d=i.call(f,f.__data__,c,r)+"",o.has(d)?a[c]=f:o.set(d,f));for(c=0;c<u;++c)d=i.call(e,s[c],c,s)+"",(f=o.get(d))?(n[c]=f,f.__data__=s[c],o.delete(d)):t[c]=new Ss(e,s[c]);for(c=0;c<l;++c)(f=r[c])&&o.get(h[c])===f&&(a[c]=f)}function g1(e){return e.__data__}function v1(e,r){if(!arguments.length)return Array.from(this,g1);var t=r?m1:p1,n=this._parents,a=this._groups;typeof e!="function"&&(e=x1(e));for(var s=a.length,i=new Array(s),c=new Array(s),f=new Array(s),o=0;o<s;++o){var l=n[o],u=a[o],h=u.length,d=_1(e.call(l,l&&l.__data__,o,n)),x=d.length,p=c[o]=new Array(x),m=i[o]=new Array(x),_=f[o]=new Array(h);t(l,u,p,m,_,d,r);for(var w=0,v=0,C,O;w<x;++w)if(C=p[w]){for(w>=v&&(v=w+1);!(O=m[v])&&++v<x;);C._next=O||null}}return i=new It(i,n),i._enter=c,i._exit=f,i}function _1(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function w1(){return new It(this._exit||this._groups.map(Zf),this._parents)}function y1(e,r,t){var n=this.enter(),a=this,s=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),r!=null&&(a=r(a),a&&(a=a.selection())),t==null?s.remove():t(s),n&&a?n.merge(a).order():a}function E1(e){for(var r=e.selection?e.selection():e,t=this._groups,n=r._groups,a=t.length,s=n.length,i=Math.min(a,s),c=new Array(a),f=0;f<i;++f)for(var o=t[f],l=n[f],u=o.length,h=c[f]=new Array(u),d,x=0;x<u;++x)(d=o[x]||l[x])&&(h[x]=d);for(;f<a;++f)c[f]=t[f];return new It(c,this._parents)}function k1(){for(var e=this._groups,r=-1,t=e.length;++r<t;)for(var n=e[r],a=n.length-1,s=n[a],i;--a>=0;)(i=n[a])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function T1(e){e||(e=A1);function r(u,h){return u&&h?e(u.__data__,h.__data__):!u-!h}for(var t=this._groups,n=t.length,a=new Array(n),s=0;s<n;++s){for(var i=t[s],c=i.length,f=a[s]=new Array(c),o,l=0;l<c;++l)(o=i[l])&&(f[l]=o);f.sort(r)}return new It(a,this._parents).order()}function A1(e,r){return e<r?-1:e>r?1:e>=r?0:NaN}function S1(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function F1(){return Array.from(this)}function C1(){for(var e=this._groups,r=0,t=e.length;r<t;++r)for(var n=e[r],a=0,s=n.length;a<s;++a){var i=n[a];if(i)return i}return null}function b1(){let e=0;for(const r of this)++e;return e}function R1(){return!this.node()}function I1(e){for(var r=this._groups,t=0,n=r.length;t<n;++t)for(var a=r[t],s=0,i=a.length,c;s<i;++s)(c=a[s])&&e.call(c,c.__data__,s,a);return this}function O1(e){return function(){this.removeAttribute(e)}}function D1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function P1(e,r){return function(){this.setAttribute(e,r)}}function N1(e,r){return function(){this.setAttributeNS(e.space,e.local,r)}}function M1(e,r){return function(){var t=r.apply(this,arguments);t==null?this.removeAttribute(e):this.setAttribute(e,t)}}function L1(e,r){return function(){var t=r.apply(this,arguments);t==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}function B1(e,r){var t=Js(e);if(arguments.length<2){var n=this.node();return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}return this.each((r==null?t.local?D1:O1:typeof r=="function"?t.local?L1:M1:t.local?N1:P1)(t,r))}function Qf(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function U1(e){return function(){this.style.removeProperty(e)}}function $1(e,r,t){return function(){this.style.setProperty(e,r,t)}}function H1(e,r,t){return function(){var n=r.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,t)}}function W1(e,r,t){return arguments.length>1?this.each((r==null?U1:typeof r=="function"?H1:$1)(e,r,t??"")):bn(this.node(),e)}function bn(e,r){return e.style.getPropertyValue(r)||Qf(e).getComputedStyle(e,null).getPropertyValue(r)}function V1(e){return function(){delete this[e]}}function G1(e,r){return function(){this[e]=r}}function z1(e,r){return function(){var t=r.apply(this,arguments);t==null?delete this[e]:this[e]=t}}function X1(e,r){return arguments.length>1?this.each((r==null?V1:typeof r=="function"?z1:G1)(e,r)):this.node()[e]}function el(e){return e.trim().split(/^|\s+/)}function P0(e){return e.classList||new tl(e)}function tl(e){this._node=e,this._names=el(e.getAttribute("class")||"")}tl.prototype={add:function(e){var r=this._names.indexOf(e);r<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var r=this._names.indexOf(e);r>=0&&(this._names.splice(r,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function rl(e,r){for(var t=P0(e),n=-1,a=r.length;++n<a;)t.add(r[n])}function nl(e,r){for(var t=P0(e),n=-1,a=r.length;++n<a;)t.remove(r[n])}function Y1(e){return function(){rl(this,e)}}function j1(e){return function(){nl(this,e)}}function K1(e,r){return function(){(r.apply(this,arguments)?rl:nl)(this,e)}}function q1(e,r){var t=el(e+"");if(arguments.length<2){for(var n=P0(this.node()),a=-1,s=t.length;++a<s;)if(!n.contains(t[a]))return!1;return!0}return this.each((typeof r=="function"?K1:r?Y1:j1)(t,r))}function J1(){this.textContent=""}function Z1(e){return function(){this.textContent=e}}function Q1(e){return function(){var r=e.apply(this,arguments);this.textContent=r??""}}function ex(e){return arguments.length?this.each(e==null?J1:(typeof e=="function"?Q1:Z1)(e)):this.node().textContent}function tx(){this.innerHTML=""}function rx(e){return function(){this.innerHTML=e}}function nx(e){return function(){var r=e.apply(this,arguments);this.innerHTML=r??""}}function ax(e){return arguments.length?this.each(e==null?tx:(typeof e=="function"?nx:rx)(e)):this.node().innerHTML}function sx(){this.nextSibling&&this.parentNode.appendChild(this)}function ix(){return this.each(sx)}function cx(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ox(){return this.each(cx)}function fx(e){var r=typeof e=="function"?e:O0(e);return this.select(function(){return this.appendChild(r.apply(this,arguments))})}function lx(){return null}function ux(e,r){var t=typeof e=="function"?e:O0(e),n=r==null?lx:typeof r=="function"?r:D0(r);return this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})}function hx(){var e=this.parentNode;e&&e.removeChild(this)}function dx(){return this.each(hx)}function xx(){var e=this.cloneNode(!1),r=this.parentNode;return r?r.insertBefore(e,this.nextSibling):e}function px(){var e=this.cloneNode(!0),r=this.parentNode;return r?r.insertBefore(e,this.nextSibling):e}function mx(e){return this.select(e?px:xx)}function gx(e){return arguments.length?this.property("__data__",e):this.node().__data__}function vx(e){return function(r){e.call(this,r,this.__data__)}}function _x(e){return e.trim().split(/^|\s+/).map(function(r){var t="",n=r.indexOf(".");return n>=0&&(t=r.slice(n+1),r=r.slice(0,n)),{type:r,name:t}})}function wx(e){return function(){var r=this.__on;if(r){for(var t=0,n=-1,a=r.length,s;t<a;++t)s=r[t],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):r[++n]=s;++n?r.length=n:delete this.__on}}}function yx(e,r,t){return function(){var n=this.__on,a,s=vx(r);if(n){for(var i=0,c=n.length;i<c;++i)if((a=n[i]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=s,a.options=t),a.value=r;return}}this.addEventListener(e.type,s,t),a={type:e.type,name:e.name,value:r,listener:s,options:t},n?n.push(a):this.__on=[a]}}function Ex(e,r,t){var n=_x(e+""),a,s=n.length,i;if(arguments.length<2){var c=this.node().__on;if(c){for(var f=0,o=c.length,l;f<o;++f)for(a=0,l=c[f];a<s;++a)if((i=n[a]).type===l.type&&i.name===l.name)return l.value}return}for(c=r?yx:wx,a=0;a<s;++a)this.each(c(n[a],r,t));return this}function al(e,r,t){var n=Qf(e),a=n.CustomEvent;typeof a=="function"?a=new a(r,t):(a=n.document.createEvent("Event"),t?(a.initEvent(r,t.bubbles,t.cancelable),a.detail=t.detail):a.initEvent(r,!1,!1)),e.dispatchEvent(a)}function kx(e,r){return function(){return al(this,e,r)}}function Tx(e,r){return function(){return al(this,e,r.apply(this,arguments))}}function Ax(e,r){return this.each((typeof r=="function"?Tx:kx)(e,r))}function*Sx(){for(var e=this._groups,r=0,t=e.length;r<t;++r)for(var n=e[r],a=0,s=n.length,i;a<s;++a)(i=n[a])&&(yield i)}var sl=[null];function It(e,r){this._groups=e,this._parents=r}function Ia(){return new It([[document.documentElement]],sl)}function Fx(){return this}It.prototype=Ia.prototype={constructor:It,select:Qd,selectAll:n1,selectChild:c1,selectChildren:u1,filter:h1,data:v1,enter:d1,exit:w1,join:y1,merge:E1,selection:Fx,order:k1,sort:T1,call:S1,nodes:F1,node:C1,size:b1,empty:R1,each:I1,attr:B1,style:W1,property:X1,classed:q1,text:ex,html:ax,raise:ix,lower:ox,append:fx,insert:ux,remove:dx,clone:mx,datum:gx,on:Ex,dispatch:Ax,[Symbol.iterator]:Sx};function Bt(e){return typeof e=="string"?new It([[document.querySelector(e)]],[document.documentElement]):new It([[e]],sl)}function Cx(e){return Bt(O0(e).call(document.documentElement))}function bx(e){let r;for(;r=e.sourceEvent;)e=r;return e}function Wr(e,r){if(e=bx(e),r===void 0&&(r=e.currentTarget),r){var t=r.ownerSVGElement||r;if(t.createSVGPoint){var n=t.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(r.getScreenCTM().inverse()),[n.x,n.y]}if(r.getBoundingClientRect){var a=r.getBoundingClientRect();return[e.clientX-a.left-r.clientLeft,e.clientY-a.top-r.clientTop]}}return[e.pageX,e.pageY]}const Ki={capture:!0,passive:!1};function qi(e){e.preventDefault(),e.stopImmediatePropagation()}function Rx(e){var r=e.document.documentElement,t=Bt(e).on("dragstart.drag",qi,Ki);"onselectstart"in r?t.on("selectstart.drag",qi,Ki):(r.__noselect=r.style.MozUserSelect,r.style.MozUserSelect="none")}function Ix(e,r){var t=e.document.documentElement,n=Bt(e).on("dragstart.drag",null);r&&(n.on("click.drag",qi,Ki),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in t?n.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}function N0(e,r,t){e.prototype=r.prototype=t,t.constructor=e}function il(e,r){var t=Object.create(e.prototype);for(var n in r)t[n]=r[n];return t}function Oa(){}var va=.7,Fs=1/va,yn="\\s*([+-]?\\d+)\\s*",_a="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",or="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ox=/^#([0-9a-f]{3,8})$/,Dx=new RegExp(`^rgb\\(${yn},${yn},${yn}\\)$`),Px=new RegExp(`^rgb\\(${or},${or},${or}\\)$`),Nx=new RegExp(`^rgba\\(${yn},${yn},${yn},${_a}\\)$`),Mx=new RegExp(`^rgba\\(${or},${or},${or},${_a}\\)$`),Lx=new RegExp(`^hsl\\(${_a},${or},${or}\\)$`),Bx=new RegExp(`^hsla\\(${_a},${or},${or},${_a}\\)$`),qc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};N0(Oa,Qr,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Jc,formatHex:Jc,formatHex8:Ux,formatHsl:$x,formatRgb:Zc,toString:Zc});function Jc(){return this.rgb().formatHex()}function Ux(){return this.rgb().formatHex8()}function $x(){return cl(this).formatHsl()}function Zc(){return this.rgb().formatRgb()}function Qr(e){var r,t;return e=(e+"").trim().toLowerCase(),(r=Ox.exec(e))?(t=r[1].length,r=parseInt(r[1],16),t===6?Qc(r):t===3?new Et(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):t===8?za(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):t===4?za(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=Dx.exec(e))?new Et(r[1],r[2],r[3],1):(r=Px.exec(e))?new Et(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=Nx.exec(e))?za(r[1],r[2],r[3],r[4]):(r=Mx.exec(e))?za(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=Lx.exec(e))?ro(r[1],r[2]/100,r[3]/100,1):(r=Bx.exec(e))?ro(r[1],r[2]/100,r[3]/100,r[4]):qc.hasOwnProperty(e)?Qc(qc[e]):e==="transparent"?new Et(NaN,NaN,NaN,0):null}function Qc(e){return new Et(e>>16&255,e>>8&255,e&255,1)}function za(e,r,t,n){return n<=0&&(e=r=t=NaN),new Et(e,r,t,n)}function Hx(e){return e instanceof Oa||(e=Qr(e)),e?(e=e.rgb(),new Et(e.r,e.g,e.b,e.opacity)):new Et}function Cs(e,r,t,n){return arguments.length===1?Hx(e):new Et(e,r,t,n??1)}function Et(e,r,t,n){this.r=+e,this.g=+r,this.b=+t,this.opacity=+n}N0(Et,Cs,il(Oa,{brighter(e){return e=e==null?Fs:Math.pow(Fs,e),new Et(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?va:Math.pow(va,e),new Et(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Et(qr(this.r),qr(this.g),qr(this.b),bs(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:eo,formatHex:eo,formatHex8:Wx,formatRgb:to,toString:to}));function eo(){return`#${Yr(this.r)}${Yr(this.g)}${Yr(this.b)}`}function Wx(){return`#${Yr(this.r)}${Yr(this.g)}${Yr(this.b)}${Yr((isNaN(this.opacity)?1:this.opacity)*255)}`}function to(){const e=bs(this.opacity);return`${e===1?"rgb(":"rgba("}${qr(this.r)}, ${qr(this.g)}, ${qr(this.b)}${e===1?")":`, ${e})`}`}function bs(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function qr(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Yr(e){return e=qr(e),(e<16?"0":"")+e.toString(16)}function ro(e,r,t,n){return n<=0?e=r=t=NaN:t<=0||t>=1?e=r=NaN:r<=0&&(e=NaN),new Xt(e,r,t,n)}function cl(e){if(e instanceof Xt)return new Xt(e.h,e.s,e.l,e.opacity);if(e instanceof Oa||(e=Qr(e)),!e)return new Xt;if(e instanceof Xt)return e;e=e.rgb();var r=e.r/255,t=e.g/255,n=e.b/255,a=Math.min(r,t,n),s=Math.max(r,t,n),i=NaN,c=s-a,f=(s+a)/2;return c?(r===s?i=(t-n)/c+(t<n)*6:t===s?i=(n-r)/c+2:i=(r-t)/c+4,c/=f<.5?s+a:2-s-a,i*=60):c=f>0&&f<1?0:i,new Xt(i,c,f,e.opacity)}function Vx(e,r,t,n){return arguments.length===1?cl(e):new Xt(e,r,t,n??1)}function Xt(e,r,t,n){this.h=+e,this.s=+r,this.l=+t,this.opacity=+n}N0(Xt,Vx,il(Oa,{brighter(e){return e=e==null?Fs:Math.pow(Fs,e),new Xt(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?va:Math.pow(va,e),new Xt(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*r,a=2*t-n;return new Et(mi(e>=240?e-240:e+120,a,n),mi(e,a,n),mi(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Xt(no(this.h),Xa(this.s),Xa(this.l),bs(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=bs(this.opacity);return`${e===1?"hsl(":"hsla("}${no(this.h)}, ${Xa(this.s)*100}%, ${Xa(this.l)*100}%${e===1?")":`, ${e})`}`}}));function no(e){return e=(e||0)%360,e<0?e+360:e}function Xa(e){return Math.max(0,Math.min(1,e||0))}function mi(e,r,t){return(e<60?r+(t-r)*e/60:e<180?t:e<240?r+(t-r)*(240-e)/60:r)*255}function Gx(e,r,t,n,a){var s=e*e,i=s*e;return((1-3*e+3*s-i)*r+(4-6*s+3*i)*t+(1+3*e+3*s-3*i)*n+i*a)/6}function zx(e){var r=e.length-1;return function(t){var n=t<=0?t=0:t>=1?(t=1,r-1):Math.floor(t*r),a=e[n],s=e[n+1],i=n>0?e[n-1]:2*a-s,c=n<r-1?e[n+2]:2*s-a;return Gx((t-n/r)*r,i,a,s,c)}}const M0=e=>()=>e;function Xx(e,r){return function(t){return e+t*r}}function Yx(e,r,t){return e=Math.pow(e,t),r=Math.pow(r,t)-e,t=1/t,function(n){return Math.pow(e+n*r,t)}}function jx(e){return(e=+e)==1?ol:function(r,t){return t-r?Yx(r,t,e):M0(isNaN(r)?t:r)}}function ol(e,r){var t=r-e;return t?Xx(e,t):M0(isNaN(e)?r:e)}const Rs=function e(r){var t=jx(r);function n(a,s){var i=t((a=Cs(a)).r,(s=Cs(s)).r),c=t(a.g,s.g),f=t(a.b,s.b),o=ol(a.opacity,s.opacity);return function(l){return a.r=i(l),a.g=c(l),a.b=f(l),a.opacity=o(l),a+""}}return n.gamma=e,n}(1);function Kx(e){return function(r){var t=r.length,n=new Array(t),a=new Array(t),s=new Array(t),i,c;for(i=0;i<t;++i)c=Cs(r[i]),n[i]=c.r||0,a[i]=c.g||0,s[i]=c.b||0;return n=e(n),a=e(a),s=e(s),c.opacity=1,function(f){return c.r=n(f),c.g=a(f),c.b=s(f),c+""}}}var qx=Kx(zx);function Jx(e,r){r||(r=[]);var t=e?Math.min(r.length,e.length):0,n=r.slice(),a;return function(s){for(a=0;a<t;++a)n[a]=e[a]*(1-s)+r[a]*s;return n}}function Zx(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Qx(e,r){var t=r?r.length:0,n=e?Math.min(t,e.length):0,a=new Array(n),s=new Array(t),i;for(i=0;i<n;++i)a[i]=L0(e[i],r[i]);for(;i<t;++i)s[i]=r[i];return function(c){for(i=0;i<n;++i)s[i]=a[i](c);return s}}function ep(e,r){var t=new Date;return e=+e,r=+r,function(n){return t.setTime(e*(1-n)+r*n),t}}function ir(e,r){return e=+e,r=+r,function(t){return e*(1-t)+r*t}}function tp(e,r){var t={},n={},a;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(a in r)a in e?t[a]=L0(e[a],r[a]):n[a]=r[a];return function(s){for(a in t)n[a]=t[a](s);return n}}var Ji=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gi=new RegExp(Ji.source,"g");function rp(e){return function(){return e}}function np(e){return function(r){return e(r)+""}}function fl(e,r){var t=Ji.lastIndex=gi.lastIndex=0,n,a,s,i=-1,c=[],f=[];for(e=e+"",r=r+"";(n=Ji.exec(e))&&(a=gi.exec(r));)(s=a.index)>t&&(s=r.slice(t,s),c[i]?c[i]+=s:c[++i]=s),(n=n[0])===(a=a[0])?c[i]?c[i]+=a:c[++i]=a:(c[++i]=null,f.push({i,x:ir(n,a)})),t=gi.lastIndex;return t<r.length&&(s=r.slice(t),c[i]?c[i]+=s:c[++i]=s),c.length<2?f[0]?np(f[0].x):rp(r):(r=f.length,function(o){for(var l=0,u;l<r;++l)c[(u=f[l]).i]=u.x(o);return c.join("")})}function L0(e,r){var t=typeof r,n;return r==null||t==="boolean"?M0(r):(t==="number"?ir:t==="string"?(n=Qr(r))?(r=n,Rs):fl:r instanceof Qr?Rs:r instanceof Date?ep:Zx(r)?Jx:Array.isArray(r)?Qx:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?tp:ir)(e,r)}function ap(e,r){return e=+e,r=+r,function(t){return Math.round(e*(1-t)+r*t)}}var ao=180/Math.PI,Zi={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ll(e,r,t,n,a,s){var i,c,f;return(i=Math.sqrt(e*e+r*r))&&(e/=i,r/=i),(f=e*t+r*n)&&(t-=e*f,n-=r*f),(c=Math.sqrt(t*t+n*n))&&(t/=c,n/=c,f/=c),e*n<r*t&&(e=-e,r=-r,f=-f,i=-i),{translateX:a,translateY:s,rotate:Math.atan2(r,e)*ao,skewX:Math.atan(f)*ao,scaleX:i,scaleY:c}}var Ya;function sp(e){const r=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return r.isIdentity?Zi:ll(r.a,r.b,r.c,r.d,r.e,r.f)}function ip(e){return e==null||(Ya||(Ya=document.createElementNS("http://www.w3.org/2000/svg","g")),Ya.setAttribute("transform",e),!(e=Ya.transform.baseVal.consolidate()))?Zi:(e=e.matrix,ll(e.a,e.b,e.c,e.d,e.e,e.f))}function ul(e,r,t,n){function a(o){return o.length?o.pop()+" ":""}function s(o,l,u,h,d,x){if(o!==u||l!==h){var p=d.push("translate(",null,r,null,t);x.push({i:p-4,x:ir(o,u)},{i:p-2,x:ir(l,h)})}else(u||h)&&d.push("translate("+u+r+h+t)}function i(o,l,u,h){o!==l?(o-l>180?l+=360:l-o>180&&(o+=360),h.push({i:u.push(a(u)+"rotate(",null,n)-2,x:ir(o,l)})):l&&u.push(a(u)+"rotate("+l+n)}function c(o,l,u,h){o!==l?h.push({i:u.push(a(u)+"skewX(",null,n)-2,x:ir(o,l)}):l&&u.push(a(u)+"skewX("+l+n)}function f(o,l,u,h,d,x){if(o!==u||l!==h){var p=d.push(a(d)+"scale(",null,",",null,")");x.push({i:p-4,x:ir(o,u)},{i:p-2,x:ir(l,h)})}else(u!==1||h!==1)&&d.push(a(d)+"scale("+u+","+h+")")}return function(o,l){var u=[],h=[];return o=e(o),l=e(l),s(o.translateX,o.translateY,l.translateX,l.translateY,u,h),i(o.rotate,l.rotate,u,h),c(o.skewX,l.skewX,u,h),f(o.scaleX,o.scaleY,l.scaleX,l.scaleY,u,h),o=l=null,function(d){for(var x=-1,p=h.length,m;++x<p;)u[(m=h[x]).i]=m.x(d);return u.join("")}}}var cp=ul(sp,"px, ","px)","deg)"),op=ul(ip,", ",")",")"),fp=1e-12;function so(e){return((e=Math.exp(e))+1/e)/2}function lp(e){return((e=Math.exp(e))-1/e)/2}function up(e){return((e=Math.exp(2*e))-1)/(e+1)}const hp=function e(r,t,n){function a(s,i){var c=s[0],f=s[1],o=s[2],l=i[0],u=i[1],h=i[2],d=l-c,x=u-f,p=d*d+x*x,m,_;if(p<fp)_=Math.log(h/o)/r,m=function(k){return[c+k*d,f+k*x,o*Math.exp(r*k*_)]};else{var w=Math.sqrt(p),v=(h*h-o*o+n*p)/(2*o*t*w),C=(h*h-o*o-n*p)/(2*h*t*w),O=Math.log(Math.sqrt(v*v+1)-v),R=Math.log(Math.sqrt(C*C+1)-C);_=(R-O)/r,m=function(k){var U=k*_,I=so(O),z=o/(t*w)*(I*up(r*U+O)-lp(O));return[c+z*d,f+z*x,o*I/so(r*U+O)]}}return m.duration=_*1e3*r/Math.SQRT2,m}return a.rho=function(s){var i=Math.max(.001,+s),c=i*i,f=c*c;return e(i,c,f)},a}(Math.SQRT2,2,4);var Rn=0,Kn=0,Yn=0,hl=1e3,Is,qn,Os=0,en=0,Zs=0,wa=typeof performance=="object"&&performance.now?performance:Date,dl=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function B0(){return en||(dl(dp),en=wa.now()+Zs)}function dp(){en=0}function Ds(){this._call=this._time=this._next=null}Ds.prototype=xl.prototype={constructor:Ds,restart:function(e,r,t){if(typeof e!="function")throw new TypeError("callback is not a function");t=(t==null?B0():+t)+(r==null?0:+r),!this._next&&qn!==this&&(qn?qn._next=this:Is=this,qn=this),this._call=e,this._time=t,Qi()},stop:function(){this._call&&(this._call=null,this._time=1/0,Qi())}};function xl(e,r,t){var n=new Ds;return n.restart(e,r,t),n}function xp(){B0(),++Rn;for(var e=Is,r;e;)(r=en-e._time)>=0&&e._call.call(void 0,r),e=e._next;--Rn}function io(){en=(Os=wa.now())+Zs,Rn=Kn=0;try{xp()}finally{Rn=0,mp(),en=0}}function pp(){var e=wa.now(),r=e-Os;r>hl&&(Zs-=r,Os=e)}function mp(){for(var e,r=Is,t,n=1/0;r;)r._call?(n>r._time&&(n=r._time),e=r,r=r._next):(t=r._next,r._next=null,r=e?e._next=t:Is=t);qn=e,Qi(n)}function Qi(e){if(!Rn){Kn&&(Kn=clearTimeout(Kn));var r=e-en;r>24?(e<1/0&&(Kn=setTimeout(io,e-wa.now()-Zs)),Yn&&(Yn=clearInterval(Yn))):(Yn||(Os=wa.now(),Yn=setInterval(pp,hl)),Rn=1,dl(io))}}function co(e,r,t){var n=new Ds;return r=r==null?0:+r,n.restart(a=>{n.stop(),e(a+r)},r,t),n}var gp=I0("start","end","cancel","interrupt"),vp=[],pl=0,oo=1,e0=2,ps=3,fo=4,t0=5,ms=6;function Qs(e,r,t,n,a,s){var i=e.__transition;if(!i)e.__transition={};else if(t in i)return;_p(e,t,{name:r,index:n,group:a,on:gp,tween:vp,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:pl})}function U0(e,r){var t=Zt(e,r);if(t.state>pl)throw new Error("too late; already scheduled");return t}function lr(e,r){var t=Zt(e,r);if(t.state>ps)throw new Error("too late; already running");return t}function Zt(e,r){var t=e.__transition;if(!t||!(t=t[r]))throw new Error("transition not found");return t}function _p(e,r,t){var n=e.__transition,a;n[r]=t,t.timer=xl(s,0,t.time);function s(o){t.state=oo,t.timer.restart(i,t.delay,t.time),t.delay<=o&&i(o-t.delay)}function i(o){var l,u,h,d;if(t.state!==oo)return f();for(l in n)if(d=n[l],d.name===t.name){if(d.state===ps)return co(i);d.state===fo?(d.state=ms,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete n[l]):+l<r&&(d.state=ms,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete n[l])}if(co(function(){t.state===ps&&(t.state=fo,t.timer.restart(c,t.delay,t.time),c(o))}),t.state=e0,t.on.call("start",e,e.__data__,t.index,t.group),t.state===e0){for(t.state=ps,a=new Array(h=t.tween.length),l=0,u=-1;l<h;++l)(d=t.tween[l].value.call(e,e.__data__,t.index,t.group))&&(a[++u]=d);a.length=u+1}}function c(o){for(var l=o<t.duration?t.ease.call(null,o/t.duration):(t.timer.restart(f),t.state=t0,1),u=-1,h=a.length;++u<h;)a[u].call(e,l);t.state===t0&&(t.on.call("end",e,e.__data__,t.index,t.group),f())}function f(){t.state=ms,t.timer.stop(),delete n[r];for(var o in n)return;delete e.__transition}}function gs(e,r){var t=e.__transition,n,a,s=!0,i;if(t){r=r==null?null:r+"";for(i in t){if((n=t[i]).name!==r){s=!1;continue}a=n.state>e0&&n.state<t0,n.state=ms,n.timer.stop(),n.on.call(a?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete t[i]}s&&delete e.__transition}}function wp(e){return this.each(function(){gs(this,e)})}function yp(e,r){var t,n;return function(){var a=lr(this,e),s=a.tween;if(s!==t){n=t=s;for(var i=0,c=n.length;i<c;++i)if(n[i].name===r){n=n.slice(),n.splice(i,1);break}}a.tween=n}}function Ep(e,r,t){var n,a;if(typeof t!="function")throw new Error;return function(){var s=lr(this,e),i=s.tween;if(i!==n){a=(n=i).slice();for(var c={name:r,value:t},f=0,o=a.length;f<o;++f)if(a[f].name===r){a[f]=c;break}f===o&&a.push(c)}s.tween=a}}function kp(e,r){var t=this._id;if(e+="",arguments.length<2){for(var n=Zt(this.node(),t).tween,a=0,s=n.length,i;a<s;++a)if((i=n[a]).name===e)return i.value;return null}return this.each((r==null?yp:Ep)(t,e,r))}function $0(e,r,t){var n=e._id;return e.each(function(){var a=lr(this,n);(a.value||(a.value={}))[r]=t.apply(this,arguments)}),function(a){return Zt(a,n).value[r]}}function ml(e,r){var t;return(typeof r=="number"?ir:r instanceof Qr?Rs:(t=Qr(r))?(r=t,Rs):fl)(e,r)}function Tp(e){return function(){this.removeAttribute(e)}}function Ap(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Sp(e,r,t){var n,a=t+"",s;return function(){var i=this.getAttribute(e);return i===a?null:i===n?s:s=r(n=i,t)}}function Fp(e,r,t){var n,a=t+"",s;return function(){var i=this.getAttributeNS(e.space,e.local);return i===a?null:i===n?s:s=r(n=i,t)}}function Cp(e,r,t){var n,a,s;return function(){var i,c=t(this),f;return c==null?void this.removeAttribute(e):(i=this.getAttribute(e),f=c+"",i===f?null:i===n&&f===a?s:(a=f,s=r(n=i,c)))}}function bp(e,r,t){var n,a,s;return function(){var i,c=t(this),f;return c==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),f=c+"",i===f?null:i===n&&f===a?s:(a=f,s=r(n=i,c)))}}function Rp(e,r){var t=Js(e),n=t==="transform"?op:ml;return this.attrTween(e,typeof r=="function"?(t.local?bp:Cp)(t,n,$0(this,"attr."+e,r)):r==null?(t.local?Ap:Tp)(t):(t.local?Fp:Sp)(t,n,r))}function Ip(e,r){return function(t){this.setAttribute(e,r.call(this,t))}}function Op(e,r){return function(t){this.setAttributeNS(e.space,e.local,r.call(this,t))}}function Dp(e,r){var t,n;function a(){var s=r.apply(this,arguments);return s!==n&&(t=(n=s)&&Op(e,s)),t}return a._value=r,a}function Pp(e,r){var t,n;function a(){var s=r.apply(this,arguments);return s!==n&&(t=(n=s)&&Ip(e,s)),t}return a._value=r,a}function Np(e,r){var t="attr."+e;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(r==null)return this.tween(t,null);if(typeof r!="function")throw new Error;var n=Js(e);return this.tween(t,(n.local?Dp:Pp)(n,r))}function Mp(e,r){return function(){U0(this,e).delay=+r.apply(this,arguments)}}function Lp(e,r){return r=+r,function(){U0(this,e).delay=r}}function Bp(e){var r=this._id;return arguments.length?this.each((typeof e=="function"?Mp:Lp)(r,e)):Zt(this.node(),r).delay}function Up(e,r){return function(){lr(this,e).duration=+r.apply(this,arguments)}}function $p(e,r){return r=+r,function(){lr(this,e).duration=r}}function Hp(e){var r=this._id;return arguments.length?this.each((typeof e=="function"?Up:$p)(r,e)):Zt(this.node(),r).duration}function Wp(e,r){if(typeof r!="function")throw new Error;return function(){lr(this,e).ease=r}}function Vp(e){var r=this._id;return arguments.length?this.each(Wp(r,e)):Zt(this.node(),r).ease}function Gp(e,r){return function(){var t=r.apply(this,arguments);if(typeof t!="function")throw new Error;lr(this,e).ease=t}}function zp(e){if(typeof e!="function")throw new Error;return this.each(Gp(this._id,e))}function Xp(e){typeof e!="function"&&(e=qf(e));for(var r=this._groups,t=r.length,n=new Array(t),a=0;a<t;++a)for(var s=r[a],i=s.length,c=n[a]=[],f,o=0;o<i;++o)(f=s[o])&&e.call(f,f.__data__,o,s)&&c.push(f);return new kr(n,this._parents,this._name,this._id)}function Yp(e){if(e._id!==this._id)throw new Error;for(var r=this._groups,t=e._groups,n=r.length,a=t.length,s=Math.min(n,a),i=new Array(n),c=0;c<s;++c)for(var f=r[c],o=t[c],l=f.length,u=i[c]=new Array(l),h,d=0;d<l;++d)(h=f[d]||o[d])&&(u[d]=h);for(;c<n;++c)i[c]=r[c];return new kr(i,this._parents,this._name,this._id)}function jp(e){return(e+"").trim().split(/^|\s+/).every(function(r){var t=r.indexOf(".");return t>=0&&(r=r.slice(0,t)),!r||r==="start"})}function Kp(e,r,t){var n,a,s=jp(r)?U0:lr;return function(){var i=s(this,e),c=i.on;c!==n&&(a=(n=c).copy()).on(r,t),i.on=a}}function qp(e,r){var t=this._id;return arguments.length<2?Zt(this.node(),t).on.on(e):this.each(Kp(t,e,r))}function Jp(e){return function(){var r=this.parentNode;for(var t in this.__transition)if(+t!==e)return;r&&r.removeChild(this)}}function Zp(){return this.on("end.remove",Jp(this._id))}function Qp(e){var r=this._name,t=this._id;typeof e!="function"&&(e=D0(e));for(var n=this._groups,a=n.length,s=new Array(a),i=0;i<a;++i)for(var c=n[i],f=c.length,o=s[i]=new Array(f),l,u,h=0;h<f;++h)(l=c[h])&&(u=e.call(l,l.__data__,h,c))&&("__data__"in l&&(u.__data__=l.__data__),o[h]=u,Qs(o[h],r,t,h,o,Zt(l,t)));return new kr(s,this._parents,r,t)}function em(e){var r=this._name,t=this._id;typeof e!="function"&&(e=Kf(e));for(var n=this._groups,a=n.length,s=[],i=[],c=0;c<a;++c)for(var f=n[c],o=f.length,l,u=0;u<o;++u)if(l=f[u]){for(var h=e.call(l,l.__data__,u,f),d,x=Zt(l,t),p=0,m=h.length;p<m;++p)(d=h[p])&&Qs(d,r,t,p,h,x);s.push(h),i.push(l)}return new kr(s,i,r,t)}var tm=Ia.prototype.constructor;function rm(){return new tm(this._groups,this._parents)}function nm(e,r){var t,n,a;return function(){var s=bn(this,e),i=(this.style.removeProperty(e),bn(this,e));return s===i?null:s===t&&i===n?a:a=r(t=s,n=i)}}function gl(e){return function(){this.style.removeProperty(e)}}function am(e,r,t){var n,a=t+"",s;return function(){var i=bn(this,e);return i===a?null:i===n?s:s=r(n=i,t)}}function sm(e,r,t){var n,a,s;return function(){var i=bn(this,e),c=t(this),f=c+"";return c==null&&(f=c=(this.style.removeProperty(e),bn(this,e))),i===f?null:i===n&&f===a?s:(a=f,s=r(n=i,c))}}function im(e,r){var t,n,a,s="style."+r,i="end."+s,c;return function(){var f=lr(this,e),o=f.on,l=f.value[s]==null?c||(c=gl(r)):void 0;(o!==t||a!==l)&&(n=(t=o).copy()).on(i,a=l),f.on=n}}function cm(e,r,t){var n=(e+="")=="transform"?cp:ml;return r==null?this.styleTween(e,nm(e,n)).on("end.style."+e,gl(e)):typeof r=="function"?this.styleTween(e,sm(e,n,$0(this,"style."+e,r))).each(im(this._id,e)):this.styleTween(e,am(e,n,r),t).on("end.style."+e,null)}function om(e,r,t){return function(n){this.style.setProperty(e,r.call(this,n),t)}}function fm(e,r,t){var n,a;function s(){var i=r.apply(this,arguments);return i!==a&&(n=(a=i)&&om(e,i,t)),n}return s._value=r,s}function lm(e,r,t){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(r==null)return this.tween(n,null);if(typeof r!="function")throw new Error;return this.tween(n,fm(e,r,t??""))}function um(e){return function(){this.textContent=e}}function hm(e){return function(){var r=e(this);this.textContent=r??""}}function dm(e){return this.tween("text",typeof e=="function"?hm($0(this,"text",e)):um(e==null?"":e+""))}function xm(e){return function(r){this.textContent=e.call(this,r)}}function pm(e){var r,t;function n(){var a=e.apply(this,arguments);return a!==t&&(r=(t=a)&&xm(a)),r}return n._value=e,n}function mm(e){var r="text";if(arguments.length<1)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,pm(e))}function gm(){for(var e=this._name,r=this._id,t=vl(),n=this._groups,a=n.length,s=0;s<a;++s)for(var i=n[s],c=i.length,f,o=0;o<c;++o)if(f=i[o]){var l=Zt(f,r);Qs(f,e,t,o,i,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new kr(n,this._parents,e,t)}function vm(){var e,r,t=this,n=t._id,a=t.size();return new Promise(function(s,i){var c={value:i},f={value:function(){--a===0&&s()}};t.each(function(){var o=lr(this,n),l=o.on;l!==e&&(r=(e=l).copy(),r._.cancel.push(c),r._.interrupt.push(c),r._.end.push(f)),o.on=r}),a===0&&s()})}var _m=0;function kr(e,r,t,n){this._groups=e,this._parents=r,this._name=t,this._id=n}function vl(){return++_m}var mr=Ia.prototype;kr.prototype={constructor:kr,select:Qp,selectAll:em,selectChild:mr.selectChild,selectChildren:mr.selectChildren,filter:Xp,merge:Yp,selection:rm,transition:gm,call:mr.call,nodes:mr.nodes,node:mr.node,size:mr.size,empty:mr.empty,each:mr.each,on:qp,attr:Rp,attrTween:Np,style:cm,styleTween:lm,text:dm,textTween:mm,remove:Zp,tween:kp,delay:Bp,duration:Hp,ease:Vp,easeVarying:zp,end:vm,[Symbol.iterator]:mr[Symbol.iterator]};function wm(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var ym={time:null,delay:0,duration:250,ease:wm};function Em(e,r){for(var t;!(t=e.__transition)||!(t=t[r]);)if(!(e=e.parentNode))throw new Error(`transition ${r} not found`);return t}function km(e){var r,t;e instanceof kr?(r=e._id,e=e._name):(r=vl(),(t=ym).time=B0(),e=e==null?null:e+"");for(var n=this._groups,a=n.length,s=0;s<a;++s)for(var i=n[s],c=i.length,f,o=0;o<c;++o)(f=i[o])&&Qs(f,e,r,o,i,t||Em(f,r));return new kr(n,this._parents,e,r)}Ia.prototype.interrupt=wp;Ia.prototype.transition=km;const r0=Math.PI,n0=2*r0,Gr=1e-6,Tm=n0-Gr;function _l(e){this._+=e[0];for(let r=1,t=e.length;r<t;++r)this._+=arguments[r]+e[r]}function Am(e){let r=Math.floor(e);if(!(r>=0))throw new Error(`invalid digits: ${e}`);if(r>15)return _l;const t=10**r;return function(n){this._+=n[0];for(let a=1,s=n.length;a<s;++a)this._+=Math.round(arguments[a]*t)/t+n[a]}}class Sm{constructor(r){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=r==null?_l:Am(r)}moveTo(r,t){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(r,t){this._append`L${this._x1=+r},${this._y1=+t}`}quadraticCurveTo(r,t,n,a){this._append`Q${+r},${+t},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(r,t,n,a,s,i){this._append`C${+r},${+t},${+n},${+a},${this._x1=+s},${this._y1=+i}`}arcTo(r,t,n,a,s){if(r=+r,t=+t,n=+n,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let i=this._x1,c=this._y1,f=n-r,o=a-t,l=i-r,u=c-t,h=l*l+u*u;if(this._x1===null)this._append`M${this._x1=r},${this._y1=t}`;else if(h>Gr)if(!(Math.abs(u*f-o*l)>Gr)||!s)this._append`L${this._x1=r},${this._y1=t}`;else{let d=n-i,x=a-c,p=f*f+o*o,m=d*d+x*x,_=Math.sqrt(p),w=Math.sqrt(h),v=s*Math.tan((r0-Math.acos((p+h-m)/(2*_*w)))/2),C=v/w,O=v/_;Math.abs(C-1)>Gr&&this._append`L${r+C*l},${t+C*u}`,this._append`A${s},${s},0,0,${+(u*d>l*x)},${this._x1=r+O*f},${this._y1=t+O*o}`}}arc(r,t,n,a,s,i){if(r=+r,t=+t,n=+n,i=!!i,n<0)throw new Error(`negative radius: ${n}`);let c=n*Math.cos(a),f=n*Math.sin(a),o=r+c,l=t+f,u=1^i,h=i?a-s:s-a;this._x1===null?this._append`M${o},${l}`:(Math.abs(this._x1-o)>Gr||Math.abs(this._y1-l)>Gr)&&this._append`L${o},${l}`,n&&(h<0&&(h=h%n0+n0),h>Tm?this._append`A${n},${n},0,1,${u},${r-c},${t-f}A${n},${n},0,1,${u},${this._x1=o},${this._y1=l}`:h>Gr&&this._append`A${n},${n},0,${+(h>=r0)},${u},${this._x1=r+n*Math.cos(s)},${this._y1=t+n*Math.sin(s)}`)}rect(r,t,n,a){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+t}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function Fm(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Ps(e,r){if((t=(e=r?e.toExponential(r-1):e.toExponential()).indexOf("e"))<0)return null;var t,n=e.slice(0,t);return[n.length>1?n[0]+n.slice(2):n,+e.slice(t+1)]}function In(e){return e=Ps(Math.abs(e)),e?e[1]:NaN}function Cm(e,r){return function(t,n){for(var a=t.length,s=[],i=0,c=e[0],f=0;a>0&&c>0&&(f+c+1>n&&(c=Math.max(1,n-f)),s.push(t.substring(a-=c,a+c)),!((f+=c+1)>n));)c=e[i=(i+1)%e.length];return s.reverse().join(r)}}function bm(e){return function(r){return r.replace(/[0-9]/g,function(t){return e[+t]})}}var Rm=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ns(e){if(!(r=Rm.exec(e)))throw new Error("invalid format: "+e);var r;return new H0({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}Ns.prototype=H0.prototype;function H0(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}H0.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Im(e){e:for(var r=e.length,t=1,n=-1,a;t<r;++t)switch(e[t]){case".":n=a=t;break;case"0":n===0&&(n=t),a=t;break;default:if(!+e[t])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var wl;function Om(e,r){var t=Ps(e,r);if(!t)return e+"";var n=t[0],a=t[1],s=a-(wl=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,i=n.length;return s===i?n:s>i?n+new Array(s-i+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+Ps(e,Math.max(0,r+s-1))[0]}function lo(e,r){var t=Ps(e,r);if(!t)return e+"";var n=t[0],a=t[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const uo={"%":(e,r)=>(e*100).toFixed(r),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Fm,e:(e,r)=>e.toExponential(r),f:(e,r)=>e.toFixed(r),g:(e,r)=>e.toPrecision(r),o:e=>Math.round(e).toString(8),p:(e,r)=>lo(e*100,r),r:lo,s:Om,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function ho(e){return e}var xo=Array.prototype.map,po=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Dm(e){var r=e.grouping===void 0||e.thousands===void 0?ho:Cm(xo.call(e.grouping,Number),e.thousands+""),t=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?ho:bm(xo.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"−":e.minus+"",f=e.nan===void 0?"NaN":e.nan+"";function o(u){u=Ns(u);var h=u.fill,d=u.align,x=u.sign,p=u.symbol,m=u.zero,_=u.width,w=u.comma,v=u.precision,C=u.trim,O=u.type;O==="n"?(w=!0,O="g"):uo[O]||(v===void 0&&(v=12),C=!0,O="g"),(m||h==="0"&&d==="=")&&(m=!0,h="0",d="=");var R=p==="$"?t:p==="#"&&/[boxX]/.test(O)?"0"+O.toLowerCase():"",k=p==="$"?n:/[%p]/.test(O)?i:"",U=uo[O],I=/[defgprs%]/.test(O);v=v===void 0?6:/[gprs]/.test(O)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function z(D){var B=R,Z=k,P,j,H;if(O==="c")Z=U(D)+Z,D="";else{D=+D;var K=D<0||1/D<0;if(D=isNaN(D)?f:U(Math.abs(D),v),C&&(D=Im(D)),K&&+D==0&&x!=="+"&&(K=!1),B=(K?x==="("?x:c:x==="-"||x==="("?"":x)+B,Z=(O==="s"?po[8+wl/3]:"")+Z+(K&&x==="("?")":""),I){for(P=-1,j=D.length;++P<j;)if(H=D.charCodeAt(P),48>H||H>57){Z=(H===46?a+D.slice(P+1):D.slice(P))+Z,D=D.slice(0,P);break}}}w&&!m&&(D=r(D,1/0));var fe=B.length+D.length+Z.length,L=fe<_?new Array(_-fe+1).join(h):"";switch(w&&m&&(D=r(L+D,L.length?_-Z.length:1/0),L=""),d){case"<":D=B+D+Z+L;break;case"=":D=B+L+D+Z;break;case"^":D=L.slice(0,fe=L.length>>1)+B+D+Z+L.slice(fe);break;default:D=L+B+D+Z;break}return s(D)}return z.toString=function(){return u+""},z}function l(u,h){var d=o((u=Ns(u),u.type="f",u)),x=Math.max(-8,Math.min(8,Math.floor(In(h)/3)))*3,p=Math.pow(10,-x),m=po[8+x/3];return function(_){return d(p*_)+m}}return{format:o,formatPrefix:l}}var ja,yl,El;Pm({thousands:",",grouping:[3],currency:["$",""]});function Pm(e){return ja=Dm(e),yl=ja.format,El=ja.formatPrefix,ja}function Nm(e){return Math.max(0,-In(Math.abs(e)))}function Mm(e,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(In(r)/3)))*3-In(Math.abs(e)))}function Lm(e,r){return e=Math.abs(e),r=Math.abs(r)-e,Math.max(0,In(r)-In(e))+1}function Bm(e){var r=0,t=e.children,n=t&&t.length;if(!n)r=1;else for(;--n>=0;)r+=t[n].value;e.value=r}function Um(){return this.eachAfter(Bm)}function $m(e,r){let t=-1;for(const n of this)e.call(r,n,++t,this);return this}function Hm(e,r){for(var t=this,n=[t],a,s,i=-1;t=n.pop();)if(e.call(r,t,++i,this),a=t.children)for(s=a.length-1;s>=0;--s)n.push(a[s]);return this}function Wm(e,r){for(var t=this,n=[t],a=[],s,i,c,f=-1;t=n.pop();)if(a.push(t),s=t.children)for(i=0,c=s.length;i<c;++i)n.push(s[i]);for(;t=a.pop();)e.call(r,t,++f,this);return this}function Vm(e,r){let t=-1;for(const n of this)if(e.call(r,n,++t,this))return n}function Gm(e){return this.eachAfter(function(r){for(var t=+e(r.data)||0,n=r.children,a=n&&n.length;--a>=0;)t+=n[a].value;r.value=t})}function zm(e){return this.eachBefore(function(r){r.children&&r.children.sort(e)})}function Xm(e){for(var r=this,t=Ym(r,e),n=[r];r!==t;)r=r.parent,n.push(r);for(var a=n.length;e!==t;)n.splice(a,0,e),e=e.parent;return n}function Ym(e,r){if(e===r)return e;var t=e.ancestors(),n=r.ancestors(),a=null;for(e=t.pop(),r=n.pop();e===r;)a=e,e=t.pop(),r=n.pop();return a}function jm(){for(var e=this,r=[e];e=e.parent;)r.push(e);return r}function Km(){return Array.from(this)}function qm(){var e=[];return this.eachBefore(function(r){r.children||e.push(r)}),e}function Jm(){var e=this,r=[];return e.each(function(t){t!==e&&r.push({source:t.parent,target:t})}),r}function*Zm(){var e=this,r,t=[e],n,a,s;do for(r=t.reverse(),t=[];e=r.pop();)if(yield e,n=e.children)for(a=0,s=n.length;a<s;++a)t.push(n[a]);while(t.length)}function kl(e,r){e instanceof Map?(e=[void 0,e],r===void 0&&(r=tg)):r===void 0&&(r=eg);for(var t=new On(e),n,a=[t],s,i,c,f;n=a.pop();)if((i=r(n.data))&&(f=(i=Array.from(i)).length))for(n.children=i,c=f-1;c>=0;--c)a.push(s=i[c]=new On(i[c])),s.parent=n,s.depth=n.depth+1;return t.eachBefore(Tl)}function Qm(){return kl(this).eachBefore(rg)}function eg(e){return e.children}function tg(e){return Array.isArray(e)?e[1]:null}function rg(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Tl(e){var r=0;do e.height=r;while((e=e.parent)&&e.height<++r)}function On(e){this.data=e,this.depth=this.height=0,this.parent=null}On.prototype=kl.prototype={constructor:On,count:Um,each:$m,eachAfter:Wm,eachBefore:Hm,find:Vm,sum:Gm,sort:zm,path:Xm,ancestors:jm,descendants:Km,leaves:qm,links:Jm,copy:Qm,[Symbol.iterator]:Zm};function vi(e){return e==null?null:ng(e)}function ng(e){if(typeof e!="function")throw new Error;return e}var ag={depth:-1},mo={},_i={};function sg(e){return e.id}function ig(e){return e.parentId}function cg(){var e=sg,r=ig,t;function n(a){var s=Array.from(a),i=e,c=r,f,o,l,u,h,d,x,p,m=new Map;if(t!=null){const _=s.map((C,O)=>og(t(C,O,a))),w=_.map(go),v=new Set(_).add("");for(const C of w)v.has(C)||(v.add(C),_.push(C),w.push(go(C)),s.push(_i));i=(C,O)=>_[O],c=(C,O)=>w[O]}for(l=0,f=s.length;l<f;++l)o=s[l],d=s[l]=new On(o),(x=i(o,l,a))!=null&&(x+="")&&(p=d.id=x,m.set(p,m.has(p)?mo:d)),(x=c(o,l,a))!=null&&(x+="")&&(d.parent=x);for(l=0;l<f;++l)if(d=s[l],x=d.parent){if(h=m.get(x),!h)throw new Error("missing: "+x);if(h===mo)throw new Error("ambiguous: "+x);h.children?h.children.push(d):h.children=[d],d.parent=h}else{if(u)throw new Error("multiple roots");u=d}if(!u)throw new Error("no root");if(t!=null){for(;u.data===_i&&u.children.length===1;)u=u.children[0],--f;for(let _=s.length-1;_>=0&&(d=s[_],d.data===_i);--_)d.data=null}if(u.parent=ag,u.eachBefore(function(_){_.depth=_.parent.depth+1,--f}).eachBefore(Tl),u.parent=null,f>0)throw new Error("cycle");return u}return n.id=function(a){return arguments.length?(e=vi(a),n):e},n.parentId=function(a){return arguments.length?(r=vi(a),n):r},n.path=function(a){return arguments.length?(t=vi(a),n):t},n}function og(e){e=`${e}`;let r=e.length;return a0(e,r-1)&&!a0(e,r-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function go(e){let r=e.length;if(r<2)return"";for(;--r>1&&!a0(e,r););return e.slice(0,r)}function a0(e,r){if(e[r]==="/"){let t=0;for(;r>0&&e[--r]==="\\";)++t;if((t&1)===0)return!0}return!1}function fg(e,r){return e.parent===r.parent?1:2}function wi(e){var r=e.children;return r?r[0]:e.t}function yi(e){var r=e.children;return r?r[r.length-1]:e.t}function lg(e,r,t){var n=t/(r.i-e.i);r.c-=n,r.s+=t,e.c+=n,r.z+=t,r.m+=t}function ug(e){for(var r=0,t=0,n=e.children,a=n.length,s;--a>=0;)s=n[a],s.z+=r,s.m+=r,r+=s.s+(t+=s.c)}function hg(e,r,t){return e.a.parent===r.parent?e.a:t}function vs(e,r){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=r}vs.prototype=Object.create(On.prototype);function dg(e){for(var r=new vs(e,0),t,n=[r],a,s,i,c;t=n.pop();)if(s=t._.children)for(t.children=new Array(c=s.length),i=c-1;i>=0;--i)n.push(a=t.children[i]=new vs(s[i],i)),a.parent=t;return(r.parent=new vs(null,0)).children=[r],r}function xg(){var e=fg,r=1,t=1,n=null;function a(o){var l=dg(o);if(l.eachAfter(s),l.parent.m=-l.z,l.eachBefore(i),n)o.eachBefore(f);else{var u=o,h=o,d=o;o.eachBefore(function(w){w.x<u.x&&(u=w),w.x>h.x&&(h=w),w.depth>d.depth&&(d=w)});var x=u===h?1:e(u,h)/2,p=x-u.x,m=r/(h.x+x+p),_=t/(d.depth||1);o.eachBefore(function(w){w.x=(w.x+p)*m,w.y=w.depth*_})}return o}function s(o){var l=o.children,u=o.parent.children,h=o.i?u[o.i-1]:null;if(l){ug(o);var d=(l[0].z+l[l.length-1].z)/2;h?(o.z=h.z+e(o._,h._),o.m=o.z-d):o.z=d}else h&&(o.z=h.z+e(o._,h._));o.parent.A=c(o,h,o.parent.A||u[0])}function i(o){o._.x=o.z+o.parent.m,o.m+=o.parent.m}function c(o,l,u){if(l){for(var h=o,d=o,x=l,p=h.parent.children[0],m=h.m,_=d.m,w=x.m,v=p.m,C;x=yi(x),h=wi(h),x&&h;)p=wi(p),d=yi(d),d.a=o,C=x.z+w-h.z-m+e(x._,h._),C>0&&(lg(hg(x,o,u),o,C),m+=C,_+=C),w+=x.m,m+=h.m,v+=p.m,_+=d.m;x&&!yi(d)&&(d.t=x,d.m+=w-_),h&&!wi(p)&&(p.t=h,p.m+=m-v,u=o)}return u}function f(o){o.x*=r,o.y=o.depth*t}return a.separation=function(o){return arguments.length?(e=o,a):e},a.size=function(o){return arguments.length?(n=!1,r=+o[0],t=+o[1],a):n?null:[r,t]},a.nodeSize=function(o){return arguments.length?(n=!0,r=+o[0],t=+o[1],a):n?[r,t]:null},a}function pg(e,r){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof r=="function"?this.interpolator(r):this.range(r);break}}return this}function Al(e){return e}function mg(e,r,t,n){var a=zd(e,r,t),s;switch(n=Ns(n??",f"),n.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(r));return n.precision==null&&!isNaN(s=Mm(a,i))&&(n.precision=s),El(n,i)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=Lm(a,Math.max(Math.abs(e),Math.abs(r))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=Nm(a))&&(n.precision=s-(n.type==="%")*2);break}}return yl(n)}function gg(e){var r=e.domain;return e.ticks=function(t){var n=r();return Gd(n[0],n[n.length-1],t??10)},e.tickFormat=function(t,n){var a=r();return mg(a[0],a[a.length-1],t??10,n)},e.nice=function(t){t==null&&(t=10);var n=r(),a=0,s=n.length-1,i=n[a],c=n[s],f,o,l=10;for(c<i&&(o=i,i=c,c=o,o=a,a=s,s=o);l-- >0;){if(o=Yi(i,c,t),o===f)return n[a]=i,n[s]=c,r(n);if(o>0)i=Math.floor(i/o)*o,c=Math.ceil(c/o)*o;else if(o<0)i=Math.ceil(i*o)/o,c=Math.floor(c*o)/o;else break;f=o}return e},e}function vg(){var e=0,r=1,t,n,a,s,i=Al,c=!1,f;function o(u){return u==null||isNaN(u=+u)?f:i(a===0?.5:(u=(s(u)-t)*a,c?Math.max(0,Math.min(1,u)):u))}o.domain=function(u){return arguments.length?([e,r]=u,t=s(e=+e),n=s(r=+r),a=t===n?0:1/(n-t),o):[e,r]},o.clamp=function(u){return arguments.length?(c=!!u,o):c},o.interpolator=function(u){return arguments.length?(i=u,o):i};function l(u){return function(h){var d,x;return arguments.length?([d,x]=h,i=u(d,x),o):[i(0),i(1)]}}return o.range=l(L0),o.rangeRound=l(ap),o.unknown=function(u){return arguments.length?(f=u,o):f},function(u){return s=u,t=u(e),n=u(r),a=t===n?0:1/(n-t),o}}function _g(e,r){return r.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Sl(){var e=gg(vg()(Al));return e.copy=function(){return _g(e,Sl())},pg.apply(e,arguments)}function wg(e){for(var r=e.length/6|0,t=new Array(r),n=0;n<r;)t[n]="#"+e.slice(n*6,++n*6);return t}const yg=e=>qx(e[e.length-1]);var Eg=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(wg);const kg=yg(Eg);function vo(e){return function(){return e}}function Tg(e){let r=3;return e.digits=function(t){if(!arguments.length)return r;if(t==null)r=null;else{const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);r=n}return e},()=>new Sm(r)}var Ag=Array.prototype.slice;function Sg(e){return e[0]}function Fg(e){return e[1]}class Cg{constructor(r,t){this._context=r,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(r,t){switch(r=+r,t=+t,this._point){case 0:{this._point=1,this._line?this._context.lineTo(r,t):this._context.moveTo(r,t);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+r)/2,this._y0,this._x0,t,r,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,r,this._y0,r,t);break}}this._x0=r,this._y0=t}}function bg(e){return new Cg(e,!1)}function Rg(e){return e.source}function Ig(e){return e.target}function Og(e){let r=Rg,t=Ig,n=Sg,a=Fg,s=null,i=null,c=Tg(f);function f(){let o;const l=Ag.call(arguments),u=r.apply(this,l),h=t.apply(this,l);if(s==null&&(i=e(o=c())),i.lineStart(),l[0]=u,i.point(+n.apply(this,l),+a.apply(this,l)),l[0]=h,i.point(+n.apply(this,l),+a.apply(this,l)),i.lineEnd(),o)return i=null,o+""||null}return f.source=function(o){return arguments.length?(r=o,f):r},f.target=function(o){return arguments.length?(t=o,f):t},f.x=function(o){return arguments.length?(n=typeof o=="function"?o:vo(+o),f):n},f.y=function(o){return arguments.length?(a=typeof o=="function"?o:vo(+o),f):a},f.context=function(o){return arguments.length?(o==null?s=i=null:i=e(s=o),f):s},f}function Dg(){return Og(bg)}const Ka=e=>()=>e;function Pg(e,{sourceEvent:r,target:t,transform:n,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:r,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:a}})}function _r(e,r,t){this.k=e,this.x=r,this.y=t}_r.prototype={constructor:_r,scale:function(e){return e===1?this:new _r(this.k*e,this.x,this.y)},translate:function(e,r){return e===0&r===0?this:new _r(this.k,this.x+this.k*e,this.y+this.k*r)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Fl=new _r(1,0,0);_r.prototype;function Ei(e){e.stopImmediatePropagation()}function jn(e){e.preventDefault(),e.stopImmediatePropagation()}function Ng(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Mg(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function _o(){return this.__zoom||Fl}function Lg(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Bg(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ug(e,r,t){var n=e.invertX(r[0][0])-t[0][0],a=e.invertX(r[1][0])-t[1][0],s=e.invertY(r[0][1])-t[0][1],i=e.invertY(r[1][1])-t[1][1];return e.translate(a>n?(n+a)/2:Math.min(0,n)||Math.max(0,a),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function $g(){var e=Ng,r=Mg,t=Ug,n=Lg,a=Bg,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],c=250,f=hp,o=I0("start","zoom","end"),l,u,h,d=500,x=150,p=0,m=10;function _(P){P.property("__zoom",_o).on("wheel.zoom",U,{passive:!1}).on("mousedown.zoom",I).on("dblclick.zoom",z).filter(a).on("touchstart.zoom",D).on("touchmove.zoom",B).on("touchend.zoom touchcancel.zoom",Z).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}_.transform=function(P,j,H,K){var fe=P.selection?P.selection():P;fe.property("__zoom",_o),P!==fe?O(P,j,H,K):fe.interrupt().each(function(){R(this,arguments).event(K).start().zoom(null,typeof j=="function"?j.apply(this,arguments):j).end()})},_.scaleBy=function(P,j,H,K){_.scaleTo(P,function(){var fe=this.__zoom.k,L=typeof j=="function"?j.apply(this,arguments):j;return fe*L},H,K)},_.scaleTo=function(P,j,H,K){_.transform(P,function(){var fe=r.apply(this,arguments),L=this.__zoom,ne=H==null?C(fe):typeof H=="function"?H.apply(this,arguments):H,oe=L.invert(ne),S=typeof j=="function"?j.apply(this,arguments):j;return t(v(w(L,S),ne,oe),fe,i)},H,K)},_.translateBy=function(P,j,H,K){_.transform(P,function(){return t(this.__zoom.translate(typeof j=="function"?j.apply(this,arguments):j,typeof H=="function"?H.apply(this,arguments):H),r.apply(this,arguments),i)},null,K)},_.translateTo=function(P,j,H,K,fe){_.transform(P,function(){var L=r.apply(this,arguments),ne=this.__zoom,oe=K==null?C(L):typeof K=="function"?K.apply(this,arguments):K;return t(Fl.translate(oe[0],oe[1]).scale(ne.k).translate(typeof j=="function"?-j.apply(this,arguments):-j,typeof H=="function"?-H.apply(this,arguments):-H),L,i)},K,fe)};function w(P,j){return j=Math.max(s[0],Math.min(s[1],j)),j===P.k?P:new _r(j,P.x,P.y)}function v(P,j,H){var K=j[0]-H[0]*P.k,fe=j[1]-H[1]*P.k;return K===P.x&&fe===P.y?P:new _r(P.k,K,fe)}function C(P){return[(+P[0][0]+ +P[1][0])/2,(+P[0][1]+ +P[1][1])/2]}function O(P,j,H,K){P.on("start.zoom",function(){R(this,arguments).event(K).start()}).on("interrupt.zoom end.zoom",function(){R(this,arguments).event(K).end()}).tween("zoom",function(){var fe=this,L=arguments,ne=R(fe,L).event(K),oe=r.apply(fe,L),S=H==null?C(oe):typeof H=="function"?H.apply(fe,L):H,W=Math.max(oe[1][0]-oe[0][0],oe[1][1]-oe[0][1]),M=fe.__zoom,N=typeof j=="function"?j.apply(fe,L):j,J=f(M.invert(S).concat(W/M.k),N.invert(S).concat(W/N.k));return function(te){if(te===1)te=N;else{var ie=J(te),ae=W/ie[2];te=new _r(ae,S[0]-ie[0]*ae,S[1]-ie[1]*ae)}ne.zoom(null,te)}})}function R(P,j,H){return!H&&P.__zooming||new k(P,j)}function k(P,j){this.that=P,this.args=j,this.active=0,this.sourceEvent=null,this.extent=r.apply(P,j),this.taps=0}k.prototype={event:function(P){return P&&(this.sourceEvent=P),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(P,j){return this.mouse&&P!=="mouse"&&(this.mouse[1]=j.invert(this.mouse[0])),this.touch0&&P!=="touch"&&(this.touch0[1]=j.invert(this.touch0[0])),this.touch1&&P!=="touch"&&(this.touch1[1]=j.invert(this.touch1[0])),this.that.__zoom=j,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(P){var j=Bt(this.that).datum();o.call(P,this.that,new Pg(P,{sourceEvent:this.sourceEvent,target:_,transform:this.that.__zoom,dispatch:o}),j)}};function U(P,...j){if(!e.apply(this,arguments))return;var H=R(this,j).event(P),K=this.__zoom,fe=Math.max(s[0],Math.min(s[1],K.k*Math.pow(2,n.apply(this,arguments)))),L=Wr(P);if(H.wheel)(H.mouse[0][0]!==L[0]||H.mouse[0][1]!==L[1])&&(H.mouse[1]=K.invert(H.mouse[0]=L)),clearTimeout(H.wheel);else{if(K.k===fe)return;H.mouse=[L,K.invert(L)],gs(this),H.start()}jn(P),H.wheel=setTimeout(ne,x),H.zoom("mouse",t(v(w(K,fe),H.mouse[0],H.mouse[1]),H.extent,i));function ne(){H.wheel=null,H.end()}}function I(P,...j){if(h||!e.apply(this,arguments))return;var H=P.currentTarget,K=R(this,j,!0).event(P),fe=Bt(P.view).on("mousemove.zoom",S,!0).on("mouseup.zoom",W,!0),L=Wr(P,H),ne=P.clientX,oe=P.clientY;Rx(P.view),Ei(P),K.mouse=[L,this.__zoom.invert(L)],gs(this),K.start();function S(M){if(jn(M),!K.moved){var N=M.clientX-ne,J=M.clientY-oe;K.moved=N*N+J*J>p}K.event(M).zoom("mouse",t(v(K.that.__zoom,K.mouse[0]=Wr(M,H),K.mouse[1]),K.extent,i))}function W(M){fe.on("mousemove.zoom mouseup.zoom",null),Ix(M.view,K.moved),jn(M),K.event(M).end()}}function z(P,...j){if(e.apply(this,arguments)){var H=this.__zoom,K=Wr(P.changedTouches?P.changedTouches[0]:P,this),fe=H.invert(K),L=H.k*(P.shiftKey?.5:2),ne=t(v(w(H,L),K,fe),r.apply(this,j),i);jn(P),c>0?Bt(this).transition().duration(c).call(O,ne,K,P):Bt(this).call(_.transform,ne,K,P)}}function D(P,...j){if(e.apply(this,arguments)){var H=P.touches,K=H.length,fe=R(this,j,P.changedTouches.length===K).event(P),L,ne,oe,S;for(Ei(P),ne=0;ne<K;++ne)oe=H[ne],S=Wr(oe,this),S=[S,this.__zoom.invert(S),oe.identifier],fe.touch0?!fe.touch1&&fe.touch0[2]!==S[2]&&(fe.touch1=S,fe.taps=0):(fe.touch0=S,L=!0,fe.taps=1+!!l);l&&(l=clearTimeout(l)),L&&(fe.taps<2&&(u=S[0],l=setTimeout(function(){l=null},d)),gs(this),fe.start())}}function B(P,...j){if(this.__zooming){var H=R(this,j).event(P),K=P.changedTouches,fe=K.length,L,ne,oe,S;for(jn(P),L=0;L<fe;++L)ne=K[L],oe=Wr(ne,this),H.touch0&&H.touch0[2]===ne.identifier?H.touch0[0]=oe:H.touch1&&H.touch1[2]===ne.identifier&&(H.touch1[0]=oe);if(ne=H.that.__zoom,H.touch1){var W=H.touch0[0],M=H.touch0[1],N=H.touch1[0],J=H.touch1[1],te=(te=N[0]-W[0])*te+(te=N[1]-W[1])*te,ie=(ie=J[0]-M[0])*ie+(ie=J[1]-M[1])*ie;ne=w(ne,Math.sqrt(te/ie)),oe=[(W[0]+N[0])/2,(W[1]+N[1])/2],S=[(M[0]+J[0])/2,(M[1]+J[1])/2]}else if(H.touch0)oe=H.touch0[0],S=H.touch0[1];else return;H.zoom("touch",t(v(ne,oe,S),H.extent,i))}}function Z(P,...j){if(this.__zooming){var H=R(this,j).event(P),K=P.changedTouches,fe=K.length,L,ne;for(Ei(P),h&&clearTimeout(h),h=setTimeout(function(){h=null},d),L=0;L<fe;++L)ne=K[L],H.touch0&&H.touch0[2]===ne.identifier?delete H.touch0:H.touch1&&H.touch1[2]===ne.identifier&&delete H.touch1;if(H.touch1&&!H.touch0&&(H.touch0=H.touch1,delete H.touch1),H.touch0)H.touch0[1]=this.__zoom.invert(H.touch0[0]);else if(H.end(),H.taps===2&&(ne=Wr(ne,this),Math.hypot(u[0]-ne[0],u[1]-ne[1])<m)){var oe=Bt(this).on("dblclick.zoom");oe&&oe.apply(this,arguments)}}}return _.wheelDelta=function(P){return arguments.length?(n=typeof P=="function"?P:Ka(+P),_):n},_.filter=function(P){return arguments.length?(e=typeof P=="function"?P:Ka(!!P),_):e},_.touchable=function(P){return arguments.length?(a=typeof P=="function"?P:Ka(!!P),_):a},_.extent=function(P){return arguments.length?(r=typeof P=="function"?P:Ka([[+P[0][0],+P[0][1]],[+P[1][0],+P[1][1]]]),_):r},_.scaleExtent=function(P){return arguments.length?(s[0]=+P[0],s[1]=+P[1],_):[s[0],s[1]]},_.translateExtent=function(P){return arguments.length?(i[0][0]=+P[0][0],i[1][0]=+P[1][0],i[0][1]=+P[0][1],i[1][1]=+P[1][1],_):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},_.constrain=function(P){return arguments.length?(t=P,_):t},_.duration=function(P){return arguments.length?(c=+P,_):c},_.interpolate=function(P){return arguments.length?(f=P,_):f},_.on=function(){var P=o.on.apply(o,arguments);return P===o?_:P},_.clickDistance=function(P){return arguments.length?(p=(P=+P)*P,_):Math.sqrt(p)},_.tapDistance=function(P){return arguments.length?(m=+P,_):m},_}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Cl=1252,Hg=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],W0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},V0=function(e){Hg.indexOf(e)!=-1&&(Cl=W0[0]=e)};function Wg(){V0(1252)}var jt=function(e){V0(e)};function bl(){jt(1200),Wg()}function wo(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function Vg(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function Rl(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var Jn=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?Vg(e.slice(2)):r==254&&t==255?Rl(e.slice(2)):r==65279?e.slice(1):e},qa=function(r){return String.fromCharCode(r)},yo=function(r){return String.fromCharCode(r)},s0,Dr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Eo(e){for(var r="",t=0,n=0,a=0,s=0,i=0,c=0,f=0,o=0;o<e.length;)t=e.charCodeAt(o++),s=t>>2,n=e.charCodeAt(o++),i=(t&3)<<4|n>>4,a=e.charCodeAt(o++),c=(n&15)<<2|a>>6,f=a&63,isNaN(n)?c=f=64:isNaN(a)&&(f=64),r+=Dr.charAt(s)+Dr.charAt(i)+Dr.charAt(c)+Dr.charAt(f);return r}function Ot(e){var r="",t=0,n=0,a=0,s=0,i=0,c=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var o=0;o<e.length;)s=Dr.indexOf(e.charAt(o++)),i=Dr.indexOf(e.charAt(o++)),t=s<<2|i>>4,r+=String.fromCharCode(t),c=Dr.indexOf(e.charAt(o++)),n=(i&15)<<4|c>>2,c!==64&&(r+=String.fromCharCode(n)),f=Dr.indexOf(e.charAt(o++)),a=(c&3)<<6|f,f!==64&&(r+=String.fromCharCode(a));return r}var ye=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),an=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function Mr(e){return ye?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function ko(e){return ye?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Yt=function(r){return ye?an(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function sn(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function G0(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return G0(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var Or=ye?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:an(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)if(a=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Gg(e){for(var r=[],t=0,n=e.length+250,a=Mr(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[t++]=i;else if(i<2048)a[t++]=192|i>>6&31,a[t++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var c=e.charCodeAt(++s)&1023;a[t++]=240|i>>8&7,a[t++]=128|i>>2&63,a[t++]=128|c>>6&15|(i&3)<<4,a[t++]=128|c&63}else a[t++]=224|i>>12&15,a[t++]=128|i>>6&63,a[t++]=128|i&63;t>n&&(r.push(a.slice(0,t)),t=0,a=Mr(65535),n=65530)}return r.push(a.slice(0,t)),Or(r)}var vt=/\u0000/g,Zn=/[\u0001-\u0006]/g;function En(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function Kt(e,r){var t=""+e;return t.length>=r?t:Ne("0",r-t.length)+t}function z0(e,r){var t=""+e;return t.length>=r?t:Ne(" ",r-t.length)+t}function Ms(e,r){var t=""+e;return t.length>=r?t:t+Ne(" ",r-t.length)}function zg(e,r){var t=""+Math.round(e);return t.length>=r?t:Ne("0",r-t.length)+t}function Xg(e,r){var t=""+e;return t.length>=r?t:Ne("0",r-t.length)+t}var To=Math.pow(2,32);function un(e,r){if(e>To||e<-To)return zg(e,r);var t=Math.round(e);return Xg(t,r)}function Ls(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Ao=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ki=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Yg(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var ge={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},So={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},jg={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Bs(e,r,t){for(var n=e<0?-1:1,a=e*n,s=0,i=1,c=0,f=1,o=0,l=0,u=Math.floor(a);o<r&&(u=Math.floor(a),c=u*i+s,l=u*o+f,!(a-u<5e-8));)a=1/(a-u),s=i,i=c,f=o,o=l;if(l>r&&(o>r?(l=f,c=s):(l=o,c=i)),!t)return[0,n*c,l];var h=Math.floor(n*c/l);return[h,n*c-h*l,l]}function jr(e,r,t){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],c={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),r&&r.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++n,++c.D)),n===60)i=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),i=[f.getFullYear(),f.getMonth()+1,f.getDate()],s=f.getDay(),n<60&&(s=(s+6)%7),t&&(s=ev(f,i))}return c.y=i[0],c.m=i[1],c.d=i[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=s,c}var Il=new Date(1899,11,31,0,0,0),Kg=Il.getTime(),qg=new Date(1900,2,1,0,0,0);function Ol(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=qg&&(t+=24*60*60*1e3),(t-(Kg+(e.getTimezoneOffset()-Il.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function X0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Jg(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Zg(e){var r=e<0?12:11,t=X0(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function Qg(e){var r=X0(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function ya(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=Zg(e):r===10?t=e.toFixed(10).substr(0,12):t=Qg(e),X0(Jg(t.toUpperCase()))}function tn(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ya(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return $t(14,Ol(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function ev(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function tv(e,r,t,n){var a="",s=0,i=0,c=t.y,f,o=0;switch(e){case 98:c=t.y+543;case 121:switch(r.length){case 1:case 2:f=c%100,o=2;break;default:f=c%1e4,o=4;break}break;case 109:switch(r.length){case 1:case 2:f=t.m,o=r.length;break;case 3:return ki[t.m-1][1];case 5:return ki[t.m-1][0];default:return ki[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:f=t.d,o=r.length;break;case 3:return Ao[t.q][0];default:return Ao[t.q][1]}break;case 104:switch(r.length){case 1:case 2:f=1+(t.H+11)%12,o=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:f=t.H,o=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:f=t.M,o=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?Kt(t.S,r.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(t.S+t.u)),s>=60*i&&(s=0),r==="s"?s===0?"0":""+s/i:(a=Kt(s,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}o=r.length===3?1:2;break;case 101:f=c,o=1;break}var l=o>0?Kt(f,o):"";return l}function Pr(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var Dl=/%/g;function rv(e,r,t){var n=r.replace(Dl,""),a=r.length-n.length;return yr(e,n,t*Math.pow(10,2*a))+Ne("%",a)}function nv(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return yr(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function Pl(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Pl(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(r/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),t.indexOf("e")===-1){var i=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+s):t+="E+"+(i-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,o,l){return f+o+l.substr(0,(a+s)%a)+"."+l.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Nl=/# (\?+)( ?)\/( ?)(\d+)/;function av(e,r,t){var n=parseInt(e[4],10),a=Math.round(r*n),s=Math.floor(a/n),i=a-s*n,c=n;return t+(s===0?"":""+s)+" "+(i===0?Ne(" ",e[1].length+1+e[4].length):z0(i,e[1].length)+e[2]+"/"+e[3]+Kt(c,e[4].length))}function sv(e,r,t){return t+(r===0?"":""+r)+Ne(" ",e[1].length+2+e[4].length)}var Ml=/^#*0*\.([0#]+)/,Ll=/\).*[0#]/,Bl=/\(###\) ###\\?-####/;function pt(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Fo(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Co(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function iv(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function cv(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Mt(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Ll)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Mt("n",n,t):"("+Mt("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return nv(e,r,t);if(r.indexOf("%")!==-1)return rv(e,r,t);if(r.indexOf("E")!==-1)return Pl(r,t);if(r.charCodeAt(0)===36)return"$"+Mt(e,r.substr(r.charAt(1)==" "?2:1),t);var a,s,i,c,f=Math.abs(t),o=t<0?"-":"";if(r.match(/^00+$/))return o+un(f,r.length);if(r.match(/^[#?]+$/))return a=un(t,0),a==="0"&&(a=""),a.length>r.length?a:pt(r.substr(0,r.length-a.length))+a;if(s=r.match(Nl))return av(s,f,o);if(r.match(/^#+0+$/))return o+un(f,r.length-r.indexOf("0"));if(s=r.match(Ml))return a=Fo(t,s[1].length).replace(/^([^\.]+)$/,"$1."+pt(s[1])).replace(/\.$/,"."+pt(s[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+Ne("0",pt(s[1]).length-p.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return o+Fo(f,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return o+Pr(un(f,0));if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Mt(e,r,-t):Pr(""+(Math.floor(t)+iv(t,s[1].length)))+"."+Kt(Co(t,s[1].length),s[1].length);if(s=r.match(/^#,#*,#0/))return Mt(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=En(Mt(e,r.replace(/[\\-]/g,""),t)),i=0,En(En(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<a.length?a.charAt(i++):x==="0"?"0":""}));if(r.match(Bl))return a=Mt(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var l="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),c=Bs(f,Math.pow(10,i)-1,!1),a=""+o,l=yr("n",s[1],c[1]),l.charAt(l.length-1)==" "&&(l=l.substr(0,l.length-1)+"0"),a+=l+s[2]+"/"+s[3],l=Ms(c[2],i),l.length<s[4].length&&(l=pt(s[4].substr(s[4].length-l.length))+l),a+=l,a;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c=Bs(f,Math.pow(10,i)-1,!0),o+(c[0]||(c[1]?"":"0"))+" "+(c[1]?z0(c[1],i)+s[2]+"/"+s[3]+Ms(c[2],i):Ne(" ",2*i+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return a=un(t,0),r.length<=a.length?a:pt(r.substr(0,r.length-a.length))+a;if(s=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var u=r.indexOf(".")-i,h=r.length-a.length-u;return pt(r.substr(0,u)+a+r.substr(r.length-h))}if(s=r.match(/^00,000\.([#0]*0)$/))return i=Co(t,s[1].length),t<0?"-"+Mt(e,r,-t):Pr(cv(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Kt(0,3-x.length):"")+x})+"."+Kt(i,s[1].length);switch(r){case"###,##0.00":return Mt(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var d=Pr(un(f,0));return d!=="0"?o+d:"";case"###,###.00":return Mt(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Mt(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function ov(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return yr(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function fv(e,r,t){var n=r.replace(Dl,""),a=r.length-n.length;return yr(e,n,t*Math.pow(10,2*a))+Ne("%",a)}function Ul(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Ul(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(r/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!t.match(/[Ee]/)){var i=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+s):t+="E+"+(i-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,o,l){return f+o+l.substr(0,(a+s)%a)+"."+l.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function nr(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Ll)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?nr("n",n,t):"("+nr("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return ov(e,r,t);if(r.indexOf("%")!==-1)return fv(e,r,t);if(r.indexOf("E")!==-1)return Ul(r,t);if(r.charCodeAt(0)===36)return"$"+nr(e,r.substr(r.charAt(1)==" "?2:1),t);var a,s,i,c,f=Math.abs(t),o=t<0?"-":"";if(r.match(/^00+$/))return o+Kt(f,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:pt(r.substr(0,r.length-a.length))+a;if(s=r.match(Nl))return sv(s,f,o);if(r.match(/^#+0+$/))return o+Kt(f,r.length-r.indexOf("0"));if(s=r.match(Ml))return a=(""+t).replace(/^([^\.]+)$/,"$1."+pt(s[1])).replace(/\.$/,"."+pt(s[1])),a=a.replace(/\.(\d*)$/,function(x,p){return"."+p+Ne("0",pt(s[1]).length-p.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return o+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return o+Pr(""+f);if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+nr(e,r,-t):Pr(""+t)+"."+Ne("0",s[1].length);if(s=r.match(/^#,#*,#0/))return nr(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=En(nr(e,r.replace(/[\\-]/g,""),t)),i=0,En(En(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<a.length?a.charAt(i++):x==="0"?"0":""}));if(r.match(Bl))return a=nr(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var l="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),c=Bs(f,Math.pow(10,i)-1,!1),a=""+o,l=yr("n",s[1],c[1]),l.charAt(l.length-1)==" "&&(l=l.substr(0,l.length-1)+"0"),a+=l+s[2]+"/"+s[3],l=Ms(c[2],i),l.length<s[4].length&&(l=pt(s[4].substr(s[4].length-l.length))+l),a+=l,a;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c=Bs(f,Math.pow(10,i)-1,!0),o+(c[0]||(c[1]?"":"0"))+" "+(c[1]?z0(c[1],i)+s[2]+"/"+s[3]+Ms(c[2],i):Ne(" ",2*i+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:pt(r.substr(0,r.length-a.length))+a;if(s=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var u=r.indexOf(".")-i,h=r.length-a.length-u;return pt(r.substr(0,u)+a+r.substr(r.length-h))}if(s=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+nr(e,r,-t):Pr(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Kt(0,3-x.length):"")+x})+"."+Kt(0,s[1].length);switch(r){case"###,###":case"##,###":case"#,###":var d=Pr(""+f);return d!=="0"?o+d:"";default:if(r.match(/\.[0#?]*$/))return nr(e,r.slice(0,r.lastIndexOf(".")),t)+pt(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function yr(e,r,t){return(t|0)===t?nr(e,r,t):Mt(e,r,t)}function lv(e){for(var r=[],t=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(a,n-a),a=n+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var $l=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Mn(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Ls(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match($l))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function uv(e,r,t,n){for(var a=[],s="",i=0,c="",f="t",o,l,u,h="H";i<e.length;)switch(c=e.charAt(i)){case"G":if(!Ls(e,i))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(u=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(u);a[a.length]={t:"t",v:s},++i;break;case"\\":var d=e.charAt(++i),x=d==="("||d===")"?d:"t";a[a.length]={t:x,v:d},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:r},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(o==null&&(o=jr(r,t,e.charAt(i+1)==="2"),o==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},f=c,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||o==null&&(o=jr(r,t),o==null))return"";for(s=c;++i<e.length&&e.charAt(i).toLowerCase()===c;)s+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=h),a[a.length]={t:c,v:s},f=c;break;case"A":case"a":case"上":var p={t:c,v:c};if(o==null&&(o=jr(r,t)),e.substr(i,3).toUpperCase()==="A/P"?(o!=null&&(p.v=o.H>=12?"P":"A"),p.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(o!=null&&(p.v=o.H>=12?"PM":"AM"),p.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(o!=null&&(p.v=o.H>=12?"下午":"上午"),p.t="T",i+=5,h="h"):(p.t="t",++i),o==null&&p.t==="T")return"";a[a.length]=p,f=c;break;case"[":for(s=c;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match($l)){if(o==null&&(o=jr(r,t),o==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},f=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Mn(e)||(a[a.length]={t:"t",v:s}));break;case".":if(o!=null){for(s=c;++i<e.length&&(c=e.charAt(i))==="0";)s+=c;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++i<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(i))>-1;)s+=c;a[a.length]={t:"n",v:s};break;case"?":for(s=c;e.charAt(++i)===c;)s+=c;a[a.length]={t:c,v:s},f=c;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":c,v:c},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:c,v:c},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++i;break}var m=0,_=0,w;for(i=a.length-1,f="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=h,f="h",m<1&&(m=1);break;case"s":(w=a[i].v.match(/\.0+$/))&&(_=Math.max(_,w[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":f=a[i].t;break;case"m":f==="s"&&(a[i].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&a[i].v.match(/[Hh]/)&&(m=1),m<2&&a[i].v.match(/[Mm]/)&&(m=2),m<3&&a[i].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M),o.M>=60&&(o.M=0,++o.H);break;case 2:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M);break}var v="",C;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=tv(a[i].t.charCodeAt(0),a[i].v,o,_),a[i].t="t";break;case"n":case"?":for(C=i+1;a[C]!=null&&((c=a[C].t)==="?"||c==="D"||(c===" "||c==="t")&&a[C+1]!=null&&(a[C+1].t==="?"||a[C+1].t==="t"&&a[C+1].v==="/")||a[i].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[C].v==="/"||a[C].v===" "&&a[C+1]!=null&&a[C+1].t=="?"));)a[i].v+=a[C].v,a[C]={v:"",t:";"},++C;v+=a[i].v,i=C-1;break;case"G":a[i].t="t",a[i].v=tn(r,t);break}var O="",R,k;if(v.length>0){v.charCodeAt(0)==40?(R=r<0&&v.charCodeAt(0)===45?-r:r,k=yr("n",v,R)):(R=r<0&&n>1?-r:r,k=yr("n",v,R),R<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),C=k.length-1;var U=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){U=i;break}var I=a.length;if(U===a.length&&k.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(C>=a[i].v.length-1?(C-=a[i].v.length,a[i].v=k.substr(C+1,a[i].v.length)):C<0?a[i].v="":(a[i].v=k.substr(0,C+1),C=-1),a[i].t="t",I=i);C>=0&&I<a.length&&(a[I].v=k.substr(0,C+1)+a[I].v)}else if(U!==a.length&&k.indexOf("E")===-1){for(C=k.indexOf(".")-1,i=U;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(l=a[i].v.indexOf(".")>-1&&i===U?a[i].v.indexOf(".")-1:a[i].v.length-1,O=a[i].v.substr(l+1);l>=0;--l)C>=0&&(a[i].v.charAt(l)==="0"||a[i].v.charAt(l)==="#")&&(O=k.charAt(C--)+O);a[i].v=O,a[i].t="t",I=i}for(C>=0&&I<a.length&&(a[I].v=k.substr(0,C+1)+a[I].v),C=k.indexOf(".")+1,i=U;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==U)){for(l=a[i].v.indexOf(".")>-1&&i===U?a[i].v.indexOf(".")+1:0,O=a[i].v.substr(0,l);l<a[i].v.length;++l)C<k.length&&(O+=k.charAt(C++));a[i].v=O,a[i].t="t",I=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(R=n>1&&r<0&&i>0&&a[i-1].v==="-"?-r:r,a[i].v=yr(a[i].t,a[i].v,R),a[i].t="t");var z="";for(i=0;i!==a.length;++i)a[i]!=null&&(z+=a[i].v);return z}var bo=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ro(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function hv(e,r){var t=lv(e),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var i=t[0].match(bo),c=t[1].match(bo);return Ro(r,i)?[n,t[0]]:Ro(r,c)?[n,t[1]]:[n,t[i!=null&&c!=null?2:1]]}return[n,s]}function $t(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:ge)[e],n==null&&(n=t.table&&t.table[So[e]]||ge[So[e]]),n==null&&(n=jg[e]||"General");break}if(Ls(n,0))return tn(r,t);r instanceof Date&&(r=Ol(r,t.date1904));var a=hv(n,r);if(Ls(a[1]))return tn(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return uv(a[1],r,t,a[0])}function Jr(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(ge[t]==null){r<0&&(r=t);continue}if(ge[t]==e){r=t;break}}r<0&&(r=391)}return ge[r]=e,r}function Hl(){ge=Yg()}var dv={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Wl=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function xv(e){var r=typeof e=="number"?ge[e]:e;return r=r.replace(Wl,"(\\d+)"),new RegExp("^"+r+"$")}function pv(e,r,t){var n=-1,a=-1,s=-1,i=-1,c=-1,f=-1;(r.match(Wl)||[]).forEach(function(u,h){var d=parseInt(t[h+1],10);switch(u.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":i=d;break;case"s":f=d;break;case"m":i>=0?c=d:a=d;break}}),f>=0&&c==-1&&a>=0&&(c=a,a=-1);var o=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);o.length==7&&(o="0"+o),o.length==8&&(o="20"+o);var l=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return i==-1&&c==-1&&f==-1?o:n==-1&&a==-1&&s==-1?l:o+"T"+l}var mv=function(){var e={};e.version="1.2.0";function r(){for(var k=0,U=new Array(256),I=0;I!=256;++I)k=I,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,U[I]=k;return typeof Int32Array<"u"?new Int32Array(U):U}var t=r();function n(k){var U=0,I=0,z=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(z=0;z!=256;++z)D[z]=k[z];for(z=0;z!=256;++z)for(I=k[z],U=256+z;U<4096;U+=256)I=D[U]=I>>>8^k[I&255];var B=[];for(z=1;z!=16;++z)B[z-1]=typeof Int32Array<"u"?D.subarray(z*256,z*256+256):D.slice(z*256,z*256+256);return B}var a=n(t),s=a[0],i=a[1],c=a[2],f=a[3],o=a[4],l=a[5],u=a[6],h=a[7],d=a[8],x=a[9],p=a[10],m=a[11],_=a[12],w=a[13],v=a[14];function C(k,U){for(var I=U^-1,z=0,D=k.length;z<D;)I=I>>>8^t[(I^k.charCodeAt(z++))&255];return~I}function O(k,U){for(var I=U^-1,z=k.length-15,D=0;D<z;)I=v[k[D++]^I&255]^w[k[D++]^I>>8&255]^_[k[D++]^I>>16&255]^m[k[D++]^I>>>24]^p[k[D++]]^x[k[D++]]^d[k[D++]]^h[k[D++]]^u[k[D++]]^l[k[D++]]^o[k[D++]]^f[k[D++]]^c[k[D++]]^i[k[D++]]^s[k[D++]]^t[k[D++]];for(z+=15;D<z;)I=I>>>8^t[(I^k[D++])&255];return~I}function R(k,U){for(var I=U^-1,z=0,D=k.length,B=0,Z=0;z<D;)B=k.charCodeAt(z++),B<128?I=I>>>8^t[(I^B)&255]:B<2048?(I=I>>>8^t[(I^(192|B>>6&31))&255],I=I>>>8^t[(I^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,Z=k.charCodeAt(z++)&1023,I=I>>>8^t[(I^(240|B>>8&7))&255],I=I>>>8^t[(I^(128|B>>2&63))&255],I=I>>>8^t[(I^(128|Z>>6&15|(B&3)<<4))&255],I=I>>>8^t[(I^(128|Z&63))&255]):(I=I>>>8^t[(I^(224|B>>12&15))&255],I=I>>>8^t[(I^(128|B>>6&63))&255],I=I>>>8^t[(I^(128|B&63))&255]);return~I}return e.table=t,e.bstr=C,e.buf=O,e.str=R,e}(),ke=function(){var r={};r.version="1.2.1";function t(g,T){for(var y=g.split("/"),E=T.split("/"),A=0,F=0,G=Math.min(y.length,E.length);A<G;++A){if(F=y[A].length-E[A].length)return F;if(y[A]!=E[A])return y[A]<E[A]?-1:1}return y.length-E.length}function n(g){if(g.charAt(g.length-1)=="/")return g.slice(0,-1).indexOf("/")===-1?g:n(g.slice(0,-1));var T=g.lastIndexOf("/");return T===-1?g:g.slice(0,T+1)}function a(g){if(g.charAt(g.length-1)=="/")return a(g.slice(0,-1));var T=g.lastIndexOf("/");return T===-1?g:g.slice(T+1)}function s(g,T){typeof T=="string"&&(T=new Date(T));var y=T.getHours();y=y<<6|T.getMinutes(),y=y<<5|T.getSeconds()>>>1,g.write_shift(2,y);var E=T.getFullYear()-1980;E=E<<4|T.getMonth()+1,E=E<<5|T.getDate(),g.write_shift(2,E)}function i(g){var T=g.read_shift(2)&65535,y=g.read_shift(2)&65535,E=new Date,A=y&31;y>>>=5;var F=y&15;y>>>=4,E.setMilliseconds(0),E.setFullYear(y+1980),E.setMonth(F-1),E.setDate(A);var G=T&31;T>>>=5;var q=T&63;return T>>>=6,E.setHours(T),E.setMinutes(q),E.setSeconds(G<<1),E}function c(g){tt(g,0);for(var T={},y=0;g.l<=g.length-4;){var E=g.read_shift(2),A=g.read_shift(2),F=g.l+A,G={};switch(E){case 21589:y=g.read_shift(1),y&1&&(G.mtime=g.read_shift(4)),A>5&&(y&2&&(G.atime=g.read_shift(4)),y&4&&(G.ctime=g.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}g.l=F,T[E]=G}return T}var f;function o(){return f||(f={})}function l(g,T){if(g[0]==80&&g[1]==75)return Yc(g,T);if((g[0]|32)==109&&(g[1]|32)==105)return Dd(g,T);if(g.length<512)throw new Error("CFB file size "+g.length+" < 512");var y=3,E=512,A=0,F=0,G=0,q=0,V=0,X=[],Y=g.slice(0,512);tt(Y,0);var Q=u(Y);switch(y=Q[0],y){case 3:E=512;break;case 4:E=4096;break;case 0:if(Q[1]==0)return Yc(g,T);default:throw new Error("Major Version: Expected 3 or 4 saw "+y)}E!==512&&(Y=g.slice(0,E),tt(Y,28));var se=g.slice(0,E);h(Y,y);var ue=Y.read_shift(4,"i");if(y===3&&ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ue);Y.l+=4,G=Y.read_shift(4,"i"),Y.l+=4,Y.chk("00100000","Mini Stream Cutoff Size: "),q=Y.read_shift(4,"i"),A=Y.read_shift(4,"i"),V=Y.read_shift(4,"i"),F=Y.read_shift(4,"i");for(var re=-1,le=0;le<109&&(re=Y.read_shift(4,"i"),!(re<0));++le)X[le]=re;var me=d(g,E);m(V,F,me,E,X);var Oe=w(me,G,X,E);Oe[G].name="!Directory",A>0&&q!==Z&&(Oe[q].name="!MiniFAT"),Oe[X[0]].name="!FAT",Oe.fat_addrs=X,Oe.ssz=E;var De={},st=[],Gn=[],zn=[];v(G,Oe,me,st,A,De,Gn,q),x(Gn,zn,st),st.shift();var Xn={FileIndex:Gn,FullPaths:zn};return T&&T.raw&&(Xn.raw={header:se,sectors:me}),Xn}function u(g){if(g[g.l]==80&&g[g.l+1]==75)return[0,0];g.chk(P,"Header Signature: "),g.l+=16;var T=g.read_shift(2,"u");return[g.read_shift(2,"u"),T]}function h(g,T){var y=9;switch(g.l+=2,y=g.read_shift(2)){case 9:if(T!=3)throw new Error("Sector Shift: Expected 9 saw "+y);break;case 12:if(T!=4)throw new Error("Sector Shift: Expected 12 saw "+y);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+y)}g.chk("0600","Mini Sector Shift: "),g.chk("000000000000","Reserved: ")}function d(g,T){for(var y=Math.ceil(g.length/T)-1,E=[],A=1;A<y;++A)E[A-1]=g.slice(A*T,(A+1)*T);return E[y-1]=g.slice(y*T),E}function x(g,T,y){for(var E=0,A=0,F=0,G=0,q=0,V=y.length,X=[],Y=[];E<V;++E)X[E]=Y[E]=E,T[E]=y[E];for(;q<Y.length;++q)E=Y[q],A=g[E].L,F=g[E].R,G=g[E].C,X[E]===E&&(A!==-1&&X[A]!==A&&(X[E]=X[A]),F!==-1&&X[F]!==F&&(X[E]=X[F])),G!==-1&&(X[G]=E),A!==-1&&E!=X[E]&&(X[A]=X[E],Y.lastIndexOf(A)<q&&Y.push(A)),F!==-1&&E!=X[E]&&(X[F]=X[E],Y.lastIndexOf(F)<q&&Y.push(F));for(E=1;E<V;++E)X[E]===E&&(F!==-1&&X[F]!==F?X[E]=X[F]:A!==-1&&X[A]!==A&&(X[E]=X[A]));for(E=1;E<V;++E)if(g[E].type!==0){if(q=E,q!=X[q])do q=X[q],T[E]=T[q]+"/"+T[E];while(q!==0&&X[q]!==-1&&q!=X[q]);X[E]=-1}for(T[0]+="/",E=1;E<V;++E)g[E].type!==2&&(T[E]+="/")}function p(g,T,y){for(var E=g.start,A=g.size,F=[],G=E;y&&A>0&&G>=0;)F.push(T.slice(G*B,G*B+B)),A-=B,G=zr(y,G*4);return F.length===0?Ye(0):Or(F).slice(0,g.size)}function m(g,T,y,E,A){var F=Z;if(g===Z){if(T!==0)throw new Error("DIFAT chain shorter than expected")}else if(g!==-1){var G=y[g],q=(E>>>2)-1;if(!G)return;for(var V=0;V<q&&(F=zr(G,V*4))!==Z;++V)A.push(F);m(zr(G,E-4),T-1,y,E,A)}}function _(g,T,y,E,A){var F=[],G=[];A||(A=[]);var q=E-1,V=0,X=0;for(V=T;V>=0;){A[V]=!0,F[F.length]=V,G.push(g[V]);var Y=y[Math.floor(V*4/E)];if(X=V*4&q,E<4+X)throw new Error("FAT boundary crossed: "+V+" 4 "+E);if(!g[Y])break;V=zr(g[Y],X)}return{nodes:F,data:$o([G])}}function w(g,T,y,E){var A=g.length,F=[],G=[],q=[],V=[],X=E-1,Y=0,Q=0,se=0,ue=0;for(Y=0;Y<A;++Y)if(q=[],se=Y+T,se>=A&&(se-=A),!G[se]){V=[];var re=[];for(Q=se;Q>=0;){re[Q]=!0,G[Q]=!0,q[q.length]=Q,V.push(g[Q]);var le=y[Math.floor(Q*4/E)];if(ue=Q*4&X,E<4+ue)throw new Error("FAT boundary crossed: "+Q+" 4 "+E);if(!g[le]||(Q=zr(g[le],ue),re[Q]))break}F[se]={nodes:q,data:$o([V])}}return F}function v(g,T,y,E,A,F,G,q){for(var V=0,X=E.length?2:0,Y=T[g].data,Q=0,se=0,ue;Q<Y.length;Q+=128){var re=Y.slice(Q,Q+128);tt(re,64),se=re.read_shift(2),ue=J0(re,0,se-X),E.push(ue);var le={name:ue,type:re.read_shift(1),color:re.read_shift(1),L:re.read_shift(4,"i"),R:re.read_shift(4,"i"),C:re.read_shift(4,"i"),clsid:re.read_shift(16),state:re.read_shift(4,"i"),start:0,size:0},me=re.read_shift(2)+re.read_shift(2)+re.read_shift(2)+re.read_shift(2);me!==0&&(le.ct=C(re,re.l-8));var Oe=re.read_shift(2)+re.read_shift(2)+re.read_shift(2)+re.read_shift(2);Oe!==0&&(le.mt=C(re,re.l-8)),le.start=re.read_shift(4,"i"),le.size=re.read_shift(4,"i"),le.size<0&&le.start<0&&(le.size=le.type=0,le.start=Z,le.name=""),le.type===5?(V=le.start,A>0&&V!==Z&&(T[V].name="!StreamData")):le.size>=4096?(le.storage="fat",T[le.start]===void 0&&(T[le.start]=_(y,le.start,T.fat_addrs,T.ssz)),T[le.start].name=le.name,le.content=T[le.start].data.slice(0,le.size)):(le.storage="minifat",le.size<0?le.size=0:V!==Z&&le.start!==Z&&T[V]&&(le.content=p(le,T[V].data,(T[q]||{}).data))),le.content&&tt(le.content,0),F[ue]=le,G.push(le)}}function C(g,T){return new Date((bt(g,T+4)/1e7*Math.pow(2,32)+bt(g,T)/1e7-11644473600)*1e3)}function O(g,T){return o(),l(f.readFileSync(g),T)}function R(g,T){var y=T&&T.type;switch(y||ye&&Buffer.isBuffer(g)&&(y="buffer"),y||"base64"){case"file":return O(g,T);case"base64":return l(Yt(Ot(g)),T);case"binary":return l(Yt(g),T)}return l(g,T)}function k(g,T){var y=T||{},E=y.root||"Root Entry";if(g.FullPaths||(g.FullPaths=[]),g.FileIndex||(g.FileIndex=[]),g.FullPaths.length!==g.FileIndex.length)throw new Error("inconsistent CFB structure");g.FullPaths.length===0&&(g.FullPaths[0]=E+"/",g.FileIndex[0]={name:E,type:5}),y.CLSID&&(g.FileIndex[0].clsid=y.CLSID),U(g)}function U(g){var T="Sh33tJ5";if(!ke.find(g,"/"+T)){var y=Ye(4);y[0]=55,y[1]=y[3]=50,y[2]=54,g.FileIndex.push({name:T,type:2,content:y,size:4,L:69,R:69,C:69}),g.FullPaths.push(g.FullPaths[0]+T),I(g)}}function I(g,T){k(g);for(var y=!1,E=!1,A=g.FullPaths.length-1;A>=0;--A){var F=g.FileIndex[A];switch(F.type){case 0:E?y=!0:(g.FileIndex.pop(),g.FullPaths.pop());break;case 1:case 2:case 5:E=!0,isNaN(F.R*F.L*F.C)&&(y=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(y=!0);break;default:y=!0;break}}if(!(!y&&!T)){var G=new Date(1987,1,19),q=0,V=Object.create?Object.create(null):{},X=[];for(A=0;A<g.FullPaths.length;++A)V[g.FullPaths[A]]=!0,g.FileIndex[A].type!==0&&X.push([g.FullPaths[A],g.FileIndex[A]]);for(A=0;A<X.length;++A){var Y=n(X[A][0]);E=V[Y],E||(X.push([Y,{name:a(Y).replace("/",""),type:1,clsid:H,ct:G,mt:G,content:null}]),V[Y]=!0)}for(X.sort(function(ue,re){return t(ue[0],re[0])}),g.FullPaths=[],g.FileIndex=[],A=0;A<X.length;++A)g.FullPaths[A]=X[A][0],g.FileIndex[A]=X[A][1];for(A=0;A<X.length;++A){var Q=g.FileIndex[A],se=g.FullPaths[A];if(Q.name=a(se).replace("/",""),Q.L=Q.R=Q.C=-(Q.color=1),Q.size=Q.content?Q.content.length:0,Q.start=0,Q.clsid=Q.clsid||H,A===0)Q.C=X.length>1?1:-1,Q.size=0,Q.type=5;else if(se.slice(-1)=="/"){for(q=A+1;q<X.length&&n(g.FullPaths[q])!=se;++q);for(Q.C=q>=X.length?-1:q,q=A+1;q<X.length&&n(g.FullPaths[q])!=n(se);++q);Q.R=q>=X.length?-1:q,Q.type=1}else n(g.FullPaths[A+1]||"")==n(se)&&(Q.R=A+1),Q.type=2}}}function z(g,T){var y=T||{};if(y.fileType=="mad")return Pd(g,y);switch(I(g),y.fileType){case"zip":return Fd(g,y)}var E=function(ue){for(var re=0,le=0,me=0;me<ue.FileIndex.length;++me){var Oe=ue.FileIndex[me];if(Oe.content){var De=Oe.content.length;De>0&&(De<4096?re+=De+63>>6:le+=De+511>>9)}}for(var st=ue.FullPaths.length+3>>2,Gn=re+7>>3,zn=re+127>>7,Xn=Gn+le+st+zn,Hr=Xn+127>>7,pi=Hr<=109?0:Math.ceil((Hr-109)/127);Xn+Hr+pi+127>>7>Hr;)pi=++Hr<=109?0:Math.ceil((Hr-109)/127);var pr=[1,pi,Hr,zn,st,le,re,0];return ue.FileIndex[0].size=re<<6,pr[7]=(ue.FileIndex[0].start=pr[0]+pr[1]+pr[2]+pr[3]+pr[4]+pr[5])+(pr[6]+7>>3),pr}(g),A=Ye(E[7]<<9),F=0,G=0;{for(F=0;F<8;++F)A.write_shift(1,j[F]);for(F=0;F<8;++F)A.write_shift(2,0);for(A.write_shift(2,62),A.write_shift(2,3),A.write_shift(2,65534),A.write_shift(2,9),A.write_shift(2,6),F=0;F<3;++F)A.write_shift(2,0);for(A.write_shift(4,0),A.write_shift(4,E[2]),A.write_shift(4,E[0]+E[1]+E[2]+E[3]-1),A.write_shift(4,0),A.write_shift(4,4096),A.write_shift(4,E[3]?E[0]+E[1]+E[2]-1:Z),A.write_shift(4,E[3]),A.write_shift(-4,E[1]?E[0]-1:Z),A.write_shift(4,E[1]),F=0;F<109;++F)A.write_shift(-4,F<E[2]?E[1]+F:-1)}if(E[1])for(G=0;G<E[1];++G){for(;F<236+G*127;++F)A.write_shift(-4,F<E[2]?E[1]+F:-1);A.write_shift(-4,G===E[1]-1?Z:G+1)}var q=function(ue){for(G+=ue;F<G-1;++F)A.write_shift(-4,F+1);ue&&(++F,A.write_shift(-4,Z))};for(G=F=0,G+=E[1];F<G;++F)A.write_shift(-4,K.DIFSECT);for(G+=E[2];F<G;++F)A.write_shift(-4,K.FATSECT);q(E[3]),q(E[4]);for(var V=0,X=0,Y=g.FileIndex[0];V<g.FileIndex.length;++V)Y=g.FileIndex[V],Y.content&&(X=Y.content.length,!(X<4096)&&(Y.start=G,q(X+511>>9)));for(q(E[6]+7>>3);A.l&511;)A.write_shift(-4,K.ENDOFCHAIN);for(G=F=0,V=0;V<g.FileIndex.length;++V)Y=g.FileIndex[V],Y.content&&(X=Y.content.length,!(!X||X>=4096)&&(Y.start=G,q(X+63>>6)));for(;A.l&511;)A.write_shift(-4,K.ENDOFCHAIN);for(F=0;F<E[4]<<2;++F){var Q=g.FullPaths[F];if(!Q||Q.length===0){for(V=0;V<17;++V)A.write_shift(4,0);for(V=0;V<3;++V)A.write_shift(4,-1);for(V=0;V<12;++V)A.write_shift(4,0);continue}Y=g.FileIndex[F],F===0&&(Y.start=Y.size?Y.start-1:Z);var se=F===0&&y.root||Y.name;if(X=2*(se.length+1),A.write_shift(64,se,"utf16le"),A.write_shift(2,X),A.write_shift(1,Y.type),A.write_shift(1,Y.color),A.write_shift(-4,Y.L),A.write_shift(-4,Y.R),A.write_shift(-4,Y.C),Y.clsid)A.write_shift(16,Y.clsid,"hex");else for(V=0;V<4;++V)A.write_shift(4,0);A.write_shift(4,Y.state||0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,Y.start),A.write_shift(4,Y.size),A.write_shift(4,0)}for(F=1;F<g.FileIndex.length;++F)if(Y=g.FileIndex[F],Y.size>=4096)if(A.l=Y.start+1<<9,ye&&Buffer.isBuffer(Y.content))Y.content.copy(A,A.l,0,Y.size),A.l+=Y.size+511&-512;else{for(V=0;V<Y.size;++V)A.write_shift(1,Y.content[V]);for(;V&511;++V)A.write_shift(1,0)}for(F=1;F<g.FileIndex.length;++F)if(Y=g.FileIndex[F],Y.size>0&&Y.size<4096)if(ye&&Buffer.isBuffer(Y.content))Y.content.copy(A,A.l,0,Y.size),A.l+=Y.size+63&-64;else{for(V=0;V<Y.size;++V)A.write_shift(1,Y.content[V]);for(;V&63;++V)A.write_shift(1,0)}if(ye)A.l=A.length;else for(;A.l<A.length;)A.write_shift(1,0);return A}function D(g,T){var y=g.FullPaths.map(function(V){return V.toUpperCase()}),E=y.map(function(V){var X=V.split("/");return X[X.length-(V.slice(-1)=="/"?2:1)]}),A=!1;T.charCodeAt(0)===47?(A=!0,T=y[0].slice(0,-1)+T):A=T.indexOf("/")!==-1;var F=T.toUpperCase(),G=A===!0?y.indexOf(F):E.indexOf(F);if(G!==-1)return g.FileIndex[G];var q=!F.match(Zn);for(F=F.replace(vt,""),q&&(F=F.replace(Zn,"!")),G=0;G<y.length;++G)if((q?y[G].replace(Zn,"!"):y[G]).replace(vt,"")==F||(q?E[G].replace(Zn,"!"):E[G]).replace(vt,"")==F)return g.FileIndex[G];return null}var B=64,Z=-2,P="d0cf11e0a1b11ae1",j=[208,207,17,224,161,177,26,225],H="00000000000000000000000000000000",K={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Z,FREESECT:-1,HEADER_SIGNATURE:P,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:H,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function fe(g,T,y){o();var E=z(g,y);f.writeFileSync(T,E)}function L(g){for(var T=new Array(g.length),y=0;y<g.length;++y)T[y]=String.fromCharCode(g[y]);return T.join("")}function ne(g,T){var y=z(g,T);switch(T&&T.type||"buffer"){case"file":return o(),f.writeFileSync(T.filename,y),y;case"binary":return typeof y=="string"?y:L(y);case"base64":return Eo(typeof y=="string"?y:L(y));case"buffer":if(ye)return Buffer.isBuffer(y)?y:an(y);case"array":return typeof y=="string"?Yt(y):y}return y}var oe;function S(g){try{var T=g.InflateRaw,y=new T;if(y._processChunk(new Uint8Array([3,0]),y._finishFlushFlag),y.bytesRead)oe=g;else throw new Error("zlib does not expose bytesRead")}catch(E){console.error("cannot use native zlib: "+(E.message||E))}}function W(g,T){if(!oe)return zc(g,T);var y=oe.InflateRaw,E=new y,A=E._processChunk(g.slice(g.l),E._finishFlushFlag);return g.l+=E.bytesRead,A}function M(g){return oe?oe.deflateRawSync(g):_e(g)}var N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(g){var T=(g<<1|g<<11)&139536|(g<<5|g<<15)&558144;return(T>>16|T>>8|T)&255}for(var ae=typeof Uint8Array<"u",ee=ae?new Uint8Array(256):[],Ae=0;Ae<256;++Ae)ee[Ae]=ie(Ae);function b(g,T){var y=ee[g&255];return T<=8?y>>>8-T:(y=y<<8|ee[g>>8&255],T<=16?y>>>16-T:(y=y<<8|ee[g>>16&255],y>>>24-T))}function Le(g,T){var y=T&7,E=T>>>3;return(g[E]|(y<=6?0:g[E+1]<<8))>>>y&3}function Fe(g,T){var y=T&7,E=T>>>3;return(g[E]|(y<=5?0:g[E+1]<<8))>>>y&7}function be(g,T){var y=T&7,E=T>>>3;return(g[E]|(y<=4?0:g[E+1]<<8))>>>y&15}function we(g,T){var y=T&7,E=T>>>3;return(g[E]|(y<=3?0:g[E+1]<<8))>>>y&31}function ce(g,T){var y=T&7,E=T>>>3;return(g[E]|(y<=1?0:g[E+1]<<8))>>>y&127}function Be(g,T,y){var E=T&7,A=T>>>3,F=(1<<y)-1,G=g[A]>>>E;return y<8-E||(G|=g[A+1]<<8-E,y<16-E)||(G|=g[A+2]<<16-E,y<24-E)||(G|=g[A+3]<<24-E),G&F}function Dt(g,T,y){var E=T&7,A=T>>>3;return E<=5?g[A]|=(y&7)<<E:(g[A]|=y<<E&255,g[A+1]=(y&7)>>8-E),T+3}function Qt(g,T,y){var E=T&7,A=T>>>3;return y=(y&1)<<E,g[A]|=y,T+1}function dr(g,T,y){var E=T&7,A=T>>>3;return y<<=E,g[A]|=y&255,y>>>=8,g[A+1]=y,T+8}function Wn(g,T,y){var E=T&7,A=T>>>3;return y<<=E,g[A]|=y&255,y>>>=8,g[A+1]=y&255,g[A+2]=y>>>8,T+16}function Sr(g,T){var y=g.length,E=2*y>T?2*y:T+5,A=0;if(y>=T)return g;if(ye){var F=ko(E);if(g.copy)g.copy(F);else for(;A<g.length;++A)F[A]=g[A];return F}else if(ae){var G=new Uint8Array(E);if(G.set)G.set(g);else for(;A<y;++A)G[A]=g[A];return G}return g.length=E,g}function Tt(g){for(var T=new Array(g),y=0;y<g;++y)T[y]=0;return T}function xr(g,T,y){var E=1,A=0,F=0,G=0,q=0,V=g.length,X=ae?new Uint16Array(32):Tt(32);for(F=0;F<32;++F)X[F]=0;for(F=V;F<y;++F)g[F]=0;V=g.length;var Y=ae?new Uint16Array(V):Tt(V);for(F=0;F<V;++F)X[A=g[F]]++,E<A&&(E=A),Y[F]=0;for(X[0]=0,F=1;F<=E;++F)X[F+16]=q=q+X[F-1]<<1;for(F=0;F<V;++F)q=g[F],q!=0&&(Y[F]=X[q+16]++);var Q=0;for(F=0;F<V;++F)if(Q=g[F],Q!=0)for(q=b(Y[F],E)>>E-Q,G=(1<<E+4-Q)-1;G>=0;--G)T[q|G<<Q]=Q&15|F<<4;return E}var Fr=ae?new Uint16Array(512):Tt(512),Vn=ae?new Uint16Array(32):Tt(32);if(!ae){for(var xt=0;xt<512;++xt)Fr[xt]=0;for(xt=0;xt<32;++xt)Vn[xt]=0}(function(){for(var g=[],T=0;T<32;T++)g.push(5);xr(g,Vn,32);var y=[];for(T=0;T<=143;T++)y.push(8);for(;T<=255;T++)y.push(9);for(;T<=279;T++)y.push(7);for(;T<=287;T++)y.push(8);xr(y,Fr,288)})();var er=function(){for(var T=ae?new Uint8Array(32768):[],y=0,E=0;y<te.length-1;++y)for(;E<te[y+1];++E)T[E]=y;for(;E<32768;++E)T[E]=29;var A=ae?new Uint8Array(259):[];for(y=0,E=0;y<J.length-1;++y)for(;E<J[y+1];++E)A[E]=y;function F(q,V){for(var X=0;X<q.length;){var Y=Math.min(65535,q.length-X),Q=X+Y==q.length;for(V.write_shift(1,+Q),V.write_shift(2,Y),V.write_shift(2,~Y&65535);Y-- >0;)V[V.l++]=q[X++]}return V.l}function G(q,V){for(var X=0,Y=0,Q=ae?new Uint16Array(32768):[];Y<q.length;){var se=Math.min(65535,q.length-Y);if(se<10){for(X=Dt(V,X,+(Y+se==q.length)),X&7&&(X+=8-(X&7)),V.l=X/8|0,V.write_shift(2,se),V.write_shift(2,~se&65535);se-- >0;)V[V.l++]=q[Y++];X=V.l*8;continue}X=Dt(V,X,+(Y+se==q.length)+2);for(var ue=0;se-- >0;){var re=q[Y];ue=(ue<<5^re)&32767;var le=-1,me=0;if((le=Q[ue])&&(le|=Y&-32768,le>Y&&(le-=32768),le<Y))for(;q[le+me]==q[Y+me]&&me<250;)++me;if(me>2){re=A[me],re<=22?X=dr(V,X,ee[re+1]>>1)-1:(dr(V,X,3),X+=5,dr(V,X,ee[re-23]>>5),X+=3);var Oe=re<8?0:re-4>>2;Oe>0&&(Wn(V,X,me-J[re]),X+=Oe),re=T[Y-le],X=dr(V,X,ee[re]>>3),X-=3;var De=re<4?0:re-2>>1;De>0&&(Wn(V,X,Y-le-te[re]),X+=De);for(var st=0;st<me;++st)Q[ue]=Y&32767,ue=(ue<<5^q[Y])&32767,++Y;se-=me-1}else re<=143?re=re+48:X=Qt(V,X,1),X=dr(V,X,ee[re]),Q[ue]=Y&32767,++Y}X=dr(V,X,0)-1}return V.l=(X+7)/8|0,V.l}return function(V,X){return V.length<8?F(V,X):G(V,X)}}();function _e(g){var T=Ye(50+Math.floor(g.length*1.1)),y=er(g,T);return T.slice(0,y)}var Ue=ae?new Uint16Array(32768):Tt(32768),Pt=ae?new Uint16Array(32768):Tt(32768),Ge=ae?new Uint16Array(128):Tt(128),$r=1,Gc=1;function Td(g,T){var y=we(g,T)+257;T+=5;var E=we(g,T)+1;T+=5;var A=be(g,T)+4;T+=4;for(var F=0,G=ae?new Uint8Array(19):Tt(19),q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],V=1,X=ae?new Uint8Array(8):Tt(8),Y=ae?new Uint8Array(8):Tt(8),Q=G.length,se=0;se<A;++se)G[N[se]]=F=Fe(g,T),V<F&&(V=F),X[F]++,T+=3;var ue=0;for(X[0]=0,se=1;se<=V;++se)Y[se]=ue=ue+X[se-1]<<1;for(se=0;se<Q;++se)(ue=G[se])!=0&&(q[se]=Y[ue]++);var re=0;for(se=0;se<Q;++se)if(re=G[se],re!=0){ue=ee[q[se]]>>8-re;for(var le=(1<<7-re)-1;le>=0;--le)Ge[ue|le<<re]=re&7|se<<3}var me=[];for(V=1;me.length<y+E;)switch(ue=Ge[ce(g,T)],T+=ue&7,ue>>>=3){case 16:for(F=3+Le(g,T),T+=2,ue=me[me.length-1];F-- >0;)me.push(ue);break;case 17:for(F=3+Fe(g,T),T+=3;F-- >0;)me.push(0);break;case 18:for(F=11+ce(g,T),T+=7;F-- >0;)me.push(0);break;default:me.push(ue),V<ue&&(V=ue);break}var Oe=me.slice(0,y),De=me.slice(y);for(se=y;se<286;++se)Oe[se]=0;for(se=E;se<30;++se)De[se]=0;return $r=xr(Oe,Ue,286),Gc=xr(De,Pt,30),T}function Ad(g,T){if(g[0]==3&&!(g[1]&3))return[Mr(T),2];for(var y=0,E=0,A=ko(T||1<<18),F=0,G=A.length>>>0,q=0,V=0;(E&1)==0;){if(E=Fe(g,y),y+=3,E>>>1)E>>1==1?(q=9,V=5):(y=Td(g,y),q=$r,V=Gc);else{y&7&&(y+=8-(y&7));var X=g[y>>>3]|g[(y>>>3)+1]<<8;if(y+=32,X>0)for(!T&&G<F+X&&(A=Sr(A,F+X),G=A.length);X-- >0;)A[F++]=g[y>>>3],y+=8;continue}for(;;){!T&&G<F+32767&&(A=Sr(A,F+32767),G=A.length);var Y=Be(g,y,q),Q=E>>>1==1?Fr[Y]:Ue[Y];if(y+=Q&15,Q>>>=4,(Q>>>8&255)===0)A[F++]=Q;else{if(Q==256)break;Q-=257;var se=Q<8?0:Q-4>>2;se>5&&(se=0);var ue=F+J[Q];se>0&&(ue+=Be(g,y,se),y+=se),Y=Be(g,y,V),Q=E>>>1==1?Vn[Y]:Pt[Y],y+=Q&15,Q>>>=4;var re=Q<4?0:Q-2>>1,le=te[Q];for(re>0&&(le+=Be(g,y,re),y+=re),!T&&G<ue&&(A=Sr(A,ue+100),G=A.length);F<ue;)A[F]=A[F-le],++F}}}return T?[A,y+7>>>3]:[A.slice(0,F),y+7>>>3]}function zc(g,T){var y=g.slice(g.l||0),E=Ad(y,T);return g.l+=E[1],E[0]}function Xc(g,T){if(g)typeof console<"u"&&console.error(T);else throw new Error(T)}function Yc(g,T){var y=g;tt(y,0);var E=[],A=[],F={FileIndex:E,FullPaths:A};k(F,{root:T.root});for(var G=y.length-4;(y[G]!=80||y[G+1]!=75||y[G+2]!=5||y[G+3]!=6)&&G>=0;)--G;y.l=G+4,y.l+=4;var q=y.read_shift(2);y.l+=6;var V=y.read_shift(4);for(y.l=V,G=0;G<q;++G){y.l+=20;var X=y.read_shift(4),Y=y.read_shift(4),Q=y.read_shift(2),se=y.read_shift(2),ue=y.read_shift(2);y.l+=8;var re=y.read_shift(4),le=c(y.slice(y.l+Q,y.l+Q+se));y.l+=Q+se+ue;var me=y.l;y.l=re+4,Sd(y,X,Y,F,le),y.l=me}return F}function Sd(g,T,y,E,A){g.l+=2;var F=g.read_shift(2),G=g.read_shift(2),q=i(g);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var V=g.read_shift(4),X=g.read_shift(4),Y=g.read_shift(4),Q=g.read_shift(2),se=g.read_shift(2),ue="",re=0;re<Q;++re)ue+=String.fromCharCode(g[g.l++]);if(se){var le=c(g.slice(g.l,g.l+se));(le[21589]||{}).mt&&(q=le[21589].mt),((A||{})[21589]||{}).mt&&(q=A[21589].mt)}g.l+=se;var me=g.slice(g.l,g.l+X);switch(G){case 8:me=W(g,Y);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var Oe=!1;F&8&&(V=g.read_shift(4),V==134695760&&(V=g.read_shift(4),Oe=!0),X=g.read_shift(4),Y=g.read_shift(4)),X!=T&&Xc(Oe,"Bad compressed size: "+T+" != "+X),Y!=y&&Xc(Oe,"Bad uncompressed size: "+y+" != "+Y),xi(E,ue,me,{unsafe:!0,mt:q})}function Fd(g,T){var y=T||{},E=[],A=[],F=Ye(1),G=y.compression?8:0,q=0,V=0,X=0,Y=0,Q=0,se=g.FullPaths[0],ue=se,re=g.FileIndex[0],le=[],me=0;for(V=1;V<g.FullPaths.length;++V)if(ue=g.FullPaths[V].slice(se.length),re=g.FileIndex[V],!(!re.size||!re.content||ue=="Sh33tJ5")){var Oe=Y,De=Ye(ue.length);for(X=0;X<ue.length;++X)De.write_shift(1,ue.charCodeAt(X)&127);De=De.slice(0,De.l),le[Q]=mv.buf(re.content,0);var st=re.content;G==8&&(st=M(st)),F=Ye(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,q),F.write_shift(2,G),re.mt?s(F,re.mt):F.write_shift(4,0),F.write_shift(-4,le[Q]),F.write_shift(4,st.length),F.write_shift(4,re.content.length),F.write_shift(2,De.length),F.write_shift(2,0),Y+=F.length,E.push(F),Y+=De.length,E.push(De),Y+=st.length,E.push(st),F=Ye(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,q),F.write_shift(2,G),F.write_shift(4,0),F.write_shift(-4,le[Q]),F.write_shift(4,st.length),F.write_shift(4,re.content.length),F.write_shift(2,De.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,Oe),me+=F.l,A.push(F),me+=De.length,A.push(De),++Q}return F=Ye(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,Q),F.write_shift(2,Q),F.write_shift(4,me),F.write_shift(4,Y),F.write_shift(2,0),Or([Or(E),Or(A),F])}var Ga={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Cd(g,T){if(g.ctype)return g.ctype;var y=g.name||"",E=y.match(/\.([^\.]+)$/);return E&&Ga[E[1]]||T&&(E=(y=T).match(/[\.\\]([^\.\\])+$/),E&&Ga[E[1]])?Ga[E[1]]:"application/octet-stream"}function bd(g){for(var T=Eo(g),y=[],E=0;E<T.length;E+=76)y.push(T.slice(E,E+76));return y.join(`\r
`)+`\r
`}function Rd(g){var T=g.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(X){var Y=X.charCodeAt(0).toString(16).toUpperCase();return"="+(Y.length==1?"0"+Y:Y)});T=T.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),T.charAt(0)==`
`&&(T="=0D"+T.slice(1)),T=T.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var y=[],E=T.split(`\r
`),A=0;A<E.length;++A){var F=E[A];if(F.length==0){y.push("");continue}for(var G=0;G<F.length;){var q=76,V=F.slice(G,G+q);V.charAt(q-1)=="="?q--:V.charAt(q-2)=="="?q-=2:V.charAt(q-3)=="="&&(q-=3),V=F.slice(G,G+q),G+=q,G<F.length&&(V+="="),y.push(V)}}return y.join(`\r
`)}function Id(g){for(var T=[],y=0;y<g.length;++y){for(var E=g[y];y<=g.length&&E.charAt(E.length-1)=="=";)E=E.slice(0,E.length-1)+g[++y];T.push(E)}for(var A=0;A<T.length;++A)T[A]=T[A].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return Yt(T.join(`\r
`))}function Od(g,T,y){for(var E="",A="",F="",G,q=0;q<10;++q){var V=T[q];if(!V||V.match(/^\s*$/))break;var X=V.match(/^(.*?):\s*([^\s].*)$/);if(X)switch(X[1].toLowerCase()){case"content-location":E=X[2].trim();break;case"content-type":F=X[2].trim();break;case"content-transfer-encoding":A=X[2].trim();break}}switch(++q,A.toLowerCase()){case"base64":G=Yt(Ot(T.slice(q).join("")));break;case"quoted-printable":G=Id(T.slice(q));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+A)}var Y=xi(g,E.slice(y.length),G,{unsafe:!0});F&&(Y.ctype=F)}function Dd(g,T){if(L(g.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var y=T&&T.root||"",E=(ye&&Buffer.isBuffer(g)?g.toString("binary"):L(g)).split(`\r
`),A=0,F="";for(A=0;A<E.length;++A)if(F=E[A],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),y||(y=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,y.length)!=y))for(;y.length>0&&(y=y.slice(0,y.length-1),y=y.slice(0,y.lastIndexOf("/")+1),F.slice(0,y.length)!=y););var G=(E[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var q="--"+(G[1]||""),V=[],X=[],Y={FileIndex:V,FullPaths:X};k(Y);var Q,se=0;for(A=0;A<E.length;++A){var ue=E[A];ue!==q&&ue!==q+"--"||(se++&&Od(Y,E.slice(Q,A),y),Q=A)}return Y}function Pd(g,T){var y=T||{},E=y.boundary||"SheetJS";E="------="+E;for(var A=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+E.slice(2)+'"',"","",""],F=g.FullPaths[0],G=F,q=g.FileIndex[0],V=1;V<g.FullPaths.length;++V)if(G=g.FullPaths[V].slice(F.length),q=g.FileIndex[V],!(!q.size||!q.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(me){return"_x"+me.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(me){return"_u"+me.charCodeAt(0).toString(16)+"_"});for(var X=q.content,Y=ye&&Buffer.isBuffer(X)?X.toString("binary"):L(X),Q=0,se=Math.min(1024,Y.length),ue=0,re=0;re<=se;++re)(ue=Y.charCodeAt(re))>=32&&ue<128&&++Q;var le=Q>=se*4/5;A.push(E),A.push("Content-Location: "+(y.root||"file:///C:/SheetJS/")+G),A.push("Content-Transfer-Encoding: "+(le?"quoted-printable":"base64")),A.push("Content-Type: "+Cd(q,G)),A.push(""),A.push(le?Rd(Y):bd(Y))}return A.push(E+`--\r
`),A.join(`\r
`)}function Nd(g){var T={};return k(T,g),T}function xi(g,T,y,E){var A=E&&E.unsafe;A||k(g);var F=!A&&ke.find(g,T);if(!F){var G=g.FullPaths[0];T.slice(0,G.length)==G?G=T:(G.slice(-1)!="/"&&(G+="/"),G=(G+T).replace("//","/")),F={name:a(T),type:2},g.FileIndex.push(F),g.FullPaths.push(G),A||ke.utils.cfb_gc(g)}return F.content=y,F.size=y?y.length:0,E&&(E.CLSID&&(F.clsid=E.CLSID),E.mt&&(F.mt=E.mt),E.ct&&(F.ct=E.ct)),F}function Md(g,T){k(g);var y=ke.find(g,T);if(y){for(var E=0;E<g.FileIndex.length;++E)if(g.FileIndex[E]==y)return g.FileIndex.splice(E,1),g.FullPaths.splice(E,1),!0}return!1}function Ld(g,T,y){k(g);var E=ke.find(g,T);if(E){for(var A=0;A<g.FileIndex.length;++A)if(g.FileIndex[A]==E)return g.FileIndex[A].name=a(y),g.FullPaths[A]=y,!0}return!1}function Bd(g){I(g,!0)}return r.find=D,r.read=R,r.parse=l,r.write=ne,r.writeFile=fe,r.utils={cfb_new:Nd,cfb_add:xi,cfb_del:Md,cfb_mov:Ld,cfb_gc:Bd,ReadShift:ca,CheckField:lu,prep_blob:tt,bconcat:Or,use_zlib:S,_deflateRaw:_e,_inflateRaw:zc,consts:K},r}();function gv(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function fr(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function Y0(e){for(var r=[],t=fr(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}var Us=new Date(1899,11,30,0,0,0);function _t(e,r){var t=e.getTime(),n=Us.getTime()+(e.getTimezoneOffset()-Us.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var Vl=new Date,vv=Us.getTime()+(Vl.getTimezoneOffset()-Us.getTimezoneOffset())*6e4,Io=Vl.getTimezoneOffset();function ei(e){var r=new Date;return r.setTime(e*24*60*60*1e3+vv),r.getTimezoneOffset()!==Io&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Io)*6e4),r}function _v(e){var r=0,t=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(t=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(a[s],10)}return r}var Oo=new Date("2017-02-19T19:06:09.000Z"),Gl=isNaN(Oo.getFullYear())?new Date("2/19/17"):Oo,wv=Gl.getFullYear()==2017;function Ze(e,r){var t=new Date(e);if(wv)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Gl.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function rn(e,r){if(ye&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return ea(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ea(Rl(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return ea(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ea(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return t[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function rt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=rt(e[t]));return r}function Ne(e,r){for(var t="";t.length<r;)t+=e;return t}function Jt(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return t=-t,s}),!isNaN(r=Number(n)))?r/t:r}var yv=["january","february","march","april","may","june","july","august","september","october","november","december"];function Dn(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),a=r.getMonth(),s=r.getDate();if(isNaN(s))return t;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&yv.indexOf(i)==-1)return t}else if(i.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||s>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var Ev=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,a){if(e||typeof n=="string")return t.split(n);for(var s=t.split(n),i=[s[0]],c=1;c<s.length;++c)i.push(a),i.push(s[c]);return i}}();function zl(e){return e?e.content&&e.type?rn(e.content,!0):e.data?Jn(e.data):e.asNodeBuffer&&ye?Jn(e.asNodeBuffer().toString("binary")):e.asBinary?Jn(e.asBinary()):e._data&&e._data.getContent?Jn(rn(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Xl(e){if(!e)return null;if(e.data)return wo(e.data);if(e.asNodeBuffer&&ye)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?wo(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function kv(e){return e&&e.name.slice(-4)===".bin"?Xl(e):zl(e)}function Lt(e,r){for(var t=e.FullPaths||fr(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var i=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[t[s]]:e.FileIndex[s]}return null}function j0(e,r){var t=Lt(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function We(e,r,t){if(!t)return kv(j0(e,r));if(!r)return null;try{return We(e,r)}catch{return null}}function Rt(e,r,t){if(!t)return zl(j0(e,r));if(!r)return null;try{return Rt(e,r)}catch{return null}}function Tv(e,r,t){return Xl(j0(e,r))}function Do(e){for(var r=e.FullPaths||fr(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function Av(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return ye?n=an(t):n=Gg(t),ke.utils.cfb_add(e,r,n)}ke.utils.cfb_add(e,r,t)}else e.file(r,t)}function Yl(e,r){switch(r.type){case"base64":return ke.read(e,{type:"base64"});case"binary":return ke.read(e,{type:"binary"});case"buffer":case"array":return ke.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Qn(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var jl=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Sv=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Po=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Fv=/<[^>]*>/g,dt=jl.match(Po)?Po:Fv,Cv=/<\w*:/,bv=/<(\/?)\w+:/;function xe(e,r,t){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(r||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(Sv),c=0,f="",o=0,l="",u="",h=1;if(i)for(o=0;o!=i.length;++o){for(u=i[o],s=0;s!=u.length&&u.charCodeAt(s)!==61;++s);for(l=u.slice(0,s).trim();u.charCodeAt(s+1)==32;)++s;for(h=(a=u.charCodeAt(s+1))==34||a==39?1:0,f=u.slice(s+1+h,u.length-h),c=0;c!=l.length&&l.charCodeAt(c)!==58;++c);if(c===l.length)l.indexOf("_")>0&&(l=l.slice(0,l.indexOf("_"))),n[l]=f,n[l.toLowerCase()]=f;else{var d=(c===5&&l.slice(0,5)==="xmlns"?"xmlns":"")+l.slice(c+1);if(n[d]&&l.slice(c-3,c)=="ext")continue;n[d]=f,n[d.toLowerCase()]=f}}return n}function ur(e){return e.replace(bv,"<$1")}var Kl={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Rv=Y0(Kl),Se=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(c,f){return Kl[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(r,function(c,f){return String.fromCharCode(parseInt(f,16))});var i=a.indexOf("]]>");return t(a.slice(0,s))+a.slice(s+9,i)+t(a.slice(i+3))}}(),Iv=/[&<>'"]/g,Ov=/[\u0000-\u001f]/g;function K0(e){var r=e+"";return r.replace(Iv,function(t){return Rv[t]}).replace(/\n/g,"<br/>").replace(Ov,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var No=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function Ie(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ti(e){for(var r="",t=0,n=0,a=0,s=0,i=0,c=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(a=e.charCodeAt(t++),n>191&&n<224){i=(n&31)<<6,i|=a&63,r+=String.fromCharCode(i);continue}if(s=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(t++),c=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,r+=String.fromCharCode(55296+(c>>>10&1023)),r+=String.fromCharCode(56320+(c&1023))}return r}function Mo(e){var r=Mr(2*e.length),t,n,a=1,s=0,i=0,c;for(n=0;n<e.length;n+=a)a=1,(c=e.charCodeAt(n))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(n+1)&63),a=2):c<240?(t=(c&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,t=(c&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,i=55296+(t>>>10&1023),t=56320+(t&1023)),i!==0&&(r[s++]=i&255,r[s++]=i>>>8,i=0),r[s++]=t%256,r[s++]=t>>>8;return r.slice(0,s).toString("ucs2")}function Lo(e){return an(e,"binary").toString("utf8")}var Ja="foo bar bazâð£",Re=ye&&(Lo(Ja)==Ti(Ja)&&Lo||Mo(Ja)==Ti(Ja)&&Mo)||Ti,ea=ye?function(e){return an(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,a=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Ea=function(){var e={};return function(t,n){var a=t+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),ql=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),Dv=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Pv=/<\/?(?:vt:)?variant>/g,Nv=/<(?:vt:)([^>]*)>([\s\S]*)</;function Bo(e,r){var t=xe(e),n=e.match(Dv(t.baseType))||[],a=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return a}return n.forEach(function(s){var i=s.replace(Pv,"").match(Nv);i&&a.push({v:Re(i[2]),t:i[1]})}),a}var Mv=/(^\s|\s$|\n)/;function Lv(e){return fr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Bv(e,r,t){return"<"+e+(t!=null?Lv(t):"")+(r!=null?(r.match(Mv)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function q0(e){if(ye&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Re(sn(G0(e)));throw new Error("Bad input format: expected Buffer or string")}var ka=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Uv={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},$v=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function Hv(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,s=5;s>=0;--s)a=a*256+e[r+s];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function Wv(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,s=0,i=n?-r:r;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(r)?26985:0);for(var c=0;c<=5;++c,s/=256)e[t+c]=s&255;e[t+6]=(a&15)<<4|s&15,e[t+7]=a>>4|n}var Uo=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=t)r.push.apply(r,e[0][n].slice(a,a+t));return r},$o=ye?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:an(r)})):Uo(e)}:Uo,Ho=function(e,r,t){for(var n=[],a=r;a<t;a+=2)n.push(String.fromCharCode(wr(e,a)));return n.join("").replace(vt,"")},J0=ye?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(vt,""):Ho(e,r,t)}:Ho,Wo=function(e,r,t){for(var n=[],a=r;a<r+t;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},Jl=ye?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Wo(e,r,t)}:Wo,Vo=function(e,r,t){for(var n=[],a=r;a<t;a++)n.push(String.fromCharCode(mn(e,a)));return n.join("")},Da=ye?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):Vo(r,t,n)}:Vo,Zl=function(e,r){var t=bt(e,r);return t>0?Da(e,r+4,r+4+t-1):""},Ql=Zl,eu=function(e,r){var t=bt(e,r);return t>0?Da(e,r+4,r+4+t-1):""},tu=eu,ru=function(e,r){var t=2*bt(e,r);return t>0?Da(e,r+4,r+4+t-1):""},nu=ru,au=function(r,t){var n=bt(r,t);return n>0?J0(r,t+4,t+4+n):""},su=au,iu=function(e,r){var t=bt(e,r);return t>0?Da(e,r+4,r+4+t):""},cu=iu,ou=function(e,r){return Hv(e,r)},$s=ou,fu=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};ye&&(Ql=function(r,t){if(!Buffer.isBuffer(r))return Zl(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},tu=function(r,t){if(!Buffer.isBuffer(r))return eu(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},nu=function(r,t){if(!Buffer.isBuffer(r))return ru(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},su=function(r,t){if(!Buffer.isBuffer(r))return au(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},cu=function(r,t){if(!Buffer.isBuffer(r))return iu(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},$s=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):ou(r,t)},fu=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var mn=function(e,r){return e[r]},wr=function(e,r){return e[r+1]*256+e[r]},Vv=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},bt=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},zr=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},Gv=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function ca(e,r){var t="",n,a,s=[],i,c,f,o;switch(r){case"dbcs":if(o=this.l,ye&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)t+=String.fromCharCode(wr(this,o)),o+=2;e*=2;break;case"utf8":t=Da(this,this.l,this.l+e);break;case"utf16le":e*=2,t=J0(this,this.l,this.l+e);break;case"wstr":return ca.call(this,e,"dbcs");case"lpstr-ansi":t=Ql(this,this.l),e=4+bt(this,this.l);break;case"lpstr-cp":t=tu(this,this.l),e=4+bt(this,this.l);break;case"lpwstr":t=nu(this,this.l),e=4+2*bt(this,this.l);break;case"lpp4":e=4+bt(this,this.l),t=su(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+bt(this,this.l),t=cu(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(i=mn(this,this.l+e++))!==0;)s.push(qa(i));t=s.join("");break;case"_wstr":for(e=0,t="";(i=wr(this,this.l+e))!==0;)s.push(qa(i)),e+=2;e+=2,t=s.join("");break;case"dbcs-cont":for(t="",o=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(o)!==-1)return i=mn(this,o),this.l=o+1,c=ca.call(this,e-f,i?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(qa(wr(this,o))),o+=2}t=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",o=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(o)!==-1)return i=mn(this,o),this.l=o+1,c=ca.call(this,e-f,i?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(qa(mn(this,o))),o+=1}t=s.join("");break;default:switch(e){case 1:return n=mn(this,this.l),this.l++,n;case 2:return n=(r==="i"?Vv:wr)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(e>0?zr:Gv)(this,this.l),this.l+=4,n):(a=bt(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=$s(this,this.l):a=$s([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=Jl(this,this.l,e);break}}return this.l+=e,t}var zv=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},Xv=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},Yv=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function jv(e,r,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)Yv(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var i=r.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,zv(this,r,this.l);break;case 8:if(n=8,t==="f"){Wv(this,r,this.l);break}case 16:break;case-4:n=4,Xv(this,r,this.l);break}return this.l+=n,this}function lu(e,r){var t=Jl(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function tt(e,r){e.l=r,e.read_shift=ca,e.chk=lu,e.write_shift=jv}function ht(e,r){e.l+=r}function Ye(e){var r=Mr(e);return tt(r,0),r}function Ar(e,r,t){if(e){var n,a,s;tt(e,e.l||0);for(var i=e.length,c=0,f=0;e.l<i;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var o=Xs[c]||Xs[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;f=e.l+s;var l=o.f&&o.f(e,s,t);if(e.l=f,r(l,o,c))return}}}function i0(){var e=[],r=ye?256:2048,t=function(o){var l=Ye(o);return tt(l,0),l},n=t(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(o){return n&&o<n.length-n.l?n:(a(),n=t(Math.max(o+1,r)))},i=function(){return a(),Or(e)},c=function(o){a(),n=o,n.l==null&&(n.l=n.length),s(r)};return{next:s,push:c,end:i,_bufs:e}}function oa(e,r,t){var n=rt(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Go(e,r,t){var n=rt(e);return n.s=oa(n.s,r.s,t),n.e=oa(n.e,r.s,t),n}function fa(e,r){if(e.cRel&&e.c<0)for(e=rt(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=rt(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=pe(e);return!e.cRel&&e.cRel!=null&&(t=Jv(t)),!e.rRel&&e.rRel!=null&&(t=Kv(t)),t}function Ai(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+je(e.s.c)+":"+(e.e.cRel?"":"$")+je(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+nt(e.s.r)+":"+(e.e.rRel?"":"$")+nt(e.e.r):fa(e.s,r.biff)+":"+fa(e.e,r.biff)}function Z0(e){return parseInt(qv(e),10)-1}function nt(e){return""+(e+1)}function Kv(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function qv(e){return e.replace(/\$(\d+)$/,"$1")}function Q0(e){for(var r=Zv(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function je(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function Jv(e){return e.replace(/^([A-Z])/,"$$$1")}function Zv(e){return e.replace(/^\$([A-Z])/,"$1")}function Qv(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function gt(e){for(var r=0,t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function pe(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Ln(e){var r=e.indexOf(":");return r==-1?{s:gt(e),e:gt(e)}:{s:gt(e.slice(0,r)),e:gt(e.slice(r+1))}}function Te(e,r){return typeof r>"u"||typeof r=="number"?Te(e.s,e.e):(typeof e!="string"&&(e=pe(e)),typeof r!="string"&&(r=pe(r)),e==r?e:e+":"+r)}function Me(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,s=e.length;for(t=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.s.c=--t,t=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(r.s.r=--t,n===s||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.e.c=--t,t=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return r.e.r=--t,r}function zo(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=$t(e.z,t?_t(r):r)}catch{}try{return e.w=$t((e.XF||{}).numFmtId||(t?14:0),t?_t(r):r)}catch{return""+r}}function Tr(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?fn[e.v]||e.v:r==null?zo(e,e.v):zo(e,r))}function Br(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function uu(e,r,t){var n=t||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,c=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var f=typeof n.origin=="string"?gt(n.origin):n.origin;i=f.r,c=f.c}s["!ref"]||(s["!ref"]="A1:A1")}var o={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var l=Me(s["!ref"]);o.s.c=l.s.c,o.s.r=l.s.r,o.e.c=Math.max(o.e.c,l.e.c),o.e.r=Math.max(o.e.r,l.e.r),i==-1&&(o.e.r=i=l.e.r+1)}for(var u=0;u!=r.length;++u)if(r[u]){if(!Array.isArray(r[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=r[u].length;++h)if(!(typeof r[u][h]>"u")){var d={v:r[u][h]},x=i+u,p=c+h;if(o.s.r>x&&(o.s.r=x),o.s.c>p&&(o.s.c=p),o.e.r<x&&(o.e.r=x),o.e.c<p&&(o.e.c=p),r[u][h]&&typeof r[u][h]=="object"&&!Array.isArray(r[u][h])&&!(r[u][h]instanceof Date))d=r[u][h];else if(Array.isArray(d.v)&&(d.f=r[u][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||ge[14],n.cellDates?(d.t="d",d.w=$t(d.z,_t(d.v))):(d.t="n",d.v=_t(d.v),d.w=$t(d.z,d.v))):d.t="s";if(a)s[x]||(s[x]=[]),s[x][p]&&s[x][p].z&&(d.z=s[x][p].z),s[x][p]=d;else{var m=pe({c:p,r:x});s[m]&&s[m].z&&(d.z=s[m].z),s[m]=d}}}return o.s.c<1e7&&(s["!ref"]=Te(o)),s}function Bn(e,r){return uu(null,e,r)}function e_(e){return e.read_shift(4,"i")}function ut(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function t_(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ec(e,r){var t=e.l,n=e.read_shift(1),a=ut(e),s=[],i={t:a,h:a};if((n&1)!==0){for(var c=e.read_shift(4),f=0;f!=c;++f)s.push(t_(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=t+r,i}var r_=ec;function Ht(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function cn(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var n_=ut;function tc(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var a_=ut,c0=tc;function rc(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var a=n===0?$s([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):zr(r,0)>>2;return t?a/100:a}function hu(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var on=hu;function ft(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function s_(e){var r={},t=e.read_shift(1),n=t>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var o=Zr[a];o&&(r.rgb=Aa(o));break;case 2:r.rgb=Aa([i,c,f]);break;case 3:r.theme=a;break}return s!=0&&(r.tint=s>0?s/32767:s/32768),r}function i_(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function du(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function c_(e){return du(e,1)}function o_(e){return du(e,2)}var nc=2,yt=3,Za=11,Xo=12,Hs=19,Qa=64,f_=65,l_=71,u_=4108,h_=4126,Je=80,xu=81,d_=[Je,xu],x_={1:{n:"CodePage",t:nc},2:{n:"Category",t:Je},3:{n:"PresentationFormat",t:Je},4:{n:"ByteCount",t:yt},5:{n:"LineCount",t:yt},6:{n:"ParagraphCount",t:yt},7:{n:"SlideCount",t:yt},8:{n:"NoteCount",t:yt},9:{n:"HiddenCount",t:yt},10:{n:"MultimediaClipCount",t:yt},11:{n:"ScaleCrop",t:Za},12:{n:"HeadingPairs",t:u_},13:{n:"TitlesOfParts",t:h_},14:{n:"Manager",t:Je},15:{n:"Company",t:Je},16:{n:"LinksUpToDate",t:Za},17:{n:"CharacterCount",t:yt},19:{n:"SharedDoc",t:Za},22:{n:"HyperlinksChanged",t:Za},23:{n:"AppVersion",t:yt,p:"version"},24:{n:"DigSig",t:f_},26:{n:"ContentType",t:Je},27:{n:"ContentStatus",t:Je},28:{n:"Language",t:Je},29:{n:"Version",t:Je},255:{},2147483648:{n:"Locale",t:Hs},2147483651:{n:"Behavior",t:Hs},1919054434:{}},p_={1:{n:"CodePage",t:nc},2:{n:"Title",t:Je},3:{n:"Subject",t:Je},4:{n:"Author",t:Je},5:{n:"Keywords",t:Je},6:{n:"Comments",t:Je},7:{n:"Template",t:Je},8:{n:"LastAuthor",t:Je},9:{n:"RevNumber",t:Je},10:{n:"EditTime",t:Qa},11:{n:"LastPrinted",t:Qa},12:{n:"CreatedDate",t:Qa},13:{n:"ModifiedDate",t:Qa},14:{n:"PageCount",t:yt},15:{n:"WordCount",t:yt},16:{n:"CharCount",t:yt},17:{n:"Thumbnail",t:l_},18:{n:"Application",t:Je},19:{n:"DocSecurity",t:yt},255:{},2147483648:{n:"Locale",t:Hs},2147483651:{n:"Behavior",t:Hs},1919054434:{}},Yo={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},m_=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function g_(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var v_=g_([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Zr=rt(v_),fn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},pu={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},jo={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function __(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function w_(e){var r=__();if(!e||!e.match)return r;var t={};if((e.match(dt)||[]).forEach(function(n){var a=xe(n);switch(a[0].replace(Cv,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":r[jo[a.ContentType]]!==void 0&&r[jo[a.ContentType]].push(a.PartName);break}}),r.xmlns!==Uv.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var _n={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function o0(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function la(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(dt)||[]).forEach(function(a){var s=xe(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var c=s.TargetMode==="External"?s.Target:Qn(s.Target,r);t[c]=i,n[s.Id]=i}}),t["!id"]=n,t}var y_="application/vnd.oasis.opendocument.spreadsheet";function E_(e,r){for(var t=q0(e),n,a;n=ka.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(a=xe(n[0],!1),a.path=="/"&&a.type!==y_)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var ua=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],k_=function(){for(var e=new Array(ua.length),r=0;r<ua.length;++r){var t=ua[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function mu(e){var r={};e=Re(e);for(var t=0;t<ua.length;++t){var n=ua[t],a=e.match(k_[t]);a!=null&&a.length>0&&(r[n[1]]=Se(a[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=Ze(r[n[1]]))}return r}var T_=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function gu(e,r,t,n){var a=[];if(typeof e=="string")a=Bo(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(l){return{v:l}}));var i=typeof r=="string"?Bo(r,n).map(function(l){return l.v}):r,c=0,f=0;if(i.length>0)for(var o=0;o!==a.length;o+=2){switch(f=+a[o+1].v,a[o].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=f,t.SheetNames=i.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=f,t.DefinedNames=i.slice(c,c+f);break;case"Charts":case"Diagramme":t.Chartsheets=f,t.ChartNames=i.slice(c,c+f);break}c+=f}}function A_(e,r,t){var n={};return r||(r={}),e=Re(e),T_.forEach(function(a){var s=(e.match(Ea(a[0]))||[])[1];switch(a[2]){case"string":s&&(r[a[1]]=Se(s));break;case"bool":r[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&gu(n.HeadingPairs,n.TitlesOfParts,r,t),r}var S_=/<[^>]+>[^<]*/g;function F_(e,r){var t={},n="",a=e.match(S_);if(a)for(var s=0;s!=a.length;++s){var i=a[s],c=xe(i);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Se(c.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var f=i.split(">"),o=f[0].slice(4),l=f[1];switch(o){case"lpstr":case"bstr":case"lpwstr":t[n]=Se(l);break;case"bool":t[n]=Ie(l);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(l,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(l);break;case"filetime":case"date":t[n]=Ze(l);break;case"cy":case"error":t[n]=Se(l);break;default:if(o.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",i,o,f)}}else if(i.slice(0,2)!=="</"){if(r.WTF)throw new Error(i)}}}return t}var C_={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Si;function b_(e,r,t){Si||(Si=Y0(C_)),r=Si[r]||r,e[r]=t}function ac(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function vu(e,r,t){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return a}function _u(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function wu(e,r,t){return r===31?_u(e):vu(e,r,t)}function f0(e,r,t){return wu(e,r,t===!1?0:4)}function R_(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return wu(e,r,0)}function I_(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var a=e.l;t[n]=e.read_shift(0,"lpwstr").replace(vt,""),e.l-a&2&&(e.l+=2)}return t}function O_(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(vt,"");return t}function D_(e){var r=e.l,t=Ws(e,xu);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=Ws(e,yt);return[t,n]}function P_(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(D_(e));return t}function Ko(e,r){for(var t=e.read_shift(4),n={},a=0;a!=t;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,r===1200?"utf16le":"utf8").replace(vt,"").replace(Zn,"!"),r===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function yu(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function N_(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Ws(e,r,t){var n=e.read_shift(2),a,s=t||{};if(e.l+=2,r!==Xo&&n!==r&&d_.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===Xo?n:r){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return vu(e,n,4).replace(vt,"");case 31:return _u(e);case 64:return ac(e);case 65:return yu(e);case 71:return N_(e);case 80:return f0(e,n,!s.raw).replace(vt,"");case 81:return R_(e,n).replace(vt,"");case 4108:return P_(e);case 4126:case 4127:return n==4127?I_(e):O_(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function qo(e,r){var t=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,c=0,f=-1,o={};for(i=0;i!=a;++i){var l=e.read_shift(4),u=e.read_shift(4);s[i]=[l,u+t]}s.sort(function(w,v){return w[1]-v[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var d=!0;if(i>0&&r)switch(r[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,d=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],d=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],d=!1);break}if((!r||i==0)&&e.l<=s[i][1]&&(d=!1,e.l=s[i][1]),d)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(r){var x=r[s[i][0]];if(h[x.n]=Ws(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:jt(c=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(s[i][0]===1){if(c=h.CodePage=Ws(e,nc),jt(c),f!==-1){var p=e.l;e.l=s[f][1],o=Ko(e,c),e.l=p}}else if(s[i][0]===0){if(c===0){f=i,e.l=s[i+1][1];continue}o=Ko(e,c)}else{var m=o[s[i][0]],_;switch(e[e.l]){case 65:e.l+=4,_=yu(e);break;case 30:e.l+=4,_=f0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=f0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=$e(e,4);break;case 64:e.l+=4,_=Ze(ac(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[m]=_}}return e.l=t+n,h}function Jo(e,r,t){var n=e.content;if(!n)return{};tt(n,0);var a,s,i,c,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var o=n.read_shift(4),l=n.read_shift(16);if(l!==ke.utils.consts.HEADER_CLSID&&l!==t)throw new Error("Bad PropertySet CLSID "+l);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),c=n.read_shift(4),a===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);a===2&&(i=n.read_shift(16),f=n.read_shift(4));var u=qo(n,r),h={SystemIdentifier:o};for(var d in u)h[d]=u[d];if(h.FMTID=s,a===1)return h;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var x;try{x=qo(n,null)}catch{}for(d in x)h[d]=x[d];return h.FMTID=[s,i],h}function Cr(e,r){return e.read_shift(r),null}function M_(e,r,t){for(var n=[],a=e.l+r;e.l<a;)n.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function $e(e,r){return e.read_shift(r)===1}function Ve(e){return e.read_shift(2,"u")}function Eu(e,r){return M_(e,r,Ve)}function L_(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function Pa(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function B_(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,a=t&8,s=1+(t&1),i=0,c,f={};a&&(i=e.read_shift(2)),n&&(c=e.read_shift(4));var o=s==2?"dbcs-cont":"sbcs-cont",l=r===0?"":e.read_shift(r,o);return a&&(e.l+=4*i),n&&(e.l+=c),f.t=l,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function nn(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function Na(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):nn(e,n,t)}function ln(e,r,t){if(t.biff>5)return Na(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function U_(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function $_(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var a=e.read_shift((n?r-24:r)>>1,"utf16le").replace(vt,"");return n&&(e.l+=24),a}function H_(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(vt,"");return t+i}function W_(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return $_(e);case"0303000000000000c000000000000046":return H_(e);default:throw new Error("Unsupported Moniker "+t)}}function es(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(vt,""):"";return t}function V_(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,c,f,o="",l,u;a&16&&(s=es(e,t-e.l)),a&128&&(i=es(e,t-e.l)),(a&257)===257&&(c=es(e,t-e.l)),(a&257)===1&&(f=W_(e,t-e.l)),a&8&&(o=es(e,t-e.l)),a&32&&(l=e.read_shift(16)),a&64&&(u=ac(e)),e.l=t;var h=i||c||f||"";h&&o&&(h+="#"+o),h||(h="#"+o),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var d={Target:h};return l&&(d.guid=l),u&&(d.time=u),s&&(d.Tooltip=s),d}function ku(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[r,t,n,a]}function Tu(e,r){var t=ku(e);return t[3]=0,t}function hr(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function G_(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function z_(e,r,t){return r===0?"":ln(e,r,t)}function X_(e,r,t){var n=t.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function Au(e){var r=e.read_shift(2),t=rc(e);return[r,t]}function Y_(e,r,t){e.l+=4,r-=4;var n=e.l+r,a=Pa(e,r,t),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function ti(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r},e:{c:a,r:t}}}function Su(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r},e:{c:a,r:t}}}var j_=Su;function Fu(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function K_(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function q_(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function it(e){e.l+=2,e.l+=e.read_shift(2)}var J_={0:it,4:it,5:it,6:it,7:q_,8:it,9:it,10:it,11:it,12:it,13:K_,14:it,15:it,16:it,17:it,18:it,19:it,20:it,21:Fu};function Z_(e,r){for(var t=e.l+r,n=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{n.push(J_[a](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function ts(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function Q_(e,r){return r===0||e.read_shift(2),1200}function e2(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,a=ln(e,0,t);return e.read_shift(r+n-e.l),a}function t2(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function r2(e,r,t){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=Pa(e,0,t);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function n2(e,r){for(var t=e.l+r,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<t;++i)s.push(B_(e));return s.Count=n,s.Unique=a,s}function a2(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function s2(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function i2(e){var r=G_(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function c2(e){return e.read_shift(2),e.read_shift(4)}function Zo(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function o2(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),o=e.read_shift(2);return{Pos:[r,t],Dim:[n,a],Flags:s,CurTab:i,FirstTab:c,Selected:f,TabRatio:o}}function f2(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function l2(){}function u2(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Pa(e,0,t),n}function h2(e){var r=hr(e);return r.isst=e.read_shift(4),r}function d2(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,a=hr(e);t.biff==2&&e.l++;var s=Na(e,n-e.l,t);return a.val=s,a}function x2(e,r,t){var n=e.read_shift(2),a=ln(e,0,t);return[n,a]}var p2=ln;function Qo(e,r,t){var n=e.l+r,a=t.biff==8||!t.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),c=e.read_shift(2),f=e.read_shift(2);return e.l=n,{s:{r:s,c},e:{r:i,c:f}}}function m2(e){var r=e.read_shift(2),t=e.read_shift(2),n=Au(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function g2(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<t;)s.push(Au(e));if(e.l!==t)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function v2(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<t;)s.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function _2(e,r,t,n){var a={},s=e.read_shift(4),i=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(2);return a.patternType=m_[c>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function w2(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=_2(e,r,n.fStyle,t),n}function y2(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function ef(e,r,t){var n=hr(e);(t.biff==2||r==9)&&++e.l;var a=L_(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function E2(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=hr(e),a=ft(e);return n.val=a,n}var tf=z_;function k2(e,r,t){var n=e.l+r,a=e.read_shift(2),s=e.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=nn(e,s),c=[];n>e.l;)c.push(Na(e));return[s,a,i,c]}function rf(e,r,t){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(a=Y_(e,r-2,t)),s.body=a||e.read_shift(r-2),typeof a=="string"&&(s.Name=a),s}var T2=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function nf(e,r,t){var n=e.l+r,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),c=e.read_shift(t&&t.biff==2?1:2),f=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),f=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var o=nn(e,i,t);a&32&&(o=T2[o.charCodeAt(0)]);var l=n-e.l;t&&t.biff==2&&--l;var u=n==e.l||c===0||!(l>0)?[]:sk(e,l,t,c);return{chKey:s,Name:o,itab:f,rgce:u}}function Cu(e,r,t){if(t.biff<8)return A2(e,r,t);for(var n=[],a=e.l+r,s=e.read_shift(t.biff>8?4:2);s--!==0;)n.push(X_(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function A2(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=Pa(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function S2(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),a=e.read_shift(2),s=nn(e,n,t),i=nn(e,a,t);return[s,i]}function F2(e,r,t){var n=Su(e);e.l++;var a=e.read_shift(1);return r-=8,[ik(e,r,t),a,n]}function af(e,r,t){var n=j_(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,nk(e,r,t)]}function C2(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function b2(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),c=ln(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:a},c,i,s]}}function R2(e,r,t){return b2(e,r,t)}function I2(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(ti(e));return t}function O2(e,r,t){if(t&&t.biff<8)return P2(e,r,t);var n=Fu(e),a=Z_(e,r-22,n[1]);return{cmo:n,ft:a}}var D2={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:n}}};function P2(e,r,t){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var i=[];return i.push((D2[n]||ht)(e,r,t)),{cmo:[a,n,s],ft:i}}function N2(e,r,t){var n=e.l,a="";try{e.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=U_(e,6,t);var c=e.read_shift(2);e.read_shift(2),Ve(e,2);var f=e.read_shift(2);e.l+=f;for(var o=1;o<e.lens.length-1;++o){if(e.l-n!=e.lens[o])throw new Error("TxO: bad continue record");var l=e[e.l],u=nn(e,e.lens[o+1]-e.lens[o]-1);if(a+=u,a.length>=(l?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=n+r,{t:a}}catch{return e.l=n+r,{t:a}}}function M2(e,r){var t=ti(e);e.l+=16;var n=V_(e,r-24);return[t,n]}function L2(e,r){e.read_shift(2);var t=ti(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(vt,""),[t,n]}function B2(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=Yo[t]||t,t=e.read_shift(2),r[1]=Yo[t]||t,r}function U2(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Tu(e));return t}function $2(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Tu(e));return t}function H2(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function bu(e,r,t){if(!t.cellStyles)return ht(e,r);var n=t&&t.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),c=e.read_shift(n),f=e.read_shift(2);n==2&&(e.l+=2);var o={s:a,e:s,w:i,ixfe:c,flags:f};return(t.biff>=5||!t.biff)&&(o.level=f>>8&7),o}function W2(e,r){var t={};return r<32||(e.l+=16,t.header=ft(e),t.footer=ft(e),e.l+=2),t}function V2(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var G2=hr,z2=Eu,X2=Na;function Y2(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function j2(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=hr(e);++e.l;var a=ln(e,r-7,t);return n.t="str",n.val=a,n}function K2(e){var r=hr(e);++e.l;var t=ft(e);return r.t="n",r.val=t,r}function q2(e){var r=hr(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function J2(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function Z2(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function Q2(e,r,t){var n=e.l+r,a=hr(e),s=e.read_shift(2),i=nn(e,s,t);return e.l=n,a.t="str",a.val=i,a}var ew=[2,3,48,49,131,139,140,245],sf=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Y0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,f){var o=[],l=Mr(1);switch(f.type){case"base64":l=Yt(Ot(c));break;case"binary":l=Yt(c);break;case"buffer":case"array":l=c;break}tt(l,0);var u=l.read_shift(1),h=!!(u&136),d=!1,x=!1;switch(u){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var p=0,m=521;u==2&&(p=l.read_shift(2)),l.l+=3,u!=2&&(p=l.read_shift(4)),p>1048576&&(p=1e6),u!=2&&(m=l.read_shift(2));var _=l.read_shift(2),w=f.codepage||1252;u!=2&&(l.l+=16,l.read_shift(1),l[l.l]!==0&&(w=e[l[l.l]]),l.l+=1,l.l+=2),x&&(l.l+=36);for(var v=[],C={},O=Math.min(l.length,u==2?521:m-10-(d?264:0)),R=x?32:11;l.l<O&&l[l.l]!=13;)switch(C={},C.name=s0.utils.decode(w,l.slice(l.l,l.l+R)).replace(/[\u0000\r\n].*$/g,""),l.l+=R,C.type=String.fromCharCode(l.read_shift(1)),u!=2&&!x&&(C.offset=l.read_shift(4)),C.len=l.read_shift(1),u==2&&(C.offset=l.read_shift(2)),C.dec=l.read_shift(1),C.name.length&&v.push(C),u!=2&&(l.l+=x?13:14),C.type){case"B":(!d||C.len!=8)&&f.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(l[l.l]!==13&&(l.l=m-1),l.read_shift(1)!==13)throw new Error("DBF Terminator not found "+l.l+" "+l[l.l]);l.l=m;var k=0,U=0;for(o[0]=[],U=0;U!=v.length;++U)o[0][U]=v[U].name;for(;p-- >0;){if(l[l.l]===42){l.l+=_;continue}for(++l.l,o[++k]=[],U=0,U=0;U!=v.length;++U){var I=l.slice(l.l,l.l+v[U].len);l.l+=v[U].len,tt(I,0);var z=s0.utils.decode(w,I);switch(v[U].type){case"C":z.trim().length&&(o[k][U]=z.replace(/\s+$/,""));break;case"D":z.length===8?o[k][U]=new Date(+z.slice(0,4),+z.slice(4,6)-1,+z.slice(6,8)):o[k][U]=z;break;case"F":o[k][U]=parseFloat(z.trim());break;case"+":case"I":o[k][U]=x?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(z.trim().toUpperCase()){case"Y":case"T":o[k][U]=!0;break;case"N":case"F":o[k][U]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+z+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));o[k][U]="##MEMO##"+(x?parseInt(z.trim(),10):I.read_shift(4));break;case"N":z=z.replace(/\u0000/g,"").trim(),z&&z!="."&&(o[k][U]=+z||0);break;case"@":o[k][U]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":o[k][U]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":o[k][U]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":o[k][U]=-I.read_shift(-8,"f");break;case"B":if(d&&v[U].len==8){o[k][U]=I.read_shift(8,"f");break}case"G":case"P":I.l+=v[U].len;break;case"0":if(v[U].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[U].type)}}}if(u!=2&&l.l<l.length&&l[l.l++]!=26)throw new Error("DBF EOF Marker missing "+(l.l-1)+" of "+l.length+" "+l[l.l-1].toString(16));return f&&f.sheetRows&&(o=o.slice(0,f.sheetRows)),f.DBF=v,o}function n(c,f){var o=f||{};o.dateNF||(o.dateNF="yyyymmdd");var l=Bn(t(c,o),o);return l["!cols"]=o.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete o.DBF,l}function a(c,f){try{return Br(n(c,f),f)}catch(o){if(f&&f.WTF)throw o}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(c,f){var o=f||{};if(+o.codepage>=0&&jt(+o.codepage),o.type=="string")throw new Error("Cannot write DBF to JS string");var l=i0(),u=m0(c,{header:1,raw:!0,cellDates:!0}),h=u[0],d=u.slice(1),x=c["!cols"]||[],p=0,m=0,_=0,w=1;for(p=0;p<h.length;++p){if(((x[p]||{}).DBF||{}).name){h[p]=x[p].DBF.name,++_;continue}if(h[p]!=null){if(++_,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(m=0;m<1024;++m)if(h.indexOf(h[p]+"_"+m)==-1){h[p]+="_"+m;break}}}}var v=Me(c["!ref"]),C=[],O=[],R=[];for(p=0;p<=v.e.c-v.s.c;++p){var k="",U="",I=0,z=[];for(m=0;m<d.length;++m)d[m][p]!=null&&z.push(d[m][p]);if(z.length==0||h[p]==null){C[p]="?";continue}for(m=0;m<z.length;++m){switch(typeof z[m]){case"number":U="B";break;case"string":U="C";break;case"boolean":U="L";break;case"object":U=z[m]instanceof Date?"D":"C";break;default:U="C"}I=Math.max(I,String(z[m]).length),k=k&&k!=U?"C":U}I>250&&(I=250),U=((x[p]||{}).DBF||{}).type,U=="C"&&x[p].DBF.len>I&&(I=x[p].DBF.len),k=="B"&&U=="N"&&(k="N",R[p]=x[p].DBF.dec,I=x[p].DBF.len),O[p]=k=="C"||U=="N"?I:s[k]||0,w+=O[p],C[p]=k}var D=l.next(32);for(D.write_shift(4,318902576),D.write_shift(4,d.length),D.write_shift(2,296+32*_),D.write_shift(2,w),p=0;p<4;++p)D.write_shift(4,0);for(D.write_shift(4,0|(+r[Cl]||3)<<8),p=0,m=0;p<h.length;++p)if(h[p]!=null){var B=l.next(32),Z=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);B.write_shift(1,Z,"sbcs"),B.write_shift(1,C[p]=="?"?"C":C[p],"sbcs"),B.write_shift(4,m),B.write_shift(1,O[p]||s[C[p]]||0),B.write_shift(1,R[p]||0),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(1,0),B.write_shift(4,0),B.write_shift(4,0),m+=O[p]||s[C[p]]||0}var P=l.next(264);for(P.write_shift(4,13),p=0;p<65;++p)P.write_shift(4,0);for(p=0;p<d.length;++p){var j=l.next(w);for(j.write_shift(1,0),m=0;m<h.length;++m)if(h[m]!=null)switch(C[m]){case"L":j.write_shift(1,d[p][m]==null?63:d[p][m]?84:70);break;case"B":j.write_shift(8,d[p][m]||0,"f");break;case"N":var H="0";for(typeof d[p][m]=="number"&&(H=d[p][m].toFixed(R[m]||0)),_=0;_<O[m]-H.length;++_)j.write_shift(1,32);j.write_shift(1,H,"sbcs");break;case"D":d[p][m]?(j.write_shift(4,("0000"+d[p][m].getFullYear()).slice(-4),"sbcs"),j.write_shift(2,("00"+(d[p][m].getMonth()+1)).slice(-2),"sbcs"),j.write_shift(2,("00"+d[p][m].getDate()).slice(-2),"sbcs")):j.write_shift(8,"00000000","sbcs");break;case"C":var K=String(d[p][m]!=null?d[p][m]:"").slice(0,O[m]);for(j.write_shift(1,K,"sbcs"),_=0;_<O[m]-K.length;++_)j.write_shift(1,32);break}}return l.next(1).write_shift(1,26),l.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),tw=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+fr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(h,d){var x=e[d];return typeof x=="number"?yo(x):x},n=function(h,d,x){var p=d.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?h:yo(p)};e["|"]=254;function a(h,d){switch(d.type){case"base64":return s(Ot(h),d);case"binary":return s(h,d);case"buffer":return s(ye&&Buffer.isBuffer(h)?h.toString("binary"):sn(h),d);case"array":return s(rn(h),d)}throw new Error("Unrecognized type "+d.type)}function s(h,d){var x=h.split(/[\n\r]+/),p=-1,m=-1,_=0,w=0,v=[],C=[],O=null,R={},k=[],U=[],I=[],z=0,D;for(+d.codepage>=0&&jt(+d.codepage);_!==x.length;++_){z=0;var B=x[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),Z=B.replace(/;;/g,"\0").split(";").map(function(N){return N.replace(/\u0000/g,";")}),P=Z[0],j;if(B.length>0)switch(P){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Z[1].charAt(0)=="P"&&C.push(B.slice(3).replace(/;;/g,";"));break;case"C":var H=!1,K=!1,fe=!1,L=!1,ne=-1,oe=-1;for(w=1;w<Z.length;++w)switch(Z[w].charAt(0)){case"A":break;case"X":m=parseInt(Z[w].slice(1))-1,K=!0;break;case"Y":for(p=parseInt(Z[w].slice(1))-1,K||(m=0),D=v.length;D<=p;++D)v[D]=[];break;case"K":j=Z[w].slice(1),j.charAt(0)==='"'?j=j.slice(1,j.length-1):j==="TRUE"?j=!0:j==="FALSE"?j=!1:isNaN(Jt(j))?isNaN(Dn(j).getDate())||(j=Ze(j)):(j=Jt(j),O!==null&&Mn(O)&&(j=ei(j))),H=!0;break;case"E":L=!0;var S=kn(Z[w].slice(1),{r:p,c:m});v[p][m]=[v[p][m],S];break;case"S":fe=!0,v[p][m]=[v[p][m],"S5S"];break;case"G":break;case"R":ne=parseInt(Z[w].slice(1))-1;break;case"C":oe=parseInt(Z[w].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+B)}if(H&&(v[p][m]&&v[p][m].length==2?v[p][m][0]=j:v[p][m]=j,O=null),fe){if(L)throw new Error("SYLK shared formula cannot have own formula");var W=ne>-1&&v[ne][oe];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");v[p][m][1]=Uu(W[1],{r:p-ne,c:m-oe})}break;case"F":var M=0;for(w=1;w<Z.length;++w)switch(Z[w].charAt(0)){case"X":m=parseInt(Z[w].slice(1))-1,++M;break;case"Y":for(p=parseInt(Z[w].slice(1))-1,D=v.length;D<=p;++D)v[D]=[];break;case"M":z=parseInt(Z[w].slice(1))/20;break;case"F":break;case"G":break;case"P":O=C[parseInt(Z[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=Z[w].slice(1).split(" "),D=parseInt(I[0],10);D<=parseInt(I[1],10);++D)z=parseInt(I[2],10),U[D-1]=z===0?{hidden:!0}:{wch:z},Pn(U[D-1]);break;case"C":m=parseInt(Z[w].slice(1))-1,U[m]||(U[m]={});break;case"R":p=parseInt(Z[w].slice(1))-1,k[p]||(k[p]={}),z>0?(k[p].hpt=z,k[p].hpx=Sa(z)):z===0&&(k[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+B)}M<1&&(O=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+B)}}return k.length>0&&(R["!rows"]=k),U.length>0&&(R["!cols"]=U),d&&d.sheetRows&&(v=v.slice(0,d.sheetRows)),[v,R]}function i(h,d){var x=a(h,d),p=x[0],m=x[1],_=Bn(p,d);return fr(m).forEach(function(w){_[w]=m[w]}),_}function c(h,d){return Br(i(h,d),d)}function f(h,d,x,p){var m="C;Y"+(x+1)+";X"+(p+1)+";K";switch(h.t){case"n":m+=h.v||0,h.f&&!h.F&&(m+=";E"+Hy(h.f,{r:x,c:p}));break;case"b":m+=h.v?"TRUE":"FALSE";break;case"e":m+=h.w||h.v;break;case"d":m+='"'+(h.w||h.v)+'"';break;case"s":m+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function o(h,d){d.forEach(function(x,p){var m="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?m+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Gs(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=zs(x.wpx)),typeof x.wch=="number"&&(m+=Math.round(x.wch))),m.charAt(m.length-1)!=" "&&h.push(m)})}function l(h,d){d.forEach(function(x,p){var m="F;";x.hidden?m+="M0;":x.hpt?m+="M"+20*x.hpt+";":x.hpx&&(m+="M"+20*Mu(x.hpx)+";"),m.length>2&&h.push(m+"R"+(p+1))})}function u(h,d){var x=["ID;PWXL;N;E"],p=[],m=Me(h["!ref"]),_,w=Array.isArray(h),v=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&o(x,h["!cols"]),h["!rows"]&&l(x,h["!rows"]),x.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var C=m.s.r;C<=m.e.r;++C)for(var O=m.s.c;O<=m.e.c;++O){var R=pe({r:C,c:O});_=w?(h[C]||[])[O]:h[R],!(!_||_.v==null&&(!_.f||_.F))&&p.push(f(_,h,C,O))}return x.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:c,to_sheet:i,from_sheet:u}}(),rw=function(){function e(s,i){switch(i.type){case"base64":return r(Ot(s),i);case"binary":return r(s,i);case"buffer":return r(ye&&Buffer.isBuffer(s)?s.toString("binary"):sn(s),i);case"array":return r(rn(s),i)}throw new Error("Unrecognized type "+i.type)}function r(s,i){for(var c=s.split(`
`),f=-1,o=-1,l=0,u=[];l!==c.length;++l){if(c[l].trim()==="BOT"){u[++f]=[],o=0;continue}if(!(f<0)){var h=c[l].trim().split(","),d=h[0],x=h[1];++l;for(var p=c[l]||"";(p.match(/["]/g)||[]).length&1&&l<c.length-1;)p+=`
`+c[++l];switch(p=p.trim(),+d){case-1:if(p==="BOT"){u[++f]=[],o=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?u[f][o]=!0:p==="FALSE"?u[f][o]=!1:isNaN(Jt(x))?isNaN(Dn(x).getDate())?u[f][o]=x:u[f][o]=Ze(x):u[f][o]=Jt(x),++o;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),u[f][o++]=p!==""?p:null;break}if(p==="EOD")break}}return i&&i.sheetRows&&(u=u.slice(0,i.sheetRows)),u}function t(s,i){return Bn(e(s,i),i)}function n(s,i){return Br(t(s,i),i)}var a=function(){var s=function(f,o,l,u,h){f.push(o),f.push(l+","+u),f.push('"'+h.replace(/"/g,'""')+'"')},i=function(f,o,l,u){f.push(o+","+l),f.push(o==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(f){var o=[],l=Me(f["!ref"]),u,h=Array.isArray(f);s(o,"TABLE",0,1,"sheetjs"),s(o,"VECTORS",0,l.e.r-l.s.r+1,""),s(o,"TUPLES",0,l.e.c-l.s.c+1,""),s(o,"DATA",0,0,"");for(var d=l.s.r;d<=l.e.r;++d){i(o,-1,0,"BOT");for(var x=l.s.c;x<=l.e.c;++x){var p=pe({r:d,c:x});if(u=h?(f[d]||[])[x]:f[p],!u){i(o,1,0,"");continue}switch(u.t){case"n":var m=u.w;!m&&u.v!=null&&(m=u.v),m==null?u.f&&!u.F?i(o,1,0,"="+u.f):i(o,1,0,""):i(o,0,m,"V");break;case"b":i(o,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":i(o,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=$t(u.z||ge[14],_t(Ze(u.v)))),i(o,0,u.w,"V");break;default:i(o,1,0,"")}}}i(o,-1,0,"EOD");var _=`\r
`,w=o.join(_);return w}}();return{to_workbook:n,to_sheet:t,from_sheet:a}}(),nw=function(){function e(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(u,h){for(var d=u.split(`
`),x=-1,p=-1,m=0,_=[];m!==d.length;++m){var w=d[m].trim().split(":");if(w[0]==="cell"){var v=gt(w[1]);if(_.length<=v.r)for(x=_.length;x<=v.r;++x)_[x]||(_[x]=[]);switch(x=v.r,p=v.c,w[2]){case"t":_[x][p]=e(w[3]);break;case"v":_[x][p]=+w[3];break;case"vtf":var C=w[w.length-1];case"vtc":switch(w[3]){case"nl":_[x][p]=!!+w[4];break;default:_[x][p]=+w[4];break}w[2]=="vtf"&&(_[x][p]=[_[x][p],C])}}}return h&&h.sheetRows&&(_=_.slice(0,h.sheetRows)),_}function n(u,h){return Bn(t(u,h),h)}function a(u,h){return Br(n(u,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function o(u){if(!u||!u["!ref"])return"";for(var h=[],d=[],x,p="",m=Ln(u["!ref"]),_=Array.isArray(u),w=m.s.r;w<=m.e.r;++w)for(var v=m.s.c;v<=m.e.c;++v)if(p=pe({r:w,c:v}),x=_?(u[w]||[])[v]:u[p],!(!x||x.v==null||x.t==="z")){switch(d=["cell",p,"t"],x.t){case"s":case"str":d.push(r(x.v));break;case"n":x.f?(d[2]="vtf",d[3]="n",d[4]=x.v,d[5]=r(x.f)):(d[2]="v",d[3]=x.v);break;case"b":d[2]="vt"+(x.f?"f":"c"),d[3]="nl",d[4]=x.v?"1":"0",d[5]=r(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var C=_t(Ze(x.v));d[2]="vtc",d[3]="nd",d[4]=""+C,d[5]=x.w||$t(x.z||ge[14],C);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function l(u){return[s,i,c,i,o(u),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:l}}(),Ta=function(){function e(l,u,h,d,x){x.raw?u[h][d]=l:l===""||(l==="TRUE"?u[h][d]=!0:l==="FALSE"?u[h][d]=!1:isNaN(Jt(l))?isNaN(Dn(l).getDate())?u[h][d]=l:u[h][d]=Ze(l):u[h][d]=Jt(l))}function r(l,u){var h=u||{},d=[];if(!l||l.length===0)return d;for(var x=l.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var m=10,_=0,w=0;w<=p;++w)_=x[w].indexOf(" "),_==-1?_=x[w].length:_++,m=Math.max(m,_);for(w=0;w<=p;++w){d[w]=[];var v=0;for(e(x[w].slice(0,m).trim(),d,w,v,h),v=1;v<=(x[w].length-m)/10+1;++v)e(x[w].slice(m+(v-1)*10,m+v*10).trim(),d,w,v,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(l){for(var u={},h=!1,d=0,x=0;d<l.length;++d)(x=l.charCodeAt(d))==34?h=!h:!h&&x in t&&(u[x]=(u[x]||0)+1);x=[];for(d in u)Object.prototype.hasOwnProperty.call(u,d)&&x.push([u[d],d]);if(!x.length){u=n;for(d in u)Object.prototype.hasOwnProperty.call(u,d)&&x.push([u[d],d])}return x.sort(function(p,m){return p[0]-m[0]||n[p[1]]-n[m[1]]}),t[x.pop()[1]]||44}function s(l,u){var h=u||{},d="",x=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};l.slice(0,4)=="sep="?l.charCodeAt(5)==13&&l.charCodeAt(6)==10?(d=l.charAt(4),l=l.slice(7)):l.charCodeAt(5)==13||l.charCodeAt(5)==10?(d=l.charAt(4),l=l.slice(6)):d=a(l.slice(0,1024)):h&&h.FS?d=h.FS:d=a(l.slice(0,1024));var m=0,_=0,w=0,v=0,C=0,O=d.charCodeAt(0),R=!1,k=0,U=l.charCodeAt(0);l=l.replace(/\r\n/mg,`
`);var I=h.dateNF!=null?xv(h.dateNF):null;function z(){var D=l.slice(v,C),B={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)B.t="z";else if(h.raw)B.t="s",B.v=D;else if(D.trim().length===0)B.t="s",B.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(B.t="s",B.v=D.slice(2,-1).replace(/""/g,'"')):Vy(D)?(B.t="n",B.f=D.slice(1)):(B.t="s",B.v=D);else if(D=="TRUE")B.t="b",B.v=!0;else if(D=="FALSE")B.t="b",B.v=!1;else if(!isNaN(w=Jt(D)))B.t="n",h.cellText!==!1&&(B.w=D),B.v=w;else if(!isNaN(Dn(D).getDate())||I&&D.match(I)){B.z=h.dateNF||ge[14];var Z=0;I&&D.match(I)&&(D=pv(D,h.dateNF,D.match(I)||[]),Z=1),h.cellDates?(B.t="d",B.v=Ze(D,Z)):(B.t="n",B.v=_t(Ze(D,Z))),h.cellText!==!1&&(B.w=$t(B.z,B.v instanceof Date?_t(B.v):B.v)),h.cellNF||delete B.z}else B.t="s",B.v=D;if(B.t=="z"||(h.dense?(x[m]||(x[m]=[]),x[m][_]=B):x[pe({c:_,r:m})]=B),v=C+1,U=l.charCodeAt(v),p.e.c<_&&(p.e.c=_),p.e.r<m&&(p.e.r=m),k==O)++_;else if(_=0,++m,h.sheetRows&&h.sheetRows<=m)return!0}e:for(;C<l.length;++C)switch(k=l.charCodeAt(C)){case 34:U===34&&(R=!R);break;case O:case 10:case 13:if(!R&&z())break e;break}return C-v>0&&z(),x["!ref"]=Te(p),x}function i(l,u){return!(u&&u.PRN)||u.FS||l.slice(0,4)=="sep="||l.indexOf("	")>=0||l.indexOf(",")>=0||l.indexOf(";")>=0?s(l,u):Bn(r(l,u),u)}function c(l,u){var h="",d=u.type=="string"?[0,0,0,0]:hc(l,u);switch(u.type){case"base64":h=Ot(l);break;case"binary":h=l;break;case"buffer":u.codepage==65001?h=l.toString("utf8"):(u.codepage,h=ye&&Buffer.isBuffer(l)?l.toString("binary"):sn(l));break;case"array":h=rn(l);break;case"string":h=l;break;default:throw new Error("Unrecognized type "+u.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=Re(h.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?h=Re(h):u.type=="binary",h.slice(0,19)=="socialcalc:version:"?nw.to_sheet(u.type=="string"?h:Re(h),u):i(h,u)}function f(l,u){return Br(c(l,u),u)}function o(l){for(var u=[],h=Me(l["!ref"]),d,x=Array.isArray(l),p=h.s.r;p<=h.e.r;++p){for(var m=[],_=h.s.c;_<=h.e.c;++_){var w=pe({r:p,c:_});if(d=x?(l[p]||[])[_]:l[w],!d||d.v==null){m.push("          ");continue}for(var v=(d.w||(Tr(d),d.w)||"").slice(0,10);v.length<10;)v+=" ";m.push(v+(_===0?" ":""))}u.push(m.join(""))}return u.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:o}}();function aw(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var a=tw.to_workbook(e,t);return t.WTF=n,a}catch(s){if(t.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Ta.to_workbook(e,r)}}var ha=function(){function e(S,W,M){if(S){tt(S,S.l||0);for(var N=M.Enum||ne;S.l<S.length;){var J=S.read_shift(2),te=N[J]||N[65535],ie=S.read_shift(2),ae=S.l+ie,ee=te.f&&te.f(S,ie,M);if(S.l=ae,W(ee,te,J))return}}}function r(S,W){switch(W.type){case"base64":return t(Yt(Ot(S)),W);case"binary":return t(Yt(S),W);case"buffer":case"array":return t(S,W)}throw"Unsupported type "+W.type}function t(S,W){if(!S)return S;var M=W||{},N=M.dense?[]:{},J="Sheet1",te="",ie=0,ae={},ee=[],Ae=[],b={s:{r:0,c:0},e:{r:0,c:0}},Le=M.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)M.Enum=ne,e(S,function(ce,Be,Dt){switch(Dt){case 0:M.vers=ce,ce>=4096&&(M.qpro=!0);break;case 6:b=ce;break;case 204:ce&&(te=ce);break;case 222:te=ce;break;case 15:case 51:M.qpro||(ce[1].v=ce[1].v.slice(1));case 13:case 14:case 16:Dt==14&&(ce[2]&112)==112&&(ce[2]&15)>1&&(ce[2]&15)<15&&(ce[1].z=M.dateNF||ge[14],M.cellDates&&(ce[1].t="d",ce[1].v=ei(ce[1].v))),M.qpro&&ce[3]>ie&&(N["!ref"]=Te(b),ae[J]=N,ee.push(J),N=M.dense?[]:{},b={s:{r:0,c:0},e:{r:0,c:0}},ie=ce[3],J=te||"Sheet"+(ie+1),te="");var Qt=M.dense?(N[ce[0].r]||[])[ce[0].c]:N[pe(ce[0])];if(Qt){Qt.t=ce[1].t,Qt.v=ce[1].v,ce[1].z!=null&&(Qt.z=ce[1].z),ce[1].f!=null&&(Qt.f=ce[1].f);break}M.dense?(N[ce[0].r]||(N[ce[0].r]=[]),N[ce[0].r][ce[0].c]=ce[1]):N[pe(ce[0])]=ce[1];break}},M);else if(S[2]==26||S[2]==14)M.Enum=oe,S[2]==14&&(M.qpro=!0,S.l=0),e(S,function(ce,Be,Dt){switch(Dt){case 204:J=ce;break;case 22:ce[1].v=ce[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ce[3]>ie&&(N["!ref"]=Te(b),ae[J]=N,ee.push(J),N=M.dense?[]:{},b={s:{r:0,c:0},e:{r:0,c:0}},ie=ce[3],J="Sheet"+(ie+1)),Le>0&&ce[0].r>=Le)break;M.dense?(N[ce[0].r]||(N[ce[0].r]=[]),N[ce[0].r][ce[0].c]=ce[1]):N[pe(ce[0])]=ce[1],b.e.c<ce[0].c&&(b.e.c=ce[0].c),b.e.r<ce[0].r&&(b.e.r=ce[0].r);break;case 27:ce[14e3]&&(Ae[ce[14e3][0]]=ce[14e3][1]);break;case 1537:Ae[ce[0]]=ce[1],ce[0]==ie&&(J=ce[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(N["!ref"]=Te(b),ae[te||J]=N,ee.push(te||J),!Ae.length)return{SheetNames:ee,Sheets:ae};for(var Fe={},be=[],we=0;we<Ae.length;++we)ae[ee[we]]?(be.push(Ae[we]||ee[we]),Fe[Ae[we]]=ae[Ae[we]]||ae[ee[we]]):(be.push(Ae[we]),Fe[Ae[we]]={"!ref":"A1"});return{SheetNames:be,Sheets:Fe}}function n(S,W){var M=W||{};if(+M.codepage>=0&&jt(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var N=i0(),J=Me(S["!ref"]),te=Array.isArray(S),ie=[];Vt(N,0,s(1030)),Vt(N,6,f(J));for(var ae=Math.min(J.e.r,8191),ee=J.s.r;ee<=ae;++ee)for(var Ae=nt(ee),b=J.s.c;b<=J.e.c;++b){ee===J.s.r&&(ie[b]=je(b));var Le=ie[b]+Ae,Fe=te?(S[ee]||[])[b]:S[Le];if(!(!Fe||Fe.t=="z"))if(Fe.t=="n")(Fe.v|0)==Fe.v&&Fe.v>=-32768&&Fe.v<=32767?Vt(N,13,d(ee,b,Fe.v)):Vt(N,14,p(ee,b,Fe.v));else{var be=Tr(Fe);Vt(N,15,u(ee,b,be.slice(0,239)))}}return Vt(N,1),N.end()}function a(S,W){var M=W||{};if(+M.codepage>=0&&jt(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var N=i0();Vt(N,0,i(S));for(var J=0,te=0;J<S.SheetNames.length;++J)(S.Sheets[S.SheetNames[J]]||{})["!ref"]&&Vt(N,27,L(S.SheetNames[J],te++));var ie=0;for(J=0;J<S.SheetNames.length;++J){var ae=S.Sheets[S.SheetNames[J]];if(!(!ae||!ae["!ref"])){for(var ee=Me(ae["!ref"]),Ae=Array.isArray(ae),b=[],Le=Math.min(ee.e.r,8191),Fe=ee.s.r;Fe<=Le;++Fe)for(var be=nt(Fe),we=ee.s.c;we<=ee.e.c;++we){Fe===ee.s.r&&(b[we]=je(we));var ce=b[we]+be,Be=Ae?(ae[Fe]||[])[we]:ae[ce];if(!(!Be||Be.t=="z"))if(Be.t=="n")Vt(N,23,z(Fe,we,ie,Be.v));else{var Dt=Tr(Be);Vt(N,22,k(Fe,we,ie,Dt.slice(0,239)))}}++ie}}return Vt(N,1),N.end()}function s(S){var W=Ye(2);return W.write_shift(2,S),W}function i(S){var W=Ye(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var M=0,N=0,J=0,te=0;te<S.SheetNames.length;++te){var ie=S.SheetNames[te],ae=S.Sheets[ie];if(!(!ae||!ae["!ref"])){++J;var ee=Ln(ae["!ref"]);M<ee.e.r&&(M=ee.e.r),N<ee.e.c&&(N=ee.e.c)}}return M>8191&&(M=8191),W.write_shift(2,M),W.write_shift(1,J),W.write_shift(1,N),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function c(S,W,M){var N={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&M.qpro?(N.s.c=S.read_shift(1),S.l++,N.s.r=S.read_shift(2),N.e.c=S.read_shift(1),S.l++,N.e.r=S.read_shift(2),N):(N.s.c=S.read_shift(2),N.s.r=S.read_shift(2),W==12&&M.qpro&&(S.l+=2),N.e.c=S.read_shift(2),N.e.r=S.read_shift(2),W==12&&M.qpro&&(S.l+=2),N.s.c==65535&&(N.s.c=N.e.c=N.s.r=N.e.r=0),N)}function f(S){var W=Ye(8);return W.write_shift(2,S.s.c),W.write_shift(2,S.s.r),W.write_shift(2,S.e.c),W.write_shift(2,S.e.r),W}function o(S,W,M){var N=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(N[0].c=S.read_shift(1),N[3]=S.read_shift(1),N[0].r=S.read_shift(2),S.l+=2):(N[2]=S.read_shift(1),N[0].c=S.read_shift(2),N[0].r=S.read_shift(2)),N}function l(S,W,M){var N=S.l+W,J=o(S,W,M);if(J[1].t="s",M.vers==20768){S.l++;var te=S.read_shift(1);return J[1].v=S.read_shift(te,"utf8"),J}return M.qpro&&S.l++,J[1].v=S.read_shift(N-S.l,"cstr"),J}function u(S,W,M){var N=Ye(7+M.length);N.write_shift(1,255),N.write_shift(2,W),N.write_shift(2,S),N.write_shift(1,39);for(var J=0;J<N.length;++J){var te=M.charCodeAt(J);N.write_shift(1,te>=128?95:te)}return N.write_shift(1,0),N}function h(S,W,M){var N=o(S,W,M);return N[1].v=S.read_shift(2,"i"),N}function d(S,W,M){var N=Ye(7);return N.write_shift(1,255),N.write_shift(2,W),N.write_shift(2,S),N.write_shift(2,M,"i"),N}function x(S,W,M){var N=o(S,W,M);return N[1].v=S.read_shift(8,"f"),N}function p(S,W,M){var N=Ye(13);return N.write_shift(1,255),N.write_shift(2,W),N.write_shift(2,S),N.write_shift(8,M,"f"),N}function m(S,W,M){var N=S.l+W,J=o(S,W,M);if(J[1].v=S.read_shift(8,"f"),M.qpro)S.l=N;else{var te=S.read_shift(2);C(S.slice(S.l,S.l+te),J),S.l+=te}return J}function _(S,W,M){var N=W&32768;return W&=-32769,W=(N?S:0)+(W>=8192?W-16384:W),(N?"":"$")+(M?je(W):nt(W))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(S,W){tt(S,0);for(var M=[],N=0,J="",te="",ie="",ae="";S.l<S.length;){var ee=S[S.l++];switch(ee){case 0:M.push(S.read_shift(8,"f"));break;case 1:te=_(W[0].c,S.read_shift(2),!0),J=_(W[0].r,S.read_shift(2),!1),M.push(te+J);break;case 2:{var Ae=_(W[0].c,S.read_shift(2),!0),b=_(W[0].r,S.read_shift(2),!1);te=_(W[0].c,S.read_shift(2),!0),J=_(W[0].r,S.read_shift(2),!1),M.push(Ae+b+":"+te+J)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(S.read_shift(2));break;case 6:{for(var Le="";ee=S[S.l++];)Le+=String.fromCharCode(ee);M.push('"'+Le.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:ae=M.pop(),ie=M.pop(),M.push(["AND","OR"][ee-20]+"("+ie+","+ae+")");break;default:if(ee<32&&v[ee])ae=M.pop(),ie=M.pop(),M.push(ie+v[ee]+ae);else if(w[ee]){if(N=w[ee][1],N==69&&(N=S[S.l++]),N>M.length){console.error("WK1 bad formula parse 0x"+ee.toString(16)+":|"+M.join("|")+"|");return}var Fe=M.slice(-N);M.length-=N,M.push(w[ee][0]+"("+Fe.join(",")+")")}else return ee<=7?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=24?console.error("WK1 unsupported op "+ee.toString(16)):ee<=30?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=115?console.error("WK1 unsupported function opcode "+ee.toString(16)):console.error("WK1 unrecognized opcode "+ee.toString(16))}}M.length==1?W[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function O(S){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=S.read_shift(2),W[3]=S[S.l++],W[0].c=S[S.l++],W}function R(S,W){var M=O(S);return M[1].t="s",M[1].v=S.read_shift(W-4,"cstr"),M}function k(S,W,M,N){var J=Ye(6+N.length);J.write_shift(2,S),J.write_shift(1,M),J.write_shift(1,W),J.write_shift(1,39);for(var te=0;te<N.length;++te){var ie=N.charCodeAt(te);J.write_shift(1,ie>=128?95:ie)}return J.write_shift(1,0),J}function U(S,W){var M=O(S);M[1].v=S.read_shift(2);var N=M[1].v>>1;if(M[1].v&1)switch(N&7){case 0:N=(N>>3)*5e3;break;case 1:N=(N>>3)*500;break;case 2:N=(N>>3)/20;break;case 3:N=(N>>3)/200;break;case 4:N=(N>>3)/2e3;break;case 5:N=(N>>3)/2e4;break;case 6:N=(N>>3)/16;break;case 7:N=(N>>3)/64;break}return M[1].v=N,M}function I(S,W){var M=O(S),N=S.read_shift(4),J=S.read_shift(4),te=S.read_shift(2);if(te==65535)return N===0&&J===3221225472?(M[1].t="e",M[1].v=15):N===0&&J===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var ie=te&32768;return te=(te&32767)-16446,M[1].v=(1-ie*2)*(J*Math.pow(2,te+32)+N*Math.pow(2,te)),M}function z(S,W,M,N){var J=Ye(14);if(J.write_shift(2,S),J.write_shift(1,M),J.write_shift(1,W),N==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var te=0,ie=0,ae=0,ee=0;return N<0&&(te=1,N=-N),ie=Math.log2(N)|0,N/=Math.pow(2,ie-31),ee=N>>>0,(ee&2147483648)==0&&(N/=2,++ie,ee=N>>>0),N-=ee,ee|=2147483648,ee>>>=0,N*=Math.pow(2,32),ae=N>>>0,J.write_shift(4,ae),J.write_shift(4,ee),ie+=16383+(te?32768:0),J.write_shift(2,ie),J}function D(S,W){var M=I(S);return S.l+=W-14,M}function B(S,W){var M=O(S),N=S.read_shift(4);return M[1].v=N>>6,M}function Z(S,W){var M=O(S),N=S.read_shift(8,"f");return M[1].v=N,M}function P(S,W){var M=Z(S);return S.l+=W-10,M}function j(S,W){return S[S.l+W-1]==0?S.read_shift(W,"cstr"):""}function H(S,W){var M=S[S.l++];M>W-1&&(M=W-1);for(var N="";N.length<M;)N+=String.fromCharCode(S[S.l++]);return N}function K(S,W,M){if(!(!M.qpro||W<21)){var N=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var J=S.read_shift(W-21,"cstr");return[N,J]}}function fe(S,W){for(var M={},N=S.l+W;S.l<N;){var J=S.read_shift(2);if(J==14e3){for(M[J]=[0,""],M[J][0]=S.read_shift(2);S[S.l];)M[J][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return M}function L(S,W){var M=Ye(5+S.length);M.write_shift(2,14e3),M.write_shift(2,W);for(var N=0;N<S.length;++N){var J=S.charCodeAt(N);M[M.l++]=J>127?95:J}return M[M.l++]=0,M}var ne={0:{n:"BOF",f:Ve},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:l},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:l},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:j},222:{n:"SHEETNAMELP",f:H},65535:{n:""}},oe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:U},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:fe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:B},38:{n:"??"},39:{n:"NUMBER27",f:Z},40:{n:"FORMULA28",f:P},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:j},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:K},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}}();function sw(e){var r={},t=e.match(dt),n=0,a=!1;if(t)for(;n!=t.length;++n){var s=xe(t[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;r.cp=W0[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=s.val;break;case"<sz":r.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":s.rgb&&(r.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return r}var iw=function(){var e=Ea("t"),r=Ea("rPr");function t(s){var i=s.match(e);if(!i)return{t:"s",v:""};var c={t:"s",v:Se(i[1])},f=s.match(r);return f&&(c.s=sw(f[1])),c}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(t).filter(function(c){return c.v})}}(),cw=function(){var r=/(\r\n|\n)/g;function t(a,s,i){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),s.push('<span style="'+c.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(s.push("<"+f+">"),i.push("</"+f+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&t(a.s,s[0],s[2]),s[0].join("")+s[1].replace(r,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),ow=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,fw=/<(?:\w+:)?r>/,lw=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function sc(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Se(Re(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Re(e),t&&(n.h=K0(n.t))):e.match(fw)&&(n.r=Re(e),n.t=Se(Re((e.replace(lw,"").match(ow)||[]).join("").replace(dt,""))),t&&(n.h=cw(iw(n.r)))),n):{t:""}}var uw=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,hw=/<(?:\w+:)?(?:si|sstItem)>/g,dw=/<\/(?:\w+:)?(?:si|sstItem)>/;function xw(e,r){var t=[],n="";if(!e)return t;var a=e.match(uw);if(a){n=a[2].replace(hw,"").split(dw);for(var s=0;s!=n.length;++s){var i=sc(n[s].trim(),r);i!=null&&(t[t.length]=i)}a=xe(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function pw(e){return[e.read_shift(4),e.read_shift(4)]}function mw(e,r){var t=[],n=!1;return Ar(e,function(s,i,c){switch(c){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||r.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function Ru(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function Er(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function gw(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Er(e,4),r.U=Er(e,4),r.W=Er(e,4),r}function vw(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function _w(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(vw(e));return r}function ww(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function yw(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Er(e,4),r.U=Er(e,4),r.W=Er(e,4),r}function Ew(e){var r=yw(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function Iu(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function Ou(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function kw(e){var r=Er(e);switch(r.Minor){case 2:return[r.Minor,Tw(e)];case 3:return[r.Minor,Aw()];case 4:return[r.Minor,Sw(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function Tw(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=Iu(e,t),a=Ou(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Aw(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Sw(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(dt,function(s){var i=xe(s);switch(ur(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(c){n[c]=i[c]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Fw(e,r){var t={},n=t.EncryptionVersionInfo=Er(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var a=e.read_shift(4);return r-=4,t.EncryptionHeader=Iu(e,a),r-=a,t.EncryptionVerifier=Ou(e,r),t}function Cw(e){var r={},t=r.EncryptionVersionInfo=Er(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function bw(e){var r=0,t,n=Ru(e),a=n.length+1,s,i,c,f,o;for(t=Mr(a),t[0]=n.length,s=1;s!=a;++s)t[s]=n[s-1];for(s=a-1;s>=0;--s)i=t[s],c=(r&16384)===0?0:1,f=r<<1&32767,o=c|f,r=o^i;return r^52811}var Du=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,c){return n(i^c)},s=function(i){for(var c=r[i.length-1],f=104,o=i.length-1;o>=0;--o)for(var l=i[o],u=0;u!=7;++u)l&64&&(c^=t[f]),l*=2,--f;return c};return function(i){for(var c=Ru(i),f=s(c),o=c.length,l=Mr(16),u=0;u!=16;++u)l[u]=0;var h,d,x;for((o&1)===1&&(h=f>>8,l[o]=a(e[0],h),--o,h=f&255,d=c[c.length-1],l[o]=a(d,h));o>0;)--o,h=f>>8,l[o]=a(c[o],h),--o,h=f&255,l[o]=a(c[o],h);for(o=15,x=15-c.length;x>0;)h=f>>8,l[o]=a(e[x],h),--o,--x,h=f&255,l[o]=a(c[o],h),--o,--x;return l}}(),Rw=function(e,r,t,n,a){a||(a=r),n||(n=Du(e));var s,i;for(s=0;s!=r.length;++s)i=r[s],i^=n[t],i=(i>>5|i<<3)&255,a[s]=i,++t;return[a,t,n]},Iw=function(e){var r=0,t=Du(e);return function(n){var a=Rw("",n,r,t);return r=a[1],a[0]}};function Ow(e,r,t,n){var a={key:Ve(e),verificationBytes:Ve(e)};return t.password&&(a.verifier=bw(t.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Iw(t.password)),a}function Dw(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Cw(e):n.Data=Fw(e,r),n}function Pw(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?Dw(e,r-2,n):Ow(e,t.biff>=8?r:r-2,t,n),n}var Nw=function(){function e(a,s){switch(s.type){case"base64":return r(Ot(a),s);case"binary":return r(a,s);case"buffer":return r(ye&&Buffer.isBuffer(a)?a.toString("binary"):sn(a),s);case"array":return r(rn(a),s)}throw new Error("Unrecognized type "+s.type)}function r(a,s){var i=s||{},c=i.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var o={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(l,u){Array.isArray(c)&&(c[u]=[]);for(var h=/\\\w+\b/g,d=0,x,p=-1;x=h.exec(l);){switch(x[0]){case"\\cell":var m=l.slice(d,h.lastIndex-x[0].length);if(m[0]==" "&&(m=m.slice(1)),++p,m.length){var _={v:m,t:"s"};Array.isArray(c)?c[u][p]=_:c[pe({r:u,c:p})]=_}break}d=h.lastIndex}p>o.e.c&&(o.e.c=p)}),c["!ref"]=Te(o),c}function t(a,s){return Br(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=Me(a["!ref"]),c,f=Array.isArray(a),o=i.s.r;o<=i.e.r;++o){s.push("\\trowd\\trautofit1");for(var l=i.s.c;l<=i.e.c;++l)s.push("\\cellx"+(l+1));for(s.push("\\pard\\intbl"),l=i.s.c;l<=i.e.c;++l){var u=pe({r:o,c:l});c=f?(a[o]||[])[l]:a[u],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(Tr(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function Mw(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Aa(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function Lw(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,a=Math.max(r,t,n),s=Math.min(r,t,n),i=a-s;if(i===0)return[0,0,r];var c=0,f=0,o=a+s;switch(f=i/(o>1?2-o:o),a){case r:c=((t-n)/i+6)%6;break;case t:c=(n-r)/i+2;break;case n:c=(r-t)/i+4;break}return[c/6,f,o/2]}function Bw(e){var r=e[0],t=e[1],n=e[2],a=t*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],c=6*r,f;if(t!==0)switch(c|0){case 0:case 6:f=a*c,i[0]+=a,i[1]+=f;break;case 1:f=a*(2-c),i[0]+=f,i[1]+=a;break;case 2:f=a*(c-2),i[1]+=a,i[2]+=f;break;case 3:f=a*(4-c),i[1]+=f,i[2]+=a;break;case 4:f=a*(c-4),i[2]+=a,i[0]+=f;break;case 5:f=a*(6-c),i[2]+=f,i[0]+=a;break}for(var o=0;o!=3;++o)i[o]=Math.round(i[o]*255);return i}function Vs(e,r){if(r===0)return e;var t=Lw(Mw(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Aa(Bw(t))}var Pu=6,Uw=15,$w=1,mt=Pu;function Gs(e){return Math.floor((e+Math.round(128/mt)/256)*mt)}function zs(e){return Math.floor((e-5)/mt*100+.5)/100}function l0(e){return Math.round((e*mt+5)/mt*256)/256}function Fi(e){return l0(zs(Gs(e)))}function ic(e){var r=Math.abs(e-Fi(e)),t=mt;if(r>.005)for(mt=$w;mt<Uw;++mt)Math.abs(e-Fi(e))<=r&&(r=Math.abs(e-Fi(e)),t=mt);mt=t}function Pn(e){e.width?(e.wpx=Gs(e.width),e.wch=zs(e.wpx),e.MDW=mt):e.wpx?(e.wch=zs(e.wpx),e.width=l0(e.wch),e.MDW=mt):typeof e.wch=="number"&&(e.width=l0(e.wch),e.wpx=Gs(e.width),e.MDW=mt),e.customWidth&&delete e.customWidth}var Hw=96,Nu=Hw;function Mu(e){return e*96/Nu}function Sa(e){return e*Nu/96}var Ww={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Vw(e,r,t,n){r.Borders=[];var a={},s=!1;(e[0].match(dt)||[]).forEach(function(i){var c=xe(i);switch(ur(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=Ie(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=Ie(c.diagonalDown)),r.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in borders")}})}function Gw(e,r,t,n){r.Fills=[];var a={},s=!1;(e[0].match(dt)||[]).forEach(function(i){var c=xe(i);switch(ur(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},r.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fills")}})}function zw(e,r,t,n){r.Fonts=[];var a={},s=!1;(e[0].match(dt)||[]).forEach(function(i){var c=xe(i);switch(ur(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Re(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?Ie(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?Ie(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?Ie(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?Ie(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?Ie(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?Ie(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?Ie(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=W0[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=Ie(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var f=Zr[a.color.index];a.color.index==81&&(f=Zr[1]),f||(f=Zr[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Vs(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fonts")}})}function Xw(e,r,t){r.NumberFmt=[];for(var n=fr(ge),a=0;a<n.length;++a)r.NumberFmt[n[a]]=ge[n[a]];var s=e[0].match(dt);if(s)for(a=0;a<s.length;++a){var i=xe(s[a]);switch(ur(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Se(Re(i.formatCode)),f=parseInt(i.numFmtId,10);if(r.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&r.NumberFmt[f]!=null;--f);r.NumberFmt[f]=c}Jr(c,f)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var rs=["numFmtId","fillId","fontId","borderId","xfId"],ns=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Yw(e,r,t){r.CellXf=[];var n,a=!1;(e[0].match(dt)||[]).forEach(function(s){var i=xe(s),c=0;switch(ur(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],c=0;c<rs.length;++c)n[rs[c]]&&(n[rs[c]]=parseInt(n[rs[c]],10));for(c=0;c<ns.length;++c)n[ns[c]]&&(n[ns[c]]=Ie(n[ns[c]]));if(r.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[c]){n.numFmtId=c;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};i.vertical&&(f.vertical=i.vertical),i.horizontal&&(f.horizontal=i.horizontal),i.textRotation!=null&&(f.textRotation=i.textRotation),i.indent&&(f.indent=i.indent),i.wrapText&&(f.wrapText=Ie(i.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var jw=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,o){var l={};if(!c)return l;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var u;return(u=c.match(r))&&Xw(u,l,o),(u=c.match(a))&&zw(u,l,f,o),(u=c.match(n))&&Gw(u,l,f,o),(u=c.match(s))&&Vw(u,l,f,o),(u=c.match(t))&&Yw(u,l,o),l}}();function Kw(e,r){var t=e.read_shift(2),n=ut(e);return[t,n]}function qw(e,r,t){var n={};n.sz=e.read_shift(2)/20;var a=i_(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var c=e.read_shift(1);c>0&&(n.family=c);var f=e.read_shift(1);switch(f>0&&(n.charset=f),e.l++,n.color=s_(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ut(e),n}var Jw=ht;function Zw(e,r){var t=e.l+r,n=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:a}}var Qw=ht;function ey(e,r,t){var n={};n.NumberFmt=[];for(var a in ge)n.NumberFmt[a]=ge[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return Ar(e,function(f,o,l){switch(l){case 44:n.NumberFmt[f[0]]=f[1],Jr(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(f.color.rgb=Vs(r.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(l),i=!0;break;case 38:s.pop(),i=!1;break;default:if(o.T>0)s.push(l);else if(o.T<0)s.pop();else if(!i||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}var ty=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function ry(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(dt)||[]).forEach(function(a){var s=xe(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(r.themeElements.clrScheme[ty.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function ny(){}function ay(){}var sy=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,iy=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,cy=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function oy(e,r,t){r.themeElements={};var n;[["clrScheme",sy,ry],["fontScheme",iy,ny],["fmtScheme",cy,ay]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,r,t)})}var fy=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Lu(e,r){(!e||e.length===0)&&(e=ly());var t,n={};if(!(t=e.match(fy)))throw new Error("themeElements not found in theme");return oy(t[0],n,r),n.raw=e,n}function ly(e,r){var t=[jl];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function uy(e,r,t){var n=e.l+r,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=Yl(s,{type:"array"})}catch{return}var c=Rt(i,"theme/theme/theme1.xml",!0);if(c)return Lu(c,t)}}function hy(e){return e.read_shift(4)}function dy(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=xy(e,4);break;case 2:r.xclrValue=ku(e);break;case 3:r.xclrValue=hy(e);break;case 4:e.l+=4;break}return e.l+=8,r}function xy(e,r){return ht(e,r)}function py(e,r){return ht(e,r)}function my(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=dy(e);break;case 6:n[1]=py(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function gy(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(my(e,t-e.l));return{ixfe:n,ext:s}}function vy(e,r){r.forEach(function(t){t[0]})}function _y(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:ut(e)}}function wy(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function yy(e){return e.l+=4,e.read_shift(4)!=0}function Ey(e,r,t){var n={Types:[],Cell:[],Value:[]},a=t||{},s=[],i=!1,c=2;return Ar(e,function(f,o,l){switch(l){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(u){c==1?n.Cell.push({type:n.Types[u[0]-1].name,index:u[1]}):c==0&&n.Value.push({type:n.Types[u[0]-1].name,index:u[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:s.push(l),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!o.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+l.toString(16))}}}),n}function ky(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(dt,function(c){var f=xe(c);switch(ur(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var o=0;o<n.Types.length;++o)n.Types[o].name==f.name&&(i=n.Types[o]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):s==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+f.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),n}function Ty(e){var r=[];if(!e)return r;var t=1;return(e.match(dt)||[]).forEach(function(n){var a=xe(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,r.push(a);break}}),r}function Ay(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=pe(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function Sy(e,r,t){var n=[];return Ar(e,function(s,i,c){switch(c){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function Fy(e,r,t,n){if(!e)return e;var a=n||{},s=!1;Ar(e,function(c,f,o){switch(o){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!f.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}},a)}function Cy(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function cf(e,r,t,n){var a=Array.isArray(e),s;r.forEach(function(i){var c=gt(i.ref);if(a?(e[c.r]||(e[c.r]=[]),s=e[c.r][c.c]):s=e[i.ref],!s){s={t:"z"},a?e[c.r][c.c]=s:e[i.ref]=s;var f=Me(e["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var o=Te(f);o!==e["!ref"]&&(e["!ref"]=o)}s.c||(s.c=[]);var l={a:i.author,t:i.t,r:i.r,T:t};i.h&&(l.h=i.h);for(var u=s.c.length-1;u>=0;--u){if(!t&&s.c[u].T)return;t&&!s.c[u].T&&s.c.splice(u,1)}if(t&&n){for(u=0;u<n.length;++u)if(l.a==n[u].id){l.a=n[u].name||l.a;break}}s.c.push(l)})}function by(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var c=i.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&t.push(c[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var c=i.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=xe(c[0]),o={author:f.authorId&&t[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},l=gt(f.ref);if(!(r.sheetRows&&r.sheetRows<=l.r)){var u=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!u&&!!u[1]&&sc(u[1])||{r:"",t:"",h:""};o.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),o.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(o.h=h.h),n.push(o)}}}}),n}function Ry(e,r){var t=[],n=!1,a={},s=0;return e.replace(dt,function(c,f){var o=xe(c);switch(ur(o[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:o.personId,guid:o.id,ref:o.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":s=f+c.length;break;case"</text>":a.t=e.slice(s,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return c}),t}function Iy(e,r){var t=[],n=!1;return e.replace(dt,function(s){var i=xe(s);switch(ur(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),t}function Oy(e){var r={};r.iauthor=e.read_shift(4);var t=on(e);return r.rfx=t.s,r.ref=pe(t.s),e.l+=16,r}var Dy=ut;function Py(e,r){var t=[],n=[],a={},s=!1;return Ar(e,function(c,f,o){switch(o){case 632:n.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!s||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}}),t}var Ny="application/vnd.ms-office.vbaProject";function My(e){var r=ke.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ke.utils.cfb_add(r,a,e.FileIndex[n].content)}}),ke.write(r)}function Ly(){return{"!type":"dialog"}}function By(){return{"!type":"dialog"}}function Uy(){return{"!type":"macro"}}function $y(){return{"!type":"macro"}}var kn=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,a,s,i){var c=!1,f=!1;s.length==0?f=!0:s.charAt(0)=="["&&(f=!0,s=s.slice(1,-1)),i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1));var o=s.length>0?parseInt(s,10)|0:0,l=i.length>0?parseInt(i,10)|0:0;return c?l+=r.c:--l,f?o+=r.r:--o,a+(c?"":"$")+je(l)+(f?"":"$")+nt(o)}return function(a,s){return r=s,a.replace(e,t)}}(),Bu=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Hy=function(){return function(r,t){return r.replace(Bu,function(n,a,s,i,c,f){var o=Q0(i)-(s?0:t.c),l=Z0(f)-(c?0:t.r),u=l==0?"":c?l+1:"["+l+"]",h=o==0?"":s?o+1:"["+o+"]";return a+"R"+u+"C"+h})}}();function Uu(e,r){return e.replace(Bu,function(t,n,a,s,i,c){return n+(a=="$"?a+s:je(Q0(s)+r.c))+(i=="$"?i+c:nt(Z0(c)+r.r))})}function Wy(e,r,t){var n=Ln(r),a=n.s,s=gt(t),i={r:s.r-a.r,c:s.c-a.c};return Uu(e,i)}function Vy(e){return e.length!=1}function of(e){return e.replace(/_xlfn\./g,"")}function He(e){e.l+=1}function Lr(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function $u(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Hu(e);t.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=Lr(e),c=Lr(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function Hu(e){var r=Lr(e),t=Lr(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function Gy(e,r,t){if(t.biff<8)return Hu(e);var n=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),s=Lr(e),i=Lr(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function Wu(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return zy(e);var n=e.read_shift(t&&t.biff==12?4:2),a=Lr(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function zy(e){var r=Lr(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function Xy(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function Yy(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return jy(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:c}}function jy(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:n}}function Ky(e,r,t){var n=(e[e.l++]&96)>>5,a=$u(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function qy(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=$u(e,s,t);return[n,a,i]}function Jy(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function Zy(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function Qy(e,r,t){var n=(e[e.l++]&96)>>5,a=Gy(e,r-1,t);return[n,a]}function eE(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function ff(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function tE(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function rE(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function nE(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function aE(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function sE(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function Vu(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function iE(e){return e.read_shift(2),Vu(e)}function cE(e){return e.read_shift(2),Vu(e)}function oE(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=Wu(e,0,t);return[n,a]}function fE(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=Yy(e,0,t);return[n,a]}function lE(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var s=Wu(e,0,t);return[n,a,s]}function uE(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[hk[a],Xu[a],n]}function hE(e,r,t){var n=e[e.l++],a=e.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:dE(e);return[a,(s[0]===0?Xu:uk)[s[1]]]}function dE(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function xE(e,r,t){e.l+=t&&t.biff==2?3:4}function pE(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function mE(e){return e.l++,fn[e.read_shift(1)]}function gE(e){return e.l++,e.read_shift(2)}function vE(e){return e.l++,e.read_shift(1)!==0}function _E(e){return e.l++,ft(e)}function wE(e,r,t){return e.l++,Pa(e,r-1,t)}function yE(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=$e(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=fn[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=ft(e);break;case 2:t[1]=ln(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function EE(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((t.biff==12?on:ti)(e));return a}function kE(e,r,t){var n=0,a=0;t.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var c=0;c!=a;++c)i[s][c]=yE(e,t.biff);return i}function TE(e,r,t){var n=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,s=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function AE(e,r,t){if(t.biff==5)return SE(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function SE(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function FE(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function CE(e,r,t){var n=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function bE(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function RE(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var IE=ht,OE=ht,DE=ht;function Ma(e,r,t){return e.l+=2,[Xy(e)]}function cc(e){return e.l+=6,[]}var PE=Ma,NE=cc,ME=cc,LE=Ma;function Gu(e){return e.l+=2,[Ve(e),e.read_shift(2)&1]}var BE=Ma,UE=Gu,$E=cc,HE=Ma,WE=Ma,VE=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function GE(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=VE[t>>2&31];return{ixti:r,coltype:t&3,rt:i,idx:n,c:a,C:s}}function zE(e){return e.l+=2,[e.read_shift(4)]}function XE(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function YE(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function jE(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function KE(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function qE(e){return e.l+=4,[0,0]}var lf={1:{n:"PtgExp",f:pE},2:{n:"PtgTbl",f:DE},3:{n:"PtgAdd",f:He},4:{n:"PtgSub",f:He},5:{n:"PtgMul",f:He},6:{n:"PtgDiv",f:He},7:{n:"PtgPower",f:He},8:{n:"PtgConcat",f:He},9:{n:"PtgLt",f:He},10:{n:"PtgLe",f:He},11:{n:"PtgEq",f:He},12:{n:"PtgGe",f:He},13:{n:"PtgGt",f:He},14:{n:"PtgNe",f:He},15:{n:"PtgIsect",f:He},16:{n:"PtgUnion",f:He},17:{n:"PtgRange",f:He},18:{n:"PtgUplus",f:He},19:{n:"PtgUminus",f:He},20:{n:"PtgPercent",f:He},21:{n:"PtgParen",f:He},22:{n:"PtgMissArg",f:He},23:{n:"PtgStr",f:wE},26:{n:"PtgSheet",f:XE},27:{n:"PtgEndSheet",f:YE},28:{n:"PtgErr",f:mE},29:{n:"PtgBool",f:vE},30:{n:"PtgInt",f:gE},31:{n:"PtgNum",f:_E},32:{n:"PtgArray",f:eE},33:{n:"PtgFunc",f:uE},34:{n:"PtgFuncVar",f:hE},35:{n:"PtgName",f:TE},36:{n:"PtgRef",f:oE},37:{n:"PtgArea",f:Ky},38:{n:"PtgMemArea",f:FE},39:{n:"PtgMemErr",f:IE},40:{n:"PtgMemNoMem",f:OE},41:{n:"PtgMemFunc",f:CE},42:{n:"PtgRefErr",f:bE},43:{n:"PtgAreaErr",f:Jy},44:{n:"PtgRefN",f:fE},45:{n:"PtgAreaN",f:Qy},46:{n:"PtgMemAreaN",f:jE},47:{n:"PtgMemNoMemN",f:KE},57:{n:"PtgNameX",f:AE},58:{n:"PtgRef3d",f:lE},59:{n:"PtgArea3d",f:qy},60:{n:"PtgRefErr3d",f:RE},61:{n:"PtgAreaErr3d",f:Zy},255:{}},JE={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},ZE={1:{n:"PtgElfLel",f:Gu},2:{n:"PtgElfRw",f:HE},3:{n:"PtgElfCol",f:PE},6:{n:"PtgElfRwV",f:WE},7:{n:"PtgElfColV",f:LE},10:{n:"PtgElfRadical",f:BE},11:{n:"PtgElfRadicalS",f:$E},13:{n:"PtgElfColS",f:NE},15:{n:"PtgElfColSV",f:ME},16:{n:"PtgElfRadicalLel",f:UE},25:{n:"PtgList",f:GE},29:{n:"PtgSxName",f:zE},255:{}},QE={0:{n:"PtgAttrNoop",f:qE},1:{n:"PtgAttrSemi",f:sE},2:{n:"PtgAttrIf",f:nE},4:{n:"PtgAttrChoose",f:tE},8:{n:"PtgAttrGoto",f:rE},16:{n:"PtgAttrSum",f:xE},32:{n:"PtgAttrBaxcel",f:ff},33:{n:"PtgAttrBaxcel",f:ff},64:{n:"PtgAttrSpace",f:iE},65:{n:"PtgAttrSpaceSemi",f:cE},128:{n:"PtgAttrIfError",f:aE},255:{}};function La(e,r,t,n){if(n.biff<8)return ht(e,r);for(var a=e.l+r,s=[],i=0;i!==t.length;++i)switch(t[i][0]){case"PtgArray":t[i][1]=kE(e,0,n),s.push(t[i][1]);break;case"PtgMemArea":t[i][2]=EE(e,t[i][1],n),s.push(t[i][2]);break;case"PtgExp":n&&n.biff==12&&(t[i][1][1]=e.read_shift(4),s.push(t[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[i][0]}return r=a-e.l,r!==0&&s.push(ht(e,r)),s}function Ba(e,r,t){for(var n=e.l+r,a,s,i=[];n!=e.l;)r=n-e.l,s=e[e.l],a=lf[s]||lf[JE[s]],(s===24||s===25)&&(a=(s===24?ZE:QE)[e[e.l+1]]),!a||!a.f?ht(e,r):i.push([a.n,a.f(e,r,t)]);return i}function ek(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var tk={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function rk(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function zu(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function uf(e,r,t){var n=zu(e,r,t);return n=="#REF"?n:rk(n,t)}function ot(e,r,t,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0}},c=[],f,o,l,u=0,h=0,d,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,m="",_=0,w=e[0].length;_<w;++_){var v=e[0][_];switch(v[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),o=c.pop(),p>=0){switch(e[0][p][1][0]){case 0:m=Ne(" ",e[0][p][1][1]);break;case 1:m=Ne("\r",e[0][p][1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}o=o+m,p=-1}c.push(o+tk[v[0]]+f);break;case"PtgIsect":f=c.pop(),o=c.pop(),c.push(o+" "+f);break;case"PtgUnion":f=c.pop(),o=c.pop(),c.push(o+","+f);break;case"PtgRange":f=c.pop(),o=c.pop(),c.push(o+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":l=oa(v[1][1],i,a),c.push(fa(l,s));break;case"PtgRefN":l=t?oa(v[1][1],t,a):v[1][1],c.push(fa(l,s));break;case"PtgRef3d":u=v[1][1],l=oa(v[1][2],i,a),x=uf(n,u,a),c.push(x+"!"+fa(l,s));break;case"PtgFunc":case"PtgFuncVar":var C=v[1][0],O=v[1][1];C||(C=0),C&=127;var R=C==0?[]:c.slice(-C);c.length-=C,O==="User"&&(O=R.shift()),c.push(O+"("+R.join(",")+")");break;case"PtgBool":c.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(v[1]);break;case"PtgNum":c.push(String(v[1]));break;case"PtgStr":c.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(v[1]);break;case"PtgAreaN":d=Go(v[1][1],t?{s:t}:i,a),c.push(Ai(d,a));break;case"PtgArea":d=Go(v[1][1],i,a),c.push(Ai(d,a));break;case"PtgArea3d":u=v[1][1],d=v[1][2],x=uf(n,u,a),c.push(x+"!"+Ai(d,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var k=(n.names||[])[h-1]||(n[0]||[])[h],U=k?k.Name:"SH33TJSNAME"+String(h);U&&U.slice(0,6)=="_xlfn."&&!a.xlfn&&(U=U.slice(6)),c.push(U);break;case"PtgNameX":var I=v[1][1];h=v[1][2];var z;if(a.biff<=5)I<0&&(I=-I),n[I]&&(z=n[I][h]);else{var D="";if(((n[I]||[])[0]||[])[0]==14849||(((n[I]||[])[0]||[])[0]==1025?n[I][h]&&n[I][h].itab>0&&(D=n.SheetNames[n[I][h].itab-1]+"!"):D=n.SheetNames[h-1]+"!"),n[I]&&n[I][h])D+=n[I][h].Name;else if(n[0]&&n[0][h])D+=n[0][h].Name;else{var B=(zu(n,I,a)||"").split(";;");B[h-1]?D=B[h-1]:D+="SH33TJSERRX"}c.push(D);break}z||(z={Name:"SH33TJSERRY"}),c.push(z.Name);break;case"PtgParen":var Z="(",P=")";if(p>=0){switch(m="",e[0][p][1][0]){case 2:Z=Ne(" ",e[0][p][1][1])+Z;break;case 3:Z=Ne("\r",e[0][p][1][1])+Z;break;case 4:P=Ne(" ",e[0][p][1][1])+P;break;case 5:P=Ne("\r",e[0][p][1][1])+P;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}c.push(Z+c.pop()+P);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":l={c:v[1][1],r:v[1][0]};var j={c:t.c,r:t.r};if(n.sharedf[pe(l)]){var H=n.sharedf[pe(l)];c.push(ot(H,i,j,n,a))}else{var K=!1;for(f=0;f!=n.arrayf.length;++f)if(o=n.arrayf[f],!(l.c<o[0].s.c||l.c>o[0].e.c)&&!(l.r<o[0].s.r||l.r>o[0].e.r)){c.push(ot(o[1],i,j,n,a)),K=!0;break}K||c.push(v[1])}break;case"PtgArray":c.push("{"+ek(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var fe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&fe.indexOf(e[0][_][0])==-1){v=e[0][p];var L=!0;switch(v[1][0]){case 4:L=!1;case 0:m=Ne(" ",v[1][1]);break;case 5:L=!1;case 1:m=Ne("\r",v[1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}c.push((L?m:"")+c.pop()+(L?"":m)),p=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function nk(e,r,t){var n=e.l+r,a=t.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],ht(e,r-2)];var c=Ba(e,i,t);return r!==i+a&&(s=La(e,r-i-a,c,t)),e.l=n,[c,s]}function ak(e,r,t){var n=e.l+r,a=t.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],ht(e,r-2)];var c=Ba(e,i,t);return r!==i+a&&(s=La(e,r-i-a,c,t)),e.l=n,[c,s]}function sk(e,r,t,n){var a=e.l+r,s=Ba(e,n,t),i;return a!==e.l&&(i=La(e,a-e.l,s,t)),[s,i]}function ik(e,r,t){var n=e.l+r,a,s=e.read_shift(2),i=Ba(e,s,t);return s==65535?[[],ht(e,r-2)]:(r!==s+2&&(a=La(e,n-s-2,i,t)),[i,a])}function ck(e){var r;if(wr(e,e.l+6)!==65535)return[ft(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Ci(e,r,t){var n=e.l+r,a=hr(e);t.biff==2&&++e.l;var s=ck(e),i=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var c=ak(e,n-e.l,t);return{cell:a,val:s[0],formula:c,shared:i>>3&1,tt:s[1]}}function ri(e,r,t){var n=e.read_shift(4),a=Ba(e,n,t),s=e.read_shift(4),i=s>0?La(e,s,a,t):null;return[a,i]}var ok=ri,ni=ri,fk=ri,lk=ri,uk={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Xu={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},hk={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function hf(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function bi(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var da={},Tn={};function xa(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Yu(e,r,t,n,a,s){try{n.cellNF&&(e.z=ge[r])}catch(c){if(n.WTF)throw c}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ze(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ge[r]==null&&Jr(dv[r]||"General",r),e.t==="e")e.w=e.w||fn[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ya(e.v);else if(e.t==="d"){var i=_t(e.v);(i|0)===i?e.w=i.toString(10):e.w=ya(i)}else{if(e.v===void 0)return"";e.w=tn(e.v,Tn)}else e.t==="d"?e.w=$t(r,_t(e.v),Tn):e.w=$t(r,e.v,Tn)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&t!=null)try{e.s=s.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Vs(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Vs(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&s.Fills)throw c}}}function dk(e,r){var t=Me(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Te(t))}var xk=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,pk=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,mk=/<(?:\w:)?hyperlink [^>]*>/mg,gk=/"(\w*:\w*)"/,vk=/<(?:\w:)?col\b[^>]*[\/]?>/g,_k=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,wk=/<(?:\w:)?pageMargins[^>]*\/>/g,ju=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,yk=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Ek=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function kk(e,r,t,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var c=r.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},o="",l="",u=e.match(pk);u?(o=e.slice(0,u.index),l=e.slice(u.index+u[0].length)):o=l=e;var h=o.match(ju);h?oc(h[0],c,a,t):(h=o.match(yk))&&Tk(h[0],h[1]||"",c,a,t);var d=(o.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var x=o.slice(d,d+50).match(gk);x&&dk(c,x[1])}var p=o.match(Ek);p&&p[1]&&Rk(p[1],a);var m=[];if(r.cellStyles){var _=o.match(vk);_&&Fk(m,_)}u&&Ik(u[1],c,r,f,s,i);var w=l.match(_k);w&&(c["!autofilter"]=Ck(w[0]));var v=[],C=l.match(xk);if(C)for(d=0;d!=C.length;++d)v[d]=Me(C[d].slice(C[d].indexOf('"')+1));var O=l.match(mk);O&&Ak(c,O,n);var R=l.match(wk);if(R&&(c["!margins"]=Sk(xe(R[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=Te(f)),r.sheetRows>0&&c["!ref"]){var k=Me(c["!ref"]);r.sheetRows<=+k.e.r&&(k.e.r=r.sheetRows-1,k.e.r>f.e.r&&(k.e.r=f.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>f.e.c&&(k.e.c=f.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Te(k))}return m.length>0&&(c["!cols"]=m),v.length>0&&(c["!merges"]=v),c}function oc(e,r,t,n){var a=xe(e);t.Sheets[n]||(t.Sheets[n]={}),a.codeName&&(t.Sheets[n].CodeName=Se(Re(a.codeName)))}function Tk(e,r,t,n,a){oc(e.slice(0,e.indexOf(">")),t,n,a)}function Ak(e,r,t){for(var n=Array.isArray(e),a=0;a!=r.length;++a){var s=xe(Re(r[a]),!0);if(!s.ref)return;var i=((t||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+Se(s.location))):(s.Target="#"+Se(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var c=Me(s.ref),f=c.s.r;f<=c.e.r;++f)for(var o=c.s.c;o<=c.e.c;++o){var l=pe({c:o,r:f});n?(e[f]||(e[f]=[]),e[f][o]||(e[f][o]={t:"z",v:void 0}),e[f][o].l=s):(e[l]||(e[l]={t:"z",v:void 0}),e[l].l=s)}}}function Sk(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function Fk(e,r){for(var t=!1,n=0;n!=r.length;++n){var a=xe(r[n],!0);a.hidden&&(a.hidden=Ie(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,ic(a.width)),Pn(a);s<=i;)e[s++]=rt(a)}}function Ck(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var bk=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Rk(e,r){r.Views||(r.Views=[{}]),(e.match(bk)||[]).forEach(function(t,n){var a=xe(t);r.Views[n]||(r.Views[n]={}),+a.zoomScale&&(r.Views[n].zoom=+a.zoomScale),Ie(a.rightToLeft)&&(r.Views[n].RTL=!0)})}var Ik=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Ea("v"),i=Ea("f");return function(f,o,l,u,h,d){for(var x=0,p="",m=[],_=[],w=0,v=0,C=0,O="",R,k,U=0,I=0,z,D,B=0,Z=0,P=Array.isArray(d.CellXf),j,H=[],K=[],fe=Array.isArray(o),L=[],ne={},oe=!1,S=!!l.sheetStubs,W=f.split(r),M=0,N=W.length;M!=N;++M){p=W[M].trim();var J=p.length;if(J!==0){var te=0;e:for(x=0;x<J;++x)switch(p[x]){case">":if(p[x-1]!="/"){++x;break e}if(l&&l.cellStyles){if(k=xe(p.slice(te,x),!0),U=k.r!=null?parseInt(k.r,10):U+1,I=-1,l.sheetRows&&l.sheetRows<U)continue;ne={},oe=!1,k.ht&&(oe=!0,ne.hpt=parseFloat(k.ht),ne.hpx=Sa(ne.hpt)),k.hidden=="1"&&(oe=!0,ne.hidden=!0),k.outlineLevel!=null&&(oe=!0,ne.level=+k.outlineLevel),oe&&(L[U-1]=ne)}break;case"<":te=x;break}if(te>=x)break;if(k=xe(p.slice(te,x),!0),U=k.r!=null?parseInt(k.r,10):U+1,I=-1,!(l.sheetRows&&l.sheetRows<U)){u.s.r>U-1&&(u.s.r=U-1),u.e.r<U-1&&(u.e.r=U-1),l&&l.cellStyles&&(ne={},oe=!1,k.ht&&(oe=!0,ne.hpt=parseFloat(k.ht),ne.hpx=Sa(ne.hpt)),k.hidden=="1"&&(oe=!0,ne.hidden=!0),k.outlineLevel!=null&&(oe=!0,ne.level=+k.outlineLevel),oe&&(L[U-1]=ne)),m=p.slice(x).split(e);for(var ie=0;ie!=m.length&&m[ie].trim().charAt(0)=="<";++ie);for(m=m.slice(ie),x=0;x!=m.length;++x)if(p=m[x].trim(),p.length!==0){if(_=p.match(t),w=x,v=0,C=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,_!=null&&_.length===2){for(w=0,O=_[1],v=0;v!=O.length&&!((C=O.charCodeAt(v)-64)<1||C>26);++v)w=26*w+C;--w,I=w}else++I;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,k=xe(p.slice(0,v),!0),k.r||(k.r=pe({r:U-1,c:I})),O=p.slice(v),R={t:""},(_=O.match(s))!=null&&_[1]!==""&&(R.v=Se(_[1])),l.cellFormula){if((_=O.match(i))!=null&&_[1]!==""){if(R.f=Se(Re(_[1])).replace(/\r\n/g,`
`),l.xlfn||(R.f=of(R.f)),_[0].indexOf('t="array"')>-1)R.F=(O.match(a)||[])[1],R.F.indexOf(":")>-1&&H.push([Me(R.F),R.F]);else if(_[0].indexOf('t="shared"')>-1){D=xe(_[0]);var ae=Se(Re(_[1]));l.xlfn||(ae=of(ae)),K[parseInt(D.si,10)]=[D,ae,k.r]}}else(_=O.match(/<f[^>]*\/>/))&&(D=xe(_[0]),K[D.si]&&(R.f=Wy(K[D.si][1],K[D.si][2],k.r)));var ee=gt(k.r);for(v=0;v<H.length;++v)ee.r>=H[v][0].s.r&&ee.r<=H[v][0].e.r&&ee.c>=H[v][0].s.c&&ee.c<=H[v][0].e.c&&(R.F=H[v][1])}if(k.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(S)R.t="z";else continue;else R.t=k.t||"n";switch(u.s.c>I&&(u.s.c=I),u.e.c<I&&(u.e.c=I),R.t){case"n":if(R.v==""||R.v==null){if(!S)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!S)continue;R.t="z"}else z=da[parseInt(R.v,10)],R.v=z.t,R.r=z.r,l.cellHTML&&(R.h=z.h);break;case"str":R.t="s",R.v=R.v!=null?Re(R.v):"",l.cellHTML&&(R.h=K0(R.v));break;case"inlineStr":_=O.match(n),R.t="s",_!=null&&(z=sc(_[1]))?(R.v=z.t,l.cellHTML&&(R.h=z.h)):R.v="";break;case"b":R.v=Ie(R.v);break;case"d":l.cellDates?R.v=Ze(R.v,1):(R.v=_t(Ze(R.v,1)),R.t="n");break;case"e":(!l||l.cellText!==!1)&&(R.w=R.v),R.v=pu[R.v];break}if(B=Z=0,j=null,P&&k.s!==void 0&&(j=d.CellXf[k.s],j!=null&&(j.numFmtId!=null&&(B=j.numFmtId),l.cellStyles&&j.fillId!=null&&(Z=j.fillId))),Yu(R,B,Z,l,h,d),l.cellDates&&P&&R.t=="n"&&Mn(ge[B])&&(R.t="d",R.v=ei(R.v)),k.cm&&l.xlmeta){var Ae=(l.xlmeta.Cell||[])[+k.cm-1];Ae&&Ae.type=="XLDAPR"&&(R.D=!0)}if(fe){var b=gt(k.r);o[b.r]||(o[b.r]=[]),o[b.r][b.c]=R}else o[k.r]=R}}}}L.length>0&&(o["!rows"]=L)}}();function Ok(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=a/20),t}var Dk=on;function Pk(){}function Nk(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=n_(e),t}function Mk(e){var r=Ht(e);return[r]}function Lk(e){var r=cn(e);return[r]}function Bk(e){var r=Ht(e),t=e.read_shift(1);return[r,t,"b"]}function Uk(e){var r=cn(e),t=e.read_shift(1);return[r,t,"b"]}function $k(e){var r=Ht(e),t=e.read_shift(1);return[r,t,"e"]}function Hk(e){var r=cn(e),t=e.read_shift(1);return[r,t,"e"]}function Wk(e){var r=Ht(e),t=e.read_shift(4);return[r,t,"s"]}function Vk(e){var r=cn(e),t=e.read_shift(4);return[r,t,"s"]}function Gk(e){var r=Ht(e),t=ft(e);return[r,t,"n"]}function Ku(e){var r=cn(e),t=ft(e);return[r,t,"n"]}function zk(e){var r=Ht(e),t=rc(e);return[r,t,"n"]}function Xk(e){var r=cn(e),t=rc(e);return[r,t,"n"]}function Yk(e){var r=Ht(e),t=ec(e);return[r,t,"is"]}function jk(e){var r=Ht(e),t=ut(e);return[r,t,"str"]}function Kk(e){var r=cn(e),t=ut(e);return[r,t,"str"]}function qk(e,r,t){var n=e.l+r,a=Ht(e);a.r=t["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(t.cellFormula){e.l+=2;var c=ni(e,n-e.l,t);i[3]=ot(c,null,a,t.supbooks,t)}else e.l=n;return i}function Jk(e,r,t){var n=e.l+r,a=Ht(e);a.r=t["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(t.cellFormula){e.l+=2;var c=ni(e,n-e.l,t);i[3]=ot(c,null,a,t.supbooks,t)}else e.l=n;return i}function Zk(e,r,t){var n=e.l+r,a=Ht(e);a.r=t["!row"];var s=ft(e),i=[a,s,"n"];if(t.cellFormula){e.l+=2;var c=ni(e,n-e.l,t);i[3]=ot(c,null,a,t.supbooks,t)}else e.l=n;return i}function Qk(e,r,t){var n=e.l+r,a=Ht(e);a.r=t["!row"];var s=ut(e),i=[a,s,"str"];if(t.cellFormula){e.l+=2;var c=ni(e,n-e.l,t);i[3]=ot(c,null,a,t.supbooks,t)}else e.l=n;return i}var eT=on;function tT(e,r){var t=e.l+r,n=on(e),a=tc(e),s=ut(e),i=ut(e),c=ut(e);e.l=t;var f={rfx:n,relId:a,loc:s,display:c};return i&&(f.Tooltip=i),f}function rT(){}function nT(e,r,t){var n=e.l+r,a=hu(e),s=e.read_shift(1),i=[a];if(i[2]=s,t.cellFormula){var c=ok(e,n-e.l,t);i[1]=c}else e.l=n;return i}function aT(e,r,t){var n=e.l+r,a=on(e),s=[a];if(t.cellFormula){var i=lk(e,n-e.l,t);s[1]=i,e.l=n}else e.l=n;return s}var sT=["left","right","top","bottom","header","footer"];function iT(e){var r={};return sT.forEach(function(t){r[t]=ft(e)}),r}function cT(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function oT(){}function fT(){}function lT(e,r,t,n,a,s,i){if(!e)return e;var c=r||{};n||(n={"!id":{}});var f=c.dense?[]:{},o,l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=!1,h=!1,d,x,p,m,_,w,v,C,O,R=[];c.biff=12,c["!row"]=0;var k=0,U=!1,I=[],z={},D=c.supbooks||a.supbooks||[[]];if(D.sharedf=z,D.arrayf=I,D.SheetNames=a.SheetNames||a.Sheets.map(function(fe){return fe.name}),!c.supbooks&&(c.supbooks=D,a.Names))for(var B=0;B<a.Names.length;++B)D[0][B+1]=a.Names[B];var Z=[],P=[],j=!1;Xs[16]={n:"BrtShortReal",f:Ku};var H;if(Ar(e,function(L,ne,oe){if(!h)switch(oe){case 148:o=L;break;case 0:d=L,c.sheetRows&&c.sheetRows<=d.r&&(h=!0),C=nt(m=d.r),c["!row"]=d.r,(L.hidden||L.hpt||L.level!=null)&&(L.hpt&&(L.hpx=Sa(L.hpt)),P[L.r]=L);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:L[2]},L[2]){case"n":x.v=L[1];break;case"s":v=da[L[1]],x.v=v.t,x.r=v.r;break;case"b":x.v=!!L[1];break;case"e":x.v=L[1],c.cellText!==!1&&(x.w=fn[x.v]);break;case"str":x.t="s",x.v=L[1];break;case"is":x.t="s",x.v=L[1].t;break}if((p=i.CellXf[L[0].iStyleRef])&&Yu(x,p.numFmtId,null,c,s,i),_=L[0].c==-1?_+1:L[0].c,c.dense?(f[m]||(f[m]=[]),f[m][_]=x):f[je(_)+C]=x,c.cellFormula){for(U=!1,k=0;k<I.length;++k){var S=I[k];d.r>=S[0].s.r&&d.r<=S[0].e.r&&_>=S[0].s.c&&_<=S[0].e.c&&(x.F=Te(S[0]),U=!0)}!U&&L.length>3&&(x.f=L[3])}if(l.s.r>d.r&&(l.s.r=d.r),l.s.c>_&&(l.s.c=_),l.e.r<d.r&&(l.e.r=d.r),l.e.c<_&&(l.e.c=_),c.cellDates&&p&&x.t=="n"&&Mn(ge[p.numFmtId])){var W=jr(x.v);W&&(x.t="d",x.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}H&&(H.type=="XLDAPR"&&(x.D=!0),H=void 0);break;case 1:case 12:if(!c.sheetStubs||u)break;x={t:"z",v:void 0},_=L[0].c==-1?_+1:L[0].c,c.dense?(f[m]||(f[m]=[]),f[m][_]=x):f[je(_)+C]=x,l.s.r>d.r&&(l.s.r=d.r),l.s.c>_&&(l.s.c=_),l.e.r<d.r&&(l.e.r=d.r),l.e.c<_&&(l.e.c=_),H&&(H.type=="XLDAPR"&&(x.D=!0),H=void 0);break;case 176:R.push(L);break;case 49:H=((c.xlmeta||{}).Cell||[])[L-1];break;case 494:var M=n["!id"][L.relId];for(M?(L.Target=M.Target,L.loc&&(L.Target+="#"+L.loc),L.Rel=M):L.relId==""&&(L.Target="#"+L.loc),m=L.rfx.s.r;m<=L.rfx.e.r;++m)for(_=L.rfx.s.c;_<=L.rfx.e.c;++_)c.dense?(f[m]||(f[m]=[]),f[m][_]||(f[m][_]={t:"z",v:void 0}),f[m][_].l=L):(w=pe({c:_,r:m}),f[w]||(f[w]={t:"z",v:void 0}),f[w].l=L);break;case 426:if(!c.cellFormula)break;I.push(L),O=c.dense?f[m][_]:f[je(_)+C],O.f=ot(L[1],l,{r:d.r,c:_},D,c),O.F=Te(L[0]);break;case 427:if(!c.cellFormula)break;z[pe(L[0].s)]=L[1],O=c.dense?f[m][_]:f[je(_)+C],O.f=ot(L[1],l,{r:d.r,c:_},D,c);break;case 60:if(!c.cellStyles)break;for(;L.e>=L.s;)Z[L.e--]={width:L.w/256,hidden:!!(L.flags&1),level:L.level},j||(j=!0,ic(L.w/256)),Pn(Z[L.e+1]);break;case 161:f["!autofilter"]={ref:Te(L)};break;case 476:f["!margins"]=L;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),L.name&&(a.Sheets[t].CodeName=L.name),(L.above||L.left)&&(f["!outline"]={above:L.above,left:L.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),L.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:u=!0;break;case 38:u=!1;break;default:if(!ne.T){if(!u||c.WTF)throw new Error("Unexpected record 0x"+oe.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(l.s.r<2e6||o&&(o.e.r>0||o.e.c>0||o.s.r>0||o.s.c>0))&&(f["!ref"]=Te(o||l)),c.sheetRows&&f["!ref"]){var K=Me(f["!ref"]);c.sheetRows<=+K.e.r&&(K.e.r=c.sheetRows-1,K.e.r>l.e.r&&(K.e.r=l.e.r),K.e.r<K.s.r&&(K.s.r=K.e.r),K.e.c>l.e.c&&(K.e.c=l.e.c),K.e.c<K.s.c&&(K.s.c=K.e.c),f["!fullref"]=f["!ref"],f["!ref"]=Te(K))}return R.length>0&&(f["!merges"]=R),Z.length>0&&(f["!cols"]=Z),P.length>0&&(f["!rows"]=P),f}function uT(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(r[+i[1]]=t?+i[2]:i[2])});var a=Se((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[r,a,n]}function hT(e,r,t,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var c=0,f=0,o="A",l={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var h=uT(u);l.s.r=l.s.c=0,l.e.c=c,o=je(c),h[0].forEach(function(d,x){i[o+nt(x)]={t:"n",v:d,z:h[1]},f=x}),l.e.r<f&&(l.e.r=f),++c}),c>0&&(i["!ref"]=Te(l)),i}function dT(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,c=e.match(ju);return c&&oc(c[0],s,a,t),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function xT(e,r){e.l+=10;var t=ut(e);return{name:t}}function pT(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Ar(e,function(f,o,l){switch(l){case 550:s["!rel"]=f;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),f.name&&(a.Sheets[t].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(o.T>0)){if(!(o.T<0)){if(!i||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}},r),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var qu=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],mT=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],gT=[],vT=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function df(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],a=0;a!=r.length;++a){var s=r[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Ie(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function xf(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ie(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Ju(e){xf(e.WBProps,qu),xf(e.CalcPr,vT),df(e.WBView,mT),df(e.Sheets,gT),Tn.date1904=Ie(e.WBProps.date1904)}var _T="][*?/\\".split("");function wT(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return _T.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var yT=/<\w+:workbook/;function ET(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(dt,function(f,o){var l=xe(f);switch(ur(l[0])){case"<?xml":break;case"<workbook":f.match(yT)&&(a="xmlns"+f.match(/<(\w+):/)[1]),t.xmlns=l[a];break;case"</workbook>":break;case"<fileVersion":delete l[0],t.AppVersion=l;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":qu.forEach(function(u){if(l[u[0]]!=null)switch(u[2]){case"bool":t.WBProps[u[0]]=Ie(l[u[0]]);break;case"int":t.WBProps[u[0]]=parseInt(l[u[0]],10);break;default:t.WBProps[u[0]]=l[u[0]]}}),l.codeName&&(t.WBProps.CodeName=Re(l.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete l[0],t.WBView.push(l);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(l.state){case"hidden":l.Hidden=1;break;case"veryHidden":l.Hidden=2;break;default:l.Hidden=0}delete l.state,l.name=Se(Re(l.name)),delete l[0],t.Sheets.push(l);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Re(l.name),l.comment&&(s.Comment=l.comment),l.localSheetId&&(s.Sheet=+l.localSheetId),Ie(l.hidden||"0")&&(s.Hidden=!0),i=o+f.length;break;case"</definedName>":s.Ref=Se(Re(e.slice(i,o))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete l[0],t.CalcPr=l;break;case"<calcPr/>":delete l[0],t.CalcPr=l;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+l[0]+" in workbook")}return f}),$v.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Ju(t),t}function kT(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=c0(e),t.name=ut(e),t}function TT(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?ut(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function AT(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function ST(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var a=e.read_shift(4),s=a_(e),i=fk(e,0,t),c=tc(e);e.l=n;var f={Name:s,Ptg:i};return a<268435455&&(f.Sheet=a),c&&(f.Comment=c),f}function FT(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;r||(r={}),r.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],Xs[16]={n:"BrtFRTArchID$",f:AT},Ar(e,function(f,o,l){switch(l){case 156:i.SheetNames.push(f.name),t.Sheets.push(f);break;case 153:t.WBProps=f;break;case 39:f.Sheet!=null&&(r.SID=f.Sheet),f.Ref=ot(f.Ptg,null,null,i,r),delete r.SID,delete f.Ptg,s.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([l,f]):i[0]=[l,f],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(f),i.XTI=i.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(l),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(l),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!o.T){if(!a||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+l.toString(16))}}},r),Ju(t),t.Names=s,t.supbooks=i,t}function CT(e,r,t){return r.slice(-4)===".bin"?FT(e,t):ET(e,t)}function bT(e,r,t,n,a,s,i,c){return r.slice(-4)===".bin"?lT(e,n,t,a,s,i,c):kk(e,n,t,a,s,i,c)}function RT(e,r,t,n,a,s,i,c){return r.slice(-4)===".bin"?pT(e,n,t,a,s):dT(e,n,t,a,s)}function IT(e,r,t,n,a,s,i,c){return r.slice(-4)===".bin"?Uy():$y()}function OT(e,r,t,n,a,s,i,c){return r.slice(-4)===".bin"?Ly():By()}function DT(e,r,t,n){return r.slice(-4)===".bin"?ey(e,t,n):jw(e,t,n)}function PT(e,r,t){return Lu(e,t)}function NT(e,r,t){return r.slice(-4)===".bin"?mw(e,t):xw(e,t)}function MT(e,r,t){return r.slice(-4)===".bin"?Py(e,t):by(e,t)}function LT(e,r,t){return r.slice(-4)===".bin"?Sy(e):Ty(e)}function BT(e,r,t,n){return t.slice(-4)===".bin"?Fy(e,r,t,n):void 0}function UT(e,r,t){return r.slice(-4)===".bin"?Ey(e,r,t):ky(e,r,t)}var Zu=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Qu=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Wt(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var a=e.match(Zu),s,i,c,f;if(a)for(f=0;f!=a.length;++f)s=a[f].match(Qu),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(i+1),n[c]=s[2].slice(1,s[2].length-1));return n}function $T(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(Zu),a,s,i,c;if(n)for(c=0;c!=n.length;++c)a=n[c].match(Qu),(s=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),t[i]=a[2].slice(1,a[2].length-1));return t}var pa;function HT(e,r){var t=pa[e]||Se(e);return t==="General"?tn(r):$t(t,r)}function WT(e,r,t,n){var a=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Ie(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Ze(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Se(r)]=a}function VT(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||fn[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ya(e.v):e.w=tn(e.v):e.w=HT(r||"General",e.v)}catch(s){if(t.WTF)throw s}try{var n=pa[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&Mn(n)){var a=jr(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(t.WTF)throw s}}}function GT(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=Ww[n.Pattern]||n.Pattern)}e[r.ID]=r}function zT(e,r,t,n,a,s,i,c,f,o){var l="General",u=n.StyleID,h={};o=o||{};var d=[],x=0;for(u===void 0&&c&&(u=c.StyleID),u===void 0&&i&&(u=i.StyleID);s[u]!==void 0&&(s[u].nf&&(l=s[u].nf),s[u].Interior&&d.push(s[u].Interior),!!s[u].Parent);)u=s[u].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=Ie(e);break;case"String":n.t="s",n.r=No(Se(e)),n.v=e.indexOf("<")>-1?Se(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Ze(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Se(e):n.v<60&&(n.v=n.v-1),(!l||l=="General")&&(l="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=pu[e],o.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=No(r||e));break}if(VT(n,l,o),o.cellFormula!==!1)if(n.Formula){var p=Se(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=kn(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=kn("RC:RC",a):n.ArrayRange&&(n.F=kn(n.ArrayRange,a),f.push([Me(n.F),n.F]))}else for(x=0;x<f.length;++x)a.r>=f[x][0].s.r&&a.r<=f[x][0].e.r&&a.c>=f[x][0].s.c&&a.c<=f[x][0].e.c&&(n.F=f[x][1]);o.cellStyles&&(d.forEach(function(m){!h.patternType&&m.patternType&&(h.patternType=m.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function XT(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Ri(e,r){var t=r||{};Hl();var n=Jn(q0(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=Re(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=rt(t);return i.type="string",Ta.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Be){a.indexOf("<"+Be)>=0&&(s=!0)}),s)return t4(n,t);pa={"General Number":"General","General Date":ge[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ge[15],"Short Date":ge[14],"Long Time":ge[19],"Medium Time":ge[18],"Short Time":ge[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ge[2],Standard:ge[4],Percent:ge[10],Scientific:ge[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],o,l={},u=[],h=t.dense?[]:{},d="",x={},p={},m=Wt('<Data ss:Type="String">'),_=0,w=0,v=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},O={},R={},k="",U=0,I=[],z={},D={},B=0,Z=[],P=[],j={},H=[],K,fe=!1,L=[],ne=[],oe={},S=0,W=0,M={Sheets:[],WBProps:{date1904:!1}},N={};ka.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";c=ka.exec(n);)switch(c[3]=(J=c[3]).toLowerCase()){case"data":if(J=="data"){if(c[1]==="/"){if((o=f.pop())[0]!==c[3])throw new Error("Bad state: "+o.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?zT(n.slice(_,c.index),k,m,f[f.length-1][0]=="comment"?j:x,{c:w,r:v},O,H[w],p,L,t):(k="",m=Wt(c[0]),_=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(P.length>0&&(x.c=P),(!t.sheetRows||t.sheetRows>v)&&x.v!==void 0&&(t.dense?(h[v]||(h[v]=[]),h[v][w]=x):h[je(w)+nt(v)]=x),x.HRef&&(x.l={Target:Se(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(S=w+(parseInt(x.MergeAcross,10)|0),W=v+(parseInt(x.MergeDown,10)|0),I.push({s:{c:w,r:v},e:{c:S,r:W}})),!t.sheetStubs)x.MergeAcross?w=S+1:++w;else if(x.MergeAcross||x.MergeDown){for(var te=w;te<=S;++te)for(var ie=v;ie<=W;++ie)(te>w||ie>v)&&(t.dense?(h[ie]||(h[ie]=[]),h[ie][te]={t:"z"}):h[je(te)+nt(ie)]={t:"z"});w=S+1}else++w;else x=$T(c[0]),x.Index&&(w=+x.Index-1),w<C.s.c&&(C.s.c=w),w>C.e.c&&(C.e.c=w),c[0].slice(-2)==="/>"&&++w,P=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(v<C.s.r&&(C.s.r=v),v>C.e.r&&(C.e.r=v),c[0].slice(-2)==="/>"&&(p=Wt(c[0]),p.Index&&(v=+p.Index-1)),w=0,++v):(p=Wt(c[0]),p.Index&&(v=+p.Index-1),oe={},(p.AutoFitHeight=="0"||p.Height)&&(oe.hpx=parseInt(p.Height,10),oe.hpt=Mu(oe.hpx),ne[v]=oe),p.Hidden=="1"&&(oe.hidden=!0,ne[v]=oe));break;case"worksheet":if(c[1]==="/"){if((o=f.pop())[0]!==c[3])throw new Error("Bad state: "+o.join("|"));u.push(d),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(h["!ref"]=Te(C),t.sheetRows&&t.sheetRows<=C.e.r&&(h["!fullref"]=h["!ref"],C.e.r=t.sheetRows-1,h["!ref"]=Te(C))),I.length&&(h["!merges"]=I),H.length>0&&(h["!cols"]=H),ne.length>0&&(h["!rows"]=ne),l[d]=h}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=w=0,f.push([c[3],!1]),o=Wt(c[0]),d=Se(o.Name),h=t.dense?[]:{},I=[],L=[],ne=[],N={name:d,Hidden:0},M.Sheets.push(N);break;case"table":if(c[1]==="/"){if((o=f.pop())[0]!==c[3])throw new Error("Bad state: "+o.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),H=[],fe=!1}break;case"style":c[1]==="/"?GT(O,R,t):R=Wt(c[0]);break;case"numberformat":R.nf=Se(Wt(c[0]).Format||"General"),pa[R.nf]&&(R.nf=pa[R.nf]);for(var ae=0;ae!=392&&ge[ae]!=R.nf;++ae);if(ae==392){for(ae=57;ae!=392;++ae)if(ge[ae]==null){Jr(R.nf,ae);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(K=Wt(c[0]),K.Hidden&&(K.hidden=!0,delete K.Hidden),K.Width&&(K.wpx=parseInt(K.Width,10)),!fe&&K.wpx>10){fe=!0,mt=Pu;for(var ee=0;ee<H.length;++ee)H[ee]&&Pn(H[ee])}fe&&Pn(K),H[K.Index-1||H.length]=K;for(var Ae=0;Ae<+K.Span;++Ae)H[H.length]=rt(K);break;case"namedrange":if(c[1]==="/")break;M.Names||(M.Names=[]);var b=xe(c[0]),Le={Name:b.Name,Ref:kn(b.RefersTo.slice(1),{r:0,c:0})};M.Sheets.length>0&&(Le.Sheet=M.Sheets.length-1),M.Names.push(Le);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?k+=n.slice(U,c.index):U=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;R.Interior=Wt(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?b_(z,J,n.slice(B,c.index)):B=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((o=f.pop())[0]!==c[3])throw new Error("Bad state: "+o.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((o=f.pop())[0]!==c[3])throw new Error("Bad state: "+o.join("|"));XT(j),P.push(j)}else f.push([c[3],!1]),o=Wt(c[0]),j={a:o.Author};break;case"autofilter":if(c[1]==="/"){if((o=f.pop())[0]!==c[3])throw new Error("Bad state: "+o.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var Fe=Wt(c[0]);h["!autofilter"]={ref:kn(Fe.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((o=f.pop())[0]!==c[3])throw new Error("Bad state: "+o.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((o=f.pop())[0]!==c[3])throw new Error("Bad state: "+o.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return wf(n,t);var be=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:be=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:be=!1}break;case"excelworkbook":switch(c[3]){case"date1904":M.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:be=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:be=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(B,c.index)){case"SheetHidden":N.Hidden=1;break;case"SheetVeryHidden":N.Hidden=2;break}else B=c.index+c[0].length;break;case"header":h["!margins"]||xa(h["!margins"]={},"xlml"),isNaN(+xe(c[0]).Margin)||(h["!margins"].header=+xe(c[0]).Margin);break;case"footer":h["!margins"]||xa(h["!margins"]={},"xlml"),isNaN(+xe(c[0]).Margin)||(h["!margins"].footer=+xe(c[0]).Margin);break;case"pagemargins":var we=xe(c[0]);h["!margins"]||xa(h["!margins"]={},"xlml"),isNaN(+we.Top)||(h["!margins"].top=+we.Top),isNaN(+we.Left)||(h["!margins"].left=+we.Left),isNaN(+we.Right)||(h["!margins"].right=+we.Right),isNaN(+we.Bottom)||(h["!margins"].bottom=+we.Bottom);break;case"displayrighttoleft":M.Views||(M.Views=[]),M.Views[0]||(M.Views[0]={}),M.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:be=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:be=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:be=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:be=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:be=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:be=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:be=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:be=!1}break;case"smarttags":break;default:be=!1;break}if(be||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?WT(D,J,Z,n.slice(B,c.index)):(Z=c,B=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var ce={};return!t.bookSheets&&!t.bookProps&&(ce.Sheets=l),ce.SheetNames=u,ce.Workbook=M,ce.SSF=rt(ge),ce.Props=z,ce.Custprops=D,ce}function u0(e,r){switch(uc(r=r||{}),r.type||"base64"){case"base64":return Ri(Ot(e),r);case"binary":case"buffer":case"file":return Ri(e,r);case"array":return Ri(sn(e),r)}}function YT(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=c_(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=o_(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var jT=[60,1084,2066,2165,2175];function KT(e,r,t,n,a){var s=n,i=[],c=t.slice(t.l,t.l+s);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}i.push(c),t.l+=s;for(var f=wr(t,t.l),o=h0[f],l=0;o!=null&&jT.indexOf(f)>-1;)s=wr(t,t.l+2),l=t.l+4,f==2066?l+=4:(f==2165||f==2175)&&(l+=12),c=t.slice(l,t.l+4+s),i.push(c),t.l+=4+s,o=h0[f=wr(t,t.l)];var u=Or(i);tt(u,0);var h=0;u.lens=[];for(var d=0;d<i.length;++d)u.lens.push(h),h+=i[d].length;if(u.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+n;return r.f(u,u.length,a)}function tr(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=ge[n])}catch(s){if(r.WTF)throw s}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||fn[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ya(e.v):e.w=tn(e.v):e.w=$t(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(s){if(r.WTF)throw s}if(r.cellDates&&n&&e.t=="n"&&Mn(ge[n]||String(n))){var a=jr(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function as(e,r,t){return{v:e,ixfe:r,t}}function qT(e,r){var t={opts:{}},n={},a=r.dense?[]:{},s={},i={},c=null,f=[],o="",l={},u,h="",d,x,p,m,_={},w=[],v,C,O=[],R=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},U={},I=function(_e){return _e<8?Zr[_e]:_e<64&&R[_e-8]||Zr[_e]},z=function(_e,Ue,Pt){var Ge=Ue.XF.data;if(!(!Ge||!Ge.patternType||!Pt||!Pt.cellStyles)){Ue.s={},Ue.s.patternType=Ge.patternType;var $r;($r=Aa(I(Ge.icvFore)))&&(Ue.s.fgColor={rgb:$r}),($r=Aa(I(Ge.icvBack)))&&(Ue.s.bgColor={rgb:$r})}},D=function(_e,Ue,Pt){if(!(oe>1)&&!(Pt.sheetRows&&_e.r>=Pt.sheetRows)){if(Pt.cellStyles&&Ue.XF&&Ue.XF.data&&z(_e,Ue,Pt),delete Ue.ixfe,delete Ue.XF,u=_e,h=pe(_e),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),_e.r<i.s.r&&(i.s.r=_e.r),_e.c<i.s.c&&(i.s.c=_e.c),_e.r+1>i.e.r&&(i.e.r=_e.r+1),_e.c+1>i.e.c&&(i.e.c=_e.c+1),Pt.cellFormula&&Ue.f){for(var Ge=0;Ge<w.length;++Ge)if(!(w[Ge][0].s.c>_e.c||w[Ge][0].s.r>_e.r)&&!(w[Ge][0].e.c<_e.c||w[Ge][0].e.r<_e.r)){Ue.F=Te(w[Ge][0]),(w[Ge][0].s.c!=_e.c||w[Ge][0].s.r!=_e.r)&&delete Ue.f,Ue.f&&(Ue.f=""+ot(w[Ge][1],i,_e,L,B));break}}Pt.dense?(a[_e.r]||(a[_e.r]=[]),a[_e.r][_e.c]=Ue):a[h]=Ue}},B={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(B.password=r.password);var Z,P=[],j=[],H=[],K=[],fe=!1,L=[];L.SheetNames=B.snames,L.sharedf=B.sharedf,L.arrayf=B.arrayf,L.names=[],L.XTI=[];var ne=0,oe=0,S=0,W=[],M=[],N;B.codepage=1200,jt(1200);for(var J=!1;e.l<e.length-1;){var te=e.l,ie=e.read_shift(2);if(ie===0&&ne===10)break;var ae=e.l===e.length?0:e.read_shift(2),ee=h0[ie];if(ee&&ee.f){if(r.bookSheets&&ne===133&&ie!==133)break;if(ne=ie,ee.r===2||ee.r==12){var Ae=e.read_shift(2);if(ae-=2,!B.enc&&Ae!==ie&&((Ae&255)<<8|Ae>>8)!==ie)throw new Error("rt mismatch: "+Ae+"!="+ie);ee.r==12&&(e.l+=10,ae-=10)}var b={};if(ie===10?b=ee.f(e,ae,B):b=KT(ie,ee,e,ae,B),oe==0&&[9,521,1033,2057].indexOf(ne)===-1)continue;switch(ie){case 34:t.opts.Date1904=k.WBProps.date1904=b;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(B.enc||(e.l=0),B.enc=b,!r.password)throw new Error("File is password-protected");if(b.valid==null)throw new Error("Encryption scheme unsupported");if(!b.valid)throw new Error("Password is incorrect");break;case 92:B.lastuser=b;break;case 66:var Le=Number(b);switch(Le){case 21010:Le=1200;break;case 32768:Le=1e4;break;case 32769:Le=1252;break}jt(B.codepage=Le),J=!0;break;case 317:B.rrtabid=b;break;case 25:B.winlocked=b;break;case 439:t.opts.RefreshAll=b;break;case 12:t.opts.CalcCount=b;break;case 16:t.opts.CalcDelta=b;break;case 17:t.opts.CalcIter=b;break;case 13:t.opts.CalcMode=b;break;case 14:t.opts.CalcPrecision=b;break;case 95:t.opts.CalcSaveRecalc=b;break;case 15:B.CalcRefMode=b;break;case 2211:t.opts.FullCalc=b;break;case 129:b.fDialog&&(a["!type"]="dialog"),b.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),b.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:O.push(b);break;case 430:L.push([b]),L[L.length-1].XTI=[];break;case 35:case 547:L[L.length-1].push(b);break;case 24:case 536:N={Name:b.Name,Ref:ot(b.rgce,i,null,L,B)},b.itab>0&&(N.Sheet=b.itab-1),L.names.push(N),L[0]||(L[0]=[],L[0].XTI=[]),L[L.length-1].push(b),b.Name=="_xlnm._FilterDatabase"&&b.itab>0&&b.rgce&&b.rgce[0]&&b.rgce[0][0]&&b.rgce[0][0][0]=="PtgArea3d"&&(M[b.itab-1]={ref:Te(b.rgce[0][0][1][2])});break;case 22:B.ExternCount=b;break;case 23:L.length==0&&(L[0]=[],L[0].XTI=[]),L[L.length-1].XTI=L[L.length-1].XTI.concat(b),L.XTI=L.XTI.concat(b);break;case 2196:if(B.biff<8)break;N!=null&&(N.Comment=b[1]);break;case 18:a["!protect"]=b;break;case 19:b!==0&&B.WTF&&console.error("Password verifier: "+b);break;case 133:s[b.pos]=b,B.snames.push(b.name);break;case 10:{if(--oe)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=Te(i),r.sheetRows&&r.sheetRows<=i.e.r){var Fe=i.e.r;i.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Te(i),i.e.r=Fe}i.e.r++,i.e.c++}P.length>0&&(a["!merges"]=P),j.length>0&&(a["!objects"]=j),H.length>0&&(a["!cols"]=H),K.length>0&&(a["!rows"]=K),k.Sheets.push(U)}o===""?l=a:n[o]=a,a=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(B.biff===8&&(B.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[b.BIFFVer]||8),B.biffguess=b.BIFFVer==0,b.BIFFVer==0&&b.dt==4096&&(B.biff=5,J=!0,jt(B.codepage=28591)),B.biff==8&&b.BIFFVer==0&&b.dt==16&&(B.biff=2),oe++)break;if(a=r.dense?[]:{},B.biff<8&&!J&&(J=!0,jt(B.codepage=r.codepage||1252)),B.biff<5||b.BIFFVer==0&&b.dt==4096){o===""&&(o="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var be={pos:e.l-ae,name:o};s[be.pos]=be,B.snames.push(o)}else o=(s[te]||{name:""}).name;b.dt==32&&(a["!type"]="chart"),b.dt==64&&(a["!type"]="macro"),P=[],j=[],B.arrayf=w=[],H=[],K=[],fe=!1,U={Hidden:(s[te]||{hs:0}).hs,name:o}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(r.dense?(a[b.r]||[])[b.c]:a[pe({c:b.c,r:b.r})])&&++b.c,v={ixfe:b.ixfe,XF:O[b.ixfe]||{},v:b.val,t:"n"},S>0&&(v.z=W[v.ixfe>>8&63]),tr(v,r,t.opts.Date1904),D({c:b.c,r:b.r},v,r);break;case 5:case 517:v={ixfe:b.ixfe,XF:O[b.ixfe],v:b.val,t:b.t},S>0&&(v.z=W[v.ixfe>>8&63]),tr(v,r,t.opts.Date1904),D({c:b.c,r:b.r},v,r);break;case 638:v={ixfe:b.ixfe,XF:O[b.ixfe],v:b.rknum,t:"n"},S>0&&(v.z=W[v.ixfe>>8&63]),tr(v,r,t.opts.Date1904),D({c:b.c,r:b.r},v,r);break;case 189:for(var we=b.c;we<=b.C;++we){var ce=b.rkrec[we-b.c][0];v={ixfe:ce,XF:O[ce],v:b.rkrec[we-b.c][1],t:"n"},S>0&&(v.z=W[v.ixfe>>8&63]),tr(v,r,t.opts.Date1904),D({c:we,r:b.r},v,r)}break;case 6:case 518:case 1030:{if(b.val=="String"){c=b;break}if(v=as(b.val,b.cell.ixfe,b.tt),v.XF=O[v.ixfe],r.cellFormula){var Be=b.formula;if(Be&&Be[0]&&Be[0][0]&&Be[0][0][0]=="PtgExp"){var Dt=Be[0][0][1][0],Qt=Be[0][0][1][1],dr=pe({r:Dt,c:Qt});_[dr]?v.f=""+ot(b.formula,i,b.cell,L,B):v.F=((r.dense?(a[Dt]||[])[Qt]:a[dr])||{}).F}else v.f=""+ot(b.formula,i,b.cell,L,B)}S>0&&(v.z=W[v.ixfe>>8&63]),tr(v,r,t.opts.Date1904),D(b.cell,v,r),c=b}break;case 7:case 519:if(c)c.val=b,v=as(b,c.cell.ixfe,"s"),v.XF=O[v.ixfe],r.cellFormula&&(v.f=""+ot(c.formula,i,c.cell,L,B)),S>0&&(v.z=W[v.ixfe>>8&63]),tr(v,r,t.opts.Date1904),D(c.cell,v,r),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(b);var Wn=pe(b[0].s);if(d=r.dense?(a[b[0].s.r]||[])[b[0].s.c]:a[Wn],r.cellFormula&&d){if(!c||!Wn||!d)break;d.f=""+ot(b[1],i,b[0],L,B),d.F=Te(b[0])}}break;case 1212:{if(!r.cellFormula)break;if(h){if(!c)break;_[pe(c.cell)]=b[0],d=r.dense?(a[c.cell.r]||[])[c.cell.c]:a[pe(c.cell)],(d||{}).f=""+ot(b[0],i,u,L,B)}}break;case 253:v=as(f[b.isst].t,b.ixfe,"s"),f[b.isst].h&&(v.h=f[b.isst].h),v.XF=O[v.ixfe],S>0&&(v.z=W[v.ixfe>>8&63]),tr(v,r,t.opts.Date1904),D({c:b.c,r:b.r},v,r);break;case 513:r.sheetStubs&&(v={ixfe:b.ixfe,XF:O[b.ixfe],t:"z"},S>0&&(v.z=W[v.ixfe>>8&63]),tr(v,r,t.opts.Date1904),D({c:b.c,r:b.r},v,r));break;case 190:if(r.sheetStubs)for(var Sr=b.c;Sr<=b.C;++Sr){var Tt=b.ixfe[Sr-b.c];v={ixfe:Tt,XF:O[Tt],t:"z"},S>0&&(v.z=W[v.ixfe>>8&63]),tr(v,r,t.opts.Date1904),D({c:Sr,r:b.r},v,r)}break;case 214:case 516:case 4:v=as(b.val,b.ixfe,"s"),v.XF=O[v.ixfe],S>0&&(v.z=W[v.ixfe>>8&63]),tr(v,r,t.opts.Date1904),D({c:b.c,r:b.r},v,r);break;case 0:case 512:oe===1&&(i=b);break;case 252:f=b;break;case 1054:if(B.biff==4){W[S++]=b[1];for(var xr=0;xr<S+163&&ge[xr]!=b[1];++xr);xr>=163&&Jr(b[1],S+163)}else Jr(b[1],b[0]);break;case 30:{W[S++]=b;for(var Fr=0;Fr<S+163&&ge[Fr]!=b;++Fr);Fr>=163&&Jr(b,S+163)}break;case 229:P=P.concat(b);break;case 93:j[b.cmo[0]]=B.lastobj=b;break;case 438:B.lastobj.TxO=b;break;case 127:B.lastobj.ImData=b;break;case 440:for(m=b[0].s.r;m<=b[0].e.r;++m)for(p=b[0].s.c;p<=b[0].e.c;++p)d=r.dense?(a[m]||[])[p]:a[pe({c:p,r:m})],d&&(d.l=b[1]);break;case 2048:for(m=b[0].s.r;m<=b[0].e.r;++m)for(p=b[0].s.c;p<=b[0].e.c;++p)d=r.dense?(a[m]||[])[p]:a[pe({c:p,r:m})],d&&d.l&&(d.l.Tooltip=b[1]);break;case 28:{if(B.biff<=5&&B.biff>=2)break;d=r.dense?(a[b[0].r]||[])[b[0].c]:a[pe(b[0])];var Vn=j[b[2]];d||(r.dense?(a[b[0].r]||(a[b[0].r]=[]),d=a[b[0].r][b[0].c]={t:"z"}):d=a[pe(b[0])]={t:"z"},i.e.r=Math.max(i.e.r,b[0].r),i.s.r=Math.min(i.s.r,b[0].r),i.e.c=Math.max(i.e.c,b[0].c),i.s.c=Math.min(i.s.c,b[0].c)),d.c||(d.c=[]),x={a:b[1],t:Vn.TxO.t},d.c.push(x)}break;case 2173:vy(O[b.ixfe],b.ext);break;case 125:{if(!B.cellStyles)break;for(;b.e>=b.s;)H[b.e--]={width:b.w/256,level:b.level||0,hidden:!!(b.flags&1)},fe||(fe=!0,ic(b.w/256)),Pn(H[b.e+1])}break;case 520:{var xt={};b.level!=null&&(K[b.r]=xt,xt.level=b.level),b.hidden&&(K[b.r]=xt,xt.hidden=!0),b.hpt&&(K[b.r]=xt,xt.hpt=b.hpt,xt.hpx=Sa(b.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||xa(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=b;break;case 161:a["!margins"]||xa(a["!margins"]={}),a["!margins"].header=b.header,a["!margins"].footer=b.footer;break;case 574:b.RTL&&(k.Views[0].RTL=!0);break;case 146:R=b;break;case 2198:Z=b;break;case 140:C=b;break;case 442:o?U.CodeName=b||U.name:k.WBProps.CodeName=b||"ThisWorkbook";break}}else ee||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),e.l+=ae}return t.SheetNames=fr(s).sort(function(er,_e){return Number(er)-Number(_e)}).map(function(er){return s[er].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&l["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=l)):t.Preamble=l,t.Sheets&&M.forEach(function(er,_e){t.Sheets[t.SheetNames[_e]]["!autofilter"]=er}),t.Strings=f,t.SSF=rt(ge),B.enc&&(t.Encryption=B.enc),Z&&(t.Themes=Z),t.Metadata={},C!==void 0&&(t.Metadata.Country=C),L.names.length>0&&(k.Names=L.names),t.Workbook=k,t}var pf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function JT(e,r,t){var n=ke.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Jo(n,x_,pf.DSI);for(var s in a)r[s]=a[s]}catch(o){if(t.WTF)throw o}var i=ke.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var c=Jo(i,p_,pf.SI);for(var f in c)r[f]==null&&(r[f]=c[f])}catch(o){if(t.WTF)throw o}r.HeadingPairs&&r.TitlesOfParts&&(gu(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function eh(e,r){r||(r={}),uc(r),bl(),r.codepage&&V0(r.codepage);var t,n;if(e.FullPaths){if(ke.find(e,"/encryption"))throw new Error("File is password-protected");t=ke.find(e,"!CompObj"),n=ke.find(e,"/Workbook")||ke.find(e,"/Book")}else{switch(r.type){case"base64":e=Yt(Ot(e));break;case"binary":e=Yt(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}tt(e,0),n={content:e}}var a,s;if(t&&YT(t),r.bookProps&&!r.bookSheets)a={};else{var i=ye?"buffer":"array";if(n&&n.content)a=qT(n.content,r);else if((s=ke.find(e,"PerfectOffice_MAIN"))&&s.content)a=ha.to_workbook(s.content,(r.type=i,r));else if((s=ke.find(e,"NativeContent_MAIN"))&&s.content)a=ha.to_workbook(s.content,(r.type=i,r));else throw(s=ke.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&ke.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=My(e))}var c={};return e.FullPaths&&JT(e,c,r),a.Props=a.Custprops=c,r.bookFiles&&(a.cfb=e),a}var Xs={0:{f:Ok},1:{f:Mk},2:{f:zk},3:{f:$k},4:{f:Bk},5:{f:Gk},6:{f:jk},7:{f:Wk},8:{f:Qk},9:{f:Zk},10:{f:qk},11:{f:Jk},12:{f:Lk},13:{f:Xk},14:{f:Hk},15:{f:Uk},16:{f:Ku},17:{f:Kk},18:{f:Vk},19:{f:ec},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ST},40:{},42:{},43:{f:qw},44:{f:Kw},45:{f:Jw},46:{f:Qw},47:{f:Zw},48:{},49:{f:e_},50:{},51:{f:wy},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:bu},62:{f:Yk},63:{f:Ay},64:{f:oT},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ht,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:cT},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Nk},148:{f:Dk,p:16},151:{f:rT},152:{},153:{f:TT},154:{},155:{},156:{f:kT},157:{},158:{},159:{T:1,f:pw},160:{T:-1},161:{T:1,f:on},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:eT},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_y},336:{T:-1},337:{f:yy,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:c0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Cu},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:nT},427:{f:aT},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:iT},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Pk},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:tT},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:c0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Dy},633:{T:1},634:{T:-1},635:{T:1,f:Oy},636:{T:-1},637:{f:r_},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:xT},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:fT},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},h0={6:{f:Ci},10:{f:Cr},12:{f:Ve},13:{f:Ve},14:{f:$e},15:{f:$e},16:{f:ft},17:{f:$e},18:{f:$e},19:{f:Ve},20:{f:tf},21:{f:tf},23:{f:Cu},24:{f:nf},25:{f:$e},26:{},27:{},28:{f:R2},29:{},34:{f:$e},35:{f:rf},38:{f:ft},39:{f:ft},40:{f:ft},41:{f:ft},42:{f:$e},43:{f:$e},47:{f:Pw},49:{f:u2},51:{f:Ve},60:{},61:{f:o2},64:{f:$e},65:{f:l2},66:{f:Ve},77:{},80:{},81:{},82:{},85:{f:Ve},89:{},90:{},91:{},92:{f:e2},93:{f:O2},94:{},95:{f:$e},96:{},97:{},99:{f:$e},125:{f:bu},128:{f:y2},129:{f:t2},130:{f:Ve},131:{f:$e},132:{f:$e},133:{f:r2},134:{},140:{f:B2},141:{f:Ve},144:{},146:{f:$2},151:{},152:{},153:{},154:{},155:{},156:{f:Ve},157:{},158:{},160:{f:z2},161:{f:W2},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:g2},190:{f:v2},193:{f:Cr},197:{},198:{},199:{},200:{},201:{},202:{f:$e},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ve},220:{},221:{f:$e},222:{},224:{f:w2},225:{f:Q_},226:{f:Cr},227:{},229:{f:I2},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:n2},253:{f:h2},255:{f:a2},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Eu},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:$e},353:{f:Cr},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:k2},431:{f:$e},432:{},433:{},434:{},437:{},438:{f:N2},439:{f:$e},440:{f:M2},441:{},442:{f:Na},443:{},444:{f:Ve},445:{},446:{},448:{f:Cr},449:{f:c2,r:2},450:{f:Cr},512:{f:Qo},513:{f:G2},515:{f:E2},516:{f:d2},517:{f:ef},519:{f:X2},520:{f:s2},523:{},545:{f:af},549:{f:Zo},566:{},574:{f:f2},638:{f:m2},659:{},1048:{},1054:{f:x2},1084:{},1212:{f:F2},2048:{f:L2},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ts},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Cr},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:H2,r:12},2173:{f:gy,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:$e,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:S2,r:12},2197:{},2198:{f:uy,r:12},2199:{},2200:{},2201:{},2202:{f:C2,r:12},2203:{f:Cr},2204:{},2205:{},2206:{},2207:{},2211:{f:i2},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ve},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:V2},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:U2},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Qo},1:{},2:{f:q2},3:{f:K2},4:{f:j2},5:{f:ef},7:{f:J2},8:{},9:{f:ts},11:{},22:{f:Ve},30:{f:p2},31:{},32:{},33:{f:af},36:{},37:{f:Zo},50:{f:Z2},62:{},52:{},67:{},68:{f:Ve},69:{},86:{},126:{},127:{f:Y2},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Q2},223:{},234:{},354:{},421:{},518:{f:Ci},521:{f:ts},536:{f:nf},547:{f:rf},561:{},579:{},1030:{f:Ci},1033:{f:ts},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Vt(e,r,t,n){var a=r;if(!isNaN(a)){var s=(t||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&fu(t)&&e.push(t)}}function mf(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,c=s&&s.index||e.length,f=Ev(e.slice(i,c),/(:?<tr[^>]*>)/i,"<tr>"),o=-1,l=0,u=0,h=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<f.length;++i){var p=f[i].trim(),m=p.slice(0,3).toLowerCase();if(m=="<tr"){if(++o,t.sheetRows&&t.sheetRows<=o){--o;break}l=0;continue}if(!(m!="<td"&&m!="<th")){var _=p.split(/<\/t[dh]>/i);for(c=0;c<_.length;++c){var w=_[c].trim();if(w.match(/<t[dh]/i)){for(var v=w,C=0;v.charAt(0)=="<"&&(C=v.indexOf(">"))>-1;)v=v.slice(C+1);for(var O=0;O<x.length;++O){var R=x[O];R.s.c==l&&R.s.r<o&&o<=R.e.r&&(l=R.e.c+1,O=-1)}var k=xe(w.slice(0,w.indexOf(">")));h=k.colspan?+k.colspan:1,((u=+k.rowspan)>1||h>1)&&x.push({s:{r:o,c:l},e:{r:o+(u||1)-1,c:l+h-1}});var U=k.t||k["data-t"]||"";if(!v.length){l+=h;continue}if(v=ql(v),d.s.r>o&&(d.s.r=o),d.e.r<o&&(d.e.r=o),d.s.c>l&&(d.s.c=l),d.e.c<l&&(d.e.c=l),!v.length){l+=h;continue}var I={t:"s",v};t.raw||!v.trim().length||U=="s"||(v==="TRUE"?I={t:"b",v:!0}:v==="FALSE"?I={t:"b",v:!1}:isNaN(Jt(v))?isNaN(Dn(v).getDate())||(I={t:"d",v:Ze(v)},t.cellDates||(I={t:"n",v:_t(I.v)}),I.z=t.dateNF||ge[14]):I={t:"n",v:Jt(v)}),t.dense?(n[o]||(n[o]=[]),n[o][l]=I):n[pe({r:o,c:l})]=I,l+=h}}}}return n["!ref"]=Te(d),x.length&&(n["!merges"]=x),n}function ZT(e,r,t,n){for(var a=e["!merges"]||[],s=[],i=r.s.c;i<=r.e.c;++i){for(var c=0,f=0,o=0;o<a.length;++o)if(!(a[o].s.r>t||a[o].s.c>i)&&!(a[o].e.r<t||a[o].e.c<i)){if(a[o].s.r<t||a[o].s.c<i){c=-1;break}c=a[o].e.r-a[o].s.r+1,f=a[o].e.c-a[o].s.c+1;break}if(!(c<0)){var l=pe({r:t,c:i}),u=n.dense?(e[t]||[])[i]:e[l],h=u&&u.v!=null&&(u.h||K0(u.w||(Tr(u),u.w)||""))||"",d={};c>1&&(d.rowspan=c),f>1&&(d.colspan=f),n.editable?h='<span contenteditable="true">'+h+"</span>":u&&(d["data-t"]=u&&u.t||"z",u.v!=null&&(d["data-v"]=u.v),u.z!=null&&(d["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+u.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+l,s.push(Bv("td",h,d))}}var x="<tr>";return x+s.join("")+"</tr>"}var QT='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',e4="</body></html>";function t4(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Br(mf(t[0],r),r);var n=dc();return t.forEach(function(a,s){xc(n,mf(a,r),"Sheet"+(s+1))}),n}function r4(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function n4(e,r){var t=r||{},n=t.header!=null?t.header:QT,a=t.footer!=null?t.footer:e4,s=[n],i=Ln(e["!ref"]);t.dense=Array.isArray(e),s.push(r4(e,i,t));for(var c=i.s.r;c<=i.e.r;++c)s.push(ZT(e,i,c,t));return s.push("</table>"+a),s.join("")}function th(e,r,t){var n=t||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?gt(n.origin):n.origin;a=i.r,s=i.c}var c=r.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,c.length),o={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var l=Ln(e["!ref"]);o.s.r=Math.min(o.s.r,l.s.r),o.s.c=Math.min(o.s.c,l.s.c),o.e.r=Math.max(o.e.r,l.e.r),o.e.c=Math.max(o.e.c,l.e.c),a==-1&&(o.e.r=a=l.e.r+1)}var u=[],h=0,d=e["!rows"]||(e["!rows"]=[]),x=0,p=0,m=0,_=0,w=0,v=0;for(e["!cols"]||(e["!cols"]=[]);x<c.length&&p<f;++x){var C=c[x];if(gf(C)){if(n.display)continue;d[p]={hidden:!0}}var O=C.children;for(m=_=0;m<O.length;++m){var R=O[m];if(!(n.display&&gf(R))){var k=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):ql(R.innerHTML),U=R.getAttribute("data-z")||R.getAttribute("z");for(h=0;h<u.length;++h){var I=u[h];I.s.c==_+s&&I.s.r<p+a&&p+a<=I.e.r&&(_=I.e.c+1-s,h=-1)}v=+R.getAttribute("colspan")||1,((w=+R.getAttribute("rowspan")||1)>1||v>1)&&u.push({s:{r:p+a,c:_+s},e:{r:p+a+(w||1)-1,c:_+s+(v||1)-1}});var z={t:"s",v:k},D=R.getAttribute("data-t")||R.getAttribute("t")||"";k!=null&&(k.length==0?z.t=D||"z":n.raw||k.trim().length==0||D=="s"||(k==="TRUE"?z={t:"b",v:!0}:k==="FALSE"?z={t:"b",v:!1}:isNaN(Jt(k))?isNaN(Dn(k).getDate())||(z={t:"d",v:Ze(k)},n.cellDates||(z={t:"n",v:_t(z.v)}),z.z=n.dateNF||ge[14]):z={t:"n",v:Jt(k)})),z.z===void 0&&U!=null&&(z.z=U);var B="",Z=R.getElementsByTagName("A");if(Z&&Z.length)for(var P=0;P<Z.length&&!(Z[P].hasAttribute("href")&&(B=Z[P].getAttribute("href"),B.charAt(0)!="#"));++P);B&&B.charAt(0)!="#"&&(z.l={Target:B}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][_+s]=z):e[pe({c:_+s,r:p+a})]=z,o.e.c<_+s&&(o.e.c=_+s),_+=v}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),o.e.r=Math.max(o.e.r,p-1+a),e["!ref"]=Te(o),p>=f&&(e["!fullref"]=Te((o.e.r=c.length-x+p-1+a,o))),e}function rh(e,r){var t=r||{},n=t.dense?[]:{};return th(n,e,r)}function a4(e,r){return Br(rh(e,r),r)}function gf(e){var r="",t=s4(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function s4(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function i4(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Se(r.replace(/<[^>]*>/g,""));return[t]}var vf={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function nh(e,r){var t=r||{},n=q0(e),a=[],s,i,c={name:""},f="",o=0,l,u,h={},d=[],x=t.dense?[]:{},p,m,_={value:""},w="",v=0,C=[],O=-1,R=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},U=0,I={},z=[],D={},B=0,Z=0,P=[],j=1,H=1,K=[],fe={Names:[]},L={},ne=["",""],oe=[],S={},W="",M=0,N=!1,J=!1,te=0;for(ka.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=ka.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?x["!ref"]=Te(k):x["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=k.e.r&&(x["!fullref"]=x["!ref"],k.e.r=t.sheetRows-1,x["!ref"]=Te(k)),z.length&&(x["!merges"]=z),P.length&&(x["!rows"]=P),l.name=l.名称||l.name,typeof JSON<"u"&&JSON.stringify(l),d.push(l.name),h[l.name]=x,J=!1):p[0].charAt(p[0].length-2)!=="/"&&(l=xe(p[0],!1),O=R=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,x=t.dense?[]:{},z=[],P=[],J=!0);break;case"table-row-group":p[1]==="/"?--U:++U;break;case"table-row":case"行":if(p[1]==="/"){O+=j,j=1;break}if(u=xe(p[0],!1),u.行号?O=u.行号-1:O==-1&&(O=0),j=+u["number-rows-repeated"]||1,j<10)for(te=0;te<j;++te)U>0&&(P[O+te]={level:U});R=-1;break;case"covered-table-cell":p[1]!=="/"&&++R,t.sheetStubs&&(t.dense?(x[O]||(x[O]=[]),x[O][R]={t:"z"}):x[pe({r:O,c:R})]={t:"z"}),w="",C=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++R,_=xe(p[0],!1),H=parseInt(_["number-columns-repeated"]||"1",10),m={t:"z",v:null},_.formula&&t.cellFormula!=!1&&(m.f=hf(Se(_.formula))),(_.数据类型||_["value-type"])=="string"&&(m.t="s",m.v=Se(_["string-value"]||""),t.dense?(x[O]||(x[O]=[]),x[O][R]=m):x[pe({r:O,c:R})]=m),R+=H-1;else if(p[1]!=="/"){++R,w="",v=0,C=[],H=1;var ie=j?O+j-1:O;if(R>k.e.c&&(k.e.c=R),R<k.s.c&&(k.s.c=R),O<k.s.r&&(k.s.r=O),ie>k.e.r&&(k.e.r=ie),_=xe(p[0],!1),oe=[],S={},m={t:_.数据类型||_["value-type"],v:null},t.cellFormula)if(_.formula&&(_.formula=Se(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(B=parseInt(_["number-matrix-rows-spanned"],10)||0,Z=parseInt(_["number-matrix-columns-spanned"],10)||0,D={s:{r:O,c:R},e:{r:O+B-1,c:R+Z-1}},m.F=Te(D),K.push([D,m.F])),_.formula)m.f=hf(_.formula);else for(te=0;te<K.length;++te)O>=K[te][0].s.r&&O<=K[te][0].e.r&&R>=K[te][0].s.c&&R<=K[te][0].e.c&&(m.F=K[te][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(B=parseInt(_["number-rows-spanned"],10)||0,Z=parseInt(_["number-columns-spanned"],10)||0,D={s:{r:O,c:R},e:{r:O+B-1,c:R+Z-1}},z.push(D)),_["number-columns-repeated"]&&(H=parseInt(_["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=Ie(_["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(_.value);break;case"percentage":m.t="n",m.v=parseFloat(_.value);break;case"currency":m.t="n",m.v=parseFloat(_.value);break;case"date":m.t="d",m.v=Ze(_["date-value"]),t.cellDates||(m.t="n",m.v=_t(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=_v(_["time-value"])/86400,t.cellDates&&(m.t="d",m.v=ei(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(_.数据数值);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",_["string-value"]!=null&&(w=Se(_["string-value"]),C=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(N=!1,m.t==="s"&&(m.v=w||"",C.length&&(m.R=C),N=v==0),L.Target&&(m.l=L),oe.length>0&&(m.c=oe,oe=[]),w&&t.cellText!==!1&&(m.w=w),N&&(m.t="z",delete m.v),(!N||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=O))for(var ae=0;ae<j;++ae){if(H=parseInt(_["number-columns-repeated"]||"1",10),t.dense)for(x[O+ae]||(x[O+ae]=[]),x[O+ae][R]=ae==0?m:rt(m);--H>0;)x[O+ae][R+H]=rt(m);else for(x[pe({r:O+ae,c:R})]=m;--H>0;)x[pe({r:O+ae,c:R+H})]=rt(m);k.e.c<=R&&(k.e.c=R)}H=parseInt(_["number-columns-repeated"]||"1",10),R+=H-1,H=0,m={},w="",C=[]}L={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s;S.t=w,C.length&&(S.R=C),S.a=W,oe.push(S)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);W="",M=0,w="",v=0,C=[];break;case"creator":p[1]==="/"?W=n.slice(M,p.index):M=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);w="",v=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(I[c.name]=f,(s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(f="",c=xe(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=xe(p[0],!1),f+=vf[p[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=xe(p[0],!1),f+=vf[p[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(o,p.index);break}else o=p.index+p[0].length;break;case"named-range":i=xe(p[0],!1),ne=bi(i["cell-range-address"]);var ee={Name:i.name,Ref:ne[0]+"!"+ne[1]};J&&(ee.Sheet=d.length),fe.Names.push(ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!_||!_["string-value"])){var Ae=i4(n.slice(v,p.index));w=(w.length>0?w+`
`:"")+Ae[0]}else xe(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ne=bi(xe(p[0])["target-range-address"]),h[ne[0]]["!autofilter"]={ref:ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(L=xe(p[0],!1),!L.href)break;L.Target=Se(L.href),delete L.href,L.Target.charAt(0)=="#"&&L.Target.indexOf(".")>-1?(ne=bi(L.Target.slice(1)),L.Target="#"+ne[0]+"!"+ne[1]):L.Target.match(/^\.\.[\\\/]/)&&(L.Target=L.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(p)}}var b={Sheets:h,SheetNames:d,Workbook:fe};return t.bookSheets&&delete b.Sheets,b}function _f(e,r){r=r||{},Lt(e,"META-INF/manifest.xml")&&E_(We(e,"META-INF/manifest.xml"),r);var t=Rt(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=nh(Re(t),r);return Lt(e,"meta.xml")&&(n.Props=mu(We(e,"meta.xml"))),n}function wf(e,r){return nh(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function fc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function d0(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Re(sn(e))}function x0(e){var r=e.reduce(function(a,s){return a+s.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(a){t.set(a,n),n+=a.length}),t}function yf(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function c4(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,a=r+13;a>=r;--a)n=n*256+e[a];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function Fa(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function Ke(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function lt(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],a=Fa(e,t),s=a&7;a=Math.floor(a/8);var i=0,c;if(a==0)break;switch(s){case 0:{for(var f=t[0];e[t[0]++]>=128;);c=e.slice(f,t[0])}break;case 5:i=4,c=e.slice(t[0],t[0]+i),t[0]+=i;break;case 1:i=8,c=e.slice(t[0],t[0]+i),t[0]+=i;break;case 2:i=Fa(e,t),c=e.slice(t[0],t[0]+i),t[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var o={data:c,type:s};r[a]==null?r[a]=[o]:r[a].push(o)}return r}function lc(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function o4(e){for(var r,t=[],n=[0];n[0]<e.length;){var a=Fa(e,n),s=lt(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:Ke(s[1][0].data),messages:[]};s[2].forEach(function(c){var f=lt(c.data),o=Ke(f[3][0].data);i.messages.push({meta:f,data:e.slice(n[0],n[0]+o)}),n[0]+=o}),(r=s[3])!=null&&r[0]&&(i.merge=Ke(s[3][0].data)>>>0>0),t.push(i)}return t}function f4(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=Fa(r,t),a=[];t[0]<r.length;){var s=r[t[0]]&3;if(s==0){var i=r[t[0]++]>>2;if(i<60)++i;else{var c=i-59;i=r[t[0]],c>1&&(i|=r[t[0]+1]<<8),c>2&&(i|=r[t[0]+2]<<16),c>3&&(i|=r[t[0]+3]<<24),i>>>=0,i++,t[0]+=c}a.push(r.slice(t[0],t[0]+i)),t[0]+=i;continue}else{var f=0,o=0;if(s==1?(o=(r[t[0]]>>2&7)+4,f=(r[t[0]++]&224)<<3,f|=r[t[0]++]):(o=(r[t[0]++]>>2)+1,s==2?(f=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(f=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),a=[x0(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(o>=f)for(a.push(a[0].slice(-f)),o-=f;o>=a[a.length-1].length;)a.push(a[a.length-1]),o-=a[a.length-1].length;a.push(a[0].slice(-f,-f+o))}}var l=x0(a);if(l.length!=n)throw new Error("Unexpected length: ".concat(l.length," != ").concat(n));return l}function l4(e){for(var r=[],t=0;t<e.length;){var n=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(f4(n,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return x0(r)}function u4(e,r,t,n){var a=fc(e),s=a.getUint32(4,!0),i=(n>1?12:8)+yf(s&(n>1?3470:398))*4,c=-1,f=-1,o=NaN,l=new Date(2001,0,1);s&512&&(c=a.getUint32(i,!0),i+=4),i+=yf(s&(n>1?12288:4096))*4,s&16&&(f=a.getUint32(i,!0),i+=4),s&32&&(o=a.getFloat64(i,!0),i+=8),s&64&&(l.setTime(l.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var u;switch(e[2]){case 0:break;case 2:u={t:"n",v:o};break;case 3:u={t:"s",v:r[f]};break;case 5:u={t:"d",v:l};break;case 6:u={t:"b",v:o>0};break;case 7:u={t:"n",v:o/86400};break;case 8:u={t:"e",v:0};break;case 9:if(c>-1)u={t:"s",v:t[c]};else if(f>-1)u={t:"s",v:r[f]};else if(!isNaN(o))u={t:"n",v:o};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return u}function h4(e,r,t){var n=fc(e),a=n.getUint32(8,!0),s=12,i=-1,c=-1,f=NaN,o=NaN,l=new Date(2001,0,1);a&1&&(f=c4(e,s),s+=16),a&2&&(o=n.getFloat64(s,!0),s+=8),a&4&&(l.setTime(l.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(c=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var u;switch(e[1]){case 0:break;case 2:u={t:"n",v:f};break;case 3:u={t:"s",v:r[c]};break;case 5:u={t:"d",v:l};break;case 6:u={t:"b",v:o>0};break;case 7:u={t:"n",v:o/86400};break;case 8:u={t:"e",v:0};break;case 9:if(i>-1)u={t:"s",v:t[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:u={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return u}function d4(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return u4(e,r,t,e[0]);case 5:return h4(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Nr(e){var r=lt(e);return Fa(r[1][0].data)}function Ef(e,r){var t=lt(r.data),n=Ke(t[1][0].data),a=t[3],s=[];return(a||[]).forEach(function(i){var c=lt(i.data),f=Ke(c[1][0].data)>>>0;switch(n){case 1:s[f]=d0(c[3][0].data);break;case 8:{var o=e[Nr(c[9][0].data)][0],l=lt(o.data),u=e[Nr(l[1][0].data)][0],h=Ke(u.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var d=lt(u.data);s[f]=d[3].map(function(x){return d0(x.data)}).join("")}break}}),s}function x4(e,r){var t,n,a,s,i,c,f,o,l,u,h,d,x,p,m=lt(e),_=Ke(m[1][0].data)>>>0,w=Ke(m[2][0].data)>>>0,v=((n=(t=m[8])==null?void 0:t[0])==null?void 0:n.data)&&Ke(m[8][0].data)>0||!1,C,O;if((s=(a=m[7])==null?void 0:a[0])!=null&&s.data&&r!=0)C=(c=(i=m[7])==null?void 0:i[0])==null?void 0:c.data,O=(o=(f=m[6])==null?void 0:f[0])==null?void 0:o.data;else if((u=(l=m[4])==null?void 0:l[0])!=null&&u.data&&r!=1)C=(d=(h=m[4])==null?void 0:h[0])==null?void 0:d.data,O=(p=(x=m[3])==null?void 0:x[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var R=v?4:1,k=fc(C),U=[],I=0;I<C.length/2;++I){var z=k.getUint16(I*2,!0);z<65535&&U.push([I,z])}if(U.length!=w)throw"Expected ".concat(w," cells, found ").concat(U.length);var D=[];for(I=0;I<U.length-1;++I)D[U[I][0]]=O.subarray(U[I][1]*R,U[I+1][1]*R);return U.length>=1&&(D[U[U.length-1][0]]=O.subarray(U[U.length-1][1]*R)),{R:_,cells:D}}function p4(e,r){var t,n=lt(r.data),a=(t=n==null?void 0:n[7])!=null&&t[0]?Ke(n[7][0].data)>>>0>0?1:0:-1,s=lc(n[5],function(i){return x4(i,a)});return{nrows:Ke(n[4][0].data)>>>0,data:s.reduce(function(i,c){return i[c.R]||(i[c.R]=[]),c.cells.forEach(function(f,o){if(i[c.R][o])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(o));i[c.R][o]=f}),i},[])}}function m4(e,r,t){var n,a=lt(r.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ke(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Ke(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=Te(s);var i=lt(a[4][0].data),c=Ef(e,e[Nr(i[4][0].data)][0]),f=(n=i[17])!=null&&n[0]?Ef(e,e[Nr(i[17][0].data)][0]):[],o=lt(i[3][0].data),l=0;o[1].forEach(function(u){var h=lt(u.data),d=e[Nr(h[2][0].data)][0],x=Ke(d.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var p=p4(e,d);p.data.forEach(function(m,_){m.forEach(function(w,v){var C=pe({r:l+_,c:v}),O=d4(w,c,f);O&&(t[C]=O)})}),l+=p.nrows})}function g4(e,r){var t=lt(r.data),n={"!ref":"A1"},a=e[Nr(t[2][0].data)],s=Ke(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return m4(e,a[0],n),n}function v4(e,r){var t,n=lt(r.data),a={name:(t=n[1])!=null&&t[0]?d0(n[1][0].data):"",sheets:[]},s=lc(n[2],Nr);return s.forEach(function(i){e[i].forEach(function(c){var f=Ke(c.meta[1][0].data);f==6e3&&a.sheets.push(g4(e,c))})}),a}function _4(e,r){var t=dc(),n=lt(r.data),a=lc(n[1],Nr);if(a.forEach(function(s){e[s].forEach(function(i){var c=Ke(i.meta[1][0].data);if(c==2){var f=v4(e,i);f.sheets.forEach(function(o,l){xc(t,o,l==0?f.name:f.name+"_"+l,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Ii(e){var r,t,n,a,s={},i=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var o;try{o=l4(f.content)}catch(u){return console.log("?? "+f.content.length+" "+(u.message||u))}var l;try{l=o4(o)}catch(u){return console.log("## "+(u.message||u))}l.forEach(function(u){s[u.id]=u.messages,i.push(u.id)})}}),!i.length)throw new Error("File has no messages");var c=((a=(n=(t=(r=s==null?void 0:s[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Ke(s[1][0].meta[1][0].data)==1&&s[1][0];if(c||i.forEach(function(f){s[f].forEach(function(o){var l=Ke(o.meta[1][0].data)>>>0;if(l==1)if(!c)c=o;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return _4(s,c)}function w4(e){return function(t){for(var n=0;n!=e.length;++n){var a=e[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function uc(e){w4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function y4(e){return _n.WS.indexOf(e)>-1?"sheet":e==_n.CS?"chart":e==_n.DS?"dialog":e==_n.MS?"macro":e&&e.length?e:"sheet"}function E4(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,y4(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function k4(e,r,t,n,a,s,i,c,f,o,l,u){try{s[n]=la(Rt(e,t,!0),r);var h=We(e,r),d;switch(c){case"sheet":d=bT(h,r,a,f,s[n],o,l,u);break;case"chart":if(d=RT(h,r,a,f,s[n],o,l,u),!d||!d["!drawel"])break;var x=Qn(d["!drawel"].Target,r),p=o0(x),m=Cy(Rt(e,x,!0),la(Rt(e,p,!0),x)),_=Qn(m,x),w=o0(_);d=hT(Rt(e,_,!0),_,f,la(Rt(e,w,!0),_),o,d);break;case"macro":d=IT(h,r,a,f,s[n],o,l,u);break;case"dialog":d=OT(h,r,a,f,s[n],o,l,u);break;default:throw new Error("Unrecognized sheet type "+c)}i[n]=d;var v=[];s&&s[n]&&fr(s[n]).forEach(function(C){var O="";if(s[n][C].Type==_n.CMNT){O=Qn(s[n][C].Target,r);var R=MT(We(e,O,!0),O,f);if(!R||!R.length)return;cf(d,R,!1)}s[n][C].Type==_n.TCMNT&&(O=Qn(s[n][C].Target,r),v=v.concat(Ry(We(e,O,!0),f)))}),v&&v.length&&cf(d,v,!0,f.people||[])}catch(C){if(f.WTF)throw C}}function Nt(e){return e.charAt(0)=="/"?e.slice(1):e}function T4(e,r){if(Hl(),r=r||{},uc(r),Lt(e,"META-INF/manifest.xml")||Lt(e,"objectdata.xml"))return _f(e,r);if(Lt(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ii<"u"){if(e.FileIndex)return Ii(e);var t=ke.utils.cfb_new();return Do(e).forEach(function(P){Av(t,P,Tv(e,P))}),Ii(t)}throw new Error("Unsupported NUMBERS file")}if(!Lt(e,"[Content_Types].xml"))throw Lt(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Lt(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Do(e),a=w_(Rt(e,"[Content_Types].xml")),s=!1,i,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",We(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!We(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var f={},o={};if(!r.bookSheets&&!r.bookProps){if(da=[],a.sst)try{da=NT(We(e,Nt(a.sst)),a.sst,r)}catch(P){if(r.WTF)throw P}r.cellStyles&&a.themes.length&&(f=PT(Rt(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(o=DT(We(e,Nt(a.style)),a.style,f,r))}a.links.map(function(P){try{var j=la(Rt(e,o0(Nt(P))),P);return BT(We(e,Nt(P)),j,P,r)}catch{}});var l=CT(We(e,Nt(a.workbooks[0])),a.workbooks[0],r),u={},h="";a.coreprops.length&&(h=We(e,Nt(a.coreprops[0]),!0),h&&(u=mu(h)),a.extprops.length!==0&&(h=We(e,Nt(a.extprops[0]),!0),h&&A_(h,u,r)));var d={};(!r.bookSheets||r.bookProps)&&a.custprops.length!==0&&(h=Rt(e,Nt(a.custprops[0]),!0),h&&(d=F_(h,r)));var x={};if((r.bookSheets||r.bookProps)&&(l.Sheets?i=l.Sheets.map(function(j){return j.name}):u.Worksheets&&u.SheetNames.length>0&&(i=u.SheetNames),r.bookProps&&(x.Props=u,x.Custprops=d),r.bookSheets&&typeof i<"u"&&(x.SheetNames=i),r.bookSheets?x.SheetNames:r.bookProps))return x;i={};var p={};r.bookDeps&&a.calcchain&&(p=LT(We(e,Nt(a.calcchain)),a.calcchain));var m=0,_={},w,v;{var C=l.Sheets;u.Worksheets=C.length,u.SheetNames=[];for(var O=0;O!=C.length;++O)u.SheetNames[O]=C[O].name}var R=s?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),U=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Lt(e,U)||(U="xl/_rels/workbook."+R+".rels");var I=la(Rt(e,U,!0),U.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=UT(We(e,Nt(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=Iy(We(e,Nt(a.people[0])),r)),I&&(I=E4(I,l.Sheets));var z=We(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=u.Worksheets;++m){var D="sheet";if(I&&I[m]?(w="xl/"+I[m][1].replace(/[\/]?xl\//,""),Lt(e,w)||(w=I[m][1]),Lt(e,w)||(w=U.replace(/_rels\/.*$/,"")+I[m][1]),D=I[m][2]):(w="xl/worksheets/sheet"+(m+1-z)+"."+R,w=w.replace(/sheet0\./,"sheet.")),v=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(m!=r.sheets)continue e;break;case"string":if(u.SheetNames[m].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var B=!1,Z=0;Z!=r.sheets.length;++Z)typeof r.sheets[Z]=="number"&&r.sheets[Z]==m&&(B=1),typeof r.sheets[Z]=="string"&&r.sheets[Z].toLowerCase()==u.SheetNames[m].toLowerCase()&&(B=1);if(!B)continue e}}k4(e,w,v,u.SheetNames[m],m,_,i,D,r,l,f,o)}return x={Directory:a,Workbook:l,Props:u,Custprops:d,Deps:p,Sheets:i,SheetNames:u.SheetNames,Strings:da,Styles:o,Themes:f,SSF:rt(ge)},r&&r.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(P,j){P=P.replace(/^Root Entry[\/]/,""),x.keys.push(P),x.files[P]=e.FileIndex[j]}))),r&&r.bookVBA&&(a.vba.length>0?x.vbaraw=We(e,Nt(a.vba[0]),!0):a.defaults&&a.defaults.bin===Ny&&(x.vbaraw=We(e,"xl/vbaProject.bin",!0))),x}function A4(e,r){var t=r||{},n="Workbook",a=ke.find(e,n);try{if(n="/!DataSpaces/Version",a=ke.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(gw(a.content),n="/!DataSpaces/DataSpaceMap",a=ke.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=_w(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=ke.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=ww(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=ke.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Ew(a.content)}catch{}if(n="/EncryptionInfo",a=ke.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=kw(a.content);if(n="/EncryptedPackage",a=ke.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function hc(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Ot(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function S4(e,r){return ke.find(e,"EncryptedPackage")?A4(e,r):eh(e,r)}function F4(e,r){var t,n=e,a=r||{};return a.type||(a.type=ye&&Buffer.isBuffer(e)?"buffer":"base64"),t=Yl(n,a),T4(t,a)}function ah(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return u0(e.slice(t),r);default:break e}return Ta.to_workbook(e,r)}function C4(e,r){var t="",n=hc(e,r);switch(r.type){case"base64":t=Ot(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=rn(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=Re(t)),r.type="binary",ah(t,r)}function b4(e,r){var t=e;return r.type=="base64"&&(t=Ot(t)),t=s0.utils.decode(1200,t.slice(2),"str"),r.type="binary",ah(t,r)}function R4(e){return e.match(/[^\x00-\x7F]/)?ea(e):e}function Oi(e,r,t,n){return n?(t.type="string",Ta.to_workbook(e,t)):Ta.to_workbook(r,t)}function p0(e,r){bl();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return p0(new Uint8Array(e),(t=rt(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Tn={},t.dateNF&&(Tn.dateNF=t.dateNF),t.type||(t.type=ye&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=ye?"buffer":"binary",n=gv(e),typeof Uint8Array<"u"&&!ye&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,n=R4(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),c=new Uint8Array(i);if(c.foo="bar",!c.foo)return t=rt(t),t.type="array",p0(G0(n),t)}switch((a=hc(n,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return S4(ke.read(n,t),t);break;case 9:if(a[1]<=8)return eh(n,t);break;case 60:return u0(n,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return aw(n,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return rw.to_workbook(n,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?F4(n,t):Oi(e,n,t,s);case 239:return a[3]===60?u0(n,t):Oi(e,n,t,s);case 255:if(a[1]===254)return b4(n,t);if(a[1]===0&&a[2]===2&&a[3]===0)return ha.to_workbook(n,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return ha.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return sf.to_workbook(n,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Nw.to_workbook(n,t);break;case 10:case 13:case 32:return C4(n,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return ew.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?sf.to_workbook(n,t):Oi(e,n,t,s)}function I4(e,r,t,n,a,s,i,c){var f=nt(t),o=c.defval,l=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),u=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:t,enumerable:!1})}catch{h.__rowNum__=t}else h.__rowNum__=t;if(!i||e[t])for(var d=r.s.c;d<=r.e.c;++d){var x=i?e[t][d]:e[n[d]+f];if(x===void 0||x.t===void 0){if(o===void 0)continue;s[d]!=null&&(h[s[d]]=o);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[d]!=null){if(p==null)if(x.t=="e"&&p===null)h[s[d]]=null;else if(o!==void 0)h[s[d]]=o;else if(l&&p===null)h[s[d]]=null;else continue;else h[s[d]]=l&&(x.t!=="n"||x.t==="n"&&c.rawNumbers!==!1)?p:Tr(x,p,c);p!=null&&(u=!1)}}return{row:h,isempty:u}}function m0(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,s=[],i=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},o=r||{},l=o.range!=null?o.range:e["!ref"];switch(o.header===1?n=1:o.header==="A"?n=2:Array.isArray(o.header)?n=3:o.header==null&&(n=0),typeof l){case"string":f=Me(l);break;case"number":f=Me(e["!ref"]),f.s.r=l;break;default:f=l}n>0&&(a=0);var u=nt(f.s.r),h=[],d=[],x=0,p=0,m=Array.isArray(e),_=f.s.r,w=0,v={};m&&!e[_]&&(e[_]=[]);var C=o.skipHidden&&e["!cols"]||[],O=o.skipHidden&&e["!rows"]||[];for(w=f.s.c;w<=f.e.c;++w)if(!(C[w]||{}).hidden)switch(h[w]=je(w),t=m?e[_][w]:e[h[w]+u],n){case 1:s[w]=w-f.s.c;break;case 2:s[w]=h[w];break;case 3:s[w]=o.header[w-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=i=Tr(t,null,o),p=v[i]||0,!p)v[i]=1;else{do c=i+"_"+p++;while(v[c]);v[i]=p,v[c]=1}s[w]=c}for(_=f.s.r+a;_<=f.e.r;++_)if(!(O[_]||{}).hidden){var R=I4(e,f,_,h,n,s,m,o);(R.isempty===!1||(n===1?o.blankrows!==!1:o.blankrows))&&(d[x++]=R.row)}return d.length=x,d}var kf=/"/g;function O4(e,r,t,n,a,s,i,c){for(var f=!0,o=[],l="",u=nt(t),h=r.s.c;h<=r.e.c;++h)if(n[h]){var d=c.dense?(e[t]||[])[h]:e[n[h]+u];if(d==null)l="";else if(d.v!=null){f=!1,l=""+(c.rawNumbers&&d.t=="n"?d.v:Tr(d,null,c));for(var x=0,p=0;x!==l.length;++x)if((p=l.charCodeAt(x))===a||p===s||p===34||c.forceQuotes){l='"'+l.replace(kf,'""')+'"';break}l=="ID"&&(l='"ID"')}else d.f!=null&&!d.F?(f=!1,l="="+d.f,l.indexOf(",")>=0&&(l='"'+l.replace(kf,'""')+'"')):l="";o.push(l)}return c.blankrows===!1&&f?null:o.join(i)}function sh(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var a=Me(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,f=c.charCodeAt(0),o=new RegExp((s=="|"?"\\|":s)+"+$"),l="",u=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(h[x]||{}).hidden||(u[x]=je(x));for(var p=0,m=a.s.r;m<=a.e.r;++m)(d[m]||{}).hidden||(l=O4(e,a,m,u,i,f,s,n),l!=null&&(n.strip&&(l=l.replace(o,"")),(l||n.blankrows!==!1)&&t.push((p++?c:"")+l)));return delete n.dense,t.join("")}function D4(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=sh(e,r);return t}function P4(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var a=Me(e["!ref"]),s="",i=[],c,f=[],o=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)i[c]=je(c);for(var l=a.s.r;l<=a.e.r;++l)for(s=nt(l),c=a.s.c;c<=a.e.c;++c)if(r=i[c]+s,t=o?(e[l]||[])[c]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}f[f.length]=r+"="+n}return f}function ih(e,r,t){var n=t||{},a=+!n.skipHeader,s=e||{},i=0,c=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var f=typeof n.origin=="string"?gt(n.origin):n.origin;i=f.r,c=f.c}var o,l={s:{c:0,r:0},e:{c,r:i+r.length-1+a}};if(s["!ref"]){var u=Me(s["!ref"]);l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),i==-1&&(i=u.e.r+1,l.e.r=i+r.length-1+a)}else i==-1&&(i=0,l.e.r=r.length-1+a);var h=n.header||[],d=0;r.forEach(function(p,m){fr(p).forEach(function(_){(d=h.indexOf(_))==-1&&(h[d=h.length]=_);var w=p[_],v="z",C="",O=pe({c:c+d,r:i+m+a});o=Ca(s,O),w&&typeof w=="object"&&!(w instanceof Date)?s[O]=w:(typeof w=="number"?v="n":typeof w=="boolean"?v="b":typeof w=="string"?v="s":w instanceof Date?(v="d",n.cellDates||(v="n",w=_t(w)),C=n.dateNF||ge[14]):w===null&&n.nullError&&(v="e",w=0),o?(o.t=v,o.v=w,delete o.w,delete o.R,C&&(o.z=C)):s[O]=o={t:v,v:w},C&&(o.z=C))})}),l.e.c=Math.max(l.e.c,c+h.length-1);var x=nt(i);if(a)for(d=0;d<h.length;++d)s[je(d+c)+x]={t:"s",v:h[d]};return s["!ref"]=Te(l),s}function N4(e,r){return ih(null,e,r)}function Ca(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=gt(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Ca(e,pe(r)):Ca(e,pe({r,c:t||0}))}function M4(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function dc(){return{SheetNames:[],Sheets:{}}}function xc(e,r,t,n){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=i+a)!=-1;++a);}if(wT(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function L4(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=M4(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function B4(e,r){return e.z=r,e}function ch(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function U4(e,r,t){return ch(e,"#"+r,t)}function $4(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function H4(e,r,t,n){for(var a=typeof r!="string"?r:Me(r),s=typeof r=="string"?r:Te(r),i=a.s.r;i<=a.e.r;++i)for(var c=a.s.c;c<=a.e.c;++c){var f=Ca(e,i,c);f.t="n",f.F=s,delete f.v,i==a.s.r&&c==a.s.c&&(f.f=t,n&&(f.D=!0))}return e}var W4={encode_col:je,encode_row:nt,encode_cell:pe,encode_range:Te,decode_col:Q0,decode_row:Z0,split_cell:Qv,decode_cell:gt,decode_range:Ln,format_cell:Tr,sheet_add_aoa:uu,sheet_add_json:ih,sheet_add_dom:th,aoa_to_sheet:Bn,json_to_sheet:N4,table_to_sheet:rh,table_to_book:a4,sheet_to_csv:sh,sheet_to_txt:D4,sheet_to_json:m0,sheet_to_html:n4,sheet_to_formulae:P4,sheet_to_row_object_array:m0,sheet_get_cell:Ca,book_new:dc,book_append_sheet:xc,book_set_sheet_visibility:L4,cell_set_number_format:B4,cell_set_hyperlink:ch,cell_set_internal_link:U4,cell_add_comment:$4,sheet_set_array_formula:H4,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class V4 extends HTMLElement{constructor(){super();At(this,"chartContainer");At(this,"tooltipContainer");const t=this.attachShadow({mode:"open"});t.innerHTML=`
      <style>
        #container { display: flex; 
          background:var(--container-bg);
          color: var(--color-text);
          padding: 5px;
        }
        #settings { 
          width: 300px; 
          padding-right: 10px; 
          margin-top: 10px;
          margin-left: 10px;
          margin-bottom: 10px;
          margin-right: 10px;
        }
        #tooltipContainer {
          flex: 1;
          border: 1px solid #ddd;
          padding: 10px;
          min-height: 100px;
          margin-left: 10px;
          margin-right: 10px;
          margin-top: 10px;
          border-radius: 10px;
          background: #353d46;
          color: white;
          overflow-y: auto;
          opacity: 1;
          transition: opacity 0.2s ease-in-out;
        }
        #chart { height: 600px; border: 1px solid #ccc; margin-top: 10px; 
          background: #353d46;
          margin-bottom: 20px;
          position: relative;
          border-radius: 20px;
          margin-left: 10px;
          margin-right: 10px;

        }
        #chart svg { width: 100%; height: 100%; }
      </style>

      <div id="container">
        <div id="settings">
          <input type="file" id="fileUpload" accept=".xlsx, .csv" />
          <button id="retryUpload">🔄 Retry</button>

          <div id="column-selectors" style="display:none;">
            <label>Parent Column:</label>
            <select id="parentSelect"></select>
            <label>Child Column:</label>
            <select id="childSelect"></select>
            <button id="renderButton">Render Tree</button>

            <div>
              <label>Tooltip Fields (Ctrl+Click for multiple):</label>
              <select id="tooltipFields" multiple style="height:100px;width:200px;"></select>
            </div>
          </div>
        </div>

        <div id="tooltipContainer">Hover a node to see details here.</div>
      </div>

      <div id="chart"></div>
    `}connectedCallback(){const t=this.shadowRoot,n=t.getElementById("fileUpload"),a=t.getElementById("retryUpload"),s=t.getElementById("parentSelect"),i=t.getElementById("childSelect"),c=t.getElementById("renderButton"),f=t.getElementById("column-selectors"),o=t.getElementById("tooltipFields");this.chartContainer=t.getElementById("chart"),this.tooltipContainer=t.getElementById("tooltipContainer");let l=[];a.onclick=()=>{n.value="",f.style.display="none",this.chartContainer.innerHTML="",this.tooltipContainer.textContent="Hover a node to see details here.",l=[]},n.onchange=()=>{var d;const u=(d=n.files)==null?void 0:d[0];if(!u)return;const h=new FileReader;h.onload=x=>{var v;const p=new Uint8Array((v=x.target)==null?void 0:v.result),m=p0(p,{type:"array"}),_=m.Sheets[m.SheetNames[0]];l=W4.sheet_to_json(_,{header:0,defval:""});const w=Object.keys(l[0]);s.innerHTML=i.innerHTML=o.innerHTML="",w.forEach(C=>{[s,i,o].forEach(O=>{const R=document.createElement("option");R.value=R.textContent=C,O.appendChild(R.cloneNode(!0))})}),f.style.display="block"},h.readAsArrayBuffer(u)},c.onclick=()=>{const u=s.value,h=i.value,d=Array.from(o.selectedOptions).map(x=>x.value);if(u===h){alert("Parent and Child columns must be different.");return}this.renderTree(l,u,h,d)}}renderTree(t,n,a,s){const i=cg().id((h,d)=>`${h[a]}_${d}`).parentId(h=>t.find(d=>d[a]===h[n])?`${h[n]}_${t.indexOf(t.find(d=>d[a]===h[n]))}`:null)(t);xg().nodeSize([160,100])(i),i.eachAfter(h=>h.data.nodeCount=h.children?h.children.reduce((d,x)=>d+(x.data.nodeCount||0),0)+h.children.length:0);const f=Sl(kg).domain([Xd(i.descendants(),h=>h.data.nodeCount)||1,0]),o=Cx("svg").attr("viewBox",[-1e3,-500,2e3,2e3]),l=o.append("g");o.call($g().on("zoom",h=>{const{transform:d}=h;l.attr("transform",d.toString())})),l.selectAll("path").data(i.links()).enter().append("path").attr("fill","none").attr("stroke","#ccc").attr("stroke-width",4).attr("d",Dg().source(h=>[h.source.x,h.source.y]).target(h=>[h.target.x,h.target.y]));const u=l.selectAll("g").data(i.descendants()).enter().append("g").attr("transform",h=>`translate(${h.x},${h.y})`).style("cursor","pointer").on("mouseover",(h,d)=>{Bt(this.tooltipContainer).transition().duration(200).style("opacity",0).on("end",()=>{this.tooltipContainer.innerHTML=s.map(x=>`<strong>${x}</strong>: ${d.data[x]}`).join("<br>"),Bt(this.tooltipContainer).transition().duration(200).style("opacity",1)}),Bt(h.currentTarget).select("rect").transition().duration(200).attr("stroke-width",5).attr("stroke","white")}).on("mouseout",(h,d)=>{Bt(h.currentTarget).select("rect").transition().duration(200).attr("stroke-width",1).attr("stroke","#333")});u.append("rect").attr("width",120).attr("height",50).attr("x",-60).attr("y",-25).attr("rx",10).attr("ry",10).attr("fill",h=>f(h.data.nodeCount??0)).attr("stroke","#333").attr("stroke-width",1),u.append("text").attr("text-anchor","middle").attr("dy",".35em").attr("fill","white").style("font-weight","bold").style("font-size","14px").text(h=>String(h.data[a]).slice(0,15)),this.chartContainer.innerHTML="",this.chartContainer.append(o.node())}}customElements.define("tree-bom-page",V4);async function oh(){const e="https://partsmanual.blob.core.windows.net/authenticationhash/credentials.json?sp=racwdli&st=2025-03-10T16:47:55Z&se=2025-08-01T00:47:55Z&sv=2022-11-02&sr=c&sig=4BjCw6SBZmI606wTM3GEQUYRcuhRQMlgKrj0Wy%2B4Y8g%3D";try{const r=await fetch(e,{cache:"no-cache"});if(!r.ok)throw new Error(`Failed to fetch whitelisted emails: ${r.statusText}`);const t=await r.json(),n=new Set;return t.forEach(a=>{n.add(a.Email.toLowerCase())}),console.log("Fetched whitelisted emails:",n),n}catch(r){return console.error("Error fetching whitelist. Returning fallback set:",r),new Set(["hshields@trebro.com"])}}let fh=[];(async()=>{const e=await oh();fh=Array.from(e)})();function G4(e){const r=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));return r?decodeURIComponent(r[2]):null}class z4{async isAuthenticated(){return!!G4("auth")}async setUserData(r){const t=r.email.toLowerCase();if(!fh.includes(t))throw new Error("Email not registered. Please request access.");window.localStorage.zeaUserData=JSON.stringify({email:t})}async getUserData(){const{zeaUserData:r}=window.localStorage;return r?JSON.parse(r):null}async signOut(){localStorage.removeItem("zeaUserData"),document.cookie="auth=; Path=/; Max-Age=0"}}const g0=new z4;let Di=null;function X4(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}class Y4 extends HTMLElement{constructor(){super();At(this,"modal");At(this,"content");At(this,"onCloseCallback");At(this,"initialBtnHTML");const t=this.attachShadow({mode:"open"});this.modal=document.createElement("div"),this.modal.classList.add("modal"),t.appendChild(this.modal),this.content=document.createElement("div"),this.content.classList.add("modal-content"),this.modal.appendChild(this.content),this.content.innerHTML=`
      <div class="container">
        <div class="imgcontainer">
          <img src="data/Crescent1.png" alt="Logo" class="logo">
        </div>
        <label for="uname"><b>Email</b></label>
        <input id="uname" type="text" placeholder="Enter Email" name="uname" required>

        <!-- CHANGED: remove password container entirely -->
        <button id="sendLinkBtn" class="btn">
          <span class="icon-text">
            <i class="fas fa-paper-plane"></i>
            <span class="text">Send Magic Link</span>
          </span>
          <span class="wave-spinner">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </span>
        </button>

        <!-- Microsoft Form container (unchanged) -->
        <div id="msFormContainer" style="display: none; margin-top: 1rem;">
          <p>If you don’t have an account, please fill out the form below:</p>
          <iframe id="msForm"
            width="640px"
            height="480px"
            frameborder="0"
            marginwidth="0"
            marginheight="0"
            style="border: none; max-width: 100%; max-height: 100vh;"
            allowfullscreen
            webkitallowfullscreen
            mozallowfullscreen
            msallowfullscreen
          ></iframe>
        </div>
      </div>
    `;const n=this.shadowRoot.getElementById("uname"),a=this.shadowRoot.getElementById("sendLinkBtn"),s=this.shadowRoot.getElementById("msFormContainer"),i=[{step0:"rgb(255, 255, 255)",step40:"rgb(255, 160, 105)",step50:"#f36f21"},{step0:"rgb(255, 255, 255)",step40:"rgb(255, 228, 141)",step50:"#FABF35"},{step0:"rgb(255, 255, 255)",step40:"rgb(255, 143, 143)",step50:"#EA3546"},{step0:"rgb(255, 255, 255)",step40:"rgb(136, 148, 255)",step50:"#345995"}];a.querySelectorAll(".wave-spinner > div").forEach(u=>{const h=i[Math.floor(Math.random()*i.length)];u.style.setProperty("--wave-color-0",h.step0),u.style.setProperty("--wave-color-40",h.step40),u.style.setProperty("--wave-color-50",h.step50)}),a.style.display="none",n.addEventListener("input",async()=>{const u=n.value.trim().toLowerCase();Di||(Di=await oh()),X4(u)?Array.from(Di).some(d=>d.startsWith(u))?(a.style.display="block",s.style.display="none"):(a.style.display="none",s.style.display="block"):(a.style.display="none",s.style.display="none")}),this.initialBtnHTML=a.innerHTML;const f=a.innerHTML,o=async()=>{const u=n.value.trim().toLowerCase();await g0.setUserData({email:u}),a.disabled=!0,a.classList.add("loading"),setTimeout(()=>{a.classList.remove("loading"),a.classList.add("success"),a.textContent="Success! Check your email",document.cookie="auth=testing; path=/;",a.innerHTML=f,a.classList.add("success"),a.textContent="Success! Check your email",this.content.classList.add("minimized"),a.onclick=o,setTimeout(()=>{document.dispatchEvent(new CustomEvent("login-success"))},1e3)},1500)};a.onclick=o;const l=document.createElement("style");l.appendChild(document.createTextNode(`
        @keyframes slideDown {
          0% {
            opacity: 0;
            transform: translateY(-50px);
          }
          100% {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes slideUp {
          0% {
            opacity: 1;
            transform: translateY(0);
          }
          100% {
            opacity: 0;
            transform: translateY(-50px);
          }
        }
        /* The Modal (background) */
        .modal {
          display: none; /* Hidden by default */
          position: fixed; /* Stay in place */
          z-index: 1; /* Sit on top */
          left: 0;
          top: 0;
          width: 100%; /* Full width */
          height: 100%; /* Full height */
          overflow: auto; /* Enable scroll if needed */
          background-color: rgb(0,0,0); /* Fallback color */
          background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        }

        /* Modal Content initial state */
        .modal-content {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          transition: transform 1.5s ease-in-out, top 1.5s ease-in-out, left 1.5s ease-in-out, width 1.5s ease-in-out, height 1.5s ease-in-out, opacity 1.5s ease-in-out;
          width: 80%;
          max-width: 600px;
          border-radius: 10px;
          z-index: 1000;
          background:var(--container-bg);
        }
        label {
          color: var(--color-text);
          display: block; /* So it sits on its own line */
        }
        .modal-content.minimized {
          opacity: 0;
        }

        /* Transition for the logo image */
        .logo {
          transition: transform 0.6s ease-in-out, width 0.6s ease-in-out;
        }

        /* When modal-content is minimized, the logo scales down */
        .modal-content.minimized .logo {
          transform: scale(0.5) rotate(-90deg);
          /* Alternatively, you can set a new width:
            width: 100px; 
          */
        }
        /* By default, hide animations (unless class is added) */
        opacity: 0;
        transform: translateY(-50px);
       }

        /* Opening animation */
        .opening-animation {
          animation: slideDown 0.4s ease forwards;
        }

        /* Closing animation */
        .closing-animation {
          animation: slideUp 0.4s ease forwards;
        }

        /* The Close Button */
        .close {
          color: #aaa;
          float: right;
          font-size: 28px;
          font-weight: bold;
        }

        .close:hover,
        .close:focus {
          color: black;
          text-decoration: none;
          cursor: pointer;
        }

        /* Full-width inputs */
        input[type=text], input[type=password] {
          width: 100%;
          padding: 12px 20px;
          margin: 12px 0;
          display: inline-block;
          border: 1px solid #ccc;
          box-sizing: border-box;
          border-radius: 12px;
        }

        /* Set a style for all buttons */
        button {
          background-color: #f36f21;
          color: black;
          padding: 14px 20px;
          margin: 8px 0;
          border: none;
          cursor: pointer;
          width: 100%;
        }

        /* Add a hover effect for buttons */
        button:hover {
          opacity: 0.8;
        }

        /* Extra style for the cancel button (red) */
        .cancelbtn {
          width: auto;
          padding: 10px 18px;
          background-color: #f44336;
        }

        /* Center the avatar image inside this container */
        .imgcontainer {
          text-align: center;
          margin: 24px 0 12px 0;
        }

        /* Avatar image */
        img.avatar {
          height: 40px;
        }

        /* Add padding to containers */
        .container {
          padding: 16px;
        }

        /* The "Forgot password" text */
        span.psw {
          float: right;
          padding-top: 16px;
        }

        /* Change styles for span and cancel button on extra small screens */
        @media screen and (max-width: 300px) {
          span.psw {
            display: block;
            float: none;
          }
          .cancelbtn {
            width: 100%;
          }
        }

        /* Style for the logo image */
        .logo {
          width: 200px; /* Adjust the width as needed */
          height: auto;
        }
              /* Base Button Styles */
      .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background:var(--container-bg);
      color: var(--color-text);
      font-size: 14px;
      font-weight: bold;
      border-radius: 12px;
      cursor: pointer;
      height: 45px;
      border: 3px solid var(--color-text);
      margin: auto;
      padding: 0 16px;
      transition: width 0.25s ease, height 0.25s ease, padding 0.25s ease;
      overflow: hidden;
      }
      

      .btn:hover {
      background-color: #e36a1e;
      color: white;
      border: none;
      
      }

      /* Container for Icon and Text */
      .btn .icon-text {
      display: absolute;
      align-items: center;
      justify-content: center;
      transition: opacity 0.25s ease;
      }

      .btn .icon-text i {
      margin-right: 8px;
      }

      /* Wave Spinner Container (hidden by default) */
      .btn .wave-spinner {
      display: none;
      }

      /* Loading State: Button shrinks to a specific size */
      .btn.loading {
      width: 140px;
      height: 60px;
      border-radius: 25px;
      border: none;
      background:var(--container-bg);
      padding: 0; /* Remove extra padding */
      animation: colorTransition 0.5s ease forwards; /* Add color transition */
      }

      /* In Loading State, remove the icon/text and reveal the spinner */
      .btn.loading .icon-text {
      display: none;
      }

      .btn.loading .wave-spinner {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      }

      /* Wave Spinner Dot Styles */
      .wave-spinner {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      }

      .wave-spinner > div {
      width: 6px;
      height: 8px;
      margin: 0 6px;
      border-radius: 20%; /* Rotate to form diamond shape */
      background:var(--container-bg);
      animation: scaling 1.2s ease-in-out infinite;
      }

      /* Set staggered animation delays for a wave effect */
      .wave-spinner > div:nth-child(1) {
      animation-delay: -0.6s;
      }
      .wave-spinner > div:nth-child(2) {
      animation-delay: -0.4s;
      }
      .wave-spinner > div:nth-child(3) {
      animation-delay: -0.2s;
      }
      .wave-spinner > div:nth-child(4) {
      animation-delay: 0s;
      }
      .wave-spinner > div:nth-child(5) {
      animation-delay: 0.2s;
      }

      @keyframes scaling {
        0%, 100% {
          transform: scaleY(0.5);
          background-color: var( --container-bg);
        }
        40% {
          transform: scaleY(1.5);
          background-color: var(--wave-color-40, rgb(255, 160, 105));
        }
        50% {
          transform: scaleY(3);
          background-color: var(--wave-color-50, #f36f21);
        }
      }

      /* Color Transition Animation */
      @keyframes colorTransition {
      0% {
      background-color: #f36f21;
      }
      100% {
      background:var(--container-bg);
      }
      }

      @keyframes successTransition {
        0% {
         background:var(--container-bg);
        }
        50% {
         background:var(--container-bg);
        }
        100% {
          background-color: #28a745;
        }
      }

      /* Success State Styling */
      .btn.success {
        animation: successTransition 0.7s ease forwards;
        background-color: #28a745;  /* Green */
        border: none;
        color: #fff;
      }
      `)),t.appendChild(l)}minimizeAndClose(){const t=document.querySelector(".modal-content");t&&t.classList.add("minimized"),setTimeout(()=>{t&&(t.style.display="none"),document.dispatchEvent(new CustomEvent("login-success"))},1500)}resetSendLinkButton(){const t=this.shadowRoot.getElementById("sendLinkBtn");t.disabled=!1,t.classList.remove("loading","success"),t.innerHTML=this.initialBtnHTML}show(t){console.log("login-dialog show() invoked"),this.content.classList.remove("minimized"),this.onCloseCallback=t,this.style.display="block",this.hidden=!1,this.modal.style.display="block"}close(){console.log("login-dialog close() invoked"),this.modal.style.display="none",this.style.display="none",this.hidden=!0,this.onCloseCallback&&this.onCloseCallback()}}customElements.define("login-dialog",Y4);let Tf=!1;class j4 extends HTMLElement{constructor(){super();At(this,"modal");At(this,"content");At(this,"loadFileCallback");const t=this.attachShadow({mode:"open"});this.modal=document.createElement("div"),this.modal.classList.add("modal"),t.appendChild(this.modal),this.content=document.createElement("div"),this.content.classList.add("modal-content"),this.modal.appendChild(this.content),this.content.innerHTML=`<div id="fileDropZone" class="fixed w-full flex h-screen">
    <input
      accept=".zcad, .gltf, .glb, gltf, .obj"
      multiple
      type="file"
      class="absolute inset-0 z-50 m-0 p-0 w-full h-full outline-none opacity-0"
      id="dropHotSpot"
    />
      <div
        class="border-2 border-gray-400 py-12 justify-center items-center p-4 m-auto rounded-lg w-3/12 h-1/3 bg-gray-200 bg-opacity-25 hover:bg-blue-200 hover:bg-opacity-25 text-black grid justify-items-center"
      >
        <div class="m-auto">
          <div class="flex flex-col space-y-2 items-center justify-center">
            <i class="fas fa-cloud-upload-alt fa-3x text-currentColor" />
            <p class="text-gray-700 text-center">Drag your gltf, obj or zcad files here or click in this area.</p>
          </div>
        </div>
      </div>
  </div>`;const n=l=>{Tf&&this.shadowRoot.getElementById("fileDropZone").classList.remove("pointer-events-none"),l.preventDefault()},a=l=>{l.preventDefault()},s=l=>{if(l.dataTransfer){for(var u=0;u<l.dataTransfer.items.length;u++)if(l.dataTransfer.items[u].kind==="file"){const h=l.dataTransfer.items[u].getAsFile();h&&c(h)}}l.preventDefault()},i=l=>{for(var u=0;u<l.target.files.length;u++){let h=l.target.files[u];c(h)}l.preventDefault()},c=l=>{const u=new FileReader;u.addEventListener("load",()=>{const h=u.result,d=l.name;this.loadFile(h,d)},!1),u.readAsDataURL(l)},f=this.shadowRoot.getElementById("dropHotSpot");f.addEventListener("change",i),f.addEventListener("drop",s),document.body.addEventListener("dragover",a),document.body.addEventListener("dragenter",n),document.body.addEventListener("drop",s);const o=document.createElement("style");o.appendChild(document.createTextNode(`
/* The Modal (background) */
.modal {
  display: block; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content/Box */
.modal-content {
  background-color: #eeeeee88;
  margin: 15% auto; /* 15% from the top and centered */
  padding: 20px;
  border: 1px solid #888;
  width: 80%; /* Could be more or less, depending on screen size */
  max-width: 600px;
}

`)),t.appendChild(o),this.hide()}display(t){this.loadFileCallback=t,this.modal.style.setProperty("pointer-events","auto"),this.modal.style.setProperty("display","block")}hide(){this.modal.style.setProperty("pointer-events","none"),this.modal.style.setProperty("display","none")}loadFile(t,n){this.hide(),Tf=!0,this.loadFileCallback&&this.loadFileCallback(t,n)}}customElements.define("drop-zone",j4);class K4 extends HTMLElement{constructor(){super();const r=this.attachShadow({mode:"open"});r.innerHTML=`
        <style>
          header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: var(--container-bg);
            padding: 10px 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            font-family: sans-serif;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 5px 10px black (0, 0, 0, 0.2);
          }
            .logo-container {
            display: flex;
            align-items: center;
            color: var(--color-text);
            }

          #darkModeToggle {
            margin-left: 10px;
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            transition: transform 0.3s ease;
          }

          #darkModeToggle:hover {
            transform: rotate(20deg) scale(1.2);
          }
            
            @keyframes slideRight {
            to {
                transform: translateX(0) rotate(90);
                opacity: 1;
            }
            }

            .logo {
            height: 40px;
            margin-right: 10px;
            transform: scale(0.5) rotate(-90deg);
            opacity: 0;
            animation: logoScaleIn 1.4s ease forwards;
            }

            @keyframes logoScaleIn {
            to {
                transform: scale(1);
                opacity: 1;
            }
            }
          .header-buttons {
            display: flex;
            gap: 10px;
          }
          /* Style header buttons similar to sendmagiclinkbtn */
          .header-btn {
            background-color: var(--container-bg);
            color: var(--color-text);
            font-size: 14px;
            font-weight: bold;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            padding: 10px 16px;
            transition: background-color 0.25s ease;
          }

          .header-btn:hover {
            background-color: #e36a1e;
            transform: scale(1.1);
            transition: transform 0.1s ease;
            color: white;
          }
          /* Initially hide the logout button; you'll show it when needed */
          .header-btn#logoutButton {
            background-color: red
            color: white;
          }
          .header-btn#logoutButton {
            background-color:rgb(194, 69, 47);  /* or a different base color if you prefer */
            color: white;
            /* Don’t forget the semicolon! */
          }
          .header-btn#logoutButton:hover {
            background-color: darkred; /* or just 'red' if you want no change */
            transform: scale(1.1);
            color: white;
          }
          .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 28px;
            margin-left: 10px;
          }

          .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
          }

          .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0;
            right: 0; bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 34px;
          }

          .slider::before {
            position: absolute;
            content: "☀️";
            height: 22px;
            width: 22px;
            left: 3px;
            bottom: 3px;
            background-color: var(--container-bg);
            border-radius: 50%;
            transition: 0.4s;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
          }

          input:checked + .slider {
            background-color: #555;
          }

          input:checked + .slider::before {
            transform: translateX(22px);
            content: "🌙";
          }

            
        </style>
        <header>
          <div class="logo-container">
            <img src="data/Crescent1.png" alt="Logo" class="logo">
            <span>fettle</span>
            <label class="toggle-switch" title="Toggle Dark Mode">
              <input type="checkbox" id="darkModeToggle" />
              <span class="slider"></span>
            </label>
          </div>
          <div class="header-buttons">
            <button class="header-btn" id="homeButton">Home</button>
            <button class="header-btn" id="goCluster">Cluster</button>
            <button class="header-btn" id="goLogo">Logo</button>
            <button class="header-btn" id="goTreeBOM">TreeBOM</button>
            <button class="header-btn" id="featuresButton">Features</button>
            <button class="header-btn" id="logoutButton">Logout</button>
          </div>
        </header>
      `}connectedCallback(){const r=this.shadowRoot,t=r.getElementById("darkModeToggle"),n=localStorage.getItem("darkMode")==="true";t.checked=n,t.addEventListener("change",()=>{document.dispatchEvent(new CustomEvent("toggleDarkMode"))}),r.getElementById("homeButton").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"home"})),r.getElementById("featuresButton").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"features"})),r.getElementById("goCluster").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"cluster"})),r.getElementById("goTreeBOM").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"treebom"})),r.getElementById("goLogo").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"logo"})),r.getElementById("logoutButton").onclick=()=>document.dispatchEvent(new CustomEvent("navigate",{detail:"logout"}))}}customElements.define("main-header",K4);function Pi(){const e=20+Math.random()*40,r=20+Math.random()*40,t=20+Math.random()*40,n=20+Math.random()*40,a=20+Math.random()*40,s=20+Math.random()*40;return`polygon(
      0% ${e}%,
      15% ${n}%,
      33% ${r}%,
      50% ${a}%,
      66% ${t}%,
      82% ${s}%,
      100% ${e}%,
      100% 100%,
      0 100%
    )`}function Af(){const e=document.body.style,r=Pi(),t=Pi(),n=Pi();e.setProperty("--wave1-clip",r),e.setProperty("--wave2-clip",t),e.setProperty("--wave3-clip",n)}function q4(){Af(),setInterval(Af,3e3)}const v0="RFC3986",_0={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},J4="RFC1738",Z4=Array.isArray,rr=(()=>{const e=[];for(let r=0;r<256;++r)e.push("%"+((r<16?"0":"")+r.toString(16)).toUpperCase());return e})(),Ni=1024,Q4=(e,r,t,n,a)=>{if(e.length===0)return e;let s=e;if(typeof e=="symbol"?s=Symbol.prototype.toString.call(e):typeof e!="string"&&(s=String(e)),t==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});let i="";for(let c=0;c<s.length;c+=Ni){const f=s.length>=Ni?s.slice(c,c+Ni):s,o=[];for(let l=0;l<f.length;++l){let u=f.charCodeAt(l);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||a===J4&&(u===40||u===41)){o[o.length]=f.charAt(l);continue}if(u<128){o[o.length]=rr[u];continue}if(u<2048){o[o.length]=rr[192|u>>6]+rr[128|u&63];continue}if(u<55296||u>=57344){o[o.length]=rr[224|u>>12]+rr[128|u>>6&63]+rr[128|u&63];continue}l+=1,u=65536+((u&1023)<<10|f.charCodeAt(l)&1023),o[o.length]=rr[240|u>>18]+rr[128|u>>12&63]+rr[128|u>>6&63]+rr[128|u&63]}i+=o.join("")}return i};function eA(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function Sf(e,r){if(Z4(e)){const t=[];for(let n=0;n<e.length;n+=1)t.push(r(e[n]));return t}return r(e)}const tA=Object.prototype.hasOwnProperty,lh={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,r){return String(e)+"["+r+"]"},repeat(e){return String(e)}},ar=Array.isArray,rA=Array.prototype.push,uh=function(e,r){rA.apply(e,ar(r)?r:[r])},nA=Date.prototype.toISOString,Xe={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Q4,encodeValuesOnly:!1,format:v0,formatter:_0[v0],indices:!1,serializeDate(e){return nA.call(e)},skipNulls:!1,strictNullHandling:!1};function aA(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const Mi={};function hh(e,r,t,n,a,s,i,c,f,o,l,u,h,d,x,p,m,_){let w=e,v=_,C=0,O=!1;for(;(v=v.get(Mi))!==void 0&&!O;){const z=v.get(e);if(C+=1,typeof z<"u"){if(z===C)throw new RangeError("Cyclic object value");O=!0}typeof v.get(Mi)>"u"&&(C=0)}if(typeof o=="function"?w=o(r,w):w instanceof Date?w=h==null?void 0:h(w):t==="comma"&&ar(w)&&(w=Sf(w,function(z){return z instanceof Date?h==null?void 0:h(z):z})),w===null){if(s)return f&&!p?f(r,Xe.encoder,m,"key",d):r;w=""}if(aA(w)||eA(w)){if(f){const z=p?r:f(r,Xe.encoder,m,"key",d);return[(x==null?void 0:x(z))+"="+(x==null?void 0:x(f(w,Xe.encoder,m,"value",d)))]}return[(x==null?void 0:x(r))+"="+(x==null?void 0:x(String(w)))]}const R=[];if(typeof w>"u")return R;let k;if(t==="comma"&&ar(w))p&&f&&(w=Sf(w,f)),k=[{value:w.length>0?w.join(",")||null:void 0}];else if(ar(o))k=o;else{const z=Object.keys(w);k=l?z.sort(l):z}const U=c?String(r).replace(/\./g,"%2E"):String(r),I=n&&ar(w)&&w.length===1?U+"[]":U;if(a&&ar(w)&&w.length===0)return I+"[]";for(let z=0;z<k.length;++z){const D=k[z],B=typeof D=="object"&&typeof D.value<"u"?D.value:w[D];if(i&&B===null)continue;const Z=u&&c?D.replace(/\./g,"%2E"):D,P=ar(w)?typeof t=="function"?t(I,Z):I:I+(u?"."+Z:"["+Z+"]");_.set(e,C);const j=new WeakMap;j.set(Mi,_),uh(R,hh(B,P,t,n,a,s,i,c,t==="comma"&&p&&ar(w)?null:f,o,l,u,h,d,x,p,m,j))}return R}function sA(e=Xe){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const r=e.charset||Xe.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=v0;if(typeof e.format<"u"){if(!tA.call(_0,e.format))throw new TypeError("Unknown format option provided.");t=e.format}const n=_0[t];let a=Xe.filter;(typeof e.filter=="function"||ar(e.filter))&&(a=e.filter);let s;if(e.arrayFormat&&e.arrayFormat in lh?s=e.arrayFormat:"indices"in e?s=e.indices?"indices":"repeat":s=Xe.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:Xe.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Xe.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Xe.allowEmptyArrays,arrayFormat:s,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Xe.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Xe.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Xe.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Xe.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Xe.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Xe.encodeValuesOnly,filter:a,format:t,formatter:n,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Xe.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Xe.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Xe.strictNullHandling}}function iA(e,r={}){let t=e;const n=sA(r);let a,s;typeof n.filter=="function"?(s=n.filter,t=s("",t)):ar(n.filter)&&(s=n.filter,a=s);const i=[];if(typeof t!="object"||t===null)return"";const c=lh[n.arrayFormat],f=c==="comma"&&n.commaRoundTrip;a||(a=Object.keys(t)),n.sort&&a.sort(n.sort);const o=new WeakMap;for(let h=0;h<a.length;++h){const d=a[h];n.skipNulls&&t[d]===null||uh(i,hh(t[d],d,c,f,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,o))}const l=i.join(n.delimiter);let u=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?u+="utf8=%26%2310003%3B&":u+="utf8=%E2%9C%93&"),l.length>0?u+l:""}const gn="4.90.0";let Ff=!1,ma,dh,xh,w0,ph,mh,gh,vh,_h;function cA(e,r={auto:!1}){if(Ff)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(ma)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${ma}'\``);Ff=r.auto,ma=e.kind,dh=e.fetch,xh=e.FormData,w0=e.File,ph=e.ReadableStream,mh=e.getMultipartRequestOptions,gh=e.getDefaultAgent,vh=e.fileFromPath,_h=e.isFsReadStream}class oA{constructor(r){this.body=r}get[Symbol.toStringTag](){return"MultipartBody"}}function fA({manuallyImported:e}={}){const r=e?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,n,a,s;try{t=fetch,n=Request,a=Response,s=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${r}`)}return{kind:"web",fetch:t,Request:n,Response:a,Headers:s,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${r}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${r}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${r}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${r}`)}},getMultipartRequestOptions:async(i,c)=>({...c,body:new oA(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}const wh=()=>{ma||cA(fA(),{auto:!0})};wh();class de extends Error{}class at extends de{constructor(r,t,n,a){super(`${at.makeMessage(r,t,n)}`),this.status=r,this.headers=a,this.request_id=a==null?void 0:a["x-request-id"],this.error=t;const s=t;this.code=s==null?void 0:s.code,this.param=s==null?void 0:s.param,this.type=s==null?void 0:s.type}static makeMessage(r,t,n){const a=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return r&&a?`${r} ${a}`:r?`${r} status code (no body)`:a||"(no status code or body)"}static generate(r,t,n,a){if(!r||!a)return new ai({message:n,cause:E0(t)});const s=t==null?void 0:t.error;return r===400?new yh(r,s,n,a):r===401?new Eh(r,s,n,a):r===403?new kh(r,s,n,a):r===404?new Th(r,s,n,a):r===409?new Ah(r,s,n,a):r===422?new Sh(r,s,n,a):r===429?new Fh(r,s,n,a):r>=500?new Ch(r,s,n,a):new at(r,s,n,a)}}class Ut extends at{constructor({message:r}={}){super(void 0,void 0,r||"Request was aborted.",void 0)}}class ai extends at{constructor({message:r,cause:t}){super(void 0,void 0,r||"Connection error.",void 0),t&&(this.cause=t)}}class pc extends ai{constructor({message:r}={}){super({message:r??"Request timed out."})}}class yh extends at{}class Eh extends at{}class kh extends at{}class Th extends at{}class Ah extends at{}class Sh extends at{}class Fh extends at{}class Ch extends at{}class bh extends de{constructor(){super("Could not parse response content as the length limit was reached")}}class Rh extends de{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var ss=function(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t},Vr=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},Ft;class si{constructor(){Ft.set(this,void 0),this.buffer=new Uint8Array,ss(this,Ft,null,"f")}decode(r){if(r==null)return[];const t=r instanceof ArrayBuffer?new Uint8Array(r):typeof r=="string"?new TextEncoder().encode(r):r;let n=new Uint8Array(this.buffer.length+t.length);n.set(this.buffer),n.set(t,this.buffer.length),this.buffer=n;const a=[];let s;for(;(s=lA(this.buffer,Vr(this,Ft,"f")))!=null;){if(s.carriage&&Vr(this,Ft,"f")==null){ss(this,Ft,s.index,"f");continue}if(Vr(this,Ft,"f")!=null&&(s.index!==Vr(this,Ft,"f")+1||s.carriage)){a.push(this.decodeText(this.buffer.slice(0,Vr(this,Ft,"f")-1))),this.buffer=this.buffer.slice(Vr(this,Ft,"f")),ss(this,Ft,null,"f");continue}const i=Vr(this,Ft,"f")!==null?s.preceding-1:s.preceding,c=this.decodeText(this.buffer.slice(0,i));a.push(c),this.buffer=this.buffer.slice(s.index),ss(this,Ft,null,"f")}return a}decodeText(r){if(r==null)return"";if(typeof r=="string")return r;if(typeof Buffer<"u"){if(r instanceof Buffer)return r.toString();if(r instanceof Uint8Array)return Buffer.from(r).toString();throw new de(`Unexpected: received non-Uint8Array (${r.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(r instanceof Uint8Array||r instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(r);throw new de(`Unexpected: received non-Uint8Array/ArrayBuffer (${r.constructor.name}) in a web platform. Please report this error.`)}throw new de("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}Ft=new WeakMap;si.NEWLINE_CHARS=new Set([`
`,"\r"]);si.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function lA(e,r){for(let a=r??0;a<e.length;a++){if(e[a]===10)return{preceding:a,index:a+1,carriage:!1};if(e[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function uA(e){for(let n=0;n<e.length-1;n++){if(e[n]===10&&e[n+1]===10||e[n]===13&&e[n+1]===13)return n+2;if(e[n]===13&&e[n+1]===10&&n+3<e.length&&e[n+2]===13&&e[n+3]===10)return n+4}return-1}function Ih(e){if(e[Symbol.asyncIterator])return e;const r=e.getReader();return{async next(){try{const t=await r.read();return t!=null&&t.done&&r.releaseLock(),t}catch(t){throw r.releaseLock(),t}},async return(){const t=r.cancel();return r.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class cr{constructor(r,t){this.iterator=r,this.controller=t}static fromSSEResponse(r,t){let n=!1;async function*a(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let s=!1;try{for await(const i of hA(r,t))if(!s){if(i.data.startsWith("[DONE]")){s=!0;continue}if(i.event===null||i.event.startsWith("response.")||i.event.startsWith("transcript.")){let c;try{c=JSON.parse(i.data)}catch(f){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),f}if(c&&c.error)throw new at(void 0,c.error,void 0,Bh(r.headers));yield c}else{let c;try{c=JSON.parse(i.data)}catch(f){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),f}if(i.event=="error")throw new at(void 0,c.error,c.message,void 0);yield{event:i.event,data:c}}}s=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{s||t.abort()}}return new cr(a,t)}static fromReadableStream(r,t){let n=!1;async function*a(){const i=new si,c=Ih(r);for await(const f of c)for(const o of i.decode(f))yield o;for(const f of i.flush())yield f}async function*s(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let i=!1;try{for await(const c of a())i||c&&(yield JSON.parse(c));i=!0}catch(c){if(c instanceof Error&&c.name==="AbortError")return;throw c}finally{i||t.abort()}}return new cr(s,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const r=[],t=[],n=this.iterator(),a=s=>({next:()=>{if(s.length===0){const i=n.next();r.push(i),t.push(i)}return s.shift()}});return[new cr(()=>a(r),this.controller),new cr(()=>a(t),this.controller)]}toReadableStream(){const r=this;let t;const n=new TextEncoder;return new ph({async start(){t=r[Symbol.asyncIterator]()},async pull(a){try{const{value:s,done:i}=await t.next();if(i)return a.close();const c=n.encode(JSON.stringify(s)+`
`);a.enqueue(c)}catch(s){a.error(s)}},async cancel(){var a;await((a=t.return)==null?void 0:a.call(t))}})}}async function*hA(e,r){if(!e.body)throw r.abort(),new de("Attempted to iterate over a response with no body");const t=new xA,n=new si,a=Ih(e.body);for await(const s of dA(a))for(const i of n.decode(s)){const c=t.decode(i);c&&(yield c)}for(const s of n.flush()){const i=t.decode(s);i&&(yield i)}}async function*dA(e){let r=new Uint8Array;for await(const t of e){if(t==null)continue;const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let a=new Uint8Array(r.length+n.length);a.set(r),a.set(n,r.length),r=a;let s;for(;(s=uA(r))!==-1;)yield r.slice(0,s),r=r.slice(s)}r.length>0&&(yield r)}class xA{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(r){if(r.endsWith("\r")&&(r=r.substring(0,r.length-1)),!r){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(r),r.startsWith(":"))return null;let[t,n,a]=pA(r,":");return a.startsWith(" ")&&(a=a.substring(1)),t==="event"?this.event=a:t==="data"&&this.data.push(a),null}}function pA(e,r){const t=e.indexOf(r);return t!==-1?[e.substring(0,t),r,e.substring(t+r.length)]:[e,"",""]}const Oh=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",Dh=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&ii(e),ii=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",mA=e=>Dh(e)||Oh(e)||_h(e);async function Ph(e,r,t){var a;if(e=await e,Dh(e))return e;if(Oh(e)){const s=await e.blob();r||(r=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=ii(s)?[await s.arrayBuffer()]:[s];return new w0(i,r,t)}const n=await gA(e);if(r||(r=_A(e)??"unknown_file"),!(t!=null&&t.type)){const s=(a=n[0])==null?void 0:a.type;typeof s=="string"&&(t={...t,type:s})}return new w0(n,r,t)}async function gA(e){var t;let r=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)r.push(e);else if(ii(e))r.push(await e.arrayBuffer());else if(wA(e))for await(const n of e)r.push(n);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(t=e==null?void 0:e.constructor)==null?void 0:t.name}; props: ${vA(e)}`);return r}function vA(e){return`[${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}function _A(e){var r;return Li(e.name)||Li(e.filename)||((r=Li(e.path))==null?void 0:r.split(/[\\/]/).pop())}const Li=e=>{if(typeof e=="string")return e;if(typeof Buffer<"u"&&e instanceof Buffer)return String(e)},wA=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",Cf=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",Nn=async e=>{const r=await yA(e.body);return mh(r,e)},yA=async e=>{const r=new xh;return await Promise.all(Object.entries(e||{}).map(([t,n])=>y0(r,t,n))),r},y0=async(e,r,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${r}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")e.append(r,String(t));else if(mA(t)){const n=await Ph(t);e.append(r,n)}else if(Array.isArray(t))await Promise.all(t.map(n=>y0(e,r+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,a])=>y0(e,`${r}[${n}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var An={},EA=function(e,r,t,n,a){if(typeof r=="function"?e!==r||!0:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r.set(e,t),t},kA=function(e,r,t,n){if(typeof r=="function"?e!==r||!0:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},is;wh();async function Nh(e){var i;const{response:r}=e;if(e.options.stream)return Sn("response",r.status,r.url,r.headers,r.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(r,e.controller):cr.fromSSEResponse(r,e.controller);if(r.status===204)return null;if(e.options.__binaryResponse)return r;const t=r.headers.get("content-type"),n=(i=t==null?void 0:t.split(";")[0])==null?void 0:i.trim();if((n==null?void 0:n.includes("application/json"))||(n==null?void 0:n.endsWith("+json"))){const c=await r.json();return Sn("response",r.status,r.url,r.headers,c),Mh(c,r)}const s=await r.text();return Sn("response",r.status,r.url,r.headers,s),s}function Mh(e,r){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:r.headers.get("x-request-id"),enumerable:!1})}class ci extends Promise{constructor(r,t=Nh){super(n=>{n(null)}),this.responsePromise=r,this.parseResponse=t}_thenUnwrap(r){return new ci(this.responsePromise,async t=>Mh(r(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(r=>r.response)}async withResponse(){const[r,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:r,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(r,t){return this.parse().then(r,t)}catch(r){return this.parse().catch(r)}finally(r){return this.parse().finally(r)}}class TA{constructor({baseURL:r,maxRetries:t=2,timeout:n=6e5,httpAgent:a,fetch:s}){this.baseURL=r,this.maxRetries=Bi("maxRetries",t),this.timeout=Bi("timeout",n),this.httpAgent=a,this.fetch=s??dh}authHeaders(r){return{}}defaultHeaders(r){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...bA(),...this.authHeaders(r)}}validateHeaders(r,t){}defaultIdempotencyKey(){return`stainless-node-retry-${DA()}`}get(r,t){return this.methodRequest("get",r,t)}post(r,t){return this.methodRequest("post",r,t)}patch(r,t){return this.methodRequest("patch",r,t)}put(r,t){return this.methodRequest("put",r,t)}delete(r,t){return this.methodRequest("delete",r,t)}methodRequest(r,t,n){return this.request(Promise.resolve(n).then(async a=>{const s=a&&ii(a==null?void 0:a.body)?new DataView(await a.body.arrayBuffer()):(a==null?void 0:a.body)instanceof DataView?a.body:(a==null?void 0:a.body)instanceof ArrayBuffer?new DataView(a.body):a&&ArrayBuffer.isView(a==null?void 0:a.body)?new DataView(a.body.buffer):a==null?void 0:a.body;return{method:r,path:t,...a,body:s}}))}getAPIList(r,t,n){return this.requestAPIList(t,{method:"get",path:r,...n})}calculateContentLength(r){if(typeof r=="string"){if(typeof Buffer<"u")return Buffer.byteLength(r,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(r).length.toString()}else if(ArrayBuffer.isView(r))return r.byteLength.toString();return null}buildRequest(r,{retryCount:t=0}={}){var x;r={...r};const{method:n,path:a,query:s,headers:i={}}=r,c=ArrayBuffer.isView(r.body)||r.__binaryRequest&&typeof r.body=="string"?r.body:Cf(r.body)?r.body.body:r.body?JSON.stringify(r.body,null,2):null,f=this.calculateContentLength(c),o=this.buildURL(a,s);"timeout"in r&&Bi("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const l=r.httpAgent??this.httpAgent??gh(o),u=r.timeout+1e3;typeof((x=l==null?void 0:l.options)==null?void 0:x.timeout)=="number"&&u>(l.options.timeout??0)&&(l.options.timeout=u),this.idempotencyHeader&&n!=="get"&&(r.idempotencyKey||(r.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=r.idempotencyKey);const h=this.buildHeaders({options:r,headers:i,contentLength:f,retryCount:t});return{req:{method:n,...c&&{body:c},headers:h,...l&&{agent:l},signal:r.signal??null},url:o,timeout:r.timeout}}buildHeaders({options:r,headers:t,contentLength:n,retryCount:a}){const s={};n&&(s["content-length"]=n);const i=this.defaultHeaders(r);return Of(s,i),Of(s,t),Cf(r.body)&&ma!=="node"&&delete s["content-type"],os(i,"x-stainless-retry-count")===void 0&&os(t,"x-stainless-retry-count")===void 0&&(s["x-stainless-retry-count"]=String(a)),os(i,"x-stainless-timeout")===void 0&&os(t,"x-stainless-timeout")===void 0&&r.timeout&&(s["x-stainless-timeout"]=String(r.timeout)),this.validateHeaders(s,t),s}async prepareOptions(r){}async prepareRequest(r,{url:t,options:n}){}parseHeaders(r){return r?Symbol.iterator in r?Object.fromEntries(Array.from(r).map(t=>[...t])):{...r}:{}}makeStatusError(r,t,n,a){return at.generate(r,t,n,a)}request(r,t=null){return new ci(this.makeRequest(r,t))}async makeRequest(r,t){var u,h;const n=await r,a=n.maxRetries??this.maxRetries;t==null&&(t=a),await this.prepareOptions(n);const{req:s,url:i,timeout:c}=this.buildRequest(n,{retryCount:a-t});if(await this.prepareRequest(s,{url:i,options:n}),Sn("request",i,n,s.headers),(u=n.signal)!=null&&u.aborted)throw new Ut;const f=new AbortController,o=await this.fetchWithTimeout(i,s,c,f).catch(E0);if(o instanceof Error){if((h=n.signal)!=null&&h.aborted)throw new Ut;if(t)return this.retryRequest(n,t);throw o.name==="AbortError"?new pc:new ai({cause:o})}const l=Bh(o.headers);if(!o.ok){if(t&&this.shouldRetry(o)){const w=`retrying, ${t} attempts remaining`;return Sn(`response (error; ${w})`,o.status,i,l),this.retryRequest(n,t,l)}const d=await o.text().catch(w=>E0(w).message),x=RA(d),p=x?void 0:d;throw Sn(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,o.status,i,l,p),this.makeStatusError(o.status,x,p,l)}return{response:o,options:n,controller:f}}requestAPIList(r,t){const n=this.makeRequest(t,null);return new AA(this,n,r)}buildURL(r,t){const n=OA(r)?new URL(r):new URL(this.baseURL+(this.baseURL.endsWith("/")&&r.startsWith("/")?r.slice(1):r)),a=this.defaultQuery();return Uh(a)||(t={...a,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(r){return Object.entries(r).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new de(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(r,t,n,a){const{signal:s,...i}=t||{};s&&s.addEventListener("abort",()=>a.abort());const c=setTimeout(()=>a.abort(),n),f={signal:a.signal,...i};return f.method&&(f.method=f.method.toUpperCase()),this.fetch.call(void 0,r,f).finally(()=>{clearTimeout(c)})}shouldRetry(r){const t=r.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:r.status===408||r.status===409||r.status===429||r.status>=500}async retryRequest(r,t,n){let a;const s=n==null?void 0:n["retry-after-ms"];if(s){const c=parseFloat(s);Number.isNaN(c)||(a=c)}const i=n==null?void 0:n["retry-after"];if(i&&!a){const c=parseFloat(i);Number.isNaN(c)?a=Date.parse(i)-Date.now():a=c*1e3}if(!(a&&0<=a&&a<60*1e3)){const c=r.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(t,c)}return await Ua(a),this.makeRequest(r,t-1)}calculateDefaultRetryTimeoutMillis(r,t){const s=t-r,i=Math.min(.5*Math.pow(2,s),8),c=1-Math.random()*.25;return i*c*1e3}getUserAgent(){return`${this.constructor.name}/JS ${gn}`}}class Lh{constructor(r,t,n,a){is.set(this,void 0),EA(this,is,r),this.options=a,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const r=this.nextPageInfo();if(!r)throw new de("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in r&&typeof t.query=="object")t.query={...t.query,...r.params};else if("url"in r){const n=[...Object.entries(t.query||{}),...r.url.searchParams.entries()];for(const[a,s]of n)r.url.searchParams.set(a,s);t.query=void 0,t.path=r.url.toString()}return await kA(this,is,"f").requestAPIList(this.constructor,t)}async*iterPages(){let r=this;for(yield r;r.hasNextPage();)r=await r.getNextPage(),yield r}async*[(is=new WeakMap,Symbol.asyncIterator)](){for await(const r of this.iterPages())for(const t of r.getPaginatedItems())yield t}}class AA extends ci{constructor(r,t,n){super(t,async a=>new n(r,a.response,await Nh(a),a.options))}async*[Symbol.asyncIterator](){const r=await this;for await(const t of r)yield t}}const Bh=e=>new Proxy(Object.fromEntries(e.entries()),{get(r,t){const n=t.toString();return r[n.toLowerCase()]||r[n]}}),SA={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},Qe=e=>typeof e=="object"&&e!==null&&!Uh(e)&&Object.keys(e).every(r=>$h(SA,r)),FA=()=>{var r;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":gn,"X-Stainless-OS":Rf(Deno.build.os),"X-Stainless-Arch":bf(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((r=Deno.version)==null?void 0:r.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":gn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":gn,"X-Stainless-OS":Rf(process.platform),"X-Stainless-Arch":bf(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const e=CA();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":gn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":gn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function CA(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:r,pattern:t}of e){const n=t.exec(navigator.userAgent);if(n){const a=n[1]||0,s=n[2]||0,i=n[3]||0;return{browser:r,version:`${a}.${s}.${i}`}}}return null}const bf=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",Rf=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let If;const bA=()=>If??(If=FA()),RA=e=>{try{return JSON.parse(e)}catch{return}},IA=/^[a-z][a-z0-9+.-]*:/i,OA=e=>IA.test(e),Ua=e=>new Promise(r=>setTimeout(r,e)),Bi=(e,r)=>{if(typeof r!="number"||!Number.isInteger(r))throw new de(`${e} must be an integer`);if(r<0)throw new de(`${e} must be a positive integer`);return r},E0=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},cs=e=>{var r,t,n,a;if(typeof process<"u")return((r=An==null?void 0:An[e])==null?void 0:r.trim())??void 0;if(typeof Deno<"u")return(a=(n=(t=Deno.env)==null?void 0:t.get)==null?void 0:n.call(t,e))==null?void 0:a.trim()};function Uh(e){if(!e)return!0;for(const r in e)return!1;return!0}function $h(e,r){return Object.prototype.hasOwnProperty.call(e,r)}function Of(e,r){for(const t in r){if(!$h(r,t))continue;const n=t.toLowerCase();if(!n)continue;const a=r[t];a===null?delete e[n]:a!==void 0&&(e[n]=a)}}const Df=new Set(["authorization","api-key"]);function Sn(e,...r){if(typeof process<"u"&&(An==null?void 0:An.DEBUG)==="true"){const t=r.map(n=>{if(!n)return n;if(n.headers){const s={...n,headers:{...n.headers}};for(const i in n.headers)Df.has(i.toLowerCase())&&(s.headers[i]="REDACTED");return s}let a=null;for(const s in n)Df.has(s.toLowerCase())&&(a??(a={...n}),a[s]="REDACTED");return a??n});console.log(`OpenAI:DEBUG:${e}`,...t)}}const DA=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const r=Math.random()*16|0;return(e==="x"?r:r&3|8).toString(16)}),PA=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",NA=e=>typeof(e==null?void 0:e.get)=="function",os=(e,r)=>{var n;const t=r.toLowerCase();if(NA(e)){const a=((n=r[0])==null?void 0:n.toUpperCase())+r.substring(1).replace(/([^\w])(\w)/g,(s,i,c)=>i+c.toUpperCase());for(const s of[r,t,r.toUpperCase(),a]){const i=e.get(s);if(i)return i}}for(const[a,s]of Object.entries(e))if(a.toLowerCase()===t)return Array.isArray(s)?(s.length<=1||console.warn(`Received ${s.length} entries for the ${r} header, using the first entry.`),s[0]):s};function Ui(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}class mc extends Lh{constructor(r,t,n,a){super(r,t,n,a),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class kt extends Lh{constructor(r,t,n,a){super(r,t,n,a),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const r=this.nextPageInfo();if(!r)return null;if("params"in r)return r.params;const t=Object.fromEntries(r.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var n;const r=this.getPaginatedItems();if(!r.length)return null;const t=(n=r[r.length-1])==null?void 0:n.id;return t?{params:{after:t}}:null}}class Ee{constructor(r){this._client=r}}let Hh=class extends Ee{list(r,t={},n){return Qe(t)?this.list(r,{},t):this._client.getAPIList(`/chat/completions/${r}/messages`,MA,{query:t,...n})}},oi=class extends Ee{constructor(){super(...arguments),this.messages=new Hh(this._client)}create(r,t){return this._client.post("/chat/completions",{body:r,...t,stream:r.stream??!1})}retrieve(r,t){return this._client.get(`/chat/completions/${r}`,t)}update(r,t,n){return this._client.post(`/chat/completions/${r}`,{body:t,...n})}list(r={},t){return Qe(r)?this.list({},r):this._client.getAPIList("/chat/completions",fi,{query:r,...t})}del(r,t){return this._client.delete(`/chat/completions/${r}`,t)}};class fi extends kt{}class MA extends kt{}oi.ChatCompletionsPage=fi;oi.Messages=Hh;let li=class extends Ee{constructor(){super(...arguments),this.completions=new oi(this._client)}};li.Completions=oi;li.ChatCompletionsPage=fi;class Wh extends Ee{create(r,t){return this._client.post("/audio/speech",{body:r,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}class Vh extends Ee{create(r,t){return this._client.post("/audio/transcriptions",Nn({body:r,...t,stream:r.stream??!1,__metadata:{model:r.model}}))}}class Gh extends Ee{create(r,t){return this._client.post("/audio/translations",Nn({body:r,...t,__metadata:{model:r.model}}))}}class $a extends Ee{constructor(){super(...arguments),this.transcriptions=new Vh(this._client),this.translations=new Gh(this._client),this.speech=new Wh(this._client)}}$a.Transcriptions=Vh;$a.Translations=Gh;$a.Speech=Wh;class gc extends Ee{create(r,t){return this._client.post("/batches",{body:r,...t})}retrieve(r,t){return this._client.get(`/batches/${r}`,t)}list(r={},t){return Qe(r)?this.list({},r):this._client.getAPIList("/batches",vc,{query:r,...t})}cancel(r,t){return this._client.post(`/batches/${r}/cancel`,t)}}class vc extends kt{}gc.BatchesPage=vc;class _c extends Ee{create(r,t){return this._client.post("/assistants",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(r,t){return this._client.get(`/assistants/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(r,t,n){return this._client.post(`/assistants/${r}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(r={},t){return Qe(r)?this.list({},r):this._client.getAPIList("/assistants",wc,{query:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(r,t){return this._client.delete(`/assistants/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class wc extends kt{}_c.AssistantsPage=wc;function Pf(e){return typeof e.parse=="function"}const Fn=e=>(e==null?void 0:e.role)==="assistant",zh=e=>(e==null?void 0:e.role)==="function",Xh=e=>(e==null?void 0:e.role)==="tool";var Gt=function(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t},Pe=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},k0,_s,ws,ta,ra,ys,na,vr,aa,Ys,js,vn,Yh;class yc{constructor(){k0.add(this),this.controller=new AbortController,_s.set(this,void 0),ws.set(this,()=>{}),ta.set(this,()=>{}),ra.set(this,void 0),ys.set(this,()=>{}),na.set(this,()=>{}),vr.set(this,{}),aa.set(this,!1),Ys.set(this,!1),js.set(this,!1),vn.set(this,!1),Gt(this,_s,new Promise((r,t)=>{Gt(this,ws,r,"f"),Gt(this,ta,t,"f")}),"f"),Gt(this,ra,new Promise((r,t)=>{Gt(this,ys,r,"f"),Gt(this,na,t,"f")}),"f"),Pe(this,_s,"f").catch(()=>{}),Pe(this,ra,"f").catch(()=>{})}_run(r){setTimeout(()=>{r().then(()=>{this._emitFinal(),this._emit("end")},Pe(this,k0,"m",Yh).bind(this))},0)}_connected(){this.ended||(Pe(this,ws,"f").call(this),this._emit("connect"))}get ended(){return Pe(this,aa,"f")}get errored(){return Pe(this,Ys,"f")}get aborted(){return Pe(this,js,"f")}abort(){this.controller.abort()}on(r,t){return(Pe(this,vr,"f")[r]||(Pe(this,vr,"f")[r]=[])).push({listener:t}),this}off(r,t){const n=Pe(this,vr,"f")[r];if(!n)return this;const a=n.findIndex(s=>s.listener===t);return a>=0&&n.splice(a,1),this}once(r,t){return(Pe(this,vr,"f")[r]||(Pe(this,vr,"f")[r]=[])).push({listener:t,once:!0}),this}emitted(r){return new Promise((t,n)=>{Gt(this,vn,!0,"f"),r!=="error"&&this.once("error",n),this.once(r,t)})}async done(){Gt(this,vn,!0,"f"),await Pe(this,ra,"f")}_emit(r,...t){if(Pe(this,aa,"f"))return;r==="end"&&(Gt(this,aa,!0,"f"),Pe(this,ys,"f").call(this));const n=Pe(this,vr,"f")[r];if(n&&(Pe(this,vr,"f")[r]=n.filter(a=>!a.once),n.forEach(({listener:a})=>a(...t))),r==="abort"){const a=t[0];!Pe(this,vn,"f")&&!(n!=null&&n.length)&&Promise.reject(a),Pe(this,ta,"f").call(this,a),Pe(this,na,"f").call(this,a),this._emit("end");return}if(r==="error"){const a=t[0];!Pe(this,vn,"f")&&!(n!=null&&n.length)&&Promise.reject(a),Pe(this,ta,"f").call(this,a),Pe(this,na,"f").call(this,a),this._emit("end")}}_emitFinal(){}}_s=new WeakMap,ws=new WeakMap,ta=new WeakMap,ra=new WeakMap,ys=new WeakMap,na=new WeakMap,vr=new WeakMap,aa=new WeakMap,Ys=new WeakMap,js=new WeakMap,vn=new WeakMap,k0=new WeakSet,Yh=function(r){if(Gt(this,Ys,!0,"f"),r instanceof Error&&r.name==="AbortError"&&(r=new Ut),r instanceof Ut)return Gt(this,js,!0,"f"),this._emit("abort",r);if(r instanceof de)return this._emit("error",r);if(r instanceof Error){const t=new de(r.message);return t.cause=r,this._emit("error",t)}return this._emit("error",new de(String(r)))};function Ec(e){return(e==null?void 0:e.$brand)==="auto-parseable-response-format"}function Ha(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function LA(e,r){return!r||!jh(r)?{...e,choices:e.choices.map(t=>({...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:kc(e,r)}function kc(e,r){const t=e.choices.map(n=>{var a;if(n.finish_reason==="length")throw new bh;if(n.finish_reason==="content_filter")throw new Rh;return{...n,message:{...n.message,...n.message.tool_calls?{tool_calls:((a=n.message.tool_calls)==null?void 0:a.map(s=>UA(r,s)))??void 0}:void 0,parsed:n.message.content&&!n.message.refusal?BA(r,n.message.content):null}}});return{...e,choices:t}}function BA(e,r){var t,n;return((t=e.response_format)==null?void 0:t.type)!=="json_schema"?null:((n=e.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(r):JSON.parse(r):null}function UA(e,r){var n;const t=(n=e.tools)==null?void 0:n.find(a=>{var s;return((s=a.function)==null?void 0:s.name)===r.function.name});return{...r,function:{...r.function,parsed_arguments:Ha(t)?t.$parseRaw(r.function.arguments):t!=null&&t.function.strict?JSON.parse(r.function.arguments):null}}}function $A(e,r){var n;if(!e)return!1;const t=(n=e.tools)==null?void 0:n.find(a=>{var s;return((s=a.function)==null?void 0:s.name)===r.function.name});return Ha(t)||(t==null?void 0:t.function.strict)||!1}function jh(e){var r;return Ec(e.response_format)?!0:((r=e.tools)==null?void 0:r.some(t=>Ha(t)||t.type==="function"&&t.function.strict===!0))??!1}function HA(e){for(const r of e??[]){if(r.type!=="function")throw new de(`Currently only \`function\` tool types support auto-parsing; Received \`${r.type}\``);if(r.function.strict!==!0)throw new de(`The \`${r.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var wt=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},ct,T0,Ks,A0,S0,F0,Kh,C0;const Nf=10;class qh extends yc{constructor(){super(...arguments),ct.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(r){var n;this._chatCompletions.push(r),this._emit("chatCompletion",r);const t=(n=r.choices[0])==null?void 0:n.message;return t&&this._addMessage(t),r}_addMessage(r,t=!0){if("content"in r||(r.content=null),this.messages.push(r),t){if(this._emit("message",r),(zh(r)||Xh(r))&&r.content)this._emit("functionCallResult",r.content);else if(Fn(r)&&r.function_call)this._emit("functionCall",r.function_call);else if(Fn(r)&&r.tool_calls)for(const n of r.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();const r=this._chatCompletions[this._chatCompletions.length-1];if(!r)throw new de("stream ended without producing a ChatCompletion");return r}async finalContent(){return await this.done(),wt(this,ct,"m",T0).call(this)}async finalMessage(){return await this.done(),wt(this,ct,"m",Ks).call(this)}async finalFunctionCall(){return await this.done(),wt(this,ct,"m",A0).call(this)}async finalFunctionCallResult(){return await this.done(),wt(this,ct,"m",S0).call(this)}async totalUsage(){return await this.done(),wt(this,ct,"m",F0).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const r=this._chatCompletions[this._chatCompletions.length-1];r&&this._emit("finalChatCompletion",r);const t=wt(this,ct,"m",Ks).call(this);t&&this._emit("finalMessage",t);const n=wt(this,ct,"m",T0).call(this);n&&this._emit("finalContent",n);const a=wt(this,ct,"m",A0).call(this);a&&this._emit("finalFunctionCall",a);const s=wt(this,ct,"m",S0).call(this);s!=null&&this._emit("finalFunctionCallResult",s),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",wt(this,ct,"m",F0).call(this))}async _createChatCompletion(r,t,n){const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),wt(this,ct,"m",Kh).call(this,t);const s=await r.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(kc(s,t))}async _runChatCompletion(r,t,n){for(const a of t.messages)this._addMessage(a,!1);return await this._createChatCompletion(r,t,n)}async _runFunctions(r,t,n){var h;const a="function",{function_call:s="auto",stream:i,...c}=t,f=typeof s!="string"&&(s==null?void 0:s.name),{maxChatCompletions:o=Nf}=n||{},l={};for(const d of t.functions)l[d.name||d.function.name]=d;const u=t.functions.map(d=>({name:d.name||d.function.name,parameters:d.parameters,description:d.description}));for(const d of t.messages)this._addMessage(d,!1);for(let d=0;d<o;++d){const p=(h=(await this._createChatCompletion(r,{...c,function_call:s,functions:u,messages:[...this.messages]},n)).choices[0])==null?void 0:h.message;if(!p)throw new de("missing message in ChatCompletion response");if(!p.function_call)return;const{name:m,arguments:_}=p.function_call,w=l[m];if(w){if(f&&f!==m){const R=`Invalid function_call: ${JSON.stringify(m)}. ${JSON.stringify(f)} requested. Please try again`;this._addMessage({role:a,name:m,content:R});continue}}else{const R=`Invalid function_call: ${JSON.stringify(m)}. Available options are: ${u.map(k=>JSON.stringify(k.name)).join(", ")}. Please try again`;this._addMessage({role:a,name:m,content:R});continue}let v;try{v=Pf(w)?await w.parse(_):_}catch(R){this._addMessage({role:a,name:m,content:R instanceof Error?R.message:String(R)});continue}const C=await w.function(v,this),O=wt(this,ct,"m",C0).call(this,C);if(this._addMessage({role:a,name:m,content:O}),f)return}}async _runTools(r,t,n){var d,x,p;const a="tool",{tool_choice:s="auto",stream:i,...c}=t,f=typeof s!="string"&&((d=s==null?void 0:s.function)==null?void 0:d.name),{maxChatCompletions:o=Nf}=n||{},l=t.tools.map(m=>{if(Ha(m)){if(!m.$callback)throw new de("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:m.$callback,name:m.function.name,description:m.function.description||"",parameters:m.function.parameters,parse:m.$parseRaw,strict:!0}}}return m}),u={};for(const m of l)m.type==="function"&&(u[m.function.name||m.function.function.name]=m.function);const h="tools"in t?l.map(m=>m.type==="function"?{type:"function",function:{name:m.function.name||m.function.function.name,parameters:m.function.parameters,description:m.function.description,strict:m.function.strict}}:m):void 0;for(const m of t.messages)this._addMessage(m,!1);for(let m=0;m<o;++m){const w=(x=(await this._createChatCompletion(r,{...c,tool_choice:s,tools:h,messages:[...this.messages]},n)).choices[0])==null?void 0:x.message;if(!w)throw new de("missing message in ChatCompletion response");if(!((p=w.tool_calls)!=null&&p.length))return;for(const v of w.tool_calls){if(v.type!=="function")continue;const C=v.id,{name:O,arguments:R}=v.function,k=u[O];if(k){if(f&&f!==O){const D=`Invalid tool_call: ${JSON.stringify(O)}. ${JSON.stringify(f)} requested. Please try again`;this._addMessage({role:a,tool_call_id:C,content:D});continue}}else{const D=`Invalid tool_call: ${JSON.stringify(O)}. Available options are: ${Object.keys(u).map(B=>JSON.stringify(B)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:C,content:D});continue}let U;try{U=Pf(k)?await k.parse(R):R}catch(D){const B=D instanceof Error?D.message:String(D);this._addMessage({role:a,tool_call_id:C,content:B});continue}const I=await k.function(U,this),z=wt(this,ct,"m",C0).call(this,I);if(this._addMessage({role:a,tool_call_id:C,content:z}),f)return}}}}ct=new WeakSet,T0=function(){return wt(this,ct,"m",Ks).call(this).content??null},Ks=function(){let r=this.messages.length;for(;r-- >0;){const t=this.messages[r];if(Fn(t)){const{function_call:n,...a}=t,s={...a,content:t.content??null,refusal:t.refusal??null};return n&&(s.function_call=n),s}}throw new de("stream ended without producing a ChatCompletionMessage with role=assistant")},A0=function(){var r,t;for(let n=this.messages.length-1;n>=0;n--){const a=this.messages[n];if(Fn(a)&&(a!=null&&a.function_call))return a.function_call;if(Fn(a)&&((r=a==null?void 0:a.tool_calls)!=null&&r.length))return(t=a.tool_calls.at(-1))==null?void 0:t.function}},S0=function(){for(let r=this.messages.length-1;r>=0;r--){const t=this.messages[r];if(zh(t)&&t.content!=null||Xh(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var a;return n.role==="assistant"&&((a=n.tool_calls)==null?void 0:a.some(s=>s.type==="function"&&s.id===t.tool_call_id))}))return t.content}},F0=function(){const r={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(r.completion_tokens+=t.completion_tokens,r.prompt_tokens+=t.prompt_tokens,r.total_tokens+=t.total_tokens);return r},Kh=function(r){if(r.n!=null&&r.n>1)throw new de("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},C0=function(r){return typeof r=="string"?r:r===void 0?"undefined":JSON.stringify(r)};class ba extends qh{static runFunctions(r,t,n){const a=new ba,s={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(r,t,s)),a}static runTools(r,t,n){const a=new ba,s={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(r,t,s)),a}_addMessage(r,t=!0){super._addMessage(r,t),Fn(r)&&r.content&&this._emit("content",r.content)}}const Jh=1,Zh=2,Qh=4,ed=8,td=16,rd=32,nd=64,ad=128,sd=256,id=ad|sd,cd=td|rd|id|nd,od=Jh|Zh|cd,fd=Qh|ed,WA=od|fd,qe={STR:Jh,NUM:Zh,ARR:Qh,OBJ:ed,NULL:td,BOOL:rd,NAN:nd,INFINITY:ad,MINUS_INFINITY:sd,INF:id,SPECIAL:cd,ATOM:od,COLLECTION:fd,ALL:WA};class VA extends Error{}class GA extends Error{}function zA(e,r=qe.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return XA(e.trim(),r)}const XA=(e,r)=>{const t=e.length;let n=0;const a=h=>{throw new VA(`${h} at position ${n}`)},s=h=>{throw new GA(`${h} at position ${n}`)},i=()=>(u(),n>=t&&a("Unexpected end of input"),e[n]==='"'?c():e[n]==="{"?f():e[n]==="["?o():e.substring(n,n+4)==="null"||qe.NULL&r&&t-n<4&&"null".startsWith(e.substring(n))?(n+=4,null):e.substring(n,n+4)==="true"||qe.BOOL&r&&t-n<4&&"true".startsWith(e.substring(n))?(n+=4,!0):e.substring(n,n+5)==="false"||qe.BOOL&r&&t-n<5&&"false".startsWith(e.substring(n))?(n+=5,!1):e.substring(n,n+8)==="Infinity"||qe.INFINITY&r&&t-n<8&&"Infinity".startsWith(e.substring(n))?(n+=8,1/0):e.substring(n,n+9)==="-Infinity"||qe.MINUS_INFINITY&r&&1<t-n&&t-n<9&&"-Infinity".startsWith(e.substring(n))?(n+=9,-1/0):e.substring(n,n+3)==="NaN"||qe.NAN&r&&t-n<3&&"NaN".startsWith(e.substring(n))?(n+=3,NaN):l()),c=()=>{const h=n;let d=!1;for(n++;n<t&&(e[n]!=='"'||d&&e[n-1]==="\\");)d=e[n]==="\\"?!d:!1,n++;if(e.charAt(n)=='"')try{return JSON.parse(e.substring(h,++n-Number(d)))}catch(x){s(String(x))}else if(qe.STR&r)try{return JSON.parse(e.substring(h,n-Number(d))+'"')}catch{return JSON.parse(e.substring(h,e.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},f=()=>{n++,u();const h={};try{for(;e[n]!=="}";){if(u(),n>=t&&qe.OBJ&r)return h;const d=c();u(),n++;try{const x=i();Object.defineProperty(h,d,{value:x,writable:!0,enumerable:!0,configurable:!0})}catch(x){if(qe.OBJ&r)return h;throw x}u(),e[n]===","&&n++}}catch{if(qe.OBJ&r)return h;a("Expected '}' at end of object")}return n++,h},o=()=>{n++;const h=[];try{for(;e[n]!=="]";)h.push(i()),u(),e[n]===","&&n++}catch{if(qe.ARR&r)return h;a("Expected ']' at end of array")}return n++,h},l=()=>{if(n===0){e==="-"&&qe.NUM&r&&a("Not sure what '-' is");try{return JSON.parse(e)}catch(d){if(qe.NUM&r)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}s(String(d))}}const h=n;for(e[n]==="-"&&n++;e[n]&&!",]}".includes(e[n]);)n++;n==t&&!(qe.NUM&r)&&a("Unterminated number literal");try{return JSON.parse(e.substring(h,n))}catch{e.substring(h,n)==="-"&&qe.NUM&r&&a("Not sure what '-' is");try{return JSON.parse(e.substring(h,e.lastIndexOf("e")))}catch(x){s(String(x))}}},u=()=>{for(;n<t&&` 
\r	`.includes(e[n]);)n++};return i()},Mf=e=>zA(e,qe.ALL^qe.NUM);var hn=function(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t},Ce=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},ze,gr,dn,br,$i,fs,Hi,Wi,Vi,ls,Gi,Lf;class Ra extends qh{constructor(r){super(),ze.add(this),gr.set(this,void 0),dn.set(this,void 0),br.set(this,void 0),hn(this,gr,r,"f"),hn(this,dn,[],"f")}get currentChatCompletionSnapshot(){return Ce(this,br,"f")}static fromReadableStream(r){const t=new Ra(null);return t._run(()=>t._fromReadableStream(r)),t}static createChatCompletion(r,t,n){const a=new Ra(t);return a._run(()=>a._runChatCompletion(r,{...t,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(r,t,n){var i;super._createChatCompletion;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Ce(this,ze,"m",$i).call(this);const s=await r.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const c of s)Ce(this,ze,"m",Hi).call(this,c);if((i=s.controller.signal)!=null&&i.aborted)throw new Ut;return this._addChatCompletion(Ce(this,ze,"m",ls).call(this))}async _fromReadableStream(r,t){var i;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),Ce(this,ze,"m",$i).call(this),this._connected();const a=cr.fromReadableStream(r,this.controller);let s;for await(const c of a)s&&s!==c.id&&this._addChatCompletion(Ce(this,ze,"m",ls).call(this)),Ce(this,ze,"m",Hi).call(this,c),s=c.id;if((i=a.controller.signal)!=null&&i.aborted)throw new Ut;return this._addChatCompletion(Ce(this,ze,"m",ls).call(this))}[(gr=new WeakMap,dn=new WeakMap,br=new WeakMap,ze=new WeakSet,$i=function(){this.ended||hn(this,br,void 0,"f")},fs=function(t){let n=Ce(this,dn,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Ce(this,dn,"f")[t.index]=n,n)},Hi=function(t){var a,s,i,c,f,o,l,u,h,d,x,p,m,_,w;if(this.ended)return;const n=Ce(this,ze,"m",Lf).call(this,t);this._emit("chunk",t,n);for(const v of t.choices){const C=n.choices[v.index];v.delta.content!=null&&((a=C.message)==null?void 0:a.role)==="assistant"&&((s=C.message)!=null&&s.content)&&(this._emit("content",v.delta.content,C.message.content),this._emit("content.delta",{delta:v.delta.content,snapshot:C.message.content,parsed:C.message.parsed})),v.delta.refusal!=null&&((i=C.message)==null?void 0:i.role)==="assistant"&&((c=C.message)!=null&&c.refusal)&&this._emit("refusal.delta",{delta:v.delta.refusal,snapshot:C.message.refusal}),((f=v.logprobs)==null?void 0:f.content)!=null&&((o=C.message)==null?void 0:o.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(l=v.logprobs)==null?void 0:l.content,snapshot:((u=C.logprobs)==null?void 0:u.content)??[]}),((h=v.logprobs)==null?void 0:h.refusal)!=null&&((d=C.message)==null?void 0:d.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(x=v.logprobs)==null?void 0:x.refusal,snapshot:((p=C.logprobs)==null?void 0:p.refusal)??[]});const O=Ce(this,ze,"m",fs).call(this,C);C.finish_reason&&(Ce(this,ze,"m",Vi).call(this,C),O.current_tool_call_index!=null&&Ce(this,ze,"m",Wi).call(this,C,O.current_tool_call_index));for(const R of v.delta.tool_calls??[])O.current_tool_call_index!==R.index&&(Ce(this,ze,"m",Vi).call(this,C),O.current_tool_call_index!=null&&Ce(this,ze,"m",Wi).call(this,C,O.current_tool_call_index)),O.current_tool_call_index=R.index;for(const R of v.delta.tool_calls??[]){const k=(m=C.message.tool_calls)==null?void 0:m[R.index];k!=null&&k.type&&((k==null?void 0:k.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(_=k.function)==null?void 0:_.name,index:R.index,arguments:k.function.arguments,parsed_arguments:k.function.parsed_arguments,arguments_delta:((w=R.function)==null?void 0:w.arguments)??""}):(k==null||k.type,void 0))}}},Wi=function(t,n){var i,c,f;if(Ce(this,ze,"m",fs).call(this,t).done_tool_calls.has(n))return;const s=(i=t.message.tool_calls)==null?void 0:i[n];if(!s)throw new Error("no tool call snapshot");if(!s.type)throw new Error("tool call snapshot missing `type`");if(s.type==="function"){const o=(f=(c=Ce(this,gr,"f"))==null?void 0:c.tools)==null?void 0:f.find(l=>l.type==="function"&&l.function.name===s.function.name);this._emit("tool_calls.function.arguments.done",{name:s.function.name,index:n,arguments:s.function.arguments,parsed_arguments:Ha(o)?o.$parseRaw(s.function.arguments):o!=null&&o.function.strict?JSON.parse(s.function.arguments):null})}else s.type},Vi=function(t){var a,s;const n=Ce(this,ze,"m",fs).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const i=Ce(this,ze,"m",Gi).call(this);this._emit("content.done",{content:t.message.content,parsed:i?i.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(a=t.logprobs)!=null&&a.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(s=t.logprobs)!=null&&s.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},ls=function(){if(this.ended)throw new de("stream has ended, this shouldn't happen");const t=Ce(this,br,"f");if(!t)throw new de("request ended without sending any chunks");return hn(this,br,void 0,"f"),hn(this,dn,[],"f"),YA(t,Ce(this,gr,"f"))},Gi=function(){var n;const t=(n=Ce(this,gr,"f"))==null?void 0:n.response_format;return Ec(t)?t:null},Lf=function(t){var n,a,s,i;let c=Ce(this,br,"f");const{choices:f,...o}=t;c?Object.assign(c,o):c=hn(this,br,{...o,choices:[]},"f");for(const{delta:l,finish_reason:u,index:h,logprobs:d=null,...x}of t.choices){let p=c.choices[h];if(p||(p=c.choices[h]={finish_reason:u,index:h,message:{},logprobs:d,...x}),d)if(!p.logprobs)p.logprobs=Object.assign({},d);else{const{content:R,refusal:k,...U}=d;Object.assign(p.logprobs,U),R&&((n=p.logprobs).content??(n.content=[]),p.logprobs.content.push(...R)),k&&((a=p.logprobs).refusal??(a.refusal=[]),p.logprobs.refusal.push(...k))}if(u&&(p.finish_reason=u,Ce(this,gr,"f")&&jh(Ce(this,gr,"f")))){if(u==="length")throw new bh;if(u==="content_filter")throw new Rh}if(Object.assign(p,x),!l)continue;const{content:m,refusal:_,function_call:w,role:v,tool_calls:C,...O}=l;if(Object.assign(p.message,O),_&&(p.message.refusal=(p.message.refusal||"")+_),v&&(p.message.role=v),w&&(p.message.function_call?(w.name&&(p.message.function_call.name=w.name),w.arguments&&((s=p.message.function_call).arguments??(s.arguments=""),p.message.function_call.arguments+=w.arguments)):p.message.function_call=w),m&&(p.message.content=(p.message.content||"")+m,!p.message.refusal&&Ce(this,ze,"m",Gi).call(this)&&(p.message.parsed=Mf(p.message.content))),C){p.message.tool_calls||(p.message.tool_calls=[]);for(const{index:R,id:k,type:U,function:I,...z}of C){const D=(i=p.message.tool_calls)[R]??(i[R]={});Object.assign(D,z),k&&(D.id=k),U&&(D.type=U),I&&(D.function??(D.function={name:I.name??"",arguments:""})),I!=null&&I.name&&(D.function.name=I.name),I!=null&&I.arguments&&(D.function.arguments+=I.arguments,$A(Ce(this,gr,"f"),D)&&(D.function.parsed_arguments=Mf(D.function.arguments)))}}}return c},Symbol.asyncIterator)](){const r=[],t=[];let n=!1;return this.on("chunk",a=>{const s=t.shift();s?s.resolve(a):r.push(a)}),this.on("end",()=>{n=!0;for(const a of t)a.resolve(void 0);t.length=0}),this.on("abort",a=>{n=!0;for(const s of t)s.reject(a);t.length=0}),this.on("error",a=>{n=!0;for(const s of t)s.reject(a);t.length=0}),{next:async()=>r.length?{value:r.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((s,i)=>t.push({resolve:s,reject:i})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new cr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function YA(e,r){const{id:t,choices:n,created:a,model:s,system_fingerprint:i,...c}=e,f={...c,id:t,choices:n.map(({message:o,finish_reason:l,index:u,logprobs:h,...d})=>{if(!l)throw new de(`missing finish_reason for choice ${u}`);const{content:x=null,function_call:p,tool_calls:m,..._}=o,w=o.role;if(!w)throw new de(`missing role for choice ${u}`);if(p){const{arguments:v,name:C}=p;if(v==null)throw new de(`missing function_call.arguments for choice ${u}`);if(!C)throw new de(`missing function_call.name for choice ${u}`);return{...d,message:{content:x,function_call:{arguments:v,name:C},role:w,refusal:o.refusal??null},finish_reason:l,index:u,logprobs:h}}return m?{...d,index:u,finish_reason:l,logprobs:h,message:{..._,role:w,content:x,refusal:o.refusal??null,tool_calls:m.map((v,C)=>{const{function:O,type:R,id:k,...U}=v,{arguments:I,name:z,...D}=O||{};if(k==null)throw new de(`missing choices[${u}].tool_calls[${C}].id
${us(e)}`);if(R==null)throw new de(`missing choices[${u}].tool_calls[${C}].type
${us(e)}`);if(z==null)throw new de(`missing choices[${u}].tool_calls[${C}].function.name
${us(e)}`);if(I==null)throw new de(`missing choices[${u}].tool_calls[${C}].function.arguments
${us(e)}`);return{...U,id:k,type:R,function:{...D,name:z,arguments:I}}})}}:{...d,message:{..._,content:x,role:w,refusal:o.refusal??null},finish_reason:l,index:u,logprobs:h}}),created:a,model:s,object:"chat.completion",...i?{system_fingerprint:i}:{}};return LA(f,r)}function us(e){return JSON.stringify(e)}class Cn extends Ra{static fromReadableStream(r){const t=new Cn(null);return t._run(()=>t._fromReadableStream(r)),t}static runFunctions(r,t,n){const a=new Cn(null),s={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(r,t,s)),a}static runTools(r,t,n){const a=new Cn(t),s={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(r,t,s)),a}}let ld=class extends Ee{parse(r,t){return HA(r.tools),this._client.chat.completions.create(r,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>kc(n,r))}runFunctions(r,t){return r.stream?Cn.runFunctions(this._client,r,t):ba.runFunctions(this._client,r,t)}runTools(r,t){return r.stream?Cn.runTools(this._client,r,t):ba.runTools(this._client,r,t)}stream(r,t){return Ra.createChatCompletion(this._client,r,t)}};class b0 extends Ee{constructor(){super(...arguments),this.completions=new ld(this._client)}}(function(e){e.Completions=ld})(b0||(b0={}));class ud extends Ee{create(r,t){return this._client.post("/realtime/sessions",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class hd extends Ee{create(r,t){return this._client.post("/realtime/transcription_sessions",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class ui extends Ee{constructor(){super(...arguments),this.sessions=new ud(this._client),this.transcriptionSessions=new hd(this._client)}}ui.Sessions=ud;ui.TranscriptionSessions=hd;var he=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},St=function(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t},et,R0,sr,Es,zt,Kr,wn,Xr,qs,Ct,ks,Ts,ga,sa,ia,Bf,Uf,$f,Hf,Wf,Vf,Gf;class qt extends yc{constructor(){super(...arguments),et.add(this),R0.set(this,[]),sr.set(this,{}),Es.set(this,{}),zt.set(this,void 0),Kr.set(this,void 0),wn.set(this,void 0),Xr.set(this,void 0),qs.set(this,void 0),Ct.set(this,void 0),ks.set(this,void 0),Ts.set(this,void 0),ga.set(this,void 0)}[(R0=new WeakMap,sr=new WeakMap,Es=new WeakMap,zt=new WeakMap,Kr=new WeakMap,wn=new WeakMap,Xr=new WeakMap,qs=new WeakMap,Ct=new WeakMap,ks=new WeakMap,Ts=new WeakMap,ga=new WeakMap,et=new WeakSet,Symbol.asyncIterator)](){const r=[],t=[];let n=!1;return this.on("event",a=>{const s=t.shift();s?s.resolve(a):r.push(a)}),this.on("end",()=>{n=!0;for(const a of t)a.resolve(void 0);t.length=0}),this.on("abort",a=>{n=!0;for(const s of t)s.reject(a);t.length=0}),this.on("error",a=>{n=!0;for(const s of t)s.reject(a);t.length=0}),{next:async()=>r.length?{value:r.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((s,i)=>t.push({resolve:s,reject:i})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(r){const t=new qt;return t._run(()=>t._fromReadableStream(r)),t}async _fromReadableStream(r,t){var s;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=cr.fromReadableStream(r,this.controller);for await(const i of a)he(this,et,"m",sa).call(this,i);if((s=a.controller.signal)!=null&&s.aborted)throw new Ut;return this._addRun(he(this,et,"m",ia).call(this))}toReadableStream(){return new cr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(r,t,n,a,s){const i=new qt;return i._run(()=>i._runToolAssistantStream(r,t,n,a,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(r,t,n,a,s){var o;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const c={...a,stream:!0},f=await r.submitToolOutputs(t,n,c,{...s,signal:this.controller.signal});this._connected();for await(const l of f)he(this,et,"m",sa).call(this,l);if((o=f.controller.signal)!=null&&o.aborted)throw new Ut;return this._addRun(he(this,et,"m",ia).call(this))}static createThreadAssistantStream(r,t,n){const a=new qt;return a._run(()=>a._threadAssistantStream(r,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(r,t,n,a){const s=new qt;return s._run(()=>s._runAssistantStream(r,t,n,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),s}currentEvent(){return he(this,ks,"f")}currentRun(){return he(this,Ts,"f")}currentMessageSnapshot(){return he(this,zt,"f")}currentRunStepSnapshot(){return he(this,ga,"f")}async finalRunSteps(){return await this.done(),Object.values(he(this,sr,"f"))}async finalMessages(){return await this.done(),Object.values(he(this,Es,"f"))}async finalRun(){if(await this.done(),!he(this,Kr,"f"))throw Error("Final run was not received.");return he(this,Kr,"f")}async _createThreadAssistantStream(r,t,n){var c;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const s={...t,stream:!0},i=await r.createAndRun(s,{...n,signal:this.controller.signal});this._connected();for await(const f of i)he(this,et,"m",sa).call(this,f);if((c=i.controller.signal)!=null&&c.aborted)throw new Ut;return this._addRun(he(this,et,"m",ia).call(this))}async _createAssistantStream(r,t,n,a){var f;const s=a==null?void 0:a.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},c=await r.create(t,i,{...a,signal:this.controller.signal});this._connected();for await(const o of c)he(this,et,"m",sa).call(this,o);if((f=c.controller.signal)!=null&&f.aborted)throw new Ut;return this._addRun(he(this,et,"m",ia).call(this))}static accumulateDelta(r,t){for(const[n,a]of Object.entries(t)){if(!r.hasOwnProperty(n)){r[n]=a;continue}let s=r[n];if(s==null){r[n]=a;continue}if(n==="index"||n==="type"){r[n]=a;continue}if(typeof s=="string"&&typeof a=="string")s+=a;else if(typeof s=="number"&&typeof a=="number")s+=a;else if(Ui(s)&&Ui(a))s=this.accumulateDelta(s,a);else if(Array.isArray(s)&&Array.isArray(a)){if(s.every(i=>typeof i=="string"||typeof i=="number")){s.push(...a);continue}for(const i of a){if(!Ui(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const c=i.index;if(c==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof c!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${c}`);const f=s[c];f==null?s.push(i):s[c]=this.accumulateDelta(f,i)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${a}, accValue: ${s}`);r[n]=s}return r}_addRun(r){return r}async _threadAssistantStream(r,t,n){return await this._createThreadAssistantStream(t,r,n)}async _runAssistantStream(r,t,n,a){return await this._createAssistantStream(t,r,n,a)}async _runToolAssistantStream(r,t,n,a,s){return await this._createToolAssistantStream(n,r,t,a,s)}}sa=function(r){if(!this.ended)switch(St(this,ks,r,"f"),he(this,et,"m",$f).call(this,r),r.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":he(this,et,"m",Gf).call(this,r);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":he(this,et,"m",Uf).call(this,r);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":he(this,et,"m",Bf).call(this,r);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},ia=function(){if(this.ended)throw new de("stream has ended, this shouldn't happen");if(!he(this,Kr,"f"))throw Error("Final run has not been received");return he(this,Kr,"f")},Bf=function(r){const[t,n]=he(this,et,"m",Wf).call(this,r,he(this,zt,"f"));St(this,zt,t,"f"),he(this,Es,"f")[t.id]=t;for(const a of n){const s=t.content[a.index];(s==null?void 0:s.type)=="text"&&this._emit("textCreated",s.text)}switch(r.event){case"thread.message.created":this._emit("messageCreated",r.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",r.data.delta,t),r.data.delta.content)for(const a of r.data.delta.content){if(a.type=="text"&&a.text){let s=a.text,i=t.content[a.index];if(i&&i.type=="text")this._emit("textDelta",s,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=he(this,wn,"f")){if(he(this,Xr,"f"))switch(he(this,Xr,"f").type){case"text":this._emit("textDone",he(this,Xr,"f").text,he(this,zt,"f"));break;case"image_file":this._emit("imageFileDone",he(this,Xr,"f").image_file,he(this,zt,"f"));break}St(this,wn,a.index,"f")}St(this,Xr,t.content[a.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(he(this,wn,"f")!==void 0){const a=r.data.content[he(this,wn,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,he(this,zt,"f"));break;case"text":this._emit("textDone",a.text,he(this,zt,"f"));break}}he(this,zt,"f")&&this._emit("messageDone",r.data),St(this,zt,void 0,"f")}},Uf=function(r){const t=he(this,et,"m",Hf).call(this,r);switch(St(this,ga,t,"f"),r.event){case"thread.run.step.created":this._emit("runStepCreated",r.data);break;case"thread.run.step.delta":const n=r.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const s of n.step_details.tool_calls)s.index==he(this,qs,"f")?this._emit("toolCallDelta",s,t.step_details.tool_calls[s.index]):(he(this,Ct,"f")&&this._emit("toolCallDone",he(this,Ct,"f")),St(this,qs,s.index,"f"),St(this,Ct,t.step_details.tool_calls[s.index],"f"),he(this,Ct,"f")&&this._emit("toolCallCreated",he(this,Ct,"f")));this._emit("runStepDelta",r.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":St(this,ga,void 0,"f"),r.data.step_details.type=="tool_calls"&&he(this,Ct,"f")&&(this._emit("toolCallDone",he(this,Ct,"f")),St(this,Ct,void 0,"f")),this._emit("runStepDone",r.data,t);break}},$f=function(r){he(this,R0,"f").push(r),this._emit("event",r)},Hf=function(r){switch(r.event){case"thread.run.step.created":return he(this,sr,"f")[r.data.id]=r.data,r.data;case"thread.run.step.delta":let t=he(this,sr,"f")[r.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=r.data;if(n.delta){const a=qt.accumulateDelta(t,n.delta);he(this,sr,"f")[r.data.id]=a}return he(this,sr,"f")[r.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":he(this,sr,"f")[r.data.id]=r.data;break}if(he(this,sr,"f")[r.data.id])return he(this,sr,"f")[r.data.id];throw new Error("No snapshot available")},Wf=function(r,t){let n=[];switch(r.event){case"thread.message.created":return[r.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=r.data;if(a.delta.content)for(const s of a.delta.content)if(s.index in t.content){let i=t.content[s.index];t.content[s.index]=he(this,et,"m",Vf).call(this,s,i)}else t.content[s.index]=s,n.push(s);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Vf=function(r,t){return qt.accumulateDelta(t,r)},Gf=function(r){switch(St(this,Ts,r.data,"f"),r.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":St(this,Kr,r.data,"f"),he(this,Ct,"f")&&(this._emit("toolCallDone",he(this,Ct,"f")),St(this,Ct,void 0,"f"));break}};class Tc extends Ee{create(r,t,n){return this._client.post(`/threads/${r}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(r,t,n){return this._client.get(`/threads/${r}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(r,t,n,a){return this._client.post(`/threads/${r}/messages/${t}`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(r,t={},n){return Qe(t)?this.list(r,{},t):this._client.getAPIList(`/threads/${r}/messages`,Ac,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(r,t,n){return this._client.delete(`/threads/${r}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Ac extends kt{}Tc.MessagesPage=Ac;class Sc extends Ee{retrieve(r,t,n,a={},s){return Qe(a)?this.retrieve(r,t,n,{},a):this._client.get(`/threads/${r}/runs/${t}/steps/${n}`,{query:a,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(r,t,n={},a){return Qe(n)?this.list(r,t,{},n):this._client.getAPIList(`/threads/${r}/runs/${t}/steps`,Fc,{query:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class Fc extends kt{}Sc.RunStepsPage=Fc;class Wa extends Ee{constructor(){super(...arguments),this.steps=new Sc(this._client)}create(r,t,n){const{include:a,...s}=t;return this._client.post(`/threads/${r}/runs`,{query:{include:a},body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}retrieve(r,t,n){return this._client.get(`/threads/${r}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(r,t,n,a){return this._client.post(`/threads/${r}/runs/${t}`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(r,t={},n){return Qe(t)?this.list(r,{},t):this._client.getAPIList(`/threads/${r}/runs`,Cc,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(r,t,n){return this._client.post(`/threads/${r}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(r,t,n){const a=await this.create(r,t,n);return await this.poll(r,a.id,n)}createAndStream(r,t,n){return qt.createAssistantStream(r,this._client.beta.threads.runs,t,n)}async poll(r,t,n){const a={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:s,response:i}=await this.retrieve(r,t,{...n,headers:{...n==null?void 0:n.headers,...a}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let c=5e3;if(n!=null&&n.pollIntervalMs)c=n.pollIntervalMs;else{const f=i.headers.get("openai-poll-after-ms");if(f){const o=parseInt(f);isNaN(o)||(c=o)}}await Ua(c);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(r,t,n){return qt.createAssistantStream(r,this._client.beta.threads.runs,t,n)}submitToolOutputs(r,t,n,a){return this._client.post(`/threads/${r}/runs/${t}/submit_tool_outputs`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(r,t,n,a){const s=await this.submitToolOutputs(r,t,n,a);return await this.poll(r,s.id,a)}submitToolOutputsStream(r,t,n,a){return qt.createToolAssistantStream(r,t,this._client.beta.threads.runs,n,a)}}class Cc extends kt{}Wa.RunsPage=Cc;Wa.Steps=Sc;Wa.RunStepsPage=Fc;class Un extends Ee{constructor(){super(...arguments),this.runs=new Wa(this._client),this.messages=new Tc(this._client)}create(r={},t){return Qe(r)?this.create({},r):this._client.post("/threads",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(r,t){return this._client.get(`/threads/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(r,t,n){return this._client.post(`/threads/${r}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(r,t){return this._client.delete(`/threads/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(r,t){return this._client.post("/threads/runs",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:r.stream??!1})}async createAndRunPoll(r,t){const n=await this.createAndRun(r,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(r,t){return qt.createThreadAssistantStream(r,this._client.beta.threads,t)}}Un.Runs=Wa;Un.RunsPage=Cc;Un.Messages=Tc;Un.MessagesPage=Ac;class $n extends Ee{constructor(){super(...arguments),this.realtime=new ui(this._client),this.chat=new b0(this._client),this.assistants=new _c(this._client),this.threads=new Un(this._client)}}$n.Realtime=ui;$n.Assistants=_c;$n.AssistantsPage=wc;$n.Threads=Un;class dd extends Ee{create(r,t){return this._client.post("/completions",{body:r,...t,stream:r.stream??!1})}}class xd extends Ee{create(r,t){return this._client.post("/embeddings",{body:r,...t})}}let bc=class extends Ee{create(r,t){return this._client.post("/files",Nn({body:r,...t}))}retrieve(r,t){return this._client.get(`/files/${r}`,t)}list(r={},t){return Qe(r)?this.list({},r):this._client.getAPIList("/files",Rc,{query:r,...t})}del(r,t){return this._client.delete(`/files/${r}`,t)}content(r,t){return this._client.get(`/files/${r}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(r,t){return this._client.get(`/files/${r}/content`,t)}async waitForProcessing(r,{pollInterval:t=5e3,maxWait:n=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),s=Date.now();let i=await this.retrieve(r);for(;!i.status||!a.has(i.status);)if(await Ua(t),i=await this.retrieve(r),Date.now()-s>n)throw new pc({message:`Giving up on waiting for file ${r} to finish processing after ${n} milliseconds.`});return i}};class Rc extends kt{}bc.FileObjectsPage=Rc;class Ic extends Ee{list(r,t={},n){return Qe(t)?this.list(r,{},t):this._client.getAPIList(`/fine_tuning/jobs/${r}/checkpoints`,Oc,{query:t,...n})}}class Oc extends kt{}Ic.FineTuningJobCheckpointsPage=Oc;class Hn extends Ee{constructor(){super(...arguments),this.checkpoints=new Ic(this._client)}create(r,t){return this._client.post("/fine_tuning/jobs",{body:r,...t})}retrieve(r,t){return this._client.get(`/fine_tuning/jobs/${r}`,t)}list(r={},t){return Qe(r)?this.list({},r):this._client.getAPIList("/fine_tuning/jobs",Dc,{query:r,...t})}cancel(r,t){return this._client.post(`/fine_tuning/jobs/${r}/cancel`,t)}listEvents(r,t={},n){return Qe(t)?this.listEvents(r,{},t):this._client.getAPIList(`/fine_tuning/jobs/${r}/events`,Pc,{query:t,...n})}}class Dc extends kt{}class Pc extends kt{}Hn.FineTuningJobsPage=Dc;Hn.FineTuningJobEventsPage=Pc;Hn.Checkpoints=Ic;Hn.FineTuningJobCheckpointsPage=Oc;class Va extends Ee{constructor(){super(...arguments),this.jobs=new Hn(this._client)}}Va.Jobs=Hn;Va.FineTuningJobsPage=Dc;Va.FineTuningJobEventsPage=Pc;class pd extends Ee{createVariation(r,t){return this._client.post("/images/variations",Nn({body:r,...t}))}edit(r,t){return this._client.post("/images/edits",Nn({body:r,...t}))}generate(r,t){return this._client.post("/images/generations",{body:r,...t})}}class Nc extends Ee{retrieve(r,t){return this._client.get(`/models/${r}`,t)}list(r){return this._client.getAPIList("/models",Mc,r)}del(r,t){return this._client.delete(`/models/${r}`,t)}}class Mc extends mc{}Nc.ModelsPage=Mc;class md extends Ee{create(r,t){return this._client.post("/moderations",{body:r,...t})}}function jA(e,r){return!r||!qA(r)?{...e,output_parsed:null,output:e.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(n=>({...n,parsed:null}))}:t)}:gd(e,r)}function gd(e,r){const t=e.output.map(a=>{if(a.type==="function_call")return{...a,parsed_arguments:QA(r,a)};if(a.type==="message"){const s=a.content.map(i=>i.type==="output_text"?{...i,parsed:KA(r,i.text)}:i);return{...a,content:s}}return a}),n=Object.assign({},e,{output:t});return Object.getOwnPropertyDescriptor(e,"output_text")||vd(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(const a of n.output)if(a.type==="message"){for(const s of a.content)if(s.type==="output_text"&&s.parsed!==null)return s.parsed}return null}}),n}function KA(e,r){var t,n,a,s;return((n=(t=e.text)==null?void 0:t.format)==null?void 0:n.type)!=="json_schema"?null:"$parseRaw"in((a=e.text)==null?void 0:a.format)?((s=e.text)==null?void 0:s.format).$parseRaw(r):JSON.parse(r)}function qA(e){var r;return!!Ec((r=e.text)==null?void 0:r.format)}function JA(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function ZA(e,r){return e.find(t=>t.type==="function"&&t.name===r)}function QA(e,r){const t=ZA(e.tools??[],r.name);return{...r,...r,parsed_arguments:JA(t)?t.$parseRaw(r.arguments):t!=null&&t.strict?JSON.parse(r.arguments):null}}function vd(e){const r=[];for(const t of e.output)if(t.type==="message")for(const n of t.content)n.type==="output_text"&&r.push(n.text);e.output_text=r.join("")}class _d extends Ee{list(r,t={},n){return Qe(t)?this.list(r,{},t):this._client.getAPIList(`/responses/${r}/input_items`,tS,{query:t,...n})}}var xn=function(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t},Rr=function(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)},pn,hs,Ir,ds,zf,Xf,Yf,jf;class Lc extends yc{constructor(r){super(),pn.add(this),hs.set(this,void 0),Ir.set(this,void 0),ds.set(this,void 0),xn(this,hs,r,"f")}static createResponse(r,t,n){const a=new Lc(t);return a._run(()=>a._createResponse(r,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createResponse(r,t,n){var i;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Rr(this,pn,"m",zf).call(this);const s=await r.responses.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const c of s)Rr(this,pn,"m",Xf).call(this,c);if((i=s.controller.signal)!=null&&i.aborted)throw new Ut;return Rr(this,pn,"m",Yf).call(this)}[(hs=new WeakMap,Ir=new WeakMap,ds=new WeakMap,pn=new WeakSet,zf=function(){this.ended||xn(this,Ir,void 0,"f")},Xf=function(t){if(this.ended)return;const n=Rr(this,pn,"m",jf).call(this,t);switch(this._emit("event",t),t.type){case"response.output_text.delta":{const a=n.output[t.output_index];if(!a)throw new de(`missing output at index ${t.output_index}`);if(a.type==="message"){const s=a.content[t.content_index];if(!s)throw new de(`missing content at index ${t.content_index}`);if(s.type!=="output_text")throw new de(`expected content to be 'output_text', got ${s.type}`);this._emit("response.output_text.delta",{...t,snapshot:s.text})}break}case"response.function_call_arguments.delta":{const a=n.output[t.output_index];if(!a)throw new de(`missing output at index ${t.output_index}`);a.type==="function_call"&&this._emit("response.function_call_arguments.delta",{...t,snapshot:a.arguments});break}default:this._emit(t.type,t);break}},Yf=function(){if(this.ended)throw new de("stream has ended, this shouldn't happen");const t=Rr(this,Ir,"f");if(!t)throw new de("request ended without sending any events");xn(this,Ir,void 0,"f");const n=eS(t,Rr(this,hs,"f"));return xn(this,ds,n,"f"),n},jf=function(t){let n=Rr(this,Ir,"f");if(!n){if(t.type!=="response.created")throw new de(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return n=xn(this,Ir,t.response,"f"),n}switch(t.type){case"response.output_item.added":{n.output.push(t.item);break}case"response.content_part.added":{const a=n.output[t.output_index];if(!a)throw new de(`missing output at index ${t.output_index}`);a.type==="message"&&a.content.push(t.part);break}case"response.output_text.delta":{const a=n.output[t.output_index];if(!a)throw new de(`missing output at index ${t.output_index}`);if(a.type==="message"){const s=a.content[t.content_index];if(!s)throw new de(`missing content at index ${t.content_index}`);if(s.type!=="output_text")throw new de(`expected content to be 'output_text', got ${s.type}`);s.text+=t.delta}break}case"response.function_call_arguments.delta":{const a=n.output[t.output_index];if(!a)throw new de(`missing output at index ${t.output_index}`);a.type==="function_call"&&(a.arguments+=t.delta);break}case"response.completed":{xn(this,Ir,t.response,"f");break}}return n},Symbol.asyncIterator)](){const r=[],t=[];let n=!1;return this.on("event",a=>{const s=t.shift();s?s.resolve(a):r.push(a)}),this.on("end",()=>{n=!0;for(const a of t)a.resolve(void 0);t.length=0}),this.on("abort",a=>{n=!0;for(const s of t)s.reject(a);t.length=0}),this.on("error",a=>{n=!0;for(const s of t)s.reject(a);t.length=0}),{next:async()=>r.length?{value:r.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((s,i)=>t.push({resolve:s,reject:i})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const r=Rr(this,ds,"f");if(!r)throw new de("stream ended without producing a ChatCompletion");return r}}function eS(e,r){return jA(e,r)}class Bc extends Ee{constructor(){super(...arguments),this.inputItems=new _d(this._client)}create(r,t){return this._client.post("/responses",{body:r,...t,stream:r.stream??!1})._thenUnwrap(n=>("object"in n&&n.object==="response"&&vd(n),n))}retrieve(r,t={},n){return Qe(t)?this.retrieve(r,{},t):this._client.get(`/responses/${r}`,{query:t,...n})}del(r,t){return this._client.delete(`/responses/${r}`,{...t,headers:{Accept:"*/*",...t==null?void 0:t.headers}})}parse(r,t){return this._client.responses.create(r,t)._thenUnwrap(n=>gd(n,r))}stream(r,t){return Lc.createResponse(this._client,r,t)}}class tS extends kt{}Bc.InputItems=_d;class wd extends Ee{create(r,t,n){return this._client.post(`/uploads/${r}/parts`,Nn({body:t,...n}))}}class Uc extends Ee{constructor(){super(...arguments),this.parts=new wd(this._client)}create(r,t){return this._client.post("/uploads",{body:r,...t})}cancel(r,t){return this._client.post(`/uploads/${r}/cancel`,t)}complete(r,t,n){return this._client.post(`/uploads/${r}/complete`,{body:t,...n})}}Uc.Parts=wd;const rS=async e=>{const r=await Promise.allSettled(e),t=r.filter(a=>a.status==="rejected");if(t.length){for(const a of t)console.error(a.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const n=[];for(const a of r)a.status==="fulfilled"&&n.push(a.value);return n};class hi extends Ee{create(r,t,n){return this._client.post(`/vector_stores/${r}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(r,t,n){return this._client.get(`/vector_stores/${r}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(r,t,n,a){return this._client.post(`/vector_stores/${r}/files/${t}`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(r,t={},n){return Qe(t)?this.list(r,{},t):this._client.getAPIList(`/vector_stores/${r}/files`,di,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(r,t,n){return this._client.delete(`/vector_stores/${r}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(r,t,n){const a=await this.create(r,t,n);return await this.poll(r,a.id,n)}async poll(r,t,n){const a={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const s=await this.retrieve(r,t,{...n,headers:a}).withResponse(),i=s.data;switch(i.status){case"in_progress":let c=5e3;if(n!=null&&n.pollIntervalMs)c=n.pollIntervalMs;else{const f=s.response.headers.get("openai-poll-after-ms");if(f){const o=parseInt(f);isNaN(o)||(c=o)}}await Ua(c);break;case"failed":case"completed":return i}}}async upload(r,t,n){const a=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(r,{file_id:a.id},n)}async uploadAndPoll(r,t,n){const a=await this.upload(r,t,n);return await this.poll(r,a.id,n)}content(r,t,n){return this._client.getAPIList(`/vector_stores/${r}/files/${t}/content`,$c,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class di extends kt{}class $c extends mc{}hi.VectorStoreFilesPage=di;hi.FileContentResponsesPage=$c;class yd extends Ee{create(r,t,n){return this._client.post(`/vector_stores/${r}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(r,t,n){return this._client.get(`/vector_stores/${r}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(r,t,n){return this._client.post(`/vector_stores/${r}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(r,t,n){const a=await this.create(r,t);return await this.poll(r,a.id,n)}listFiles(r,t,n={},a){return Qe(n)?this.listFiles(r,t,{},n):this._client.getAPIList(`/vector_stores/${r}/file_batches/${t}/files`,di,{query:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async poll(r,t,n){const a={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:s,response:i}=await this.retrieve(r,t,{...n,headers:a}).withResponse();switch(s.status){case"in_progress":let c=5e3;if(n!=null&&n.pollIntervalMs)c=n.pollIntervalMs;else{const f=i.headers.get("openai-poll-after-ms");if(f){const o=parseInt(f);isNaN(o)||(c=o)}}await Ua(c);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(r,{files:t,fileIds:n=[]},a){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const s=(a==null?void 0:a.maxConcurrency)??5,i=Math.min(s,t.length),c=this._client,f=t.values(),o=[...n];async function l(h){for(let d of h){const x=await c.files.create({file:d,purpose:"assistants"},a);o.push(x.id)}}const u=Array(i).fill(f).map(l);return await rS(u),await this.createAndPoll(r,{file_ids:o})}}class Ur extends Ee{constructor(){super(...arguments),this.files=new hi(this._client),this.fileBatches=new yd(this._client)}create(r,t){return this._client.post("/vector_stores",{body:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(r,t){return this._client.get(`/vector_stores/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(r,t,n){return this._client.post(`/vector_stores/${r}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(r={},t){return Qe(r)?this.list({},r):this._client.getAPIList("/vector_stores",Hc,{query:r,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(r,t){return this._client.delete(`/vector_stores/${r}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}search(r,t,n){return this._client.getAPIList(`/vector_stores/${r}/search`,Wc,{body:t,method:"post",...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Hc extends kt{}class Wc extends mc{}Ur.VectorStoresPage=Hc;Ur.VectorStoreSearchResponsesPage=Wc;Ur.Files=hi;Ur.VectorStoreFilesPage=di;Ur.FileContentResponsesPage=$c;Ur.FileBatches=yd;var Ed;class ve extends TA{constructor({baseURL:r=cs("OPENAI_BASE_URL"),apiKey:t=cs("OPENAI_API_KEY"),organization:n=cs("OPENAI_ORG_ID")??null,project:a=cs("OPENAI_PROJECT_ID")??null,...s}={}){if(t===void 0)throw new de("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const i={apiKey:t,organization:n,project:a,...s,baseURL:r||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&PA())throw new de(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new dd(this),this.chat=new li(this),this.embeddings=new xd(this),this.files=new bc(this),this.images=new pd(this),this.audio=new $a(this),this.moderations=new md(this),this.models=new Nc(this),this.fineTuning=new Va(this),this.vectorStores=new Ur(this),this.beta=new $n(this),this.batches=new gc(this),this.uploads=new Uc(this),this.responses=new Bc(this),this._options=i,this.apiKey=t,this.organization=n,this.project=a}defaultQuery(){return this._options.defaultQuery}defaultHeaders(r){return{...super.defaultHeaders(r),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(r){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(r){return iA(r,{arrayFormat:"brackets"})}}Ed=ve;ve.OpenAI=Ed;ve.DEFAULT_TIMEOUT=6e5;ve.OpenAIError=de;ve.APIError=at;ve.APIConnectionError=ai;ve.APIConnectionTimeoutError=pc;ve.APIUserAbortError=Ut;ve.NotFoundError=Th;ve.ConflictError=Ah;ve.RateLimitError=Fh;ve.BadRequestError=yh;ve.AuthenticationError=Eh;ve.InternalServerError=Ch;ve.PermissionDeniedError=kh;ve.UnprocessableEntityError=Sh;ve.toFile=Ph;ve.fileFromPath=vh;ve.Completions=dd;ve.Chat=li;ve.ChatCompletionsPage=fi;ve.Embeddings=xd;ve.Files=bc;ve.FileObjectsPage=Rc;ve.Images=pd;ve.Audio=$a;ve.Moderations=md;ve.Models=Nc;ve.ModelsPage=Mc;ve.FineTuning=Va;ve.VectorStores=Ur;ve.VectorStoresPage=Hc;ve.VectorStoreSearchResponsesPage=Wc;ve.Beta=$n;ve.Batches=gc;ve.BatchesPage=vc;ve.Uploads=Uc;ve.Responses=Bc;const Vc=new ve({apiKey:void 0,dangerouslyAllowBrowser:!0});async function nS(e,r,t,n){let a="";if(n){const f="fileSearch";r(f,`[FileSearch] Searching in "${n}" for context...`);try{const o=await Vc.responses.create({model:"gpt-4o-mini",input:`Summarize any relevant info about: ${e}`,tools:[{type:"file_search",vector_store_ids:[n]}]});t(f,`[FileSearch] Done searching in "${n}".`),a=o.output_text||""}catch(o){t(f,`[FileSearch] Failed: ${String(o)}`)}}const s="planProject";r(s,"[planProject] Requesting project plan...");const i=await aS(e,a);t(s,"[planProject] Plan generated & parsed.");const c={};for(const f of i){const o=`generateFile:${f.filePath}`;r(o,`[Orchestrator] Generating file "${f.filePath}"...`);const l=await sS(f,a);t(o,`[Orchestrator] Finished "${f.filePath}".`),c[f.filePath]=l}return c}async function aS(e,r){console.log("[planProject] Sending request to openai.responses.create...");const t=`
      You are an expert architect.
      The user wants: "${e}"
  
      Additional reference info (if any):
      ${r}
  
      Please return a JSON array describing each needed file (filePath + short description).
      Keep it minimal if the user asked for a small project, or more thorough if complex.
      If it is an Azure Python function, etc...
    `,n=await Vc.responses.create({model:"o3-mini",input:t,reasoning:{effort:"medium"}});console.log("[planProject] Raw response from OpenAI:",n);let a=[];try{const s=n.output_text;a=JSON.parse(s),console.log("[planProject] Successfully parsed response:",a)}catch(s){console.warn("[planProject] Failed to parse JSON. Using fallback plan. Error:",s),a=[{filePath:"index.html",description:"Front-end HTML"},{filePath:"index.ts",description:"Front-end TS logic"},{filePath:"azure-functions/__init__.py",description:"Azure Function entry point"}]}return a}async function sS(e,r){console.log("[generateOneFile] Requesting content for:",e.filePath);const t=`
      You are a code generator. 
      The user also provided extra reference info:
      ${r}
  
      Generate the file: "${e.filePath}" 
      Description: ${e.description}
      Return ONLY the file content, no extra commentary.
    `,n=await Vc.responses.create({model:"o3-mini",input:t,reasoning:{effort:"high"}});return console.log("[generateOneFile] Raw file content from OpenAI:",n),(n.output_text||"").trim()}class iS extends HTMLElement{constructor(){super();At(this,"shadow");At(this,"stepCards",new Map);this.shadow=this.attachShadow({mode:"open"}),this.shadow.innerHTML=`
      <style>
        .cluster-container {
          display: flex;
          flex-direction: column;
          padding: 16px;
          font-family: sans-serif;
        }
        .actions {
          margin-top: 12px;
          display: flex;
          flex-wrap: wrap;
          align-items: center;
          gap: 8px; /* spacing between elements */
          width: auto;
        }
        .results {
          margin-top: 16px;
          white-space: pre-wrap;
          font-size: 0.9rem;
          background: #f7f7f7;
          padding: 12px;
          border-radius: 6px;
        }
        button {
          background-color: var(--container-bg);
          color: var(--color-text);
          font-size: 14px;
          font-weight: bold;
          border: black 3px solid;
          border-radius: 12px;
          cursor: pointer;
          transform: scale(0.9);
          padding: 10px 16px;
          transition: background-color 0.25s ease;
        }
        button:hover {
          background-color: #e36a1e;
          border: #e36a1e 3px solid;
          transform: scale(1);
          transition: transform 0.1s ease;
          color: white;
        }

        /* NEW: styling the selector to match your button look. */
        select.store-selector {
          background-color: var(--container-bg);
          color: var(--color-text);
          font-size: 14px;
          font-weight: bold;
          border: black 3px solid;
          border-radius: 12px;
          cursor: pointer;
          transform: scale(0.9);
          padding: 8px 16px;
          transition: background-color 0.25s ease;
        }
        select.store-selector:hover {
          background-color: #e36a1e;
          border: #e36a1e 3px solid;
          transform: scale(1);
          transition: transform 0.1s ease;
          color: white;
        }

        textarea {
          width: 100%;
          padding: 12px;
          min-height: 100px;
        }
        .download-buttons {
          margin-top: 16px;
        }

        /* Carousel: new cards on the left, older cards fade out right */
        .carousel {
          display: flex;
          flex-direction: row;
          overflow-x: auto;
          gap: 16px;
          margin-top: 16px;
          padding-bottom: 8px;
          overflow-x: hidden;
        }
        .log-card {
          min-width: 240px;
          background: var(--container-bg);
          border-radius: 8px;
          box-shadow: 0 2px 4px rgba(0,0,0,0.15);
          flex-shrink: 0;
          padding: 12px;
          display: flex;
          flex-direction: row;
          align-items: center;
          transition: opacity 0.6s ease;
        }
        .pulse-hex {
          width: 60px;
          height: 60px;
          margin-right: 12px;
        }
        .log-text {
          font-size: 0.85rem;
          color: var(--color-text);
          line-height: 1.4;
          display: inline-block;
        }
        /* Wave animation (continuous) */
        @keyframes waveUpDown {
          0%, 100% { transform: translateY(0); }
          50%      { transform: translateY(-8px); }
        }
        .wave-char {
          display: inline-block;
          animation: waveUpDown 1s ease-in-out infinite;
        }
        /* On finish, we transition from mid-wave back to baseline */
        @keyframes waveFadeOut {
          from { transform: translateY(-8px); }
          to   { transform: translateY(0); }
        }
        .wave-char-final {
          display: inline-block;
          animation: waveFadeOut 0.4s ease forwards;
        }

        /* Pulse for the hex polygons */
        @keyframes flashOrange {
          0%, 100% { fill: var(--original-fill); transform: scale(1); }
          50%      { fill: var(--container-bg); transform: scale(1); }
        }
        .pulse {
          animation: flashOrange 1.2s ease-in-out infinite;
        }
      </style>

      <div class="cluster-container">
        <h2>Cluster Page</h2>
        <p>Describe your desired project:</p>
        <textarea id="projectDescription"
          placeholder="e.g., 'Build a TS/HTML web app with Azure Function backend...'">
        </textarea>

        <div class="actions">
          <!-- NEW: File store selector -->
          <select class="store-selector" id="storeSelector">
            <option value="">Select a Vector</option>
            <option value="vector_store_1">Vector Store 1 UI ONLY</option>
            <option value="vector_store_2">Vector Store 2 UI ONLY</option>
            <option value="vector_store_3">Vector Store 3 UI ONLY</option>
          </select>

          <button id="generateBtn">Generate Project</button>
        </div>

        <div class="carousel" id="logCarousel"></div>
        <div class="results" id="results"></div>
        <div class="download-buttons" id="downloadButtons"></div>
      </div>
    `}connectedCallback(){this.shadow.getElementById("generateBtn").addEventListener("click",()=>this.onGenerateProject())}async onGenerateProject(){const t=this.shadow.getElementById("projectDescription"),n=this.shadow.getElementById("results"),a=this.shadow.getElementById("downloadButtons"),s=this.shadow.getElementById("logCarousel"),c=this.shadow.getElementById("storeSelector").value;n.innerText="",a.innerHTML="",s.innerHTML="",this.stepCards.clear();const f=t.value.trim();if(!f){n.innerText="Please provide a project description.";return}n.innerText=`Generating project...
`;try{const o=await nS(f,(u,h)=>this.startLogCard(u,h),(u,h)=>this.finishLogCard(u,h),c);n.innerText=`Project successfully generated!

Files:`;const l=Object.keys(o);l.forEach(u=>{n.innerText+=`
- ${u}`}),l.forEach(u=>{const h=o[u],d=document.createElement("button");d.innerText=`Download ${u}`,d.addEventListener("click",()=>{const x=new Blob([h],{type:"text/plain"}),p=URL.createObjectURL(x),m=document.createElement("a");m.href=p,m.download=u,m.click(),URL.revokeObjectURL(p)}),a.appendChild(d)})}catch(o){n.innerText=`Error: ${o}`}}startLogCard(t,n){const a=this.shadow.getElementById("logCarousel"),s=n.replace(/\[.*?\]\s*/g,""),i=this.createWaveText(s),c=document.createElement("div");c.classList.add("log-card");const f=this.createPulseHex(),o=document.createElement("div");o.classList.add("log-text"),o.appendChild(i),c.appendChild(f),c.appendChild(o),a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c),this.stepCards.set(t,c),this.updateCardOpacity()}finishLogCard(t,n){const a=this.stepCards.get(t);if(!a)return;const s=n.replace(/\[.*?\]\s*/g,""),i=this.createWaveText(s,!1),c=a.querySelector(".log-text");c&&(c.innerHTML="",c.appendChild(i)),a.querySelectorAll("polygon").forEach(o=>{o.classList.remove("pulse")})}createPulseHex(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.setAttribute("viewBox","0 0 200 200"),t.classList.add("pulse-hex"),[{points:"100,100 152,70   152,130",fill:"#EA3546"},{points:"100,100 152,130  100,160",fill:"#EA3546"},{points:"100,100 100,160  48,130",fill:"#FABF35"},{points:"100,100 48,130   48,70",fill:"#FABF35"},{points:"100,100 48,70    100,40",fill:"#345995"},{points:"100,100 100,40   152,70",fill:"#345995"}].forEach((a,s)=>{const i=document.createElementNS("http://www.w3.org/2000/svg","polygon");i.setAttribute("points",a.points),i.setAttribute("fill",a.fill),i.style.setProperty("--original-fill",a.fill),i.style.setProperty("--color-bg","#FFF"),i.classList.add("pulse"),i.style.animationDelay=`${s*.1}s`,t.appendChild(i)}),t}createWaveText(t,n=!0){const a=document.createElement("span");return t.split("").forEach((s,i)=>{const c=document.createElement("span");if(c.textContent=s,s.trim()===""){a.appendChild(c);return}n?(c.classList.add("wave-char"),c.style.animationDelay=`${i*.01}s`):c.classList.add("wave-char-final"),a.appendChild(c)}),a}updateCardOpacity(){const t=this.shadow.getElementById("logCarousel");Array.from(t.querySelectorAll(".log-card")).forEach((a,s)=>{const i=1-s*.15,c=Math.max(.3,i);a.style.opacity=String(c)})}}customElements.define("cluster-page",iS);const cS=750,oS=0;class fS extends HTMLElement{constructor(){super();At(this,"shadow");this.shadow=this.attachShadow({mode:"open"}),this.shadow.innerHTML=`
      <style>
        .cluster-container {
          display: flex;
          flex-direction: column;
          padding: 16px;
          font-family: sans-serif;
          align-items: center;
          max-height: 90vh;
          overflow-y: auto;
          overflow-x: hidden;
        }

        .logo-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
          gap: 24px;
          width: 100%;
          justify-items: center;
          align-items: center;
          padding: 16px;
          overflow-y: auto;
          overflow-x: hidden;
        }

        .logo-wrapper svg {
          width: 200px;
          height: 200px;
          margin: 20px auto;
        }
        .logo-wrapper:hover {
          transform: scale(1.1) rotate(10deg);
        }

        polygon {
          transform-origin: 100px 100px;
          transition: fill 0.3s ease;
        }

        @keyframes flashOrange {
          0%, 100% { fill: var(--original-fill); transform: scale(1);}
          50%      { fill: var(--color-bg); transform: scale(1); }
        }
        
        @keyframes rotateColors {
          0%   { fill: var(--c0); }
          16%  { fill: var(--c5); }
          33%  { fill: var(--c4); }
          50%  { fill: var(--c3); }
          66%  { fill: var(--c2); }
          83%  { fill: var(--c1); }
          100% { fill: var(--c0); }
        }

        .rotate {
          animation: rotateColors 2.4s linear 3;
        }

        .pulse {
          animation: flashOrange 1.2s ease-in-out 3;
        }
        @keyframes groupPulse {
          0%, 100% {
            transform: translate(0, 0);
          }
          50% {
            transform: var(--move);
          }
        }

        .group-animate {
          animation: groupPulse 1.5s ease-in-out 3;
        }
      </style>

      <div class="cluster-container">
        <h2>Logo Page</h2>
            <div class="logo-grid">
              <div class="logo-wrapper"></div>
              <div class="logo-wrapper"></div>
              <div class="logo-wrapper"></div>
              <div class="logo-wrapper"></div> <!-- New one -->
            </div>
      </div>
    `}connectedCallback(){this.loadSVG().then(()=>{this.shadow.querySelectorAll(".logo-wrapper").forEach(t=>{t.addEventListener("click",()=>{const n=t.querySelectorAll("polygon");n.forEach(a=>{const s=a.classList,i=s.contains("pulse"),c=s.contains("rotate"),f=s.contains("group-animate");a.classList.remove("pulse","rotate","group-animate"),a.getBoundingClientRect().width,i&&a.classList.add("pulse"),c&&a.classList.add("rotate"),f&&[[0,1],[2,3],[4,5]].forEach((l,u)=>{l.forEach((h,d)=>{const x=u*cS+d*oS;setTimeout(()=>{n[h].classList.add("group-animate")},x)})})})})})})}async loadSVG(){try{const n=await(await fetch("./data/hexlogo.html")).text(),i=new DOMParser().parseFromString(n,"text/html").querySelector("svg"),c=this.shadow.querySelectorAll(".logo-wrapper");if(i&&c[0]){const f=i.cloneNode(!0);c[0].appendChild(f),f.querySelectorAll("polygon").forEach((l,u)=>{const h=l.getAttribute("fill")||"#000";l.style.setProperty("--original-fill",h),l.classList.add("pulse"),l.style.animationDelay=`${u*.4}s`})}if(i&&c[1]){const f=i.cloneNode(!0);c[1].appendChild(f);const o=f.querySelectorAll("polygon"),l=["#EA3546","#EA3546","#FABF35","#FABF35","#345995","#345995"];o.forEach((u,h)=>{u.style.setProperty("--c0",l[h%6]),u.style.setProperty("--c1",l[(h+1)%6]),u.style.setProperty("--c2",l[(h+2)%6]),u.style.setProperty("--c3",l[(h+3)%6]),u.style.setProperty("--c4",l[(h+4)%6]),u.style.setProperty("--c5",l[(h+5)%6]),u.classList.add("rotate")})}if(i&&c[2]){const f=i.cloneNode(!0);c[2].appendChild(f),f.querySelectorAll("polygon").forEach((l,u)=>{const h=l.getAttribute("fill")||"#000";l.style.setProperty("--original-fill",h),l.classList.add("pulse");const d=Math.floor(u/2);l.style.animationDelay=`${d*.4}s`})}if(i&&c[3]){const f=i.cloneNode(!0);c[3].appendChild(f);const o=f.querySelectorAll("polygon");o.forEach((u,h)=>{const d=u.getAttribute("fill")||"#000";u.style.setProperty("--original-fill",d);let x="";h===0||h===1?x="translate(15px, 15px)":h===2||h===3?x="translate(-15px, 15px)":(h===4||h===5)&&(x="translate(0px, -15px)"),u.style.setProperty("--move",x)}),[[0,1],[2,3],[4,5]].forEach((u,h)=>{u.forEach(d=>{const x=o[d];setTimeout(()=>{x.classList.add("group-animate")},h*1500)})})}}catch(t){console.error("Failed to load SVG:",t)}}}customElements.define("logo-page",fS);window.addEventListener("DOMContentLoaded",()=>{q4();let e=document.querySelector("main-header");e||(e=document.createElement("main-header"),document.body.prepend(e));let r=document.getElementById("mainContainer");r||(r=document.createElement("div"),r.id="mainContainer",document.body.appendChild(r)),kd()});async function kd(){const e=document.querySelector("main-header"),r=document.getElementById("mainContainer"),t=document.getElementById("login"),n=document.querySelector("main-header").shadowRoot.querySelector("#logoutButton");n.onclick=async()=>{console.log("Logout button clicked"),await g0.signOut(),r.innerHTML="",e.style.display="none",n.style.display="none",e.classList.remove("visible"),r.classList.remove("visible"),r.classList.add("hidden"),t.resetSendLinkButton(),t.show()},await g0.isAuthenticated()?(console.log("User is authenticated - showing header + main container"),e.style.display="block",n.style.display="block",r.classList.remove("hidden"),t.style.display="none",r.innerHTML="",r.appendChild(document.createElement("tree-bom-page")),lS(),setTimeout(()=>{e.classList.add("visible"),r.classList.add("visible")},50)):(console.log("User is NOT authenticated - hiding header + showing login"),e.style.display="none",n.style.display="none",r.innerHTML="",t.show())}function zi(e){const r=document.getElementById("mainContainer");r.innerHTML="",e.classList.add("page-content","slide-up-enter"),r.appendChild(e),requestAnimationFrame(()=>{e.classList.add("slide-up-enter-active")}),setTimeout(()=>{e.classList.remove("slide-up-enter","slide-up-enter-active")},300)}function lS(){document.addEventListener("navigate",e=>{const r=e.detail;r==="treebom"?zi(document.createElement("tree-bom-page")):r==="cluster"?zi(document.createElement("cluster-page")):r==="logo"&&zi(document.createElement("logo-page"))})}let Xi=!1;document.addEventListener("toggleDarkMode",()=>{Xi=!Xi,document.body.classList.toggle("dark-mode",Xi)});document.addEventListener("login-success",()=>{console.log("login-success event received - re-checking auth via init()"),kd()});
